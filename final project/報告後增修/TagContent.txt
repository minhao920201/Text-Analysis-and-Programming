標題:M1晶片的MacBook Pro在使用Jupyter Notebook時無法更改檔案名稱
標籤:#python 3 #python問題 #apple mac #jupyter notebook 

M1晶片的MacBook Pro之前在使用Jupyter Notebook時都能正常更改檔案名稱，但是今天要更改新的檔案名稱時卻發現不能更改了!
以下是更改檔案名稱時出現的錯誤代碼：
Traceback (most recent call last): File "/Users/hotsungkai/miniforge3/envs/DL/lib/python3.9/site-packages/tornado/web.py", line 1704, in _execute result = await result File "/Users/hotsungkai/miniforge3/envs/DL/lib/python3.9/site-packages/tornado/gen.py", line 234, in wrapper yielded = ctx_run(next, result) File "/Users/hotsungkai/miniforge3/envs/DL/lib/python3.9/site-packages/notebook/services/contents/handlers.py", line 135, in patch model = yield maybe_future(cm.update(model, path)) File "/Users/hotsungkai/miniforge3/envs/DL/lib/python3.9/site-packages/notebook/services/contents/manager.py", line 296, in update self.rename(path, new_path) File "/Users/hotsungkai/miniforge3/envs/DL/lib/python3.9/site-packages/notebook/services/contents/manager.py", line 284, in rename self.rename_file(old_path, new_path) File "/Users/hotsungkai/miniforge3/envs/DL/lib/python3.9/site-packages/notebook/services/contents/filemanager.py", line 579, in rename_file raise web.HTTPError(400, f'Cannot rename file or directory {os_path!r}') NameError: name 'os_path' is not defined


標題:python 程式問題
標籤:程式設計 python 上機實作 函式 

求救  這兩題要怎麼做



標題:請問怎麼用np.unique來計算一個csv檔裡面的某個欄位有幾個?
標籤:np.unique csv len python入門 

由於好像沒辦法上傳csv檔
所以我就把csv檔裡面的東西截圖下來放上去
然後我用的方法寫出來感覺也沒算出report_id這個欄位有幾個,只是用list方式顯示出來，很長一條，也沒算出有幾個，是要用len嗎? 試過幾次都是錯誤 還是哪裡需要修改? 程式放下面
x = list(df["report_id"])
print(x)
type(x)
unique_values = np.unique(x)
unique_values, counts = np.unique(x, return_counts=True)


#unique, counts = np.unique(x, return_counts=True)
#print(np.unique(x))

這是執行後的結果，可以請好心人幫忙協助，看是要修改哪裡嗎?



標題:Error 'Player' object has no attribute 'rect' (已解決)
標籤:python python系列文章 

import pygame as pg

fps=60#貞數
width=500
height=600
white=(255,255,255)
green=(0,255,0)
pg.init()#遊戲初始化
screen=pg.display.set_mode((width,height))#視窗大小
pg.display.set_caption("JCP的手槍")#遊戲標題
clock=pg.time.Clock()#建立一個物件，對時間做管理及操控

class Player(pg.sprite.Sprite):
  def _init_(self):
      pg.sprite.Sprite.__init__(self)#內建Sprite初始函式
      self.image=pg.Surface((50,40))#顯示圖片
      self.image.fill(green)
      self.rect=self.image.get_rect()#定位圖片(把圖片框起來)
      self.rect.center=(width/2,height/2)
  
  def update(self):
      self.rect.x+=2
      if self.rect.left>width:
         self.rect.right=0

all_sprites=pg.sprite.Group()
player=Player()
all_sprites.add(player)

#遊戲迴圈
running=True
while running:
  clock.tick(fps)#設定成60貞，解決玩家電腦性能不一的問題  
  #取得輸入，如果玩家點出去，則遊戲停止
  for event in pg.event.get():
    if event.type==pg.QUIT:
       running=False
  
  #更新遊戲
  all_sprites.update()

  #畫面顯示(調色)
  screen.fill(white)
  all_sprites.draw(screen)
  pg.display.update()

pg.quit



標題:Day12 LINE BOT & 天氣預報 - 2  問題請教!!!
標籤:python3.9 linebot 天氣 

Hi Koios1143您好：
我是jinjon，今天在瀏覽您的這篇文章後，試著在我的NB環境執行，有些問題想請教您，不知是否可以呢?
我的NB環境說明如下：
Win 11 Home中文版
Python 3.9.7
Spyder IDE 5.1.5
Line bot 設定完成
將程式碼在我的 Spyder 執行後，調整一些錯誤後(將encoding='utf-8'拿掉)，在line上輸入"新竹市"，linebot 會回覆 新竹市，但是輸入"天氣 新竹市"時，它就會出現下列錯誤訊息：
[2022-06-15 01:28:50,564] ERROR in app: Exception on /callback [POST]
Traceback (most recent call last):
File "C:\Users\jinjo\anaconda3\lib\site-packages\flask\app.py", line 2447, in wsgi_app
response = self.full_dispatch_request()
File "C:\Users\jinjo\anaconda3\lib\site-packages\flask\app.py", line 1952, in full_dispatch_request
rv = self.handle_user_exception(e)
File "C:\Users\jinjo\anaconda3\lib\site-packages\flask\app.py", line 1821, in handle_user_exception
reraise(exc_type, exc_value, tb)
File "C:\Users\jinjo\anaconda3\lib\site-packages\flask_compat.py", line 39, in reraise
raise value
File "C:\Users\jinjo\anaconda3\lib\site-packages\flask\app.py", line 1950, in full_dispatch_request
rv = self.dispatch_request()
File "C:\Users\jinjo\anaconda3\lib\site-packages\flask\app.py", line 1936, in dispatch_request
return self.view_functionsrule.endpoint
File "D:\PythonProject\氣候達人\weather-36h-2.py", line 27, in callback
handler.handle(body, signature)
File "C:\Users\jinjo\anaconda3\lib\site-packages\linebot\webhook.py", line 259, in handle
self.__invoke_func(func, event, payload)
File "C:\Users\jinjo\anaconda3\lib\site-packages\linebot\webhook.py", line 271, in __invoke_func
func(event)
File "D:\PythonProject\氣候達人\weather-36h-2.py", line 80, in handle_message
res = get(city)
File "D:\PythonProject\氣候達人\weather-36h-2.py", line 41, in get
res = json.load(open('card.json','r'))
FileNotFoundError: [Errno 2] No such file or directory: 'card.json'
{"destination":"Ub4f57f0b6db3e790b0871de9058bc09c","events":[{"type":"message","message":{"type":"text","id":"16261973442172","text":"天氣 新竹市"},"webhookEventId":"01G5HM5J068F875YRER6J148PA","deliveryContext":{"isRedelivery":false},"timestamp":1655227729450,"source":{"type":"user","userId":"Ubc5678016cee49e3cd2d7a332cf6da49"},"replyToken":"56314d12e09b4cf197de5b8e6abdf9cf","mode":"active"}]}
127.0.0.1 - - [15/Jun/2022 01:28:50] "POST /callback HTTP/1.1" 500 -
請問這些錯誤產生，是否我有少了什麼步驟呢? 您程式裡面的open「card.json , bubble.json」這二個檔案是要如何產生呢?
謝謝





標題:Python 整理大檔案txt 如何擷取在關鍵字之間的段落
標籤:python3 擷取txt文字 

各位前輩好,我是最近在學習Python的新手,若有敘述不完全的部分敬請告知
我現在在分析一個大型的檔案,使用python3,我想擷取的部分大概是這樣
ORIGIN
1 data data data data data.........
61 data data data data data........
121 data data data data data.....
//
irrelative irrelative irrelative irrelative irrelative irrelative
irrelative irrelative irrelative irrelative irrelative irrelative
ORIGIN
1 data data data data data.........
61 data data data data data........
121 data data data data data.....
181 data data data data data ......
//
簡單來說 我想擷取的部分是被'ORIGIN'與'//'給框住的部分 並且分段 每組data的長度不一 有40行的資料也有超過300行的 然後有多段資料
目前嘗試過https://ithelp.ithome.com.tw/questions/10202583
當中JaphenChen大大的方法 但只能順利print第一筆資料

於是改用findall 再用join去拆解list 結果Spyder炸了 所以也不太確定結果究竟如何
麻煩各位大大協助指教


標題:python 猜數字遊戲按下開始就沒有回應了
標籤:python 猜數字 錯誤 沒有回應 

程式一定有錯但是我不知道在哪裡請各位大神幫幫我
import tkinter as tk
import random

def play():  
    rankc = int(rank_en.get())
    
    if rankc == 1 : 
       easy(rank1)
    if rankc == 2 :
        normal(rank1)
    if rankc == 3 :
        hard(rank1)
        
def easy(rank):
    n = random.randint(1,10)
    a = 0
    while True:
        a = a+1
        gue = gus_en.get()
        if gue.isdigit():
            gue = int(gue)
            if gue > n:
                print(gue,"太大了")
            elif gue < n:
                print(gue,"太小了")
            else :
                print("恭喜你猜對了,你猜了",a,'次')
                break

def normal(rank):
    n = random.randint(1,100)
    a = 0
    while True:
        a = a+1
        gue = gus_en.get()
        if gue.isdigit():
            gue = int(gue)
            if gue > n:
                print(gue,"太大了")
            elif gue < n:
                print(gue,"太小了")
            else :
                print("恭喜你猜對了,你猜了",a,'次')
                break

def hard(rank):
    n = random.randint(1,200)
    a = 0
    while True:
        a = a+1
        gue = gus_en.get()
        if gue.isdigit():
            gue = int(gue)
            if gue > n:
                print(gue,"太大了")
            elif gue < n:
                print(gue,"太小了")
            else :
                print("恭喜你猜對了,你猜了",a,'次')
                break
rank1 = []
win = tk.Tk()

win.title('猜數字遊戲')
win.geometry('600x600')
win.configure(background ='gray' )

ha = tk.Label(win,text =  '終極密碼',font = ('標楷體',30))
ha.pack()

rankf=tk.Frame(win)
rankf.pack()

rank = tk.Label(rankf,text = '選擇難度 1.簡單(1~10)  2.普通(1~100)  3.困難(1~200) :',font = ('標楷體',15))
rank.pack(side = tk.LEFT)
rank_en = tk.Entry(rankf)
rank_en.pack(side = tk.LEFT)

run = tk. Button(win)
run.pack()

p_button=tk.Button(win,text = '開始',command = play)
p_button.pack()

gus=tk.Frame(win)
gus.pack()

guse = tk.Label(gus,text = '猜的數字:',font = ('標楷體',15))
guse.pack(side = tk.LEFT)
gus_en = tk.Entry(gus)
gus_en.pack(side = tk.LEFT)



r_label = tk.Label(win)
r_label.pack() 


win.mainloop()



標題:python 架站問題請教
標籤:python3 web 

您好：
初學python,若後續要自學開發網站
請問，
1.是否有類似 xamp的那種架站包?(apache+ mysql + php)  免安裝?
2.VS CODE 可以直接開發?
謝謝!


標題:python 連接mysql不知道程式碼中哪裡出了問題...這卡了我兩天還是找不到解決辦法，真心懇求各位帥哥美女的幫忙
標籤:python mysql phpmyadmin 

https://img.onl/n92Sya
錯誤問題
IndexError                                Traceback (most recent call last)
 in 
143     champions(insertornot,date)
144
--> 145 main()
146
147
 in main()
141         mycursor.execute(creat)
142
--> 143     champions(insertornot,date)
144
145 main()
 in champions(insertornot, date)
59         n = 0
60         rk = 0
---> 61         for item in test[x].select('.champion-index-table__name'):
62             name = item.text
63             rank = test[x].find_all("td", class_="champion-index-table__cell champion-index-table__cell--rank")[rk].text
IndexError: list index out of range
程式碼如下
import requests
from bs4 import BeautifulSoup
import sys
import mysql.connector
mydb = mysql.connector.connect(
host="127.0.0.1",
user="root",
passwd="",
database="opgg"
)
mycursor = mydb.cursor()
def champions(insertornot,date):
tablename = date + "_champions"
res = requests.get("http://tw.op.gg/champion/")
soup = BeautifulSoup(res.text, features="html.parser")
# for champoin in soup.select(".champion-index__champion-item__name"):
#    champoins.append(champoin.text)
# 取得所有英雄名字
# print(champoins) #印出所有英雄名字
# result =soup
# TOPname= soup.select("tbody.tabItem.champion-trend-tier-TOP .champion-index-table__name")
# TOPwinrate = soup.select("tbody.tabItem.champion-trend-tier-TOP .champion-index-table__cell champion-index-table__cell--value")
# for item in TOPwinrate:
#    print(item.text)

# print(TOP.select("champion-index-table__cell champion-index-table__cell--rank")[0].text)

# for chapname in soup.select(".tabItem champion-trend-tier-TOP"):
#    print(chapname.select(".champion-index-table__name selectorgadget_selecteds").text)

soup = BeautifulSoup(res.text, features="html.parser")
test = soup.findAll('tbody')

# w =test[0].select('.champion-index-table__name')
# print(test[1].text)
# print(test[0].find_all("td", class_="champion-index-table__cell champion-index-table__cell--value")[0].text)
# test1 = test[0].find_all("td", class_="champion-index-table__cell champion-index-table__cell--value")[0].text
# test1 = test1.replace('%','')
# test2 = float(test1)
# print(test2)
# for item in test[0].find_all("td", class_="champion-index-table__cell champion-index-table__cell--value")[1].text:
#    print(item.text)

def insertchampions(rank, name, win, pick, position):
    sql = "INSERT INTO " + tablename + " (rank , name, winrate ,pickrate ,position) VALUES (%s, %s ,%s ,%s,%s)"
    val = (rank, name, win, pick, position)
    mycursor.execute(sql, val)
    mydb.commit()

position = ['Top', 'Jungle', 'Middle', 'Bottom', 'Support']

for x in range(0, 5):
    print(position[x])
    n = 0
    rk = 0
    for item in test[x].select('.champion-index-table__name'):
        name = item.text
        rank = test[x].find_all("td", class_="champion-index-table__cell champion-index-table__cell--rank")[rk].text
        rk += 1
        win = test[x].find_all("td", class_="champion-index-table__cell champion-index-table__cell--value")[n].text
        win = win.replace('%', '')
        win = float(win)
        n += 1
        pick = test[x].find_all("td", class_="champion-index-table__cell champion-index-table__cell--value")[n].text
        n += 2
        pick = pick.replace('%', '')
        pick = float(pick)
        if insertornot == 'y':
            insertchampions(rank, name, win, pick, position[x])
            url="http://www.op.gg/champion/"+name+"/statistics/"+position[x]+"/matchup?"
            counter(name,url ,insertornot,position[x],date)
        else:
            pass
        #print(item + win + pick)
        print("名字:{name} 排名:{rank} 勝率:{win} 選用率:{pick}".format(name=name, rank=rank, win=win, pick=pick))
        # print('{name} is {age} years old!'.format(name = 'Justin', age = 35))
        

def counter(champoin,url,insertornot,position,date):
tablename = date + "_counters"
def insertcounter(name, cname, cwin, crate,times, position):
    sql = "INSERT INTO " + tablename + " (name , cname, cwin ,crate,times ,position) VALUES (%s, %s ,%s, %s ,%s,%s)"
    # (name VARCHAR(25) ,cname VARCHAR(25) , winrate FLOAT(20) ,cwin FLOAT(20),crate FLOAT(20),position VARCHAR(10),date INT(10) NOT NULL DEFAULT
    val = (champoin, cname, cwin, crate,times, position)
    mycursor.execute(sql, val)
    mydb.commit()
cookies = dict(customLocale='en_US')
res = requests.get(url, cookies=cookies)
soup = BeautifulSoup(res.text, features="html.parser")
times = soup.select('.champion-matchup-champion-list small')  # 對線次數
nwr = soup.select('.champion-matchup-champion-list span')  # 名字勝率機率

# print(test)
t = 0  # t是次數
n = 0  # n是名字、勝率、機率
# print(nwr[3].text)
for item in times:

    counter = times[t].text
    counter = counter.replace(',', '')
    counter = int(counter)
    t += 1

    cname = nwr[n].text
    n += 1

    cwin = nwr[n].text
    cwin = str(cwin).strip()
    cwin = cwin.replace('%', '')
    cwin = float(cwin)
    n += 1

    crate = nwr[n].text
    crate = str(crate)
    crate = crate.replace('%', '')
    crate = float(crate)

    n += 1
    #print("名字:{cname} 勝率:{cwin} 次數:{counter} 機率:{crate}".format(cname=cname, cwin=cwin, counter=counter, crate=crate))
    if insertornot =='y':
        insertcounter(champoin, cname, cwin, crate,counter, position);

def main():
insertornot = input('是否存入資料庫(y/whatever):')
date = input('輸入今天日期(Ex:20181225)：')
if insertornot == 'y':

    tablename = date+"_champions"
    creat="CREATE TABLE "+ tablename + " (rank INT(10), name VARCHAR(25) , winrate FLOAT(20) ,pickrate FLOAT(20),position VARCHAR(10),date INT(10) NOT NULL DEFAULT " + date +")"
    mycursor.execute(creat)
    tablename = date+"_counters"
    creat="CREATE TABLE "+ tablename + " (name VARCHAR(25) ,cname VARCHAR(25)  ,cwin FLOAT(20),crate FLOAT(20),times INT(10),position VARCHAR(10),date INT(10) NOT NULL DEFAULT " + date +")"
    mycursor.execute(creat)

champions(insertornot,date)

main()


標題:PYTHON如何讀取EXCEL檔案中相對位置並讓它匯成EXCEL
標籤:python excel 

各位大大，大家好，我是PYTHON初學者，就EXCEL或者利用PYTHON有沒有辦法把工作表1數值類似取特定位置但是我想要工作表2能塞選個機制就比如工作表1一列1,2,3,4,5,6,7,8,9,10
工作表2一列0,0,1,1,0,0,1,0,1,0
能匯出比如相對位置以第二工作表為主(我要取0那個位置)
匯出新的EXCEL出1,2,5,6,8,10這樣而已啊


標題:要怎麼解決斜線在括弧裡無法使用的問題
標籤:python入門 python 

Bug:"(" was not closed
code = code.replace('\', 'I')



標題:python如何判斷xls裡有巨集
標籤:python xls xlsm win32com vba 

大家好, 我是 python 初學者, 目前使用 python 正在寫一個 xls2xlsx 程式, 但忽然想到有些 xls 裡有巨集存在, 不知道 python 要如何判斷 xls 裡有巨集?? 若 xls 有巨集則自動轉存成 xlsm
目前我是使用 win32com
我曾參考過這個文章 (Python win32com模块操作Excel：VBA模块读写)
會出現: 不信任以程式設計方式存取 Visual Basic 專案
不知道我錯在哪了
1.我是 office 2007
2.python 3.8.10, 模組全部更新到最新
3.已開啟信任中心的巨集設定: "啟用所有巨集"及勾選"信任存取VBA專案物件模型"
懇請各位幫忙
錯誤訊息:
R->D:\prg_python\test\test.xls
Traceback (most recent call last):
  File "D:\prg_python\xlsVba.py", line 27, in <module>
    vba = wb.VBProject.VBComponents.Count
  File "C:\Users\user\AppData\Roaming\Python\Python38\site-packages\win32com\client\dynamic.py", line 628, in __getattr__
    ret = self._oleobj_.Invoke(retEntry.dispid, 0, invoke_type, 1)
pywintypes.com_error: (-2147352567, '發生例外狀況。', (0, 'Microsoft Office Excel', '不信任以程式設計方式存取 Visual Basic 專案\n', 'C:\\Program Files (x86)\\Microsoft Office\\Office12\\1028\\XLMAIN11.CHM', 0, -2146827284), None)

測試用程式碼如下:
# python 3.8.1
#
# 自動版
#
#
import os
import sys
import win32com.client
from win32com.client import Dispatch
# 搜尋條件
import fnmatch

readDir =r"D:\prg_python\test"
writeDir = readDir
fileType = ["*.xls"]
xlsFile = "test.xls"

readFile = readDir + "\\" + xlsFile
w = win32com.client.Dispatch('Excel.Application')
w.Visible = 0
w.DisplayAlerts = 0
origin_val = w.Application.AutomationSecurity
w.Application.AutomationSecurity = 1
print("R->" + readFile )
wb = w.Workbooks.Open(readFile)       
vba = 0                   
vba = wb.VBProject.VBComponents.Count

if vba == 0:
   writeFile = readFile + "x"
   wb.SaveAs(writeFile,FileFormat = 51)
   print("W>>"+  writeFile)
else:
   writeFile = readFile + "m"
   wb.SaveAs(writeFile,FileFormat = 52)

wb.Close()
w.Application.AutomationSecurity = origin_val
w.Quit()# 退出
# 刪除舊檔
try:
   if vba == 0:
      os.remove(readFile)
except OSError as e:
   print(e)
else:
   print("File is deleted successfully")
                
sys.exit(0)




標題:問答程式跑不出題目
標籤:python入門 

from untitled5 import Question        

choose1=[
    "有沒有想我啊?\n (a)當然摟 想死你了\n (b)怎麼可能 我已經忘記你勒\n",
]
questions = [
    Question(choose1[0],"a"),
]
def test(questions):
    for question in questions:        
        answer = input(question.description)
        if answer == question.answer:
            print("太棒了","看你疑惑的眼神,我還以為你忘了我(","給予","一個大大的擁抱")
               
        if answer != question.answer:
            print("琳達:真沒想到你竟然忘了我,我真的好難過")
            print("琳達跑走了")

class Question:
    def __init__(self,description,answer):
        self.description=description
        self.answer=answer

根據影片做了個問答程式 有小改過 但run的時候什麼都沒發生 很好奇怎麼沒跑出題目
請大神解惑


標題:(已解決)繪製matplotlib的bar狀圖，向大神求解
標籤:pandas python matplotlib bar chart 

目前是python初學，請教大大們
已整理原始資料如下
	       XSC1593	         XSP-BD0018
CAD001	3 days 03:33:02	 1 days 01:04:58
CAM001	1 days 02:00:05	             NaT
CNC001	0 days 03:00:00	             NaT
CNC002	            NaT	 0 days 06:59:57
EDM001	0 days 07:00:57	             NaT
EDM002	            NaT	 0 days 08:29:40

想繪製bar狀圖
x軸為[XSC1593,XSP-BD0018]
y軸為所花時間加總，如下圖(由excel輸出)

縱坐標希望調整為小時
希望透過程式直接繪圖輸出報表
麻煩各位大神協助，感恩


標題:(急!!!!!!)爬蟲+line bot 問題
標籤:python line messaging api linebot 

想請問要怎麼把執行出來的\n去除，且要如何放進line bot程式裡?
試了很久都用不出來

import requests
from bs4 import BeautifulSoup
url1 = 'https://invoice.etax.nat.gov.tw/'
html1 = requests.get(url1)
moneys = [["期別","頭獎","特別獎","特獎","頭獎","增開六獎"]]
sp = BeautifulSoup(html1.text, 'lxml')
all1 = sp.find("div", class_="container-xl")
#print(all1)
date = sp.find("div", class_="carousel-item active").find('a')
tb = sp.find('span', class_='font-weight-bold etw-color-red')
t = sp.find_all('span', class_='font-weight-bold etw-color-red')[1]
head1 = sp.find("p", class_="etw-tbiggest mb-md-4")
head2 = sp.find_all("p", class_="etw-tbiggest mb-md-4")[1]
head3 = sp.find_all("p", class_="etw-tbiggest mb-md-4")[2]
add1 = sp.find_all("span", class_="font-weight-bold etw-color-red")
money=[date.text,
tb.text,
t.text,
head1.text,
head2.text,
head3.text,
add1[-1].text]
moneys.append(money)
for money in moneys:
print(money)


標題:文字雲問題
標籤:#python #文字雲 

請問為什麼文字雲產生的時候每個字詞後面都會有'符號呢?
https://drive.google.com/file/d/1WZ3xl37KX-HM71z_LVi1HIuPtuzTVX2h/view?usp=sharing
# 資料整理
comment = pd.read_csv('drink留言內容.csv')

removeword = ['span','class','f3','https','imgur','h1','_   blank','href','rel','nofollow','target','cdn','cgi','b4','jpg','hl','b1','f5','f4','goo.gl','f2','email','map','f1','f6','__cf___','data','bbs''html','cf','f0','b2','b3','b5','b6','原文內容','原文連結','作者''標題','時間','看板','<','>','，','。','？','—','閒聊','・','/','=','\"','\n','」','「','！','[',']','：','‧','╦','╔','╗','║','╠','╬','╬',':','╰','╩','╯','╭','╮','│','╪','─','《','》','_','.','、','（','）','　','*','※','~','○','”','“','～','@','＋','\r','▁',')','(','-','═','?',',','!','…','&',';','『','』','#','＝',"'"
,'\l','的','了','也','就','在','以','會','都','XD','不是','覺得','沒','喔','知道','店','可能','說','看到','感覺','應該']

for i in removeword:
    comment["content"] = comment["content"].apply(lambda x: str(x).replace(i,""))

sentence=''
#中文範例
for i in comment['content']:
    sentence=sentence+i
    print(sentence)

seg_list = jieba.cut(sentence, cut_all=False)
seg_list = jieba.lcut(sentence, cut_all=False)

def remove_stop_words(file_name,seg_list):
  with open(file_name,'r',encoding='utf-8') as f:
    stop_words = f.readlines()
  stop_words = [stop_word.rstrip() for stop_word in stop_words]
  new_list = []
  
  for seg in seg_list:
    if seg not in stop_words:
      new_list.append(seg)
  return new_list


#統計詞頻
file_name = 'stopwords.txt'
seg_list = remove_stop_words(file_name,seg_list)

def count_segment_freq(seg_list):
  seg_df = pd.DataFrame(seg_list,columns=['seg'])
  seg_df['count'] = 1
  sef_freq = seg_df.groupby('seg')['count'].sum().sort_values(ascending=False)
  sef_freq = pd.DataFrame(sef_freq)
  return sef_freq
sef_freq = count_segment_freq(seg_list)
sef_freq.head()


font_path = r'msjh.ttc'
wc = WordCloud(background_color='black',font_path=font_path)
wc.generate(str(seg_list))
plt.imshow(wc)
plt.axis("off")
plt.show()




標題:python dataframe求問
標籤:python系列文章 

請使用者輸入姓名與各科成績，
以建立成績資料。輸入完畢後-1跳出，
並利用DataFrame列印你輸入的成績。


標題:[深度學習] 多輸入模型用.flow_from_directory()卻只讀到其中一個資料夾
標籤:深度學習 python 

首先感謝點進來的各位大大們，這是小弟我第一次在此發問，排版較差，還請大家耐心看完。
問題:
目前正在學習如何使用多輸入模型，但遇到的這個問題在網路上找了許久卻找不到解決方法。
這是本該input進去的資料:
訓練資料1: origin: 5 classes, 150 images
訓練資料2: entropy: 5 classes, 150 images
驗證資料1: origin: 5 classes, 150 images
驗證資料2: entropy: 5 classes, 150 images
也就是說本來預期會得到以下這樣的結果
Found 150 images belonging to 5 classes.
Found 150 images belonging to 5 classes.
Found 150 images belonging to 5 classes.
Found 150 images belonging to 5 classes.

但卻只出現以下結果
Found 150 images belonging to 5 classes.
Found 150 images belonging to 5 classes.

檢查後發現只有訓練資料1: origin 和驗證資料1: origin 被抓進去，請問各位大大該如何解決此問題?
以下為程式碼
train_gen = ImageDataGenerator()
test_gen = ImageDataGenerator()

def generate_generator_multiple(generator, dir1, dir2, batch_size, img_rows, img_cols):
    
    genX1 = generator.flow_from_directory(
                                dir1,
                                target_size = (img_rows, img_cols),
                                #target_size = (64, 64),
                                # 遵照論文所示，將batch_size 設定為8
                                batch_size = batch_size,
                                #shuffle=False,
                                class_mode = 'categorical',
                                seed=666
                                )
    
    genX2 = generator.flow_from_directory(
                                dir2,
                                target_size = (img_rows, img_cols),
                                #target_size = (64, 64),
                                # 遵照論文所示，將batch_size 設定為8
                                batch_size = batch_size,
                                #shuffle=False,
                                class_mode = 'categorical',
                                seed=666
                                )
    
    while True:
            X1i = genX1.next()
            X2i = genX2.next()
            yield [X1i[0], X2i[0]], X2i[1]  #Yield both images and their mutual label
                       
inputgenerator = generate_generator_multiple(
                                            generator=train_gen,
                                            dir1=train_origin_dir,
                                            dir2=train_entropy_dir,
                                            batch_size=batch_size,
                                            img_rows=img_rows,
                                            img_cols=img_cols
                                            )       
     
testgenerator = generate_generator_multiple(
                                           generator=test_gen,
                                           dir1=test_origin_dir,
                                           dir2=test_entropy_dir,
                                           batch_size=batch_size,
                                           img_rows=img_rows,
                                           img_cols=img_cols
                                           )
                                           
---- 中間為神經網路的架構----

history = model.fit(
          inputgenerator,
          steps_per_epoch = trainsetsize/batch_size,
          validation_data = testgenerator,
          validation_steps = testsetsize/batch_size,
          epochs = epochs,
          callbacks = callbacks_list,
          verbose = 2
          )

只出現
Found 150 images belonging to 5 classes.
Found 150 images belonging to 5 classes.
Epoch 1/1000



標題:請問Python出現NotImplementedError，要怎麼處理，ARMA 才能出來
標籤:python python系列文章 arma 

我是位學生，在建立ARMA中遇到一些問題，已經有問過老師，老師沒辦法解決這個問題，也找過網路但還是不行，所以上來尋求幫忙。
在我的電腦上打了以下的程式碼之後出現錯誤，程式碼是從老師那邊複製下來的，在老師的電腦上沒有出現NotImplementedError
程式碼:
from statsmodels.tsa import arima_model
model1=arima_model.ARIMA(CPItrain,order=(1,0,1)).fit()
model1.summary()
出來結果:
NotImplementedError:
statsmodels.tsa.arima_model.ARMA and statsmodels.tsa.arima_model.ARIMA have
been removed in favor of statsmodels.tsa.arima.model.ARIMA (note the .
between arima and model) and statsmodels.tsa.SARIMAX.
statsmodels.tsa.arima.model.ARIMA makes use of the statespace framework and
is both well tested and maintained. It also offers alternative specialized
parameter estimators.

=> 有想過是不是程式的問題，所以重新下載anaconda，重新下載後還是有出現錯誤。
=> 上網找，把程式碼修改後
程式碼:
import statsmodels.api as sm
model1 = sm.tsa.arima.ARIMA(CPItrain, order=(1,0,1)).fit()
model1.summary()

但出來的不是ARMA Model Results 是 SARIMAX Results ，也有進行程式碼的其他修改，但最後出來的不是NotImplementedError，就是 SARIMAX 的圖。
=>有嘗試再次安裝statsmodels，但也還是有一樣的問題出現。
想請問有甚麼解決方法能讓ARMA Model Results出來，而不是出現錯誤或是SARIMAX。
謝謝


標題:python-四則運算與資料結構(?)
標籤:python python入門 python 3 資料結構與演算法 演算法 

目前在練習四則運算，我想自己寫判斷，不使用eval()來操作，
我的解題想法是把運算式子用陣列表達，最後會是多層陣列。

x="2*9*3+5*8/2+60*10/5/1"
#經過我的split之後會變成以下:
x=[[['2'], ['9'], '3'], [['5'], ['8', '2']], [['60'], ['10', '5', '1']]]
#我是先分割加減，然後才是乘法，最後是除法

接下來我就知道answer=x[0]+x[1]+x[2]，因為第一次分割是加法。
所以要處理這三項，而每一項裡面的值是相乘：
x[0]=x[0][0]*x[0][1]*x[0][2]
x[1]=x[1][0]*x[1][1]

以此類推
最後要處理除法就會像是這樣

x[2][1]=x[2][1][0]/x[2][1][1]/x[2][1][2]

思考方向講完了，接下來是操作，我試圖用一個函式去丟出某陣列的所有項，
但我不知道該如何把所有項拿來運作乘除。
def AllofArr(test):
    for i in range(len(test)):
        if type(test[i])==list:
            return AllofArr(test[i])
        print(test[i],end="")#這裡我只能把項都丟出來 實際上我想要讓他們運算


後來我想到物件導向與類別之類的觀念，試圖建立一個class

class Book:
    def __init__(self,one,two,three,long):
        self.one=one
        self.two=two
        self.three=three
        self.long=long
    
    #我想讓某陣列裡面的所有值存起來，目前先操作三項而已
def SaveValue(A):
    if len(A)==3:
        s=Book(A[0],A[1],A[2],3)
    
    if len(A)==2:
        s=Book(A[0],A[1],'null',2)
    
    if len(A)==1:
        s=Book(A[0],'null','null',1)
    return s


#這個是想要call出某一項的值的函式
def One(A):
    q=SaveValue(A).one
    return q

def Two(A):
    q=SaveValue(A).two
    return q
 
def SaveValue(A):
    q=SaveValue(A).three
    return q

目前寫到這邊，整體好像已經到一個極限了，不知道該如何操作下去。
我希望能依照我的最初思路去解，
似乎還差遞迴或是一個漂亮的迴圈，因為我知道我這種想法勢必會面對以下的code：
One(One(Three(One(x))))

One(One(One(x)))
Two(Two(One(x)))
One(Three(One(x)))

這種東西……
對於這題，我有看到有人提出DFS與BFS的演算法，我想知道跟我的作法是否有類似？
稍微去看了教學影片，感覺是很棒的東西，
但在自己的code中不太知道如何運用。
想問如果要用我這種處理陣列的方式解題，該怎麼把它寫完？


標題:python 接近值
標籤:python 

我最近有一個問題，但沒有方向，就是關於股票的跳動，因為它有限制，我想寫一支程式，假設我自己做了分析得出我想買在15.02元，但因股價限制，我只能買在15.05元，我可以用什麼方法讓我輸入15.02，但結果得出15.05元。不知道各位大大可否指點個方向，謝謝!!


標題:pisa.createpdf該如何套中文
標籤:python cartridge pdf 中文 pisa 

我在寫mezzanine cms的 cartridge時 想產生發票pdf檔但出現亂碼，希望有高手教我套字體。


標題:使用pyinstaller打包後因py檔內包含.gif無法開啟(已解決)
標籤:python 

我寫了個程式打算使用pyinstaller打包，過程結果是顯示successfully，但開啟後都會出現
https://ithelp.ithome.com.tw/upload/images/20220605/20149232st8FJrZS22.png
我有上網參考將圖片資料夾加入的部分

https://blog.csdn.net/qq_42952590/article/details/119179920
但仍然無法解決，故想請教還有什麼辦法可以解決，謝謝。



標題:如何讓2個column的分析直方圖轉為有比例的圓餅圖？
標籤:python seaborn database 資料分析 資料探勘 

各位大神好，點進來非常感謝您！
標體可能描述的不是很清楚請見諒！我想請教以下問題：
我正在做疫情的資料分析，正在做到每個特徵值對上死亡率並想要呈現兩個之間的比例差異時發現效果不是很清楚:

hipertension:高血壓（1為有，2為沒有）
如果單從直方圖來看並不太能簡單發現有高血壓的人比較容易死亡。
所以因此想要把直方圖轉成兩個圓餅圖。
示意圖

請問要怎麼做？感謝！！
附上程式碼：
plt.figure( figsize=(10,5), facecolor="#FFF8DC")
gs = gridspec.GridSpec(len(selected_cols),1)            
ax = plt.subplot( gs[i] )
ax.grid(color='#000000', linestyle=':', axis='y', zorder=0,  dashes=(1,5))
sns.countplot(ax=ax, data=train, x='HIPERTENSION', palette = 'Oranges', hue='DEATH',edgecolor='black',**{'hatch':'/','linewidth':2})
ax.set_ylabel("",fontsize=14, fontweight='bold', fontfamily='serif', color="#000000") 
ax.set_facecolor("#FFF8DC")

plt.show()



標題:Python 超新手-next()
標籤:python入門 python 

各位大大, 想請教一下為什麼以下
print(next(multi_yield()))和你print(next(multi_obj))結果會不一樣？謝謝??
def multi_yield():
yield_str = ‘first string’
yield yield_str
yield_str = ‘second string’
yield yield_str
multi_obj = multi_yield()
print(next(multi_obj))
#output: first string
print(next(multi_obj))
#output:second string
p rint(next(multi_yield()))
#output: first string
p rint(next(multi_yield()))
#output: second string


標題:Python安裝後無法執行Message: session not created exception: Missing or invalid capabilities
標籤:python selenium selenium webdriver 自動化測試 

照著網路上的教學安裝了Python和selenium
皆有顯示安裝完成的字樣
但當要執行程式時，一直跑出
【exited with code=1】以及【Message: session not created exception: Missing or invalid capabilities】
照了網路上的方式，檢查檔案和修改，還是無法執行
想請問有前輩知道這能怎麼解決嗎...?非常感謝


標題:在SQL語法內插入python變數方法
標籤:python3 mysql 

大家好 小弟我python新手 有問題想請教大家
我想寫一個class中的function可以輸入table名稱和插入的值
就可以直接寫入sql的databse中的table裡
但是在變數那塊不管是用format或是execute裡丟入變數都成功不了
不是出現沒有此column就是出現沒有這個table
已經確定column和table都是確實存在的，想請問有什麼方式解決



標題:python閏年計算
標籤:python入門 

小弟剛開始學程式，剛剛在看網路上大家講解閏年的計算時，發現大家在計算閏年時都會先從4開始除起。
例如:

然而，我自己在最開始想到的解決方法為從400開始檢查起，因為我認為如果可被400整除，即符合其他條件
程式如下:

想請教一下，這樣的解法是否有誤?


標題:想實現一個在個人電腦查詢的簡單系統
標籤:mysql python 

大家好，我是新手，最近學了mysql和前端語言和java還有python
想練習做一個生活上或用到的小工具
我最近想做一個輸入關鍵字，例如輸入YAHOO或是奇摩，下面就會列出有關YAHOO的相關訊息或是網址，有點類似字典查詢功能的app或網頁，但是因為只在自己電腦使用，所以不會租網域之類。
目前想法是把資料存在mysql的資料庫，然後寫網頁(框架)去把mysql的東西讀出來?但這個需要php技術嗎?我沒有學過php，不是說很理解要怎麼把mysql的資料傳到前端
另一個是我曾經試過一個笨方法，把資料全部用Python寫成字典，但缺點就是，我一定要輸入YAHOO或是yahoo之類，我只要輸入奇摩這種非YAHOO的關鍵字就不能找到資料。
想請大家幫我想看看有什麼方法可以讓我實現我的小工具。
感謝


標題:python：savgol_filter的使用
標籤:python 


想請問各位大神，savgol_filter的使用方式，以及該如何更改code!!


標題:Python  Flask 與 Flask-APScheduler 無法同時運行 (佈署在IIS上)
標籤:#python #python 3 #flask #apscheduler 

背景說明
如標題，
目前在測試Flask框架下，透過APScheduler定時執行任務，
Flask主程式跟APSceduler程式碼在同一個.py檔內，
並定時執行計數的工作，將計算值輸出到log.txt。
問題
將scheduler.start()寫在 if name == "main" 內，
就無法正常執行定時任務，但可以正確路由到網址，
如果把scheduler.start()移出來，
則定時任務正常執行，但就變成不能正確由到網址。
不知道是不是一次只能有一個thread在運行? 不知道有沒有相關文件可參考?
若是的話，該如何解決呢?
以下是程式碼的部分:
from flask import Flask
from apscheduler.schedulers.blocking import BlockingScheduler
import logging

app = Flask(__name__)

#設定Logging 參數
logging.basicConfig(level=logging.WARNING, filename='./log.txt',
	format='[%(asctime)s %(levelname)-8s] %(message)s',
	datefmt='%Y%m%d %H:%M:%S',
	)

#endregion

#時區設置
blockSched = BlockingScheduler(timezone="Asia/Taipei")

#region (測試用) APScheduler 用
initnum = 1
@blockSched.scheduled_job('interval', seconds=20)
def counter():
    global initnum
    total = initnum + 1 
    
    logging.error('計算: ' + str(total))
    print(total)

    initnum = total

#endregion


@app.route("/apstest")
def home():
    return "Hello Flask"

#blockSched.add_job(counter, 'interval', seconds=10)

#==== blockSched.start()，在這裡可以正常執行定時任務 ===========
#==== 但就變成無法正常路由到 /apstest ===========
#blockSched.start()

if __name__ == "__main__":
    #==== 可以正常路由到 /apstest ===========
    #==== 但就無法正常執行定時任務 ===========
    blockSched.start()
    app.run()




標題:python-在VS code終端機執行的錯誤問題
標籤:python vscode python入門 程式競賽 程式設計 

直接上圖

很明顯我code裡面的迴圈因為縮排沒弄好出錯了
現在終端機底下完全卡住沒辦法輸入
後來我找到方法重開終端機  只是還是無法跑x=input()這種
**後來把程式碼改對的  丟到測資那邊也通過  若我在互動式窗也可成功執行
跑出正確結果
**
只是還有圖片中的問題

以上  想問一下  一般打完python都一定要在互動式窗執行嗎?
終端機執行為什麼會不等使用者輸入input導致出錯呢?
那 除了互動式窗以外  是否還有別的執行方法


標題:python基礎-讓使用者輸入input卻沒有等待
標籤:python 練習 程式比賽 程式競賽 題目 


目的:
讓使用者輸入數字  再處理數字
問題:
沒有等待輸入數字  直接進行下去  導致錯誤
說明:
我用的環境是VS code 執行方法是shift+enter

以下是執行碼：
a=0
b=1
c=a+b
first=True
num = input("請輸入喔")


if int(num)<3:
    print("請輸入大於三的數字")
else:
    x=0
    while x < (num-3):
        a=b
        b=c
        c=a+b
        if (first==True):
            print("0 1 1 ",end="")
            first=False
        print(c,end="")
        print(" ",end="")
        x=x+1

錯誤顯示在此：


請問該如何調整呢 已經完成練習題的解答了(費式數列XD)
卡在不能輸入數值讓人很頭痛
是否要用別的執行方法或是改一下code


標題:HELP!!!!!!   python 設定S含有6個學生的姓名資料
標籤:python3 python python入門 

完全沒學過python但得上python課程，完全不懂，請專業人士救火，感激不盡！！！
（題目）
設定S含有6個學生的姓名資料, 請印出, 格式如下:
第 1筆   洪廷暐
第 2筆   邱卉妮
第 3筆   陳建勲


標題:tensorflow BP倒傳遞類神經 遇到問題
標籤:python3 tensorflow 

各位大大好，小弟剛入門寫PYTHON，我用tensorflow寫倒傳遞類神經，一直無法解決問題，之前可以跑，現在突然無法跑，不知道是不是漏掉什麼安裝包沒下載，原因暫時不曉得，希望大大們幫忙。
evaluations = []
STEPS = 400
for i in range(1250):
regressor.train(input_fn=wx_input_fn(X_train, y=y_train), steps=STEPS)
evaluations.append(regressor.evaluate(input_fn=wx_input_fn(X_val,
y_val,
num_epochs=1,
shuffle=False)))
以上是我的程式碼，結果跑出以下錯誤:
NotFoundError: Restoring from checkpoint failed. This is most likely due to a Variable name or other graph key that is missing from the checkpoint. Please ensure that you have not altered the graph expected based on the checkpoint. Original error:
2 root error(s) found.
(0) Not found: Key dnn/hiddenlayer_1/bias not found in checkpoint
[[node save/RestoreV2 (defined at \anaconda3\envs\bp-gpu\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py:1502) ]]
(1) Not found: Key dnn/hiddenlayer_1/bias not found in checkpoint
[[node save/RestoreV2 (defined at \anaconda3\envs\bp-gpu\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py:1502) ]]
[[save/RestoreV2/_7]]
0 successful operations.
0 derived errors ignored.
Original stack trace for 'save/RestoreV2':
File "\anaconda3\envs\bp-gpu\lib\runpy.py", line 197, in _run_module_as_main
return _run_code(code, main_globals, None,
File "\anaconda3\envs\bp-gpu\lib\runpy.py", line 87, in _run_code
exec(code, run_globals)
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel_launcher.py", line 16, in 
app.launch_new_instance()
File "\anaconda3\envs\bp-gpu\lib\site-packages\traitlets\config\application.py", line 846, in launch_instance
app.start()
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel\kernelapp.py", line 677, in start
self.io_loop.start()
File "\anaconda3\envs\bp-gpu\lib\site-packages\tornado\platform\asyncio.py", line 199, in start
self.asyncio_loop.run_forever()
File "\anaconda3\envs\bp-gpu\lib\asyncio\base_events.py", line 601, in run_forever
self._run_once()
File "\anaconda3\envs\bp-gpu\lib\asyncio\base_events.py", line 1905, in _run_once
handle._run()
File "\anaconda3\envs\bp-gpu\lib\asyncio\events.py", line 80, in _run
self._context.run(self._callback, *self._args)
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel\kernelbase.py", line 471, in dispatch_queue
await self.process_one()
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel\kernelbase.py", line 460, in process_one
await dispatch(*args)
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel\kernelbase.py", line 367, in dispatch_shell
await result
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel\kernelbase.py", line 662, in execute_request
reply_content = await reply_content
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel\ipkernel.py", line 360, in do_execute
res = shell.run_cell(code, store_history=store_history, silent=silent)
File "\anaconda3\envs\bp-gpu\lib\site-packages\ipykernel\zmqshell.py", line 532, in run_cell
return super().run_cell(*args, **kwargs)
File "\anaconda3\envs\bp-gpu\lib\site-packages\IPython\core\interactiveshell.py", line 2880, in run_cell
result = self._run_cell(
File "\anaconda3\envs\bp-gpu\lib\site-packages\IPython\core\interactiveshell.py", line 2935, in _run_cell
return runner(coro)
File "\anaconda3\envs\bp-gpu\lib\site-packages\IPython\core\async_helpers.py", line 129, in pseudo_sync_runner
coro.send(None)
File "\anaconda3\envs\bp-gpu\lib\site-packages\IPython\core\interactiveshell.py", line 3134, in run_cell_async
has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
File "\anaconda3\envs\bp-gpu\lib\site-packages\IPython\core\interactiveshell.py", line 3337, in run_ast_nodes
if await self.run_code(code, result, async=asy):
File "\anaconda3\envs\bp-gpu\lib\site-packages\IPython\core\interactiveshell.py", line 3397, in run_code
exec(code_obj, self.user_global_ns, self.user_ns)
File "\AppData\Local\Temp\ipykernel_21300\2606756210.py", line 4, in <cell line: 3>
regressor.train(input_fn=wx_input_fn(X_train, y=y_train), steps=STEPS)
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 350, in train
loss = self._train_model(input_fn, hooks, saving_listeners)
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1176, in _train_model
return self._train_model_default(input_fn, hooks, saving_listeners)
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1207, in _train_model_default
return self._train_with_estimator_spec(estimator_spec, worker_hooks,
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow_estimator\python\estimator\estimator.py", line 1502, in _train_with_estimator_spec
with training.MonitoredTrainingSession(
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 602, in MonitoredTrainingSession
return MonitoredSession(
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 1035, in init
super(MonitoredSession, self).init(
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 750, in init
self._sess = _RecoverableSession(self._coordinated_creator)
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 1232, in init
_WrappedSession.init(self, self._create_session())
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 1237, in _create_session
return self._sess_creator.create_session()
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 903, in create_session
self.tf_sess = self._session_creator.create_session()
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 661, in create_session
self._scaffold.finalize()
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\monitored_session.py", line 244, in finalize
self._saver.build()
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\saver.py", line 848, in build
self._build(self._filename, build_save=True, build_restore=True)
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\saver.py", line 876, in _build
self.saver_def = self._builder._build_internal(  # pylint: disable=protected-access
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\saver.py", line 509, in _build_internal
restore_op = self._AddShardedRestoreOps(filename_tensor, per_device,
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\saver.py", line 383, in _AddShardedRestoreOps
self._AddRestoreOps(
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\saver.py", line 335, in _AddRestoreOps
all_tensors = self.bulk_restore(filename_tensor, saveables, preferred_shard,
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\training\saver.py", line 583, in bulk_restore
return io_ops.restore_v2(filename_tensor, names, slices, dtypes)
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\ops\gen_io_ops.py", line 1489, in restore_v2
_, _, _op, _outputs = _op_def_library._apply_op_helper(
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 748, in _apply_op_helper
op = g._create_op_internal(op_type_name, inputs, dtypes=None,
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\framework\ops.py", line 3561, in _create_op_internal
ret = Operation(
File "\anaconda3\envs\bp-gpu\lib\site-packages\tensorflow\python\framework\ops.py", line 2045, in init
self._traceback = tf_stack.extract_stack_for_node(self._c_op)


標題:Python Selenium 用於蝦皮購物找尋元素
標籤:python selenium #蝦皮 selenium webdriver selenium 

請問使用Selenium應用於蝦皮找尋商品選項時，該如何持續偵測，未上架 (如圖反白，不能點選)的商品。
若發現未開賣的商品未上架時，就刷新頁面，再重新偵測，直到商品上架了，就自動點選該商品，然後再點擊購買。
我透過Selenium 八種定位方式，仍無法順利偵測，蝦皮的商品選項，都是用class命名，且命名方式相似，點選的商品選項又會不同。
目前測試結果都是，刷新介面後，就直接點選購買了，並沒有點選到我想要的商品選項，目標是想不停刷新介面，直到商品上架，就點選該商品選項，然後再點擊購買。
請各位大大幫幫解惑，自學Python所以不是很懂
以下部份Code
B = '//*[@id="main"]/div/div[2]/div[1]/div/div[2]/div/div[2]/div[3]/div/div[4]/div/div[3]/div/div[1]/div/button[1]'

while 1:
    try:
        buy1 = WebDriverWait(driver,1,0.4).until(EC.presence_of_all_elements_located((By.XPATH, B)))
        print('成功進入商品頁面')
        driver.find_element_by_xpath(B).click()
        print('點擊商品選項-完成')
        driver.find_element_by_xpath('//*[@id="main"]/div/div[2]/div[1]/div/div[2]/div/div[2]/div[3]/div/div[5]/div/div/button[2]').click()
        print('點擊直接購買-完成')
        break 
        
     except:
        print("還不能購買!刷新頁面")
        driver.refresh()




標題:使用Python網路爬蟲輸出CSV時出現I/O operation on closed file.錯誤
標籤:pythonm 網路爬蟲 

我最近在做網路爬蟲，我爬蟲的網址是這個https://www.jkf.net/lady/2021/rank.php
，我有成功把資料爬下來，但是我要輸出成CSV檔案，卻發生了錯誤，錯誤訊息是
ValueError: I/O operation on closed file.
我的程式如下:
import csv
import requests
from bs4 import BeautifulSoup
 
url = 'https://www.jkf.net/lady/2021/rank.php'
response = requests.get(url=url)
 
soup = BeautifulSoup(response.text, 'lxml')

info_items = soup.find_all('li', 'in_fade')

  
with open('JKF.csv', 'w', encoding='utf-8', newline='') as csv_file:
        
    csv_writer = csv.writer(csv_file)
    csv_writer.writerow(['號碼', '暱稱', '網址'])

 
for item in info_items:
    
    num = item.find('div', 'num').text.strip()
    name = item.find('div', 'tx').text.strip()
    link =item.find('a').get('href')       
  
    csv_writer.writerow([num, name, link])   
    print('{} {} 網址:{}'.format(num,name,link))

請問到底為什麼會這樣呢?有誰知道的可以幫我解答嗎?謝謝


標題:爬蟲urllib.error.HTTPError: HTTP Error 419: unknown status 是什麼意思?
標籤:python3 網路爬蟲 

我想要在租屋網存取資料，卻遇到HTTP Error 419錯誤，請問是遇到什麼問題了?
import urllib.request as req
import json
#建立連線網址
url="https://rent.591.com.tw/home/search/rsList?is_format_data=1&is_new_list=1&type=1&region=1"
request = req.Request(url,headers={
    "User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.61 Safari/537.36"
})

with req.urlopen(request) as response:
    data=response.read().decode("utf-8")

data=json.loads(data)
print(request)


錯誤訊息
urllib.error.HTTPError: HTTP Error 419: unknown status

請問是怎麼了?謝謝


標題:在form沒有設定action下，如何用requests送出表單?
標籤:requests webscraping python web scraper get 

https://app.disclosures.io/link/1482-Nightshade-Road-31-0ax3eu92
此網址的form沒有action，如何使用requests送出表單呢?
目前寫法不知使用get有沒有錯?
import requests
from bs4 import BeautifulSoup
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.67 Safari/537.36'}

Name = ['Kevin','Elvis']
Email = ['kevinabcd@gmail.com','elvis1234@gmail.com']
Phone = ['(913) 585-4402',"(913) 585-4402"]

url = 'https://app.disclosures.io/link/1482-Nightshade-Road-31-0ax3eu92'

for i in range(2):
    resp = requests.get(url,headers=headers ,params={
        'input-role':'Buyer Agent',
        'input-name':Name[i], 
        'input-email':Email[i],
        'input-phone':Phone[i]})
    print(resp.url)



標題:[ PHP]使用表格傳資料給python並執行後，無法顯示表格
標籤:#php #python #exec #mysql #webdriver 

我想
1.使用表單讓使用者輸入值

2.按下"查詢"會呼叫python執行並且代入剛才使用者輸入的值($value)
3.最後把python所print的東西在網頁上用表格展示(後來改成從資料庫取得資料，資料庫的資料是從被呼叫的py匯入的)
1~2都有成功，3不僅值沒跑出來連表格也沒出現，2的python程式碼都有成功執行
以下是我的php寫法:
<?php
		echo '<form action="" method="post">';   
			echo '<input type="text" name="value" placeholder="請輸入值">';
			echo '<input type="submit" value="查詢">';
		echo '</form>';
	
		

	
		if (isset($_POST['value'])) {
			
			echo '<br>';
			
			$value = $_POST['value'];
			
			
			// 定義資料庫資訊
			$DB_NAME = "mydb"; // 資料庫名稱
			$DB_USER = "root"; // 資料庫管理帳號
			$DB_PASS = "********"; // 資料庫管理密碼
			$DB_HOST = "localhost"; // 資料庫位址





			// 連接 MySQL 資料庫伺服器
			$con = mysqli_connect($DB_HOST, $DB_USER, $DB_PASS);
			if (empty($con)) {
				print mysqli_error($con);
				die("資料庫連接失敗！");
				exit;
			}

			// 選取資料庫
			if (!mysqli_select_db($con, $DB_NAME)) {
				die("選取資料庫失敗！");
			} else {
				/*echo "連接 " . $DB_NAME . " 資料庫成功！<br>";*/
			}

			// 設定連線編碼
			mysqli_query($con, "SET NAMES 'utf8mb3'");

			$sql="SELECT * from information WHERE `search_id`='" . $value . "'";
			$result = mysqli_query($con, $sql);

			$nums = mysqli_num_rows($result);   //查詢資料筆數

			echo '<table border="1">';
				echo '<tr>';
					echo '<th>欄位 1</th>';
					echo '<th>欄位 2</th>';
					echo '<th>欄位 3</th>';
					echo '<th>欄位 4</th>';
				echo '</tr>';
				echo '<tr>';


				#--------------------資料庫無資料----------------------
					if ($nums == 0) {    
						$output = exec("D:/ProgramData/Anaconda3/python D:/xampp/htdocs/website_test/car_information.py {$value}", $out, $ret);

						#echo json_encode($out);
						
						
						

						$result = mysqli_query($con, $sql);

					}



				#------------------資料庫有資料---------------------
					while ($row = mysqli_fetch_array($result, MYSQLI_NUM)) {



						echo '<td>' . $row[0] . '</td>';
						echo '<td>' . $row[1] . '</td>';
						echo '<td>' . $row[2] . '</td>';
						echo '<td>' . $row[3] . '</td>';
					

					}


				echo '</tr>';
			echo '</table>';
	
		}
	?>

請問各位高手我是不是有漏了什麼才導致執行python後表格出不來?(感覺像是頁面沒有轉跳)
如果還需要其他資料會再補，先謝謝各位了!!

更新 : 根據多方嘗試發現原因是因為py檔的webdriver(在指定網站載圖片)導致，把爬蟲的部分刪掉表格就會顯示但是var_dump($output)的值是亂碼，$out是空，$ret為0
請問各位高手，要如何才能解決此問題?謝謝!!


標題:python function to string
標籤:python入門 pyhton 

python中如果使用：
def x(i):
    return(i+1)
print(str(x)) # <function x at 0x...>

便會印出<function x at 0x00000203A320DD38>，
而不是def x(i): return(i+1)。
那該如何在python中取得函式「內容」的字串？
又或是python沒有辦法？
舉例js：
function x(i){return(i+1)}
console.log(x.toString()); // function x(i){return(i+1)}



標題:[已解決]bat執行py檔沒反應
標籤:bat批次檔 python 

想請問一下
目前我有一個bat檔內容如圖片1
執行過後的結果如圖片2
目前手動執行cmd的結果為圖片3
請問是bat檔的哪個部分需要修正呢?
圖片1

圖片2

圖片3



標題:想透過Python移除CSV檔案內的Emoji表情符號或特殊字符
標籤:emoji python 爬蟲 pandas 情緒分析 

如題目，目前正學習資料爬蟲!
想要將爬蟲的結果文字檔案(CSV)進行文字情緒分析~
但是文件內容含有大量Emoji導致情緒辨識無法執行!
故希望找到事前清洗Emoji的方法!
目前嘗試程式碼如下，但是還是無法順利執行，懇求前輩們指點迷津!

import re
import pandas as pd
def demoji(text):
emoji_pattern = re.compile("["
u"\U0001F600-\U0001F64F"  # emoticons
u"\U0001F300-\U0001F5FF"  # symbols & pictographs
u"\U0001F680-\U0001F6FF"  # transport & map symbols
u"\U0001F1E0-\U0001F1FF"  # flags (iOS)
u"\U00002702-\U000027B0"
u"\U000024C2-\U0001F251"
u"\U00010000-\U0010ffff"
"]+", flags=re.UNICODE)
return(emoji_pattern.sub(r'', text))
data = pd.read_csv('test.csv',encoding='utf-8', sep='\t') # read tsv file
data = pd.read_csv('test.csv',encoding='utf-8')  read csv file
data[u'header'] = data[u'header'].astype(str)
data[u'header'] = data[u'header'].apply(lambda x:demoji(x))
data.to_csv('output.csv',index=False, encoding='utf-8') # save to csv file

錯誤顯示為KeyError: 'header'
才疏學淺沒辦法獨立除錯，再麻煩有經驗的前輩協助，感激不盡~


標題:python pyinstaller/auto-py-to-exe 打包失敗
標籤:python pyinstaller auto-py-to-exe 


Windows PowerShell
Copyright (C) Microsoft Corporation. 著作權所有，並保留一切權利。

請嘗試新的跨平台 PowerShell https://aka.ms/pscore6

PS C:\Users\USER> py -m pip install auto-py-to-exe
Requirement already satisfied: auto-py-to-exe in c:\python\lib\site-packages (2.20.0)
Requirement already satisfied: pyinstaller>=4.6 in c:\python\lib\site-packages (from auto-py-to-exe) (5.1)
Requirement already satisfied: Eel==0.12.4 in c:\python\lib\site-packages (from auto-py-to-exe) (0.12.4)
Requirement already satisfied: bottle in c:\python\lib\site-packages (from Eel==0.12.4->auto-py-to-exe) (0.12.19)
Requirement already satisfied: bottle-websocket in c:\python\lib\site-packages (from Eel==0.12.4->auto-py-to-exe) (0.2.9)
Requirement already satisfied: future in c:\python\lib\site-packages (from Eel==0.12.4->auto-py-to-exe) (0.18.2)
Requirement already satisfied: whichcraft in c:\python\lib\site-packages (from Eel==0.12.4->auto-py-to-exe) (0.6.1)
Requirement already satisfied: altgraph in c:\python\lib\site-packages (from pyinstaller>=4.6->auto-py-to-exe) (0.17.2)
Requirement already satisfied: pywin32-ctypes>=0.2.0 in c:\python\lib\site-packages (from pyinstaller>=4.6->auto-py-to-exe) (0.2.0)
Requirement already satisfied: pyinstaller-hooks-contrib>=2021.4 in c:\python\lib\site-packages (from pyinstaller>=4.6->auto-py-to-exe) (2022.5)
Requirement already satisfied: pefile>=2017.8.1 in c:\python\lib\site-packages (from pyinstaller>=4.6->auto-py-to-exe) (2021.9.3)
Requirement already satisfied: setuptools in c:\python\lib\site-packages (from pyinstaller>=4.6->auto-py-to-exe) (58.1.0)
Requirement already satisfied: gevent-websocket in c:\python\lib\site-packages (from bottle-websocket->Eel==0.12.4->auto-py-to-exe) (0.10.1)
Requirement already satisfied: gevent in c:\python\lib\site-packages (from gevent-websocket->bottle-websocket->Eel==0.12.4->auto-py-to-exe) (21.12.0)
Requirement already satisfied: zope.interface in c:\python\lib\site-packages (from gevent->gevent-websocket->bottle-websocket->Eel==0.12.4->auto-py-to-exe) (5.4.0)
Requirement already satisfied: cffi>=1.12.2 in c:\python\lib\site-packages (from gevent->gevent-websocket->bottle-websocket->Eel==0.12.4->auto-py-to-exe) (1.15.0)
Requirement already satisfied: zope.event in c:\python\lib\site-packages (from gevent->gevent-websocket->bottle-websocket->Eel==0.12.4->auto-py-to-exe) (4.5.0)
Requirement already satisfied: greenlet<2.0,>=1.1.0 in c:\python\lib\site-packages (from gevent->gevent-websocket->bottle-websocket->Eel==0.12.4->auto-py-to-exe) (1.1.2)
Requirement already satisfied: pycparser in c:\python\lib\site-packages (from cffi>=1.12.2->gevent->gevent-websocket->bottle-websocket->Eel==0.12.4->auto-py-to-exe) (2.21)
PS C:\Users\USER> py -m auto-py-to-exe
C:\Python\python.exe: No module named auto-py-to-exe
PS C:\Users\USER>


已經安裝了但是還是會依直出現 No module named XXX
pyinstaller/auto-py-to-exe 這兩種方法都會失敗..
請問各位該如何解決


標題:利用Python爬蟲的程式碼，爬取蝦皮的商品資訊~原本可以執行，現在會出錯誤!
標籤:python 爬蟲 蝦皮 網頁爬蟲 網路爬蟲 

如題，原本可以正常執行的程式碼，今天想要換主題測試，發現會出錯!
都沒有調整過範例的語法，懇請對於爬蟲了解的前輩能解答或協助除錯。
#----------------------------------------#
載入必要套件
import requests
from bs4 import BeautifulSoup
import json
import pandas as pd
import time
from tqdm import tqdm
import time
import re
import random
#----------------------------------------#
首先設定我們要的關鍵字
keyword = '運動內衣'
page = 1
#----------------------------------------#
#封包標頭檔
my_headers = {'authority' : 'shopee.tw',
'method': 'GET',
'path': '/api/v1/item_detail/?item_id=1147052312&shop_id=17400098',
'scheme': 'https',
'accept': '/',
'accept-encoding': 'gzip, deflate, br',
'accept-language': 'zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6',
'cookie': '_ga=GA1.2.1087113924.1519696808; SPC_IA=-1; SPC_F=SDsFai6wYMRFvHCNzyBRCvFIp92UnuU3; REC_T_ID=f2be85da-1b61-11e8-a60b-d09466041854; __BWfp=c1519696822183x3c2b15d09; __utmz=88845529.1521362936.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); _atrk_siteuid=HEgUlHUKcEXQZWpB; SPC_EC=-; SPC_U=-; SPC_T_ID="vBBUETICFqj4EWefxIdZzfzutfKhrgytH2wyevGxiObL3hFEfy0dpQSOM/yFzaGYQLUANrPe7QZ4hqLZotPs72MhLd8aK0qhIwD5fqDrlRs="; SPC_T_IV="IpxA2sGrOUQhMH4IaolDSA=="; cto_lwid=2fc9d64c-3cfd-4cf9-9de7-a1516b03ed79; csrftoken=EDL9jQV76T97qmB7PaTPorKtfMlU7eUO; bannerShown=true; _gac_UA-61915057-6=1.1529645767.EAIaIQobChMIwvrkw8bm2wIVkBiPCh2bZAZgEAAYASAAEgIglPD_BwE; _gid=GA1.2.1275115921.1529896103; SPC_SI=2flgu0yh38oo0v2xyzns9a2sk6rz9ou8; __utma=88845529.1087113924.1519696808.1528465088.1529902919.7; __utmc=88845529; appier_utmz=%7B%22csr%22%3A%22(direct)%22%2C%22timestamp%22%3A1529902919%7D; _atrk_sync_cookie=true; _gat=1',
'if-none-match': "55b03-9ff4fb127aff56426f5ec9022baec594",
'referer': 'https://shopee.tw/6-9-%F0%9F%87%B0%F0%9F%87%B7%E9%9F%93%E5%9C%8B%E9%80%A3%E7%B7%9A-omg!%E6%96%B0%E8%89%B2%E7%99%BB%E5%A0%B4%F0%9F%94%A5%E4%BA%A4%E5%8F%89%E7%BE%8E%E8%83%8CBra%E5%BD%88%E5%8A%9B%E8%83%8C%E5%BF%83-i.17400098.1147052312',
'user-agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36',
'x-api-source': 'pc',
'x-requested-with': 'XMLHttpRequest'
}
#----------------------------------------#
#專門用來請求蝦皮的相關商品基本資料
def request_shopee(keyword, page):
url = 'https://shopee.tw/api/v2/search_items/?by=relevancy&keyword=' + keyword + '&limit=100&newest=' + str(page*100) + '&order=desc&page_type=search&version=2'
#開始請求
list_req = requests.get(url,headers = my_headers)
soup = BeautifulSoup(list_req.content, "html.parser")
#將扒下來的文字轉成Json
getjson=json.loads(soup.text)
return getjson['items']

#----------------------------------------#
使用方法
items_json = request_shopee(keyword = '運動內衣', page = 0)
#----------------------------------------#
原本都正常執行，今天使用發現會出現:



標題:如何用google map API 得知某住址的附近是否有鐵路或高速公路呢?
標籤:googlemapapi api google map python 

https://www.google.com/maps/place/443+Magritte+Way,+Mountain+View,+CA+94041/@37.3867397,-122.0587789,16.5z/data=!4m5!3m4!1s0x808fb71e30a1f89d:0x1ed7683b0c97fc5d!8m2!3d37.3857587!4d-122.057498

這個地點附近有鐵路，若有多個googlemap地址如何不用肉眼判別，就知道這個地址旁有鐵路或高速公路呢? 是用哪個google map api做的嗎?


標題:Apache AirFlow2.0 分佈式爬蟲管理解決方案 請益
標籤:#etl #datapipeline #python 3 #airflow2.0 #scrawler 

各位大大好
小弟近期在學習研究 AirFlow2.0 這個排程管理工具
目前遇到一個問題，不知道版上有沒有有經驗的大大能協助解惑
我的案例是這樣：
過往公司有許多爬蟲每天都需要執行排程任務 (分散在 N 台windows VM上)，基本都是用 windows 工作排程器做設定，但長期下來就發現這非常難以管理，也沒有一個較完善的錯誤偵查機制，如果爬蟲死了，幾本上都是等到 User 反映 DB 沒資料才會知道。
因此小弟在研究後，決定想要導入 AirFlow2.0 作為公司未來的 ETL 解決方案
目前 AirFlow Webserver 架在一台 Linux 主機上，而如果要用分散式處理，我看網路上的資源，好像大部分會指向推薦使用 CeleryExecutor 這個工具，但自己對 Celery 的概念有點有看沒懂 QQ 看起來是他還需要另外架一台 Server 作為 Queue 的管理 Server 這樣嗎？
另外我也在文件看到另一個 DaskExecutor，從敘述來看，好像也是用來處理分佈式排程工作的功能，但 DaskExecutor/CeleryExecutor 這兩個有甚麼具體的差異嗎？
若以小弟的案例來說，請問有沒有比較適合的研究方向呢？
研究了很久還有覺得有點鬼打牆，希望各位大大指點，感恩感恩><


標題:[爬蟲]轉跳頁面問題
標籤:#爬蟲 #python #轉跳頁面 

各位大大好，我是爬蟲新手，以下是我的問題
總共有三個頁面
1.查詢
2.查詢成功等待中(有可能失敗)
3.需求的資料(展示)
我想爬蟲取得頁面中的圖片(第三個頁面)，第二個頁面偶爾會顯示系統內部問題獲取資料失敗，所以我想做一個迴圈:
如果第二個頁面等待超過10秒還沒轉跳到第三個頁面或者第二個頁面顯示加載失敗，則從第一個頁面再次開始(1→2→1→2→3)
但是裡面的條件判斷我沒有頭緒，查資料得知python的等待有三種方法，其中WebDriverWait...until比較符合我想要的，卻不知道該怎麼寫才能得到我想要的結果，請問大大們能不能給我一個方向或者提示，先謝謝各位大大了!


標題:ImportError: cannot import name 'word_list' from 'words'
標籤:py python python3 python入門 python系列文章 





標題:python 取影片的第一格
標籤:python video mp4 

我想用python把一個.mp4影片的第一格轉成圖片並儲存，我該怎麼做?
比如說:
這是一個影片(我會把它下載成mp4然後處理)

我要的結果:(這張圖片)



標題:(以解決) python selenium 如何獲取回傳的json檔
標籤:python selenium webdriver json 

我目前使用python selenium，瀏覽器是firefox，
想要爬網站中的提供的分析內容，
發現在get前往網址後會得到Type是json的lists，像是下圖

類似問題像是下面這個網站
連結
那我希望能得到lists中的內容或是lists這份檔案，
試了print(driver.page_source)的內容來看也沒發現想要的內容
想問看看能怎麼下手 拜託了
更
目前用把selenium 換成 seleniumwire，
用以下方式把response全部抓出來看，
終於成功抓到想要的json檔
for request in driver.requests:
    if request.response:
        print(
            request.url,
            request.response.status_code,
            request.response.headers['Content-Type']
        )



標題:請問python裡的not(Variable) 在 while迴圈的第一行裡的運作原理
標籤:python python入門 #新手求指導 


這圖裡的code是這樣的:
sth = False
while not(sth):
print(not(sth))
print("what is going on?")
請問這個not(sth)是預設==False的時候會執行while迴圈而==True的時候則不執行嗎？
可是我覺得很奇怪耶因為這裡應該要寫一些condition的東西，可是not(sth)就只是True而已，True代表的是布林值又不是什麼condition。如果是condition應該要寫not(sth)==True才對吧。
抱歉可能有些用語表達的不好，小弟剛學不到一個星期...請大家不吝指教！


標題:已解決  Python在圖片上加文字,但檔案名稱有中文,儲存後亂碼
標籤:python 

程式碼如下
import os
from os import listdir
from os.path import isfile, isdir, join
import cv2
import numpy as np
import os, datetime
import datetime
import time
from cv2 import imdecode

a = C:\Users\IUSER\Desktop\Photo1400x960\Cut\20220512\test.jpg
print(a)

#讀取圖片
bk_img = cv2.imdecode(np.fromfile(a, dtype=np.uint8), cv2.IMREAD_UNCHANGED)
    
#新增文字
cv2.putText(bk_img,'test text!!!!', (1120,920), cv2.FONT_HERSHEY_SIMPLEX,1.2,(48,125,237), 2, cv2.LINE_AA)

#儲存圖片
cv2.imwrite(a,bk_img)


我想在指定的圖片上加字並且儲存
目前檔名若無中文,可以正常儲存
但若檔名有中文,儲存後檔名會變成亂碼
請教大家如何解決,謝謝!


標題:請問一下這一題曜怎麼寫？（python)
標籤:python python3 python系列文章 python入門 py 




標題:python 如何把建立好的資料庫視覺化 
標籤:python 

我想問一下如何把做好的資料庫變成統計圖之類的


標題:python pandas 資料比對
標籤:pandas python 

我現在有兩張dataframe
A dataframe
註冊             ID
registration    A123456789
login           A123456789
registration    B123456789
registration    C123456789
需要把有 registration 挑出 然後用 ID 去比對沒有login的 結果會是如下
註冊            ID
registration    B123456789
registration    C123456789
df['Event Name'] == '註冊' | df['Event Name'] != 'login '
也沒得到預期結果?
請問各位前輩該如何篩選?


標題:python word轉pdf找不到檔案
標籤:#python #word #pdf 

請問為什麼在練習把word轉成pdf時會顯示找不到檔案呢??
確定當前工作路徑有要轉檔的word，已經試過絕對路徑跟相對路徑，結果都還是會報錯
報錯
com_error: (-2147352567, '發生例外狀況。', (0, 'Microsoft Word', '找不到檔案。\r (C:\\Users\\...\\文件\\your_word_document.docx)', 'wdmain11.chm', 24654, -2146823114), None)

程式碼
from win32com.client import Dispatch
import win32com.client
import docx
wordFilename = 'your_word_document.docx'
pdfFilename = 'your_pdf_filename.pdf'

doc = docx.Document()
# Code to create Word document goes here.
doc.save(wordFilename)

wdFormatPDF = 17 # word轉pdf的數字代碼
wordObj = win32com.client.Dispatch('Word.Application')
docObj = wordObj.Documents.Open(wordFilename)
docObj.SaveAs(pdfFilename, FileFormat=wdFormatPDF)
docObj.Close()
wordObj.Quit()



標題:請問要怎麼修改？？？>_<
標籤:python python3 python系列文章 py python入門 

T=int(input('T'))
i=0
n=[]
k=[]
while i<T:
    n,k=list(map(int,input('day level').split(' ')))
    i=i+1
i=0
if int(i) == 1:
    j=n[i]-2
    k=1
    while j>0:
        x=(((j+1)*j)/2)*k
        y=y+x
        k=k+1
        print(y+((n[i-3])*(n[i-2]))+1)
    i+=i    
else:
    int(n.split())
    int(k.split())
    a=n[1]
    b=k[1]
    c=((2*b-a+3)*(a-1)/2)+1
        
    while a>2:
        d=((2*b-a+3)*(a-1)/2)
        a=a+1
        e=e+d
    print(c+e)
    i+=i 



標題:Python QuerrySet處理多筆資料陣列出錯?
標籤:python django 陣列 

想請教各位，我目前遇到這個 陣列問題 想不出來要怎麼解 @@
我輸入一筆"編號"，有相同編號的資料，就存進檔案下載
但只有我輸入兩筆以上不同的"編號"，就會報錯，無法輸出存檔
只輸入一筆"編號"篩選資料條件，可以匯出檔案

輸入兩筆以上的"編號"篩選資料條件，就會報錯

程式碼：

Views：
def down_file(request):
    ssid = CourseData.objects.all()
    if request.method == "POST":    
        sids = request.POST.get("sids").strip()
        if "," in sids:
            dfs = CourseData.objects.filter(sid = "NA")
            sdfs = sids.split(",")
            for n in sdfs:
                sdfses = CourseData.objects.filter(sid = n.strip())
                dfs = dfs | sdfses
        else : 
            dfs = CourseData.objects.filter(sid__in = [sids]).values_list("sid","name","phone","email","sdept")
        response = HttpResponse(content_type = "text/csv")
        response.write(codecs.BOM_UTF8)
        response['Content-Disposition'] = 'attachment; filename = "Report.csv" ' 
        writer = csv.writer(response)
        writer.writerow(["編號","姓名","手機","信箱","單位"])
    #for df in dfs:
        writer.writerows(dfs)
    return response 



標題:佈署在IIS 的 Flask App 透過Flask_APScheduler與Logging無法正常輸出資料
標籤:python flask apscheduler iis logging 

問題
目前有一支具SSL憑證的 Flask App，
並透過 Flask_APScheduler 定時存一個字串到 log file，
在 Debug Mode 下，程式會自動創建log.txt，
完全沒有報錯都能順利儲存資料進 log file，
但在 IIS 啟動站台後，卻無法正常輸出資料，也不會自動創建log.txt
不知道是不是 IIS 啟動有問題? 還是啟動前有什麼方式需要重新佈署讓IIS更新程式碼?
以下是我測試的程式碼:
from flask_apscheduler import APScheduler
from flask import Flask
import logging


app = Flask(__name__)

@app.route("/")
def home():
    return "Hello, This is a ReporSender	in IIS Server."
	
	
#設定Logging 參數
logging.basicConfig(level=logging.DEBUG, filename='./log.txt',
	format='[%(asctime)s %(levelname)-8s] %(message)s',
	datefmt='%Y%m%d %H:%M:%S',
	)


#定時任務參數
class Config(object):
    JOBS = [
        {
            'id': 'job1',
            'func':'__main__:ReportSender',
            'trigger':'interval',
            'seconds':5
        }
    ]

app.config.from_object(Config())# 為例項化的flask引入配置

def ReportSender():
    try:
        logging.critical('測試測試')

    except Exception as e:
        logging.error("Catch an exception.", exc_info=True)
		
if __name__ == "__main__":
    try:
        logging.critical("啟動成功")
        scheduler = APScheduler()
        scheduler.init_app(app)
        scheduler.start()
        app.run()       
    except Exception as e:
		logging.error("Catch an exception.", exc_info=True)



標題:python機率問題
標籤:python norm stats 

https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html
請問norm.pdf這個function,為什麼我要給他我的平均值跟標準差
1.這個function的功能不是應該是給他x資料,他用y軸表現出x資料的機率分布嗎?
給他平均值跟標準差的目的為何?

如果不給他就會自動設動平均值0，標準差1
可是明明常態分布來說6這個點是最多的,怎麼變成0最高
我把平均值6,標準差1放進去就會正常

所以要跑x資料的pdf分佈應該要先算出平均跟標準差嗎?
2.為什麼不放data.sort圖形就會亂跑,資料不是應該由x最小(3)到x最大(9)將pdf(x)的y軸依序連接嗎,資料在list中擺放的順序為何會影響圖形呢?

圖形看起來像是根據list中的擺放順序連接的


標題:Python threading 新手發問[已解決]
標籤:python3 thread 

小弟日前在測試一個結構，主程式搭配兩個子執行緒，我給他們代號分別為子執行緒1和子執行緒2，想請問一下，因為目的需求，我想要當子執行緒1，因異常失敗時，關閉所有線程，和主程式，請問這有可能實現嗎?我查了資料，大多似乎都是在討論主程式運行結束後，如何關閉所有線程。我的google能力真的太差= = ，因為花了太多時間，都沒能找到答案，所以才想請教一下有經驗的大大，能否分享經驗。無論如何，感謝大大的賞臉閱讀!!
def work1():
    do_something
thread1= threading.Thread(target=work1)
thread1.start() 
def work2():
    do_something
thread2= threading.Thread(target=work2)
thread2.start() 

執行主程式...


這是我目前理想中的架構，請問有可能實現嗎?
def work1():
    do_something
thread1= threading.Thread(target=work1)
def work2():
    do_something
thread2= threading.Thread(target=work2)

主程式...

def main():
    try:
        thread1.start()
        thread2.start()
        執行主程式...
    except:
       關閉所有程序
        
if __name__ == '__main__':
    main()


補充後續解決方式:
最後使用os._exit()終止所有程序了，感覺不是很好的方法，但我想要的效果有實現。
期待其他人有更好的方式可以分享一下。
os._exit()



標題:python錯誤訊息
標籤:python入門 python python系列文章 


import requests,json
html = requests.get("https://building.tycg.gov.tw/opendata/OpenDataSearchUrl.do?d=OPENDATA&c=BUILDLIC&Start=1&%E5%9F%B7%E7%85%A7%E9%A1%9E%E5%88%A5=%E5%BB%BA%E9%80%A0%E5%9F%B7%E7%85%A7&%E7%99%BC%E7%85%A7%E6%97%A5%E6%9C%9F=111%E5%B9%B401%E6%9C%88")
list1 = eval(html.text)
print(list1)
s="執照類別,執照字號,原執照,變更設計次數,基地面積,建築面積,總樓地板面積,建築高度,地下避難,法定空間,建造類別,構造別,地上層數,地下層數,棟樹,戶數,起造人,設計人,監造人,承造人,雜項,停車,發照日,開工日,竣工日,qtime,樓層概要,地號,門牌\n"
for dict in list1:
list2=list(dict.values())
print(list2)
s=s+"{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}{},{},{},{},{},{},{},{},{},{}\n".format(list2[0],list2[1],list2[2],list2[3],list2[4],list2[5],list2[6],list2[7],list2[8],list2[9],list2[10],list2[11],list2[12],list2[13],list2[14],list2[15],list2[16],list2[17],list2[18],list2[19],list2[20],list2[21],list2[22],list2[23],list2[24],list2[25],list2[26],list2[27],list2[28])
fw=open("桃園市110年1月.csv","w")
fw.write(s)
fw.close()
程式碼如上
各位大大下午好，小弟想抓公開資訊資料json檔轉成CSV檔，但RUN的時候跑出這一行，請問是哪裡出錯了呢?
File "c:\users\user.spyder-py3\untitled2.py", line 7, in 
list2=list(dict.values())
AttributeError: 'str' object has no attribute 'values'
json來源:https://building.tycg.gov.tw/opendata/OpenDataSearchUrl.do?d=OPENDATA&c=BUILDLIC&Start=1&%E5%9F%B7%E7%85%A7%E9%A1%9E%E5%88%A5=%E5%BB%BA%E9%80%A0%E5%9F%B7%E7%85%A7&%E7%99%BC%E7%85%A7%E6%97%A5%E6%9C%9F=111%E5%B9%B401%E6%9C%88


標題:python+django 篩選後的資料呈現在網頁畫面，要如何下載存檔?
標籤:django python export download web 

想請教各位，我在參考別人的範例練習寫網頁(py+dj)
已經把從db篩選出來的資料，呈現在網頁畫面上，如下圖.
網頁畫面

想把這些篩選出來的資料另外下載存檔，但目前當按下載按鈕後，傳給後端是空值 @@
所以檔案會是沒內容，要怎麼把篩選的資料存在按鈕帶過去給後端?
除了jquery的ajax用法，有其他方式可以進行嗎? 或是有什麼修改方式??
謝謝各位
附上程式碼
Views：
def down_file(request):
    if request.method == "POST":    
        sids = request.POST.get("sid")
    dfs = Data.objects.filter(cid__in=["sid"]).values_list("sid","name","phone","email","dept")
    response = HttpResponse(content_type = "text/csv")
    response.write(codecs.BOM_UTF8)
    response['Content-Disposition'] = 'attachment; filename = "Report.csv" ' 
    writer = csv.writer(response)
    writer.writerow(["編號","姓名","手機","信箱","部門"])
    for df in dfs:
        writer.writerow(df)
    return response

Templates：
{% extends "base.html" %}
{% block headmessage %}查詢系統{% endblock %}
{% block main-content %}
<hr>
<script>
    function changesid(x) {
        window.location = "/bycid/"+x.value+"/";
    }
    function changedepart(x) {
        window.location = "/bydepart/"+x.value+"/";
    }
</script>
<form id="sid" action="/bycid/" method="POST">
{% csrf_token %}
工號查詢：<input name="sid" size="50" placeholder="Search" >
<input id="sid" type="submit" value="查詢">

單位查詢：
<select style="width: 200px;"  onchange="changedepart(this)">
    <option value=0>請選擇單位</option>
{% for dept in sdepartments %}
    <option value={{ dept.id }}>{{ dept.name }}</option>
{% endfor %}
</select> 
</form>
<br>
<form action="/down_file/" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <button type="button" onclick="window.location.href='/down_file'" >下載檔案</button> 
<hr>
以下共顯示{{ num }}筆資料：
<table class="table table-striped table-hover table-xxl text-nowrap">
    <tr>
        <td>工號</td><td>姓名</td><td>手機</td><td>信箱</td><td>單位</td>
    </tr>
{% for c in course %}
    <tr>
        <td><small>{{c.cid}}</small></td> <!--編號-->
        <td><small>{{c.name}}</small></td> <!--姓名-->
        <td><small>{{c.phone}}</small></td> <!--手機-->
        <td><small>{{c.email}}</small></td><!--信箱-->
        <td><small>{{c.dept}}</small></td><!--部門-->
    </tr>
{% endfor %}
</table>
{% endblock %}



標題:請問這個為何行不通(python)求救
標籤:python py python3 python入門 




標題:二元搜尋樹的節點加總問題
標籤:binary tree python python 3 

如圖，我現在想要實現改變二元搜尋樹的每個節點成為"自己與所有比自己小的節點值"的總和

終端機輸出必須是這個:
Before : 4 2 6 1 3 5 7
After: 10 3 21 1 6 15 28

這是我寫的程式:
class Node:
    def __init__(self, value):
        self.val = value
        self.left = None
        self.right = None

class BST:
    def __init__(self):
        self.root = None
    def insert(self, new):
        if self.root == None:  # 若樹根為空
            self.root = Node(new)
        else:
            cur = self.root
            while cur:  # 迴圈會在走到 None 的時候結束
                parent = cur  # 把父節點的位置保存下來
                if cur.val > new:  # 若當前節點比插入值大，則往左子樹走
                    cur = cur.left
                elif cur.val < new:  # 若當前節點比插入值小，則往右子樹走
                    cur = cur.right
                else:  # 若當前節點等於插入值，則直接離開insert()
                    return
            if parent.val > new:  # 若父節點比插入值大，則插入父節的點的左子樹
                parent.left = Node(new)
            else:  # 若父節點比插入值小，則插入父節的點的右子樹
                parent.right = Node(new)

    def levelorder(self):
        queue = [self.root]
        while queue!=[]:
            print(queue[0].val, end = " ")
            if queue[0].left:
                queue.append(queue[0].left)
            if queue[0].right:
                queue.append(queue[0].right)
            queue.pop(0)
        print()

# ======================================== 題目 ========================================
    def sum_of_smaller(self, now):
    #用遞迴方式完成中序走訪
        if now is None: return #如果現在的節點是空的，直接回傳
        self.sum_of_smaller(now.left) #走訪左節點
        print(now.val) #印出走訪到的節點
        self.sum_of_smaller(now.right)#走訪右節點
        
# ======================================================================================

if __name__ == "__main__":
    # 建立二元搜尋樹物件，並且加入節點
    bst = BST()
    lst = [4, 2, 6, 1, 3, 5, 7]
    for val in lst:
        bst.insert(val)
        
    # 顯示原始二元樹的階層走訪
    print("Before : ", end = "")
    bst.levelorder()

    # 使用 sum_of_smaller 方法來改變 bst 物件本身
    bst.sum_of_smaller(bst.root)

    # 顯示更改後二元樹的階層走訪
    print("After : ", end = "")
    bst.levelorder()

我目前是用遞迴的方式寫出中序走訪(sum_of_smaller函式)，發現這個樹走訪完剛好就是1,2,3,4,5,6,7，我只要把一個節點和它前面的節點們加總起來就會有答案。
但是我嘗試一些方法....... 都不是我要的。像是額外設一個total = 0變數，再做 total += now.val但結果都是0。另外，這程式的結果應該要直接改變二元樹本身。
請問這部分要怎麼解? 解答要放在sum_of_smaller函式中


標題:Python sqlite3 SQL指令請教
標籤:sql sqlite3 python 

目前Table欄位如下

目前已經有start，需要更新end，並且同時計算兩者之間的間隔分鐘，
請教各位大神如何在Python sqlite3下用一行sql指令完成，小弟對於sql指令還不熟悉，煩請各位大神指教！謝謝！


標題:selenium點擊按鈕問題
標籤:selenium selenium webdriver #selenium python爬蟲 python 

網頁程式碼
<button class="hollow>帳密/E-mail登入</button
使用driver.find_element_by_xpath(//*[@id="pan-body"]/div/div/div[2]/div[2]/button[2])
卻沒有任何反應，在想是不是因為沒有網址連結，所以自動無法點擊。
若要產生點擊效果，該如何解呢？


標題:爬蟲  Chrome自動關閉問題
標籤:#爬蟲 #chromedriver #python #chrome #自動關閉 

各位大大好，我這幾天才剛接觸爬蟲，都是在網路上找資料自學的，卡了很多地方最後都能解決，唯獨執行全部程式碼後Chrome會自動關閉問題(剛開始用前幾次不會，之後不管做什麼事都會自動關閉)一直不能解決，請問各位大大可能是們麼原因?先謝謝各位大大了!
以下附上版本號:
Chrome : 101.0.4951.67 (正式版本) (64 位元)
ChromeDriver : 101.0.4951.41
以下附上我的程式碼(在IG用關鍵字下載圖片):
from selenium import webdriver
from selenium.webdriver.common.keys import Keys

from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

import time

import os
import wget





path = "D:/chromedriver.exe"
driver = webdriver.Chrome(path)


driver.get("https://www.instagram.com/")
print(driver.title)




#會等瀏覽器10秒鐘，直到XXX(By後的條件)可以被點擊為止
username = WebDriverWait(driver, 10).until(    
    EC.element_to_be_clickable((By.CLASS_NAME, "KPnG0"))
)


#---------------------------------------用FB登入-------------------------------------------------
login = driver.find_element(by=By.XPATH, value='//*[@id="loginForm"]/div/div[5]/button/span[2]')
login.click()    


#---------------------等帳號欄位可點擊------------------------
username = WebDriverWait(driver, 10).until(    
    EC.element_to_be_clickable((By.ID, "email"))
)

#---------------------等密碼欄位可點擊------------------------
password = WebDriverWait(driver, 10).until(    
    EC.element_to_be_clickable((By.ID, "pass"))
)


login_FB = driver.find_element(by=By.XPATH, value='//*[@id="loginbutton"]')

username.clear()  #清空帳號
password.clear()  #清空密碼
username.send_keys('xxxxx@gmail.com')   #輸入帳號
password.send_keys('xxxxx')   #輸入密碼

login_FB.click()   #點擊登入



#---------------------等搜尋欄位可點擊------------------------
search = WebDriverWait(driver, 10).until(    
    EC.element_to_be_clickable((By.CLASS_NAME, "XTCLo"))
)

keyword = '#cat'

search.send_keys(keyword)   #搜尋cat
time.sleep(1)   #等待1秒
search.send_keys(Keys.RETURN)   #按下enter鍵
time.sleep(1)   #等待1秒
search.send_keys(Keys.RETURN)   #按下enter鍵



time.sleep(5)   #等待5秒(如果不等5秒，執行完第二次search.send_keys(Keys.RETURN)就會閃退，並且下載的圖片是搜尋cat結果之前的頁面的圖)


#---------------------等圖片可點擊------------------------
WebDriverWait(driver, 10).until(    
    EC.presence_of_element_located((By.CLASS_NAME, "FFVAD"))
)


#滾軸下拉5次
for i in range(5):
    driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")
    time.sleep(5)


imgs = driver.find_elements(by=By.CLASS_NAME, value="FFVAD")




path = os.path.join(keyword)
os.mkdir(path)   #建資料夾



#下載圖片
count = 0
for img in imgs:
    save_as = os.path.join(path, keyword + str(count) + '.jpg')
    wget.download(img.get_attribute("src"), save_as)
    count += 1

終端機訊息 :
PS D:\xampp\htdocs\website_test> & D:/ProgramData/Anaconda3/python.exe d:/xampp/htdocs/website_test/py_test2.py
d:\xampp\htdocs\website_test\py_test2.py:24: DeprecationWarning: executable_path has been deprecated, please pass in a Service object
  driver = webdriver.Chrome(path)

DevTools listening on ws://127.0.0.1:62490/devtools/browser/1fada151-04b0-48e8-879a-7af83530ff04
Instagram
[6864:22832:0513/132954.606:ERROR:device_event_log_impl.cc(214)] [13:29:54.606] USB: usb_device_handle_win.cc:1049 Failed to read descriptor from node connection: 連結到系統的某個裝置
失去作用。 (0x1F)
[6864:22832:0513/132954.609:ERROR:device_event_log_impl.cc(214)] [13:29:54.609] USB: usb_device_handle_win.cc:1049 Failed to read descriptor from node connection: 連結到系統的某個裝置
失去作用。 (0x1F)
100% [..............................................................................] 62177 / 62177

如果還缺什麼資料麻煩大大告知，萬分感謝!


標題:C#與python連結問題
標籤:c# python 

大家好我最近想將C#作為我的人機介面，python作為後端機器學習的演算法，看網路上很多人推薦IronPython但IronPython有些函式庫不支援，請問大家有什麼推薦的方法嗎?


標題:PYPI server 搭建
標籤:python 

想搭建個pypi-server，查了網路的教學大多都是透過https://pypi.org/project/pypiserver
我是放置在docker container內，服務也起了，
但十分不穩定動不動就會斷掉，要重啟container，
不知道是否有比較好的架構及穩定性，使用總人數20餘個。
謝謝~


標題:如何對指定篩選完的資料並下載?
標籤:python django excel 匯出csv download 

我使用"models.objects.all()" 會變成全部資料都撈出來並存檔(這不是正確結果)；
改用"models.objects.filter()"則會報錯(值太多未整理?!)，錯誤如下圖
Error







想請教各位，這要怎麼修改才能得到我要的正確結果?(想對指定篩選完的"學號"資料並下載)
謝謝各位!!
Models：
class CourseData(models.Model):
    sid = models.CharField(max_length=20, verbose_name="學號")
    name = models.CharField(max_length=20, verbose_name="姓名")
    phone = models.CharField(max_length=20, verbose_name="手機")
    email = models.CharField(max_length=100, verbose_name="信箱")
    sdept = models.CharField(max_length=50, verbose_name="學生系所")
    scls = models.CharField(max_length=50, verbose_name="班級")
    scampus = models.CharField(max_length=20, verbose_name="校區")
    cid = models.CharField(max_length=20, verbose_name="選課代號")
    ctype = models.CharField(max_length=20, verbose_name="學制")
    cdept = models.CharField(max_length=50, verbose_name="開課系所")
    ccls = models.CharField(max_length=50, verbose_name="開課班級")
    ccampus = models.CharField(max_length=20, verbose_name="上課校區")
    teacher = models.CharField(max_length=20, verbose_name="上課教師")
    cdeptemail = models.CharField(max_length=100, verbose_name="開課單位信箱")
    teacheremail = models.CharField(max_length=100, verbose_name="上課教師信箱")
    ctime = models.CharField(max_length=50, verbose_name="上課時間")
    place = models.CharField(max_length=20, verbose_name="上課教室")
    subject = models.CharField(max_length=50, verbose_name="科目")
    mcls = models.CharField(max_length=50, verbose_name="合班班級")
    snum = models.PositiveIntegerField(default=0, verbose_name="人數 ")
    duration = models.CharField(max_length=50, verbose_name="假期")
    def __str__(self):
        return self.name

Templates：
{% extends "base.html" %}
{% block headmessage %}查詢系統{% endblock %}
{% block main-content %}
<hr>
<script>
    function changesid(x) {
        window.location = "/bysid/"+x.value+"/";
    }
    function changedepart(x) {
        window.location = "/byssdepart/"+x.value+"/";
    }
</script>
<form action="/bysid/" method="POST">
{% csrf_token %}
學號查詢：<input name="sid" size="50" placeholder="Search">
<input type="submit" value="查詢">
學生系所查詢：
<select style="width: 200px" onchange="changedepart(this)">
    <option value=0>請選擇系所</option>
{% for dept in sdepartments %}
    <option value={{ dept.id }}>{{ dept.name }}</option>
{% endfor %}
</select>
</form>
<br>
{% csrf_token %}
{{form}}
<button onclick="window.location.href='/down_file'" >下載檔案</button>
<hr>
以下共顯示{{ num }}筆資料：
    <table class="table table-striped table-hover table-xxl text-nowrap">
    <tr>
        <td>學號</td><td>姓名</td><td>手機</td><td>學生信箱</td><td>學生系所</td>
        <td>學生班級</td><td>學生校區</td><td>選課代號</td><td>開課學制</td><td>開課系所</td>
        <td>開課班級</td><td>上課校區</td>
    </tr>
    {% for c in course %}
    <tr>
        <td><small>{{c.sid}}</small></td> <!--學號-->
        <td><small>{{c.name}}</small></td> <!--學生姓名-->
        <td><small>{{c.phone}}</small></td> <!--手機-->
        <td><small>{{c.email}}</small></td><!--學生信箱-->
        <td><small>{{c.sdept}}</small></td><!--學生系所-->
        <td><small>{{c.scls}}</small></td><!--學生班級-->
        <td><small>{{c.scampus}}</small></td> <!--學生校區-->
        <td><small>{{c.cid}}</small></td> <!--選課代號-->
        <td><small>{{c.ctype}}</small></td> <!--開課學制-->
        <td><small>{{c.cdept}}</small></td><!--開課系所-->
        <td><small>{{c.ccls}}</small></td><!--開課班級-->
        <td><small>{{c.ccampus}}</small></td><!--上課校區-->
    </tr>
    {% endfor %}
    </table>
    {% endblock %}

Views：
def down_file(request):
    sdepartments = Department.objects.all()
    cdepartments = CDepartment.objects.all()
    ssid = CourseData.objects.all()

    sops = CourseData.objects.all().values_list("sid","name","phone","email","sdept","scls","scampus","cid","ctype","cdept","ccls","ccampus")
    response = HttpResponse(content_type="text/csv")
    response.write(codecs.BOM_UTF8)
    response['Content-Disposition'] = 'attachment; filename = "Report.csv"'
    writer = csv.writer(response)
    writer.writerow(["學號","學生姓名","手機","學生信箱","學生系所","學生班級","學生校區","選課代號","開課學制","開課系所","開課班級","上課校區"])
    for sop in sops:
        writer.writerow(sop)
    return response

畫面：



標題:pandas把列的格式改成正確的
標籤:coulumns python 

!
要怎麼把上面列的地方變成正確的格式



標題:Python3下載pandas，執行Run之後，下面的Terminal一直閃爍，且並沒有Run出東西
標籤:#python 3 #pandas #python求救 #python問題 #yfinance 

如題，有下載
pip install pandas
pip install pandas_datareader
pip install yfinance
在沒有反應後，因為我是安裝python3，於是
pip3 install pandas
pip3 install pandas_datareader
pip3 install yfinance
python3的套件也一併下載了
這是我Run的程式

這是我執行Run後，下面Terminal的顯示

請問需要增減什麼部分，才能讓程式順利執行？
萬分感謝!!
(早上發文發錯地方，請見諒！）


標題:Python+Django 要如何從db篩選資料並下載成excel或csv檔?(已解決)
標籤:django python excel download csv 

想請教各位，我用py+dj做網頁和pandas套件。
主要是想把篩選完的不同學號資料，存檔輸出成Excel檔案。
目前是先測試抓網頁上的資料並存成CSV檔，雖然目前是可以執行下載按鈕並存檔到電腦；但問題是會抓不到資料，只會存成空檔案...(問題1)
另外因考量到存取效率問題，打算從db裡面抓篩選完不同學號資料並存檔成excel，
請問要怎麼修改才好?(問題2)
卡很久都還沒頭緒@@
謝謝各位!!

Models：
class CourseData(models.Model):
    sid = models.CharField(max_length=20, verbose_name="學號")
    name = models.CharField(max_length=20, verbose_name="姓名")
    phone = models.CharField(max_length=20, verbose_name="手機")
    email = models.CharField(max_length=100, verbose_name="信箱")
    sdept = models.CharField(max_length=50, verbose_name="學生系所")
    scls = models.CharField(max_length=50, verbose_name="班級")
    scampus = models.CharField(max_length=20, verbose_name="校區")
    cid = models.CharField(max_length=20, verbose_name="選課代號")
    ctype = models.CharField(max_length=20, verbose_name="學制")
    cdept = models.CharField(max_length=50, verbose_name="開課系所")
    ccls = models.CharField(max_length=50, verbose_name="開課班級")
    ccampus = models.CharField(max_length=20, verbose_name="上課校區")
    teacher = models.CharField(max_length=20, verbose_name="上課教師")
    cdeptemail = models.CharField(max_length=100, verbose_name="開課單位信箱")
    teacheremail = models.CharField(max_length=100, verbose_name="上課教師信箱")
    ctime = models.CharField(max_length=50, verbose_name="上課時間")
    place = models.CharField(max_length=20, verbose_name="上課教室")
    subject = models.CharField(max_length=50, verbose_name="科目")
    mcls = models.CharField(max_length=50, verbose_name="合班班級")
    snum = models.PositiveIntegerField(default=0, verbose_name="人數 ")
    duration = models.CharField(max_length=50, verbose_name="防疫假期間")
    def __str__(self):
        return self.name

class StudentData(models.Model):
    sid = models.CharField(max_length=20, verbose_name="學號")
    name = models.CharField(max_length=20, verbose_name="姓名")
    stype1 = models.CharField(max_length=20, verbose_name="部別")
    stype2 = models.CharField(max_length=20, verbose_name="學制")
    dept = models.CharField(max_length=20, verbose_name="系所")
    deptfullname = models.CharField(max_length=50, verbose_name="系所全名")
    clasaname = models.CharField(max_length=50, verbose_name="班級名稱")
    phone = models.CharField(max_length=20, verbose_name="學生手機")
    campus = models.CharField(max_length=20, verbose_name="校區")
    def __str__(self):
        return self.name

class Department(models.Model):
    name = models.CharField(max_length=50, verbose_name="系所簡稱")
    def __str__(self):
        return self.name

class CDepartment(models.Model):
    name = models.CharField(max_length=50, verbose_name="開課單位")
    def __str__(self):
        return self.name

Template：
{% extends "base.html" %}
{% block headmessage %}查詢系統{% endblock %}
{% block main-content %}
<hr>
<script>
    function changesid(x) {
        window.location = "/bysid/"+x.value+"/";
    }
    function changedepart(x) {
        window.location = "/byssdepart/"+x.value+"/";
    }
    // function changecdepart(x) {
    //     window.location = "/bycdepart/"+x.value+"/";
    // }
</script>
<form action="/bysid/" method="POST">
{% csrf_token %}
學號查詢：<input name="sid" size="50" placeholder="Search" >
<input type="submit" value="查詢">
<!-- <select style="width: 150px;" onchange="changesid(this)">
    <option value=0>請選擇學號</option>
{% for sid in ssid %}
    <option value={{ sid.id }}>{{ sid.sid }}</option>
{% endfor %}
</select> -->
學生系所查詢：
<select style="width: 200px;" onchange="changedepart(this)">
    <option value=0>請選擇系所</option>
{% for dept in sdepartments %}
    <option value={{ dept.id }}>{{ dept.name }}</option>
{% endfor %}
</select> 
</form>
<br>
    {% csrf_token %}
    {{ form }}
    <button onclick="window.location.href='/down_file'">下載檔案</button>
</form>
<hr>
以下共顯示{{ num }}筆資料：
<table class="table table-striped table-hover table-xxl text-nowrap">
    <tr>
        <td>學號</td><td>姓名</td><td>手機</td><td>學生信箱</td><td>學生系所</td>
        <td>學生班級</td><td>學生校區</td><td>選課代號</td><td>開課學制</td><td>開課系所</td>
        <td>開課班級</td><td>上課校區</td><td>上課教師</td><td>開課單位信箱</td><td>開課老師信箱</td>
        <td>上課時間</td><td>上課教室</td><td>科目</td><td>合班班級</td><td>實收人數</td><td>防疫假期間</td>
    </tr>
{% for c in course %}
    <tr>
        <td><small>{{c.sid}}</small></td> <!--學號-->
        <td><small>{{c.name}}</small></td> <!--學生姓名-->
        <td><small>{{c.phone}}</small></td> <!--手機-->
        <td><small>{{c.email}}</small></td><!--學生信箱-->
        <td><small>{{c.sdept}}</small></td><!--學生系所-->
        <td><small>{{c.scls}}</small></td><!--學生班級-->
        <td><small>{{c.scampus}}</small></td> <!--學生校區-->
        <td><small>{{c.cid}}</small></td> <!--選課代號-->
        <td><small>{{c.ctype}}</small></td> <!--開課學制-->
        <td><small>{{c.cdept}}</small></td><!--開課系所-->
        <td><small>{{c.ccls}}</small></td><!--開課班級-->
        <td><small>{{c.ccampus}}</small></td><!--上課校區-->
        <td><small>{{c.teacher}}</small></td><!--上課教師-->
        <td><small>{{c.cdeptemail}}</small></td><!--開課單位信箱-->
        <td><small>{{c.teacheremail}}</small></td><!--開課老師信箱-->
        <td><small>{{c.ctime}}</small></td><!--上課時間-->
        <td><small>{{c.place}}</small></td><!--上課教室-->
        <td><small>{{c.subject}}</small></td><!--科目-->
        <td><small>{{c.mcls}}</small></td><!--合班班級-->
        <td><small>{{c.snum}}</small></td><!--實收人數-->
        <td><small>{{c.duration}}</small></td><!--防疫假期間-->
    </tr>
{% endfor %}
</table>
{% endblock %}

view：
系所查詢
def search_by_ssdepart(request, id=1):
    sdepartments = Department.objects.all()
    scdepartments = CDepartment.objects.all()
    ssid = CourseData.objects.all()
    try:
        target_depart = Department.objects.get(id=id)
        course = CourseData.objects.filter(sdept=target_depart).order_by("teacher")
        ssid = StudentData.objects.filter(dept="資管系")
    except:
        course = course = CourseData.objects.filter(sdept="環工程").order_by("teacher")
    num = len(course)
    return render(request, "list.html")

學號查詢
def search_by_sid(request,pk=1):
    sdepartments = Department.objects.all()
    cdepartments = CDepartment.objects.all()
    ssid = CourseData.objects.all()
    if request.method == "POST":
        sid = request.POST.get("sid").strip()
        if "," in sid:
            course = CourseData.objects.filter(sid="NA")
            sids = sid.split(",")
            for n in sids:
                courses = CourseData.objects.filter(sid=n.strip())
                course = course | courses
        else:
            course = CourseData.objects.filter(sid=sid).order_by("teacher")
        num = len(course)
        return render(request, "list.html")
    return redirect("/")

檔案下載
def down_file(request,id=1):      
    url="http://127.0.0.1:8000/byssdepart/4/"
    down_file = pd.read_html(url)
    df = down_file[0]

    response = HttpResponse(content_type='text/csv')
    writer = csv.writer(response)
    response.write(codecs.BOM_UTF8)
    try:
        writer.writerow(list(df.columns))
        for i  in range(len(df)):
            writer.writerow(list(df.loc[i].values))
        response['Content-Disposition'] = 'attachment; filename= "Repost.csv"'
    except:
        response['Content-Disposition'] = 'attachment; filename= "Error.csv"'
    return response

Url：
urlpatterns = [
    path('', views.index),
    path('query-excel/', views.query_excel),
    path('student/', views.student),
    path('student/dept/<str:dept>/', views.student),
    path('byname/', views.search_by_name),
    path('bytname/', views.search_by_tname),
    path('bytname/<str:name>/', views.search_by_tname),
    path('bydepart/<int:id>/', views.search_by_depart),
    path('bycdepart/<int:id>/', views.search_by_cdepart),
    path('byssdepart/<int:id>/', views.search_by_ssdepart),
    path('list/', views.list),
    path('list/dept/<str:dept>/', views.list),
    path('bysid/', views.search_by_sid),
    path('bysid/<int:pk>/' , views.search_by_sid),
    path('down_file/', views.down_file),
    path('down_file/<int:id>/', views.down_file),
    path('admin/', admin.site.urls),
]



標題:list 合併 但是規格不一
標籤:python 

如題
我有三個list of list
一個list_tmp打算當作標籤用
list_tmp=['A','B','C','D','E','F','G']
a=[['A','1'],['B','2'],['C','3']]
b=[['A','5'],['C','2'],['D','1']]
c=[['C','1'],['E','2']]
我有嘗試過將有值得加進來
但是格式上會偏掉
我期望的結果是
如果a裡面有A則加入1 b裡面有A則加入5 c裡面沒有A則加入'-'
都沒有的話就比如F跟G就加入'-'
list_tmp2=[['A','1','5','-']
['B','2','-','-']
['C','3','2','1']
['D','-','1','-']
['E','-','-','2']
['F','-','-','-']
['G','-','-','-']]
求救大神 感謝


標題:已解決！
標籤:python 

已經解決了！
不好意思 打擾大家了


標題:如何用Python實現監控軟體偵測黑畫面自動重啟
標籤:python3 監控軟體 

Hi 想請教大家
如何實作用Python實現監控軟體偵測到黑畫面自動重啟 想問問大家有沒有推薦的方法或是好用的package推薦


標題:Line bot 可以接收 Line notify 所傳送的訊息嗎？
標籤:#line #linebot #python 

各位前輩好，小弟目前正在做有關Line Bot的專題，遇到了一處不清楚的地方，想請問一下把Line Bot 和 Line Notify 放在同一個群組，Notify 傳送的訊息有辦法讓 Line Bot去接收並做處理嗎？
謝謝各位前輩


標題:Python出現錯誤 KeyError: 'Columns not found: ' 請求版上前輩解惑!
標籤:python keyerror columns not found 錯誤 爬蟲 

如提，出現錯誤 KeyError: 'Columns not found: '
在執行下列網站範例
8-5 蝦皮市場區隔
不管怎麼調整還是會報錯誤，嘗試過檢查文件本身(錯誤前的檔案，下載來檢查)，確定無空白或亂碼等~
出現錯誤如圖! 詢問作者也無解，故想請教版上大大們~

已經研究一周，若是能有替代方案或解決辦法，懇請協助~感激不盡


標題:關於Flask 連入ip變成了127.0.0.1
標籤:python flask 

如標題所示
小弟不知道是不是改動到了什麼flask設定
導致原本連入的ip會顯示真實ip
現在都變成了127.0.0.1
另外我是在建置在AWS的linux
本來本地端不會顯示127.0.0.1



標題:python使重複篩選的資料不再出現
標籤:python pandas excel 

請問有一個即時更新的excel表，使用pandas篩選出資料後，
設定2秒更新後，請問如何將篩選出來的資料如果和前2秒資料相同就限制不出現??
謝謝各位!!
#篩選excel
import pandas as pd
data = pd.read_excel("0503.xlsm")
filter = (data['登入人數'] > 20) & (data['次數'] >30) 
print(data.loc[filter])

#重複時間
import time
def sleep_time(hour, min, sec):
    return hour*3600 + min*60 +sec
second = sleep_time(0,0,2)
while True:
    time.sleep(second)
    print(data.loc[filter])



標題:請教python selenium chrome多開能夠同步做一樣的動作嗎
標籤:python selenium 

各位大哥好我想請教個問題
我在使用selenium多開瀏覽器(不同chrome視窗多個),
但每個網頁加載的時間盡不相同
所以操作下一步時每個開始的時間不一樣
我想問能不能讓前面做完某步的瀏覽器等全部瀏覽器跑完再一起進行下一步
ex: 第一個網頁點完按鈕1,等待2,3...n個瀏覽器都點完按鈕,全部瀏覽器再執行點下一個按鈕2的動作。
這是我目前的代碼(不會等待)
from datetime import datetime
from selenium import webdriver
import threading
from multiprocessing import Queue
from selenium.webdriver.common.by import By
from selenium.webdriver.support.wait import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options
 
def selenium_mult():
    chrome_options = Options()
    chrome_options.add_argument("--headless") 
    ser=Service('./chromedriver')
    driver = webdriver.Chrome(service = ser,options=chrome_options)
    driver.set_window_size(540,480)
    driver.get('https:/website') 
 
    WebDriverWait(driver,10,1).until(EC.visibility_of_element_located((By.XPATH, '//*[@id="btn"]/div/div[3]/button[1]'))) 
    driver.find_element(By.XPATH, '//*[@id="btn"]/div/div[3]/button[1]').click()  #click button 1
    Ftime = datetime.now()
 
    WebDriverWait(driver,30,1).until(EC.visibility_of_element_located((By.XPATH, '//*[@id="btn"]/div/div[2]/div[1]/div[6]/div'))) 
    driver.find_element(By.XPATH, '//*[@id="btn"]/div/div[2]/div[1]/div[6]/div').click() #click button 2
 
if __name__ == '__main__':
    for i in range(5):
        t = threading.Thread(target=selenium_mult)
        t.start()
    
 



標題:使用python連結LIne notify 回傳excel資料 
標籤:line line bot python pandas excel 

各位好，因沒有學習過專業python，嘗試著自己寫出股價篩選後使用line notify即時回傳至手機，目前已分別寫出(A)用pandas篩選excel中的股票和(B)line notify的程式碼，
但想將(A)篩選出的資料用(B)傳至LINE，但不知道怎麼將兩程式碼結合...
import pandas as pd
data = pd.read_excel("0503.xlsm")

filter = (data['成交量'] > 2000) & (data['預估量'] >5) 
print(data.loc[filter])

import requests

def lineNotifyMessage(token, msg):

    headers = {
        "Authorization": "Bearer " + token, 
        "Content-Type" : "application/x-www-form-urlencoded"
    }

    payload = {'message': msg }
    r = requests.post("https://notify-api.line.me/api/notify", headers = headers, params = payload)

    return r.status_code

if __name__ == "__main__":
  token = 'token********'
  message = '想把excel篩選出來的資訊傳出'
  lineNotifyMessage(token, message)



標題:tab 鍵在某些程式會自動排版
標籤:tab python vscode 

各位前輩好，我在解下列題目的時候
for i in range (1, 5):
    for j in range (1, 5):
        if j==4:
            print("\t", i*j)
        else:
            print("\t", i*j, end='')

得到的結果是這樣：
	 1	 2	 3	 4
	 2	 4	 6	 8
	 3	 6	 9	 12
	 4	 8	 12	 16

意外發現 python 竟然會自動對齊，在雙位數的時候，tab 會自動變小，讓我很意外。
我另外試了 vscode 也得到一樣的結果，還有 macOS 內建的 Notes 也是。
但是 hackmd 就不會對齊，他的 tab 都是 4 格
     1     2     3     4
     5     6     7     8
     9     10     11     12

請問一下為何會有這種現象呢？我不太知道這該如何查資料，感謝各位前輩了！


標題:關於字串做複數的分割
標籤:python 

各位前輩好
我目前已知道針對字串裡某個特定符號可以做切割到不同列
例如
df2 = df_sort['規格'].str.split('*', expand=True)

這個語法可以針對字串裡面有*的時候便可以做切割
但如果針對匯入的資料（如Excel檔案）的某個欄位他有複數條件的話，這可以怎樣處理呢？
例如我這邊分析內容為AAA,BBB/CCC+DDD

,前面的字串內容為第一列
,到/中間有BBB的字串，做為第二列
/到+的中間有CCC，做為第三列
+的後面字串DDD為第四列

由於我是python小白，目前還沒有頭緒可以怎麼處理這樣的內容
還請各位前輩指教，謝謝！

感謝前輩們的指教，最後採取
df2 = df_sort['規格'].str.split(',|/|+', expand=True)

可以讓我的程式碼比較簡單化些
再次感謝Froce大以及星空大的指點


標題:[Python]輸出結果和自己本來所想的不一樣
標籤:python 

各位前輩好，下面為我程式的敘述
其實到中途都跟我原本的想法一致（不斷用print()做結果確認）
但是到了最後一兩步就出了差錯，是否能幫小弟我確認程式碼哪裡出問題了嗎？
"""
此程式的作用
1. 讀取指定資料夾下的所有.xlsx、.xls以及.ods檔案
2. 讀取的檔案內容作結合
3. 依據特定欄位列（型號）內容做升冪排序
4. 針對其他欄位列（規格）的內容做字串切割
5. 字串切割後把原本的欄位列去除，並把切割後的資料放到資料最後端結合
6. 將切割後的資料的欄位更改名稱（不更改名稱的話會變成0、1、2之類）
7. 輸出成新的Excel檔案
"""
import glob
import pandas as pd

# 分別設定來源檔案路徑以及輸出檔案的路徑
import_folder_path = 'D:/automatic/final'
export_file_path = 'D:/excelprocess'

# 讀取來源資料夾內所有的.xlsx、.xls以及.ods檔案
path1 = import_folder_path + '/' + '*.xlsx'
path2 = import_folder_path + '/' + '*.xls'
path3 = import_folder_path + '/' + '*.ods'
file_path = glob.glob(path1)+glob.glob(path2)+glob.glob(path3)

# 將所有檔案資料結合（會以檔案名排序優先讀取）
df_concat = pd.DataFrame()
for i in file_path:
    df_read_excel = pd.read_excel(i)
    df_concat = pd.concat([df_read_excel, df_concat])

# 按照合併Excel表格欄位裡「型號」的內容欄位做升冪
df_sort = df_concat.sort_values(by='型號', ascending=True)

# 針對「規格」列的*符號做切割並延展成其他列
df2 = df_sort['規格'].str.split('*', expand=True)

# 刪除已排列後（df_sort）的Dataframe裡面的「規格」列後，並在尾端加入文字分割處理後的內容
df3 = df_sort.drop('規格', axis=1).join(df2)

'''
將原本的規格列刪除後，將列名更改名稱分別為「長」、「寬」、「高」
此處有兩種做法
方法1：只要填入分割成幾列就填入幾欄
方法2：全部有幾欄就要填幾個欄位名稱
'''
# df3.rename(columns={0: '長', 1: '寬', 2: '高'}, inplace=True)
df3.columns = ['型號', '數字', '長', '寬', '高']

'''
調動欄位顯示的方式
dfdisplay = df3.loc[:, ['數字', '型號', '寬', '長', '高']]
'''

# 輸出為xlsx檔案
df3.to_excel(export_file_path+'/'+'MultiFileSplitProcess.xlsx', index=False)


其實到df2為止都沒問題（有使用print(df2)確認內容）
但是到了下面做結合時（df3）就出現問題了
所謂的問題是，原本整個資料僅有28行資料，但是不知道為什麼在print(df3)的時候
竟然會暴增至134行資料（有些資料重複）
不知道這是什麼狀況？
※附帶一題，如果只有讀取單一檔案的話，是不會發生這問題的，但是在讀取多個檔案才有這樣多出資料


標題:如何在aws Linux上安装Flask-MySQLDB？
標籤:flask python3 mysql yum pip 

pip3 install flask-mysqldb
或
python3 -m pip install flask-mysqldb

本機版本的可以成功安裝Flask-MySQLDB

雲端上的linux

有試過
sudo apt install libmariadb-dev-compat
apt 或 yum install libmysqlclient-dev
apt install python-dev or apt install python3-dev
yum install python3-devel mysql-devel


標題:Django 使用QuerySet 的filter save()，id編號會抓錯?
標籤:python django 

我用py+Django寫編輯修改的功能，遇到QuerySet filter的save錯誤。
查過官方文檔的內容是說’QuerySet’ object has no attribute ‘save’，
也就是說這是一個集合QuerySet，而對於集合的話，是沒有“save”這個屬性。
所以我在save()的位置添加**[0]**，使其值不為空
按下編輯修改按鈕後，可以抓到當前資料的id編號，如下圖

但問題來了，當我按下submit(確認修改)，撈進來的id卻從id編號:1開始抓資料?! 如下圖

反而不是抓當前資料的id編號(舉例:id 120)，這也是因為 filter 所影響的問題嗎?
請問該如何修正才能正確抓到當前資料的id編號? 謝謝
以下是提供我的程式代碼
Models：
Software Table
class Software(models.Model):
    STATUS_CHOICES = [
        (0, '規劃中'),
        (1, '開發中'),
        (2, '使用中'),
        (3, '已廢棄')
    ]
    name = models.CharField(max_length=100, verbose_name="系統名稱")
    url = models.CharField(max_length=100, verbose_name="系統網址")
    status = models.PositiveIntegerField(default=0, choices=STATUS_CHOICES,  verbose_name="目前狀態") 
    company = models.ForeignKey(Company, on_delete=models.CASCADE,  verbose_name="開發公司或單位")
    team = models.ForeignKey(Team, on_delete=models.DO_NOTHING,  verbose_name="所屬組別")
    def __str__(self):
        return self.name

Memo Table
class Memo(models.Model):
    notes = models.TextField()
    software = models.ForeignKey(Software, on_delete=models.CASCADE)
    #software = models.ForeignKey(Software, on_delete=models.SET_NULL, null=True, blank=True)
    timestamp = models.DateTimeField(default=timezone.now)
 
    def __str__(self):
        return self.notes

Templates:
{% extends 'base.html' %}
{% block title %}
查核系統
{% endblock %}
{% block main %}
<h2 >編輯備註</h2>
<hr>
<form action="/editmemo/" method="POST">
{% csrf_token %}
<input name="pk" type="hidden" value={{ target_memo.id }}>
<table class="table table-striped">
    <tr>
        <td align=right>備註：
        </td>
        <td>
            {% for memo in memos %}
            <input type=text name="memos" size=50  value='{{memo.notes}}'>
            {% endfor %}
        </td>
    </tr> 
    <tr><td>　</td><td>
        <input type=submit value="確定修改" class="btn btn-warning">
    </td></tr>
</table>
</form>
{% endblock %}

Views:
@login_required(login_url='/admin/login/')
def edit_memo(request,pk=1):
    teamid = Team.objects.get(name = logged_user.team).id
    target_soft = Software.objects.get(id=pk)
    item = Software.objects.get(id=pk)
    if request.method=="POST":
        softwareid = request.POST.get('softwareid')
        item = Software.objects.get(id=pk)
        memos = Memo.objects.filter(software=item)
        memos[0].save() #使值不為空
        return render(request,"showdetail.html",locals())      
    try:
        memos = Memo.objects.filter(software=item)
    except:       
        return redirect("/showall/")
    return render(request, "edit_memo.html", locals())  

Url:
urlpatterns = [
    path('editmemo/',views.edit_memo),
    path('editmemo/<int:pk>/',views.edit_memo),
    path('', views.index),
]+static(settings.MEDIA_URL,document_root=settings.MEDIA_ROOT)



標題:該如何使用selenium點擊googlemap商家按鈕
標籤:python爬蟲 

板上各位前輩大家好，想要使用selenium點擊googlemap上的更多評論去抓取評論，不過一直沒有辦法讓程式點擊到那個按鈕(如下圖)

原本是用以下的程式碼去做點擊，不過一直跳出錯誤
button = chrome.find_element_by_class_name('BgrMEd-cYlvTc')
button.click()

NoSuchElementException
Message: no such element: Unable to locate element: {"method":"css selector","selector":".BgrMEd-cYlvTc"}
懇請板上的大大，若有任何解決方案可以協助我，感恩!


標題:程式執行顯示AttributeError: 'float' object has no attribute 'split'
標籤:python 爬蟲 float split 

板上各位前輩大家好，想請教一個程式錯誤問題!
我透過爬蟲想要抓某賣場的商品資料內容，首先導入資料

再來把資料的原本的英文名稱改為中文方便辨識


**重點，我想將文章內的 #tag 的標示都抓出來，也確定內容有出現 #xxx 的標籤
**

然後就會出錯~

懇請板上的大大，若有任何解決方案可以協助我，感恩!


標題:Python Dataframe篩選與轉換技巧請教
標籤:python dataframe pandas 

目前手邊有一份資料如下(金額為當日某地區總金額)：

現在想要篩選顧客同一日去了某地以外還去了哪裡，並且計算兩地的平均值，轉換成如下的關聯表(以106為例)：

請教各位大神在使用Python/pandas處理上有什麼方法可以做到，感謝各位大神!!


標題:如何設定chromedriver要列印背景圖形
標籤:python chromedriver 

我要將網頁內容列印成PDF，但結果背景都是空白的
發現原因是chrome的背景圖形設定是預設-否
有查到該設定的語法是  'printBackground':True
卻不知道該如何把這句加到我的程式中，請大神們開釋，謝謝！
我的程式如下：
from selenium import webdriver
import json

chrome_options = webdriver.ChromeOptions()
appState = {
   'recentDestinations': [
      {
           'id': 'Save as PDF',
           'origin': 'local',
           'account': ''
      }
  ],
   'selectedDestinationId': 'Save as PDF',
   'version': 2
}
prefs = {
   'printing.print_preview_sticky_settings.appState': json.dumps(appState), 
   'savefile.default_directory': output_path,
   'download.default_directory': output_path,
}
chrome_options.add_experimental_option('prefs', prefs)
chrome_options.add_argument('--kiosk-printing')
driver = webdriver.Chrome(executable_path = r"C:\Users\User\Desktop\RPA\chromedriver.exe", options = chrome_options)

driver.get('https://icinfo.immigration.gov.tw/NIL_WEB/NFCData.aspx')
driver.execute_script('document.title="{}";'.format('居留證查詢.pdf'));
driver.execute_script('window.print();')
print('已另存為居留證查詢.pdf')



標題:如何實作在iPhone 上的iOS 自動化
標籤:python3 automation iphone pythonista shortcuts 

Hi 想請教大家
如何實作在iPhone 上的iOS 自動化，有在搜尋如何使用iPhone的捷徑和Pythonista去完成：
1.實作在iPhone 上自動登入網頁、做自動打卡的功能
啟動Safari
登入網頁
打帳密
點打卡按鈕
遇到問題：不知道如何使用捷徑完成，似乎要加入js語法才能完成
2.啟動火車時刻表app 在我離開公司自動查詢火車班次
遇到問題：native app內的按鈕點擊可以用以上兩種方法做到嗎？
以上再麻煩各位看有沒有什麼建議 謝謝


標題:python package安裝備份的問題
標籤:python3 

請教大家
透過下列指令
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cudatoolkit=11.1 -c pytorch -c conda-forge

pip install torch==1.8.0+cu111 torchvision==0.9.0+cu111 torchaudio==0.8.0 -f https://download.pytorch.org/whl/torch_stable.html

而因為電腦不一定有外網可使用, 要如何將已經安裝的 package 備份轉移到別台電腦來使用呢?
謝謝


標題:pygame碰撞問題
標籤:pygame python #新手求指導 

目前在練習pygame，而在判斷玩家跟敵人碰撞的時候遇到TypeError: 'Player' object is not iterable，想問一下該怎麼解決這個問題。
import pygame
import random

FPS = 60
WIDTH = 600
HEIGHT = 600
WHITE = (255, 255, 255)
GREEN = (0, 255, 0)
RED = (255, 0, 0)
YELLOW = (255, 255, 0)

#遊戲初始化 創建視窗
pygame.init()
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("game")
clock = pygame.time.Clock()


class Player(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.Surface((10, 10))
        self.image.fill(GREEN)
        self.rect = self.image.get_rect()
        self.rect.center = (WIDTH/2, HEIGHT/2)
        self.speedx = 3
        self.speedy = 3
        
    def update(self):
        key_pressed = pygame.key.get_pressed()
        
        #上下左右
        if key_pressed[pygame.K_RIGHT]:
            self.rect.x += self.speedx
        if key_pressed[pygame.K_LEFT]:
            self.rect.x -= self.speedx
        if key_pressed[pygame.K_UP]:
            self.rect.y -= self.speedy
        if key_pressed[pygame.K_DOWN]:
            self.rect.y += self.speedy
        
        #控制邊界
        if self.rect.right > WIDTH:
            self.rect.right = WIDTH
        if self.rect.left < 0:
            self.rect.left = 0
        if self.rect.bottom > HEIGHT:
            self.rect.bottom = HEIGHT
        if self.rect.top < 0:
            self.rect.top = 0
            
    def attack(self):
        bullet = Attack(self.rect.centerx, self.rect.top)
        all_sprites.add(bullet)
        bullets.add(bullet)
        
class Soldier(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.Surface((15, 15))
        self.image.fill(RED)
        self.rect = self.image.get_rect()
        
        #球由上到下    
        self.rect.x = random.randrange(0, WIDTH - self.rect.width)
        self.rect.y = random.randrange(0, 40)
        self.speedx = random.randrange(-3, 3)
        self.speedy = random.randrange(2, 6)
        
  
    def update(self):
        self.rect.x += self.speedx  
        self.rect.y += self.speedy
        
        #碰到邊界重製
        if self.rect.right > WIDTH or self.rect.left < 0 :
            self.speedx *= -1
            
        if self.rect.bottom > HEIGHT or self.rect.top < 0 :
            self.speedy *= -1

class Attack(pygame.sprite.Sprite):
    def __init__(self, x, y):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.Surface((8, 8))
        self.image.fill(YELLOW)
        self.rect = self.image.get_rect()
        
        self.rect.centerx = x
        self.rect.bottom = y
        self.speedy = -10
        
  
    def update(self):
        self.rect.y += self.speedy
        
        #碰到邊界重製
        if self.rect.top < 0 :
            self.kill()
            
#動作儲存            
all_sprites = pygame.sprite.Group()
soldiers = pygame.sprite.Group()
bullets = pygame.sprite.Group()
player = Player()
all_sprites.add(player)

#增加敵人
for j in range (15):
    soldier = Soldier()
    all_sprites.add(soldier)
    soldiers.add(soldier)



#遊戲迴圈
running = True
while running:
    #1秒內更新幾次
    clock.tick(FPS)
    
    #取得輸入
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
        elif event.type == pygame.KEYDOWN:
            if event.key == pygame.K_SPACE:
                player.attack()
    #更新遊戲
    all_sprites.update()
    
    #判斷敵人跟子彈是否碰撞
    hits = pygame.sprite.groupcollide(soldiers, bullets, True, True)
    for hit in hits:
        soldier = Soldier()
        all_sprites.add(soldier)
    
    #判斷敵人與玩家是否碰撞    
    hit = pygame.sprite.groupcollide(player, soldiers, False, False)
    if hit :
        running = False
    
    #畫面顯示
    screen.fill(WHITE)
    all_sprites.draw(screen)
    pygame.display.update()

pygame.quit()




標題:Python 控制網頁並上傳檔案
標籤:python fileupload file html 


如上圖，「選擇檔案」按鈕的html如下
點選後會跳出檔案總管讓我選擇檔案
<input name="fileinput" type="file" id="fileinput" names="file" accept=".jpg,.gif,.bmp,.png" onchange="afterChooseUploadFile();">

選擇完成後會呈現此畫面，最後再按儲存，才會將圖片檔案送出存檔

但是「選擇檔案」這個按鈕，python無法找到元素(錯誤訊息如下)
請問該如何操作，才能把檔案路徑傳上去呢?
NoSuchElementException: no such element: Unable to locate element: {"method":"xpath","selector":"//*[@id="fileinput"]"}
  (Session info: chrome=100.0.4896.127)



標題:python中，print不能打印出函數嗎?
標籤:#python #python求救 #python問題 #新手疑問 #新手求講解 

def add(a,b):
    print(a+b)
print(add(3,4))

大家好，小弟剛接觸python，想請問以上述程式碼會運行出7與none值，這是因為裡面add(3,4)先運行出7值，後續print因為無法打印出add(3,4)這個函數，所以會同時跑出7與none值嗎?


標題:Python  不換行輸入驗證
標籤:python cli 

執行環境:Windows終端機
目的:
想要實現驗證輸入是否有誤，如果有誤則將警告訊息顯示在下方，
然後不換行，繼續在原本的地方輸入，直到輸入無誤後，則將警告訊息刪除。
想要實現如PyInquirer套件功能，程式碼在下下方。
問題A: 不知道如何收回訊息，只能想到覆蓋的方法。
問題B: 輸入A正確後，繼續輸入B時，如果輸入錯誤，寫入警告訊息後，想要回到原本輸入位置，但是輸入位置數值為固定，所以光標會跑到上面去，所以不知道有什麼更好的辦法回到原本輸入位置。
第一次發問，請教各位大大。
目前的程式碼:
程式碼可能很蠢的地方很多，歡迎糾正。
# -*- coding: utf-8 -*-
import os
import sys

class Input_ask():
    def __init__(self, Message):
        self.Message = Message #提問內容
        self.Input()

    def Input(self):
        try:
            self.Reply = input(self.Message).strip()
            self.Judge()
        except KeyboardInterrupt:
            sys.exit()

    #判斷
    def Judge(self):
        if os.path.isfile(self.Reply) == True and self.Reply.strip() != "": 
            return self.Reply
        else:
            self.ShowError()
        

    #顯示錯誤訊息
    def ShowError(self):
        #輸出錯誤訊息
        sys.stderr.write("\n\n" + "\033[31m" + "請輸入正確的檔名" + "\033[0m") 
        #回到原本輸入位置(需修改)        
        sys.stdout.write("\033[%dH" % (3)) 
        self.Input()

print("某某訊息...\n")
FileA = Input_ask("請輸入來源檔案名稱: ").Reply
print("\n" + FileA)
FileB = Input_ask("\n\n請輸入目的檔案名稱: ").Reply
print("\n" + FileB)

輸出畫面:
1.輸入錯誤，顯示警告訊息，但不換行，繼續在原本位置輸入

2.輸入正確後想把錯誤訊息收回，然後繼續輸入下一個



使用PyInquirer套件:
from PyInquirer import prompt
from prompt_toolkit.validation import Validator, ValidationError
from examples import custom_style_3 #美化用


class NumberValidator(Validator):
    def validate(self, document):
        try:
            int(document.text)
        except ValueError:
            raise ValidationError(
                message='Please enter a number', #警告訊息
                cursor_position=len(document.text))  # Move cursor to end

questions = [
    {
        'type': 'input',
        'name': 'quantity',
        'message': 'How many do you need?', #輸入提示
        'validate': NumberValidator, #輸入驗證(在上方)
        'filter': lambda val: int(val)
    }    
]

answers = prompt(questions, style=custom_style_3)
print('Order receipt:')
print(answers)

輸出畫面:
1.輸入錯誤會顯示警告訊息，重新輸入時會自動刪除警告。


2.能輸出警告訊息，在原本位置繼續輸入

想要請問原理是什麼，如何實現的。


標題:python zipfile未正確close
標籤:python zipfile 

我用python執行操作時
突然的報錯導致zip沒有執行close
結果再想開啟zip時就會報錯BadZipFile
可以用winrar修復
有辦法用python修復這個zip檔嗎
import zipfile
bufferDir='buffer.zip'
z = zipfile.ZipFile(bufferDir, 'a', zipfile.ZIP_STORED)

在這裡出現錯誤導致zip沒有close

z.close()




標題:CNN類別定義&分類
標籤:cnn python 

以mnist為例明確地將類別分成10個類別
若我的圖片有A、B、C．．． Y、Z類
但實際特徵較為明顯
人比較好定義的類別只有
A、B、C 三大類
其餘的我都想直接統一定義成others類
所以簡單說不屬於ABC的我都定義為others
若以這樣的模式透過CNN去建模(A、B、C、others 四大類)
模型有辦法學會嗎
或是想請問有更好的解法嗎
謝謝


標題:'str' object has no attribute 'price51'
標籤:python python入門 技術問答 

如題，想問這是哪裡出了問題，謝謝



標題:寫一個定時提醒簡單的小程式，python?PWA?c# win-form? or others?
標籤:python pwa 

想寫一個類似蕃茄鐘的小工具，可以利用Windows Task Scheduler自動觸發（最小化或系統列執行），當程式執行後開始計時，當計時到數時，可以跳出一個alert window。
語言/工具不限的話，各位有建議的做法嗎?（當做code for fun）


標題:python seaborn 製作bar chart
標籤:seaborn barchart python3 

想請穩如果是用匯入csv檔案來製作bar chart,那麼當資料以年齡為x軸，但是想取其中age_code=10~20來製作bar chart，請問如何寫出該區間的程式碼，我大約知道使用dataframe.loc 來擷取區間，但是我是用匯入檔案來製作barchart，所以原本製作barchart就沒有使用dataframe這個單字，所以不太清楚該如何使用這個dataframe.loc
原本還未擷取x軸區域時的程式碼
from pandas import read_csv
df1=read_csv('test.csv')
print(df1)
import seaborn as sns
fig=sns.barplot(x='age_code',y='N',data=df1)
希望有人能幫我解答，謝謝


標題:python 找不到元素按鈕
標籤:python 定位 元素 button 


如圖，左邊有一個「選擇檔案」按鈕，按下後會跳出檔案總管讓我選檔案上傳
但是我一直找不到按鈕
語法
driver.find_element_by_xpath('/html/body/form/div[3]/div[2]/main/div/div[2]/table[2]/tbody/tr[2]/td[1]/div/a').click()

錯誤訊息NoSuchElementException: no such element: Unable to locate element: {"method":"css selector","selector":"[name="ctl00_ContentPlaceHolder1_tb_totalWeight"]"} (Session info: chrome=100.0.4896.127)
再請各位協助~~謝謝!!


標題:Python+Django如何去撈出正確的FK資料內容?
標籤:python django foreign key 

請教各位前輩
我用Python+Django的架構，我想在畫面的"備註"欄位，顯示出正確的內容，但不知道要怎麼去撈PK對應到FK的資料，一直都撈錯 @@
狀況問題：我從"SoftWare"這張表，去對應到 "Memo"這張表，要去db內撈出資料回來，但都會變成撈到 "Memo"的id，抓到的內容就不是我要的資料內容.
我該怎麼修改才對? (舉例：software_id : 4 要撈出 Memo id: 8 資料內容)
謝謝各位前輩
附上code及db和畫面圖片
畫面

db

Models - Memo
class Memo(models.Model):
	notes = models.TextField()
	software = models.ForeignKey(Software, on_delete=models.CASCADE)
	timestamp = models.DateTimeField(default=timezone.now)

	def __str__(self):
		return self.notes

Models - Software
class Software(models.Model):
	STATUS_CHOICES = [
		(0, '規劃中'),
		(1, '開發中'),
		(2, '使用中'),
		(3, '已廢棄')
	]
	name = models.CharField(max_length=100, verbose_name="系統名稱")
	url = models.CharField(max_length=100, verbose_name="系統網址")
	status = models.PositiveIntegerField(default=0, choices=STATUS_CHOICES,  verbose_name="目前狀態") 
	company = models.ForeignKey(Company, on_delete=models.CASCADE,  verbose_name="開發公司或單位")
	team = models.ForeignKey(Team, on_delete=models.DO_NOTHING,  verbose_name="所屬組別")
	def __str__(self):
		return self.name

Templates
<form method="POST" name="myform" action="." >
{% csrf_token %}
<table class="table table-striped">
    <tr>
        <td align=right>新增備註：</td>
        <td>
            <input type=text size=50 name="notes" value='{{target_Memo.notes}}'>
        </td>
    </tr>
    <tr>
        <td>　</td>
    <td>
        <input type=submit value="送出">
    </td>
    </tr>
</table>
</form>
{% endblock %}

Views
def add_showmemo(request,id=None,logmemo=None):
    logged_user = User.objects.get(username=request.user.username)
    logged_user = UserProfile.objects.get(user=logged_user)
    if request.method=="POST":
        unit = Memo.objects.get('notes')
    try:
        target_Memo = Memo.objects.get(id=id)
        #target_Memo.save()
    except Exception as e:
        print(e)
        return redirect("/showdetail/")        
    return render(request, "add_showmemo.html", locals())



標題:樹莓派語音控制
標籤:#樹莓派 物聯網 python 語音辨識 機器學習 

最近專題遇到了困難想了很久但想不出解決方法所以決定在這發問，老師希望能做出樹莓派與音辨識控制行為，而本身也有麥克風與喇叭了那麼想問有甚麼方法和方式可以實現語音控制，若是想用Google語音可以直接用嗎? 還是要再另外買專用的板子? 也希望好心的大大能幫忙解答提供範例和教學方式資源的協助 拜託了~~~


標題:json.loads()印不出從requests.get().text的json格式?
標籤:json python json.loads 網路爬蟲 requests.get 

請問前輩為何 https://www.dcard.tw/_api/forums/funny/posts?limit=100 網頁是Json檔，但是以下程式碼卻出錯呢?
import json
import requests
url="https://www.dcard.tw/_api/forums/funny/posts?limit=100"
res = requests.get(url).text
data = json.loads(res)
print(data)



標題:該如何刪除空白欄位欄的那一列呢？
標籤:python 

各位前輩好
新手小弟再來討教Python的語法
功能描述：

讀取某資料夾內的所有.xlsx檔案
把資料結合在一起後依據欄位裡的number做升冪
輸出為已處理.xlsx檔案

以下為小弟的程式碼
import glob
import pandas as pd

# 分別設定來源檔案路徑以及輸出檔案的路徑
import_folder_path = 'D:/automatic/excel'
export_file_path = 'D:/excelprocess'

# 讀取來源資料夾內所有的.xlsx檔案
path = import_folder_path + '/' + '*.xlsx'
file_path = glob.glob(path)

# 將所有檔案資料結合
df_concat = pd.DataFrame()
for i in file_path:
    df_read_excel = pd.read_excel(i)
    df_concat = pd.concat([df_read_excel, df_concat])

# 將前頭一個空白列刪除
df_drop = df_concat.drop('NaN', axis=1)
# 按照Excel表格欄位裡number的欄位做升冪
df_sort = df_drop.sort_values(by='number', ascending=True)

# 將最後排列結果輸出成已處理.xlsx檔案
df_sort.to_excel(export_file_path+'/'+'已處理.xlsx')


目前遇到的問題是
# 將前頭一個空白列刪除
df_drop = df_concat.drop('NaN', axis=1)
這一行的空欄內容
如果在這行之前執行print(df_concat)的話
會看到前面多出一行，而第一行第一欄就是空白值
我想藉由判別該空白值然後刪掉那一列的東西
但是輸入NaN或是輸入空白都無效，都會說找不到該變數（但這不是變數啊）
還請各位前輩指教這樣的狀況下該怎麼處理，謝謝！


標題:python 查詢不到元素
標籤:python div click web website 


如上圖，左邊是未挑選區，右邊是已挑選區
一次只能選擇一個到右邊
我的需求是點選左邊的選項後，點選「轉EXCEL」按鈕下載
但現在下面的任何一個元素都會找不到
以下是我的code
from selenium import webdriver
import time

PATH = "C:/Users/USER/Desktop/chromedriver.exe"


driver = webdriver.Chrome(PATH)


driver.get("http://.........")
 
#登入網站
USERID = driver.find_element_by_name("userid")
USERID.send_keys("XXXXX")
USERPWD = driver.find_element_by_name("passwd")
USERPWD.send_keys("XXXXX")
driver.find_element_by_xpath('//*[@id="logIn"]').click()

#等待網站載入
driver.implicitly_wait(6)


#點選記錄查詢
driver.find_element_by_xpath('/html/body/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr/td/div/table[2]/tbody/tr[1]/td').click()
#點選行車紀錄
driver.find_element_by_xpath('/html/body/table/tbody/tr[2]/td/table/tbody/tr/td[1]/table/tbody/tr/td/div/table[2]/tbody/tr[2]/td/table/tbody/tr[1]/td/span').click()


time.sleep(5)   


#點選左邊選項
driver.find_element_by_xpath('/html/body/table/tbody[2]/tr/td/table/tbody/tr[2]/td[1]/div/div[1]/a').click()



錯誤訊息如下
no such element: Unable to locate element: {"method":"xpath","selector":"/html/body/table/tbody[2]/tr/td/table/tbody/tr[2]/td[1]/div/div[1]/a"}
  (Session info: chrome=100.0.4896.127)

且div裡每一個選項ID都相同..
未被選到的選項會在lcode底下

選擇後的選項會在rcode底下

再請大家協助~~謝謝!!


標題:[Python]執行xlsx檔案輸出時出現錯誤
標籤:python 

各位前輩好
小弟我是初學Python的新手
目前正在嘗試做一些Python的應用希望能夠在工作上有些幫助
功能如下：
1.xlsx:為來源的excel檔案

讀取1.xlsx檔案
分析1.xlsx檔案裡面的特定欄位項
指定特定欄位項的內容輸出成不同的表格

例如表格欄位如下：
name	number	age
abc	1	    11
def	2	    12
ghi	3	    13
jkl    4       14
mno	5	    15
我這裡依據name這一列輸出檔案會變成
abc.xlsx
def.xlsx
ghi.xlsx
jkl.xlsx
mno.xlsx
每個檔案會別有name和number以及age這個欄位，下面並有該當的資料
以下是我的程式碼
import pandas as pd

# 設定輸入檔案路徑、讀取工作表名稱以及輸出檔案的路徑
import_file_path = 'D:/automatic/excel/a.xlsx'
excel_sheet_name = '工作表1'
export_file_path = 'D:/excelprocess'

# 定義df_order並透過pandas讀取指定的路徑且指定分頁的xlsx檔案
df_order = pd.read_excel(import_file_path, sheet_name=excel_sheet_name)
# 定義company_name為檔案中僅取出name那一列的資料
company_name = df_order['name'].unique()

# 依據name的欄位分割成不同顯示方式並輸出成Excel檔案
for i in company_name:
    df_order_company = df_order[df_order['name'] == i]
    df_order_company.to_excel(export_file_path+'/'+i+'xlsx')

程式碼的部分我想應該沒什麼問題（因為我是按照別人的範例依樣畫葫蘆）
但是在輸出的時候出現了error
內容如下
Traceback (most recent call last):
  File "C:\Users\rucif\PycharmProjects\file\venv\lib\site-packages\pandas\io\excel\_base.py", line 999, in __new__
    engine = config.get_option(f"io.excel.{ext}.writer", silent=True)
  File "C:\Users\rucif\PycharmProjects\file\venv\lib\site-packages\pandas\_config\config.py", line 256, in __call__
    return self.__func__(*args, **kwds)
  File "C:\Users\rucif\PycharmProjects\file\venv\lib\site-packages\pandas\_config\config.py", line 128, in _get_option
    key = _get_single_key(pat, silent)
  File "C:\Users\rucif\PycharmProjects\file\venv\lib\site-packages\pandas\_config\config.py", line 114, in _get_single_key
    raise OptionError(f"No such keys(s): {repr(pat)}")
pandas._config.config.OptionError: No such keys(s): 'io.excel..writer'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\rucif\PycharmProjects\file\file.py", line 18, in <module>
    df_order_company.to_excel(export_file_path+'/'+i+'xlsx')
  File "C:\Users\rucif\PycharmProjects\file\venv\lib\site-packages\pandas\core\generic.py", line 2345, in to_excel
    formatter.write(
  File "C:\Users\rucif\PycharmProjects\file\venv\lib\site-packages\pandas\io\formats\excel.py", line 888, in write
    writer = ExcelWriter(  # type: ignore[abstract]
  File "C:\Users\rucif\PycharmProjects\file\venv\lib\site-packages\pandas\io\excel\_base.py", line 1003, in __new__
    raise ValueError(f"No engine for filetype: '{ext}'") from err
ValueError: No engine for filetype: ''

Process finished with exit code 1

不知道這是哪裡出現問題了？還請前輩指教，謝謝


標題:datatable 的 css物件應用失敗
標籤:python3 flask html css 

想請教各位
最近在寫python +flask web
就是發現一件事情
html有些渲染的部分或是類似像datatable這個css物件
edge可以順利顯示
google chrome則無法顯示table格式
手機連上雲端的網站也是同樣問題 (已將網頁所需檔案都上傳雲端執行)
想請教是哪個環節有問題嗎?
失敗畫面

成功畫面



標題:如何在AWS的Linux系統上執行.py 
標籤:python3 aws linux 

小弟在AWS的Linux系統執行.py
目前遇到一個問題就是
因為在本地端有安裝多個套件 以至於在linux上會沒辦法import相關套件
是否有更快的方式 抑或是只能
一個一個去安裝相關套件
另外小弟有打算用pyinstaller去包成exe在linux上面執行


標題:Mezzanine cms runserver成功 想輸入內容卻報錯
標籤:django python mezzanine 

TypeError at /admin/blog/blogpost/add/
clean() got an unexpected keyword argument 'styles'
什麼問題


標題:python 移除list元素問題
標籤:python 

list1 = [1,2,3]
list2 = list1
del list1[1]
print(list2)
結果print出來是[1,3]
我試了remove pop del都一樣
想問一下為什麼 不是應該是原來的list嗎
感謝


標題:Python to_sql 問題
標籤:python mysql sql gcp 

我使用
df.to_sql('Table_name',con=engine,index=False,if_exists='replace')
將資料上傳到 資料庫中
原本有設定 "ID" 當作資料庫中的 Primary key
但在每次同樣方式傳到資料庫後 , Primary key 設定就會跑掉 , 就跟 create new table 一樣 , 再請指教  謝謝幫忙


標題:該如何評估系統所需要的記憶體
標籤:python memory system log trace code 

如題，最近在開發一個系統，想請教版上的各位對於評估系統所需的記憶體有什麼看法，例如可以從什麼方面來觀測 or 利用 log 紀錄什麼樣的資訊來評估


標題:求救python大大
標籤:python 

求救



標題:Flask渲染bootstrap carousel
標籤:python flask bootstrap5 


https://bootstrap5.hexschool.com/docs/5.1/components/carousel/
小弟我使用bootstrap carousel這個元件
上面的圖是bootstrap的範例圖
我想把我python的資料渲染上去
但是切換按鈕都無法動作 只顯示第一個輪播的img
html的地方其他都沒變
只有改以下這邊
  {% for tmp in tmps %}
  <div class="carousel-item active">
    <img src={{tmp[3]}} class="d-block w-100" alt="...">
    <div class="carousel-caption d-none d-md-block">
      <h5><a href="{{tmp[2]}}">{{tmp[0]}}<</h5>
      <p href="{{tmp[2]}}">{{tmp[1]}}</p>
    </div>
  </div>

  {% endfor %}

</div>

感謝大神指教


標題:關於蝦皮爬蟲，對於 seller 的登入問題
標籤:python3 網頁爬蟲 crawler 

各位大大，您好，
我有試過 selenium 或者有用 requests
selenium 會遇到要點選連結，發簡訊的問題
requests 我用 cookies 的方式
好像是不正確的，因為跑很久才會出來不正確的
回傳的信息： ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
請問是否不能透過 cookies 登入的方式？
還請各位大大是否可以告知，謝謝！
import requests
import re
import pandas as pd
import http.cookiejar
from bs4 import BeautifulSoup
from fake_useragent import UserAgent
from lxml import etree, html

import json

url = 'https://seller.shopee.tw/portal/product/list/all'
headers = requests.utils.default_headers()

headers.update({
        'Host': 'seller.shopee.tw',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36 Edg/100.0.1185.44',
        'Accept': 'application/json, text/javascript, */*; q=0.01',
        'Accept-Language': 'zh-TW,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6',
        'Accept-Encoding': 'gzip, deflate, br',
        'Referer': 'https://seller.shopee.tw/account/signin?next=index.index&params=%5B%5D',
        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
        'Content-Length': '175',
        'Connection': 'keep-alive',
        'cache-control': 'max-age=0',
        'Cookie':'SPC_CDS=c6d83195-36d0-44d0-8cf3-28048ab0a801; SPC_SC_SA_TK=; SPC_SC_SA_UD=; SC_DFP=8fIlJwr9WELra90iOnVKcX5q50C77BVq; SPC_F=WUoPxOooqqf7bZ4zi9YbiC51pOD8kAF4; _gcl_au=1.1.554183486.1650289319; SPC_SI=mall.yG6gp8FzRwFbCWAUMpO672W58fJwTtun; _gid=GA1.2.430041453.1650289320; SC_SSO=-; SC_SSO_U=-; _QPWSDCXHZQA=de866c47-e411-4af3-e561-2c59a7c453ec; UYOMAPJWEMDGJ=; _ga_RPSBE3TQZZ=GS1.1.1650334609.103.0.1650334609.60; _ga=GA1.1.11249714.1650289320; G_ENABLED_IDPS=google; shopee_webUnique_ccd=f70yT08jegushoSqNREyFg%3D%3D%7CFriBOLTO%2BOf6MbIucNOxDDB1AoeJ%2B4qXZCgpskp9M42zwyM1YdfDM1orDXb3iK9e7uNOj9tJ43LU3BNIcNz1%7Cd01NDUQtBfXRtBuX%7C04%7C3; SPC_IVS=; SPC_R_T_ID=PzjMC/wTquV/Q6j9BN6no6yfCGcWgIOXIWen5BjXAPpYwDtvihLaOf58sJIL9Usig5/YxC7POPfsxpfI3tAVch/zPXCa+7IOddYdlgb1Qz8=; SPC_R_T_IV=tvDRVjWvzEPbV0YRDn4z6g==; SPC_T_ID=PzjMC/wTquV/Q6j9BN6no6yfCGcWgIOXIWen5BjXAPpYwDtvihLaOf58sJIL9Usig5/YxC7POPfsxpfI3tAVch/zPXCa+7IOddYdlgb1Qz8=; SPC_T_IV=tvDRVjWvzEPbV0YRDn4z6g==; SPC_SC_TK=94ee3ddd4e5e841c5812a6f9ceed87d8; SPC_EC="ai6N7Ekh6VVCe6tJgCoVI6vY9cRXXbOyhAOvxwFGW+A8s6AdZ7x2d1jV6tW6jwQvw/0wimB6LynfafPaL0O0FQQc0tWZcnDI76rwVY244MMWRbX4NelOK/XC2E43fl3bwZ95ltlJZoZGEiyaTpA1lA=="; SPC_ST=".RzJRVnF2OVoxR0xuV2k3ThY1Hz7uXPdsCrM0pqko5udwfsPr+jrJbZR/cIHfPcWS4bBj80rmI9LNN3uPlSUr35P7cMLJ6xA59FSQRJcKZJSM9dqsCxfK4m7M9RrK/q2p6oqcWdNjnXn5Sx1Y7r5yYgHydXWqcFzd/MEveMhYU3eZFOhWkBXEqqQngVPzK0Rk"; SPC_WST="ai6N7Ekh6VVCe6tJgCoVI6vY9cRXXbOyhAOvxwFGW+A8s6AdZ7x2d1jV6tW6jwQvw/0wimB6LynfafPaL0O0FQQc0tWZcnDI76rwVY244MMWRbX4NelOK/XC2E43fl3bwZ95ltlJZoZGEiyaTpA1lA=="; SPC_SC_UD=3778846; SPC_U=3778846; SPC_STK="4SoACDMBGg2//PSvdIBpZp85qefsnIMBjxjvLEFV0NFNqYSZOV+F4PbFs0tfIRj0CSaS4lyOa1kTuGRy3rUsLHeC1VdNEk3CmHjmIwRk2NYLcdttubYa8kZu0ygQao9WHKC5wmwJrUhyfprOL25imvks2kiuNCeQi0lP/NCGFzQ="'
})

r = requests.get(url, headers=headers)
print(r.status_code)
print(r.history)
print(r.url)



標題:Python+Django做網頁開發，"編輯 Edit"功能傳遞資料時會傳不過去?
標籤:python django 

繼上次找到是rouning問題之後，已經有解決了，感謝提供建議和提示.
這次又來發問請教，因為實在是想不透這錯誤到底是什麼 @@
我是使用Python+Django做網頁開發，正在練習寫"編輯 Edit"功能
但在資料驗證時候try except，卻發生錯誤導致直接跳到except結束，結果也就是沒有任何編輯完並存檔.
有問題的行數在 View.py的第195行，這到底是為什麼資料傳不過去到變數...@@
錯誤訊息如下圖
ERR:

View:
@login_required(login_url='/admin/login/')
def edit_task(request,id=1):
    logged_user = User.objects.get(username=request.user.username)
    logged_user = UserProfile.objects.get(user=logged_user)
    unit= TaskList.objects.all()
    if request.method == "POST":
        etask = request.POST.get("task")
        try:
         # task = TaskList.objects.get(task=etask) #這行資料型態傳進來有問題?!         
            target_edit = TaskList.objects.get(task=etask)
            target_edit.task = etask
            target_edit.save()
        except Exception as e:
            print(e)         
            return redirect("/tasklist/")
    try:
        target_edit = TaskList.objects.get(id=id)     
    except:
        return redirect("/tasklist/")              
    return render(request,"edit_task.html",locals())

Template:
<form action="/edittask/" method="POST">
{% csrf_token %}
<table class="table table-striped">
    <tr>
        <td align=right>待辦事項</td>
        <td><input type=text name="task" size=100  value='{{target_edit.task}}' required></td>
    </tr> 
    <tr><td>　</td><td>
        <input type=submit value="確定" class="btn btn-primary">
    </td></tr>
</table>
</form>

Model:
class TaskList(models.Model):
	task = models.CharField(max_length=200)
	priority = models.PositiveIntegerField(default=0)
	status = models.PositiveIntegerField(default=0)    # 0:未處理，100:已完成
	user = models.CharField(max_length=50)
	worker = models.CharField(max_length=50, null=True, blank=True)
	timestamp = models.DateTimeField(default=timezone.now)
	start_date = models.DateField(null=True, blank=True)
	finish_date = models.DateField(null=True, blank=True)
	def __str__(self):
		return self.task



標題:執行append產生list of list ，但執行結果無法符合個人所需(已編輯：無法正確append的錯誤表達方式)(已解決)
標籤:python3 append list of list 

import time
list01=['1','2','3','4','5','6','7']
list02=['A','B','C','D','E','F','G']
tmp=[]
News=[]
for i,j in zip(list01,list02):
    tmp.append(i)
    tmp.append(j)
    News.append(tmp)
    time.sleep(3)
    print(tmp)
    print(News)
    tmp.clear()
個人邏輯顯示結果為
[['1','A'],['2','B'],['3','C']...]
實際結果為
[['7', 'G'], ['7', 'G'], ['7', 'G'], ['7', 'G'], ['7', 'G'], ['7', 'G'], ['7', 'G']]



標題:Python Flask 無法成功部署在IIS ，出現不明的FastCGI錯誤
標籤:flask python iis linebot fastcgi 

背景
未來想將原本發佈在 Heroku 的 Line Bot 佈署在 IIS 上
於是想先從簡單的 Flask application 佈署至 IIS 上
問題
嘗試瀏覽網頁出現 HTTP Error 500 - Internal Server Error (發生不明的FastCGI錯誤)
以下為錯誤附圖
https://img.onl/FcAktM
嘗試過的步驟

安裝python(用pip)
安裝wFastCGI(已從IIS管理員確定有FastCGI設定選項)
開啟或關閉Windows功能，IIS 勾選 CGI
建立站台(實體路徑同Python app資料夾，埠號81)
Python app 資料夾置於C:\inetpub\wwwroot\Flask_IIS (已提供 IIS_IUSRS 修改權限)
建立web.config設定檔

Python 檔程式碼 (my_app.py)
from flask import Flask

app = Flask(__name__)

@app.route('/')
def index():
	return 'Hello IIS from Flask framework.'

	
if __name__ == '__main__':
	app.run()


Web.Config 檔內容
<configuration>  
  <system.webServer>
    <handlers>
        <add name="Python FastCGI" path="*" verb="*" modules="FastCgiModule" scriptProcessor="C:\Users\steve\anaconda3\python.exe|C:\Users\steve\anaconda3\lib\site-packages\wfastcgi.py" resourceType="Unspecified" requireAccess="Script" />
    </handlers>
  </system.webServer>
  <appSettings>
    <add key="WSGI_HANDLER" value="my_app.app" /> 
    <add key="PYTHONPATH" value="C:\inetpub\wwwroot\Flask_IIS" />
	<add key="WSGI_LOG" value="C:\inetpub\wwwroot\Flask_IIS\app.log" />
  </appSettings>
</configuration>  

不知道有沒有人遇過相同的問題?
還是我漏了什麼步驟?
再麻煩大家幫我解惑!謝謝!


標題:Django的編輯修改功能，出現DoesNotExist的錯誤??
標籤:python django 

想請問各位，我自己在自學，圖片中是練習時寫的code一直找不出是哪裡寫錯@@
圖片中是我練習寫的code，是哪一行有寫錯?才會發生DoesNotExist的錯誤!!還麻煩各位請指教，謝謝。
Error :






標題:建立不同python版本虛擬環境
標籤:python venv anaconda 

使用anaconda建立虛擬環境
$conda create --name py37-env python=3.7.10
可以建立一個python3.7.10的虛擬環境
若是使用python3自帶的venv
$python -m venv py-env
可以如同anaconda一樣建立不同的python版本嗎
謝謝


標題:python 控制 chrome動態選項
標籤:python chrome 動態選項 網頁 webdrive 


選項是動態的，左邊有非常多選項
點選後會跳到右邊
且一次只能選擇一個項目
我使用這個語法但都沒有反應，選項都不會移動到右邊
driver.find_element_by_xpath('XXXXX').click()
以下附上語法，跟選項的html資訊
#開啟瀏覽器
from selenium import webdriver
PATH = "C:/Users/USER/Desktop/chromedriver.exe"
driver = webdriver.Chrome(PATH)
driver.get("網址")
 
 #登入
USERID = driver.find_element_by_name("userid")
USERID.send_keys("帳號")
USERPWD = driver.find_element_by_name("passwd")
USERPWD.send_keys("密碼")
driver.find_element_by_xpath('//*[@id="logIn"]').click()

#點選到對應頁面-記錄查詢
driver.find_element_by_xpath('XXXXX').click()

#點選動態選項
driver.find_element_by_xpath('XXXXX').click()




標題:python 如何將圖片轉成二進制存到資料庫
標籤:@python @mssql 

這是我的語法
d = db(2)
with open('2.jpg','rb') as f:
    r = f.read()
    
sql = "INSERT INTO Fty_Photo(img2) values('%s')" % (r)
d.run_cmd(sql)

儲存的時候他會報很長的錯誤
ProgrammingError: (102, b"Incorrect syntax near '\'.DB-Lib error message 20018, severity 15:\nGeneral SQL Server error: Check messages from the SQL .......以下省略
網上找基本上都是存到MYSQL裡面去，但是資料型態是BLOB或LONGBLOB
MSSQL好像沒有這兩種型態
我設定了資料型態有兩個一個是image另一個則是varbinary(MAX)
有人知道這其中一種的儲存方式嗎?
我想用PY存入到資料庫後，在用網頁把照片撈出來顯示


標題:(已解決;謝謝提供意見的專家們~)mysql無法存取文字資料檔
標籤:mysql python scrawl 

真的很感謝大家熱心的解答!!!!! 又讓我學到更多了!!!
大家好，想請問專家為什麼有幾筆文字檔無法存取呢，問題是content那欄的文字，若只insert id和title，每一筆檔案都可以存入mysql當中，唯獨content不行，確認過不是因為字元的大小，目前是用mediumtext，已經非常大了，且長度比id=4和id=5的content都可以存入，想問是文字檔裡有不能存入的字嗎?請大家幫忙解答，非常感謝！

debug執行cursor.execute(a)時，就會直接跳到except

可以看到i = 3和i = 4兩筆無法存入



標題:PYTHON更新至3.7.13 security bugfix release
標籤:python3 python 

請問各位Python前輩，python 3.7.x最後binary installers為3.7.9，
若想透過官網升版到3.7.13，想請問大大該怎麼操作。
下載回來後為Python-3.7.13.tar
https://www.python.org/downloads/release/python-3713/



標題:Python   想請問如何移除多餘逗號 (已解決)
標籤:python3 

大家好:
我使用了此網站[https://www.geeksforgeeks.org/avl-tree-set-1-insertion/] 的程式碼，修改為 AVL tree 的 inorder traversal 版本。
但是我的輸出結尾會有多餘的逗號，在網路上搜尋一些方法，好像大多都是關於字串，因為還不太熟悉python，想請教大家該如何移除尾端多餘的逗號?  謝謝大家!


標題:Regex 替換錯誤的引號
標籤:python regex 

請問可以用 regex 替換錯誤的引號嗎？
」Excepteur sint」
「Hello World「
」foobar「
「Hello」Lorem ipsum dolor sit amet「World」

期望
「Excepteur sint」
「Hello World」
「foobar」
「Hello」Lorem ipsum dolor sit amet「World」

編輯
感謝 @Han，@海綿寶寶 的回答。(因為我等級不夠，無法在底下回應。)

@Han 再透過索引檢查第一個是不是 「 就可以決定是否替換
最後一個也一樣道理，提供給你參考

Hmm，不一定要只用 regex 來替換嘛
import regex

text = "」Excepteur sint」, 「Hello」Lorem ipsum dolor sit amet「World」"

for match in regex.finditer("[「」].*?[「」]", text):
    quotes_text = match.group()
    
    if not regex.search("「.*?」", quotes_text):
        quotes_text = f"「{quotes_text[1:-1]}」"
        text = text.replace(text[match.start():match.end()], quotes_text)

print(text)
# result -> 「Excepteur sint」, 「Hello」Lorem ipsum dolor sit amet「World」

# 但是如果 text = "「foo「Hello」bar」"
# result -> 「foo」Hello「bar」

感謝 @海綿寶寶 寫的 pattern
新的期望
input: 「foo「Hello」bar」
output: 「foo「Hello」bar」



標題:heroku 佈署問題
標籤:linebot heroku python 

我的line chatbot出現了問題~他跟我說name沒有定義....
部過我的程式碼是依據網路上教學寫的.....
查了很久不清楚問題出在哪...
懇請各位救救我!!!
以下為程式碼

heroku 的記錄問題



標題:[Python]DataFrame擷取資料相關問題
標籤:python入門 

想請問我有一組Series資料(ALL)及一組DataFrame資料
Series資料

DataFrame資料

想將兩組資料中id相同的資料取出
目前寫的程式碼如下
`
ID = pd.read_excel("py.xlsx",sheet_name = 'ID')
A = pd.read_excel("py.xlsx",sheet_name = 'A')
ID = pd.DataFrame(ID)
A = pd.DataFrame(A)
ID.reset_index(inplace=True, drop=False)
A.reset_index(inplace=True, drop=False)
print(A)
for i in A['ID']:
for j in ID['ALL_ID']:
if i == j:
c = A.loc[i]
print(c)
`
但出現如圖錯誤

python新手，還請各位指教，謝謝


標題:Python迴圈問題
標籤:python迴圈問題 

dear 各位先進
我是程式小白，最近剛開始學python
sumA=0
sumB=0
for i in range(1,10):
if i%2==1:
sumA=sumA+i
else:
sumB=sumB+i
print(sumA)
我想說為何最後他print出來的結果是
1
4
9
16
照理來說應該還有一個9,也就是說最後應該是25阿....
可否請大家指導我一下 謝謝


標題:如何在 wx.CheckListBox 使用搜尋
標籤:wxpython wxwidgets 

我嘗試自已做一個 dialog，實現像 Excel篩選裡面的功能。
當搜尋列輸入內容後，下面的列表會相對應的變更。並且下表是可複選。

目前已經把dialog外觀做好了(如下)，但找不到方法實現搜尋的功能。

預想是用wx.SearchCtrl的內容變更觸發wx.CheckListBox更新。
但找不到方法，只有找到ListBox有clear的方法。
源碼如下…
class MyFrame1 (wx.Dialog):
    
    def __init__(self, parent):
        wx.Dialog.__init__(self, parent, -1)
        lst = ['apple','box','cat','dog','eye']
        sizer = wx.BoxSizer(wx.VERTICAL)
        self.search = wx.SearchCtrl( self, wx.ID_ANY, wx.EmptyString, wx.DefaultPosition, wx.DefaultSize, 0 )
        self.message = wx.StaticText(self, -1, "Pick some fruit")
        self.clb = wx.CheckListBox(self, -1, choices = lst)
        self.chbox = wx.CheckBox(self, -1, 'Select all')
        self.btns = self.CreateSeparatedButtonSizer(wx.OK | wx.CANCEL)
        self.Bind(wx.EVT_CHECKBOX, self.EvtChBox, self.chbox)
        sizer.Add(self.message, 0, wx.ALL | wx.EXPAND, 5)
        sizer.Add(self.search, 0, wx.ALL|wx.EXPAND, 5 )
        sizer.Add(self.clb, 1, wx.ALL | wx.EXPAND, 5)
        sizer.Add(self.chbox, 0, wx.ALL | wx.EXPAND, 5)
        sizer.Add(self.btns, 0, wx.ALL | wx.EXPAND, 5)
        self.SetSizer(sizer)

    def EvtChBox(self, event):
        state = self.chbox.IsChecked()
        for i in range(self.clb.GetCount()):
            self.clb.Check(i, state)

    def OnExit(self, event):
        self.Close()

if __name__ == '__main__':
    app = wx.App() 
    frm = MyFrame1(None) 
    frm.Show()
    app.MainLoop() 



標題:Python Flask 在 WindowsServer2012執行時圖片無法顯示問題
標籤:python flask windows server 

小弟是自學Python Flask 的新手 , 原本都是正常的但是最近突然出現一個問題是圖片沒辦法正常顯示 , 測試過用FireFox是可以正常讀取的 , Chrome和Edge都會出現破圖的現象 , 如下圖

程式碼如下


我用自己的桌上型PC執行程式讓別人連進來就沒有這個問題 , 但是我搬到Windows Server 2012 讓別人連進去就會有出現這樣的問題(防火牆都已經關閉) , 還需要甚麼資訊會再補上的,還請各位大神幫忙解答 , 謝謝 !


標題:python 運行一段時間後卡住[已解決]
標籤:python 

如題，小弟目前正在樹莓派4上使用Thonny運行python，我的程式主要工作是將感測器資料，分別存入DB和使用websocket發送消息給web，運作剛開始工作都正常，但大約過10分鐘左右或更短(時間沒有規律)，程式會卡住，並且沒有報錯，想請問各位大大們，如果遇到類似狀況會如何排錯，目前我是分別將存入資料庫和websocket個別分開單獨運行進行測試，看看會不會是其中一方的問題，結果兩個function都會運行一段時間就卡住，跟同時運作狀況一樣 
所以想請教各位大大，有沒有好的排錯技巧。(沒有報錯代碼的情況)

補充一下後續。
針對代碼除錯，我將function都關掉，留下單純藍芽接收資料時，我發現單單只是接收就會卡住...後來去爬文發現，原來是ESP32和RPI之間的藍芽溝通，很早就存在問題，所以這算是先天性的缺陷，所以我計畫，先將這部分修好，再看看後續的function表現。
https://stackoverflow.com/questions/65366042/bluepy-frequent-ble-disconnects-between-raspberry-pi4-and-esp32-bluetooth


標題:jupyter notebook 版面問題
標籤:python jupyternotebook 

我裝了jupyter theme 下了
jt -t chesterish -f consolamono -fs 140 -altp -tfs 13 -nfs 115 -ofs 14 -cellw 80% -T
的指令後，我的每個cell左上角的 ln number不見了，請問怎麼改回他讓它顯示出來



標題:在VScode用python連結MySQL
標籤:python mysql vscode 

大家好，我正在學習python以及MySQL
目前按照網路上教學，可以在cmd中連結資料庫如下圖

後來我想嘗試在VsCode上做這件事
可是"import mysql.connector" 會出現如下問題

我google了一下，覺得可能是要用pip安裝，之前在cmd上有裝過(如下圖)

這樣應該裝好了? 但還是不行...

有點不清楚的地方是，電腦中安裝的python跟pip環境和VSCode中的環境有關嗎?
VScode還是需要在延伸模組那邊裝一次?
目前這情況應該怎麼處理呢?
謝謝


標題:python: 堆疊 return 
標籤:python return 堆疊 

1.請問第一次印完函數最後一行print(arr[n],end=" ")會繞回哪裡? 為何不會直接結束?
2.請問是因為arr[index]的index若超出範圍，才結束嗎? 為何不會出現錯誤訊息?
def f(arr):
    global n
    m = len(arr)
    print(arr[n],end=" ")
    if (n < m-1):
        n = n+1
        f(arr)
    else:
        return 
    # print('hello')
    n = n -1  #第一次到此處是n = 3
    print(arr[n],end=" ") # 第一次在這印出arr[2]，下一步要回去哪裡??? 為何不是從這就結束?
    
n = 0
arr = ["a","b","c","d"]
f(arr)



標題:python 如何把每個位數提出來相減
標籤:python digit distance 

在 d 位數字中，印出距離 <= k 的數字
(限制前提: d >= 2，k <= 8)
舉例 d = 2 時，代表要在 10~99 間，印出距離 <= k 的數字
距離的定義為 相鄰兩兩字之間的差距 之最大差距
例如數字 1658
其相鄰兩數的差距為 |1-6|, |6-5|, |5-8| = 5, 1, 3
那麼 1658 這個數字的距離就是 5
若 5 <= k，則印出 1658


標題:python 變更商品及價格問題
標籤:python #新手求指導 

如題 請問各位大大 如果我想寫一個程式 能夠變更商品以及價格
如
dict_product={'鉛筆':10,'原子筆':20,'立可帶':30}
input(請問要修改、增加、刪除商品品項與價格？(Y/N))
想透過輸入Y or N去做修改
大概要朝哪方向寫呢


標題:Python LINE Bot + QnA Maker 連續對話問題
標籤:line bot python qna maker prompt 多回對話 

我在做LineBot＋Django＋QnA maker的project，遇到一些問題想請教。
問題：
如果QnA pairs 有multi-turn prompts, 但當LINEBot跟QnA Maker連結後，這些multi-turn prompts 未能提取出來，只能顯示出基本答案，所有multi-turn prompts都不能顯示出來。
請問如何能在LINE Bot中做到multi-turn conversation, 即QnA maker的multi-turn prompts。
謝謝?


標題:半新手轉職前端或全端工程師進修準備
標籤:轉職 轉職工程師 python javascript 

大家好，剛來這個網站，這是我第一次發問，如果有任何不專業地方，還前輩多包涵！
［背景簡介］
碩士讀的是農業科系，畢業後在私人種苗公司擔任了研發人員2年，月薪大概37K，只是月休大概4~6天，一般大型連假都要加班，所以便離職。
第二份工作接到國外農業外派4年，年薪大概150~200，只是最近發生了重大事件不得不離職~
［個人和程式能力背景:］
英文: TOEIC 815
西班牙文: DELE B1
大約一年前從python開始接觸，包含資料型別、IDE環境設定、pandas資料處理、簡單爬蟲等，還有一些SQL語法。
因為程式設計也學了OOP概念和類別繼承概念(class,attribute等)。
今年開始接觸前端部分html、css和javascript等，僅接觸簡單Flask框架。
**邏輯思考: **
可以開始作些簡單leetcode，因為還沒學演算法，只會基本迴圈所以大概簡單等級有時候要想半天。
目標語言: Python or JavaScript
目標職缺:
前端或後端工程師，偏向改善讓使用者體驗增加和穩定串接API讓後端資料庫(尚在摸索興趣，並如何產出有用的MINI project)。
想徵詢進修方法：
1.目前主要以線上Udemy課程，然後重複看個兩三次嘗試複習，但總覺得觀念滿零散龐雜，也缺乏實際專題實作，所以像目前在熟悉javasript，python就會忘記一些，使用上還要翻stackflow或google。 目前還在學DOM階段，尚未進入jquery或其他VUE,React框架。
2.不知道是否資策會全端工程師(六角等)課程或其他建議
藉由有進度學習和專案建立補強觀念，當然私底下也是要靠自己補足演算法、離散數學等練習
【回國就業心態建立】
我知道不能好高騖遠倚賴去個資策會等，就又回到之前年薪，目前只想回國轉職到持平第一份工作收入，但不是無限制加班的勞力活。
也明瞭中途非本科轉職和四大或讀四年資訊背景同學一定有差，只能以後續努力慢慢補足，不捨近求遠羨慕別人，只求符合自己實力所及。
如果轉職觀念上有偏差，再拜託各位前進給我指教！謝謝您的閱讀！


標題:java GregorianCalendar 
標籤:java python 

大家好, 請問一下java 的 GregorianCalendar是python 裡面的哪一個class?
datetime? calendar? 還是datetime2 module? 謝謝


標題:java 轉python 一問
標籤:python java 

請問一下以下這段code 裡面的int estimate = (int)getEstDiff(calUnit, d1, d2);
這段之後的在python 是怎樣表達, 謝謝
public static int getDateDiff(String Field, Date d1, Date d2) 
	{
		if (d1 == null | d2 == null) return 0;
		
		// swap if d1 later than d2
		boolean neg = false;
		if( d1.after(d2) ) {
			 Date temp = d1;
			 d1 = d2;
			 d2 = temp;
			 neg = true;
		  }
		  
		Field = Field.toUpperCase();
		int calUnit;
		if (Field.compareTo("Y") == 0)
			calUnit = Calendar.YEAR;
		else if (Field.compareTo("M") == 0)
			calUnit = Calendar.MONTH;
		else if (Field.compareTo("W") == 0)
			calUnit = Calendar.WEEK_OF_YEAR;
		else if (Field.compareTo("D") == 0)
			calUnit = Calendar.DAY_OF_MONTH;
		else if (Field.compareTo("H") == 0)
			calUnit = Calendar.HOUR;
		else if (Field.compareTo("MI") == 0)
			calUnit = Calendar.MINUTE;
		else 
			calUnit = Calendar.SECOND;
					
		// estimate the diff.  d1 is now guaranteed <= d2
		int estimate = (int)getEstDiff(calUnit, d1, d2);

		// convert the Dates to GregorianCalendars
		GregorianCalendar c1 = new GregorianCalendar();
		//c1.set(d1.getYear(), d1.getMonth(), d1.getDate(), d1.getHours(), d1.getMinutes(), d1.getSeconds());
		c1.setTime(d1);
		GregorianCalendar c2 = new GregorianCalendar();
		//c2.set(d2.getYear(), d2.getMonth(), d2.getDate(), d2.getHours(), d2.getMinutes(), d2.getSeconds());
		c2.setTime(d2);

		// add 2 units less than the estimate to 1st date,
		//  then serially add units till we exceed 2nd date
		c1.add( calUnit, (int)estimate - 2 );
		for( int i=estimate-1; ; i++ ) 
		{
			c1.add(calUnit, 1);
			if(c1.after(c2))
				return neg ? 1-i : i-1;
		}
   }



標題:Python打包成 exe 檔 無法正確執行
標籤:python3 cx_oracle exe 

請問大大
在Spyder(Python 3.8)內可以執行，由網頁擷取匯率寫入Oracle。
但打包成exe檔後卻無法正確寫入Oracle(在同一台電腦執行哦!)，
請問是少做了什麼設定 ?
謝謝 !


標題:Python 小數點運算問題
標籤:python 

請各位大大幫忙解答，我是剛學python的新手，不曉得為什執行程式後，答案應該是-10.4
但不曉得為啥會是-10.399999999999999，請幫忙解惑，感謝
程式碼:
number1 = input("請輸入第一個數字: ")
print(float(number1))
number2 = input("請輸入第二個數字: ")
print(float(number2))

number = float(number1) + float(number2)
number = float(number)

print(number)

結果:
請輸入第一個數字: -8.2
-8.2
請輸入第二個數字: -2.2
-2.2
-10.399999999999999



標題:python如只取最後一個括弧內的字串
標籤:python 

record.description會有
'NM_001001182.3 Mus musculus bromodomain adjacent to zinc finger domain, 2B (Baz2b), mRNA'
要如何取最後一個括號內的字串，因括號可能有二個以上
我用p1 = re.compile(r'([)]', re.S)
print(re.findall(p1,record.description))


標題:python如何擺脫while true(新手提問)[已解決]
標籤:python 

如主題所述，以往利用python收集感測器資料時，都是使用While True: 這種方式，不斷重複執行，將感測器收到的最新資料，存入資料庫，問題來了，如果今天我還有額外的程式需要運作，不能總讓程式卡在while迴圈裡，所以想請教一下，有甚麼推薦的做法嗎?另外請問一下threading 模組這種多線程的方式，可以同時執行多個任務，互不干擾，是不是就是最佳解?問題很菜，多多包涵。以下附上隨機生成的數值為範例
from bluepy import btle
import random
import time
import datetime
from pymongo import MongoClient
client = MongoClient('mongodb://localhost:27017/')
db = client['admin']

list1 = []
while True:
    Yaw=round(random.uniform(-1,1),2)
    Pitch=round(random.uniform(-1,1),2)
    Roll=round(random.uniform(-1,1),2)
    Ax=round(random.uniform(-1,1),2)
    Ay=round(random.uniform(-1,1),2)
    Az=round(random.uniform(-1,1),2)
    Gx=round(random.uniform(-1,1),2)
    Gy=round(random.uniform(-1,1),2)
    Gz=round(random.uniform(-1,1),2)
    Mx=round(random.uniform(-1,1),2)
    My=round(random.uniform(-1,1),2)
    Mz=round(random.uniform(-1,1),2)
    Temp=round(random.uniform(-1,1),2)
    list1 = [Yaw,Pitch,Roll,Ax,Ay,Az,Gx,Gy,Gz,Mx,My,Mz,Temp]
    post = {"Yaw": Yaw,
         "Pitch": Pitch,
         "Roll": Roll,
         "Ax": Ax,
         "Ay": Ay,
         "Az": Az,
         "Gx": Gx,
         "Gy": Gy,
         "Gz": Gz,
         "Mx": Mx,
         "My": My,
         "Mz": Mz,
         "Temp": Temp
         }
    posts = db.posts
    post_id = posts.insert_one(post).inserted_id
    print (" id is ", post_id)
   
    print (list1)
 
   
    time.sleep(5)



標題:請益Python中二維dict字典內刪除重複的方法
標籤:python3 dict dictionary 

c_dict = {'0':{'id':'222'},'1':{'id':'222'},'2':{'id':'333'}}

請問若要將原本dict中id值為重複的刪除，只留下方結果，有什麼好方法嗎？
謝謝。
c_dict = {'0':{'id':'222'},'1':{'id':'333'}}



標題:SelectField 無法取值並判斷 
標籤:wtforms python html flask 

網頁錯誤訊息
ValueError: View function did not return a response. 
The function either returned None or ended without a return statement.

app
 form = m.SelectForm(request.form) 
        if request.method =='POST' and form.validate():           
            pla = request.form['pla']                      
            detail= m.sql_read()          

module
class SelectForm(Form): 
         pla = SelectField('選取地區', choices=[('Daiaj','大甲區'),('central','中區')])

html
<form method='post' action="{{url_for ('Select')}}">   
        {{ form.pla.label }} 
        {{ form.pla}}    
        <input type=submit name="see" value='查詢'>
    </form>



標題:[已解決^^] MySQL 無法接收佔位符號的內容
標籤:python mysql %s 

錯誤訊息
pymysql.err.ProgrammingError: 
(1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''Beitun_District'' at line 1")

app檔
def Select():
    if request.method == 'GET': 
        session.clear()
        form = m.SelectForm() 
        return render_template('index.html', form=form)
    else:
        form = m.SelectForm(request.form) 
        if request.method =='POST' and form.validate():       
            add = request.form['add'] 
            agg = request.form['agg']                          
            detail= m.sql_read(add) 

module檔
def sql_read(add):  
    connection = pymysql.connect(host='********',
                                 port=3307,
                                 user='root',
                                 password='*****',
                                 database='taichung',
                                 charset='utf8mb4')  
    with connection:
        with connection.cursor() as cursor:
            sql = "SELECT * FROM  %s "        
            cursor.execute(sql,add)                     
            rows=cursor.fetchall()        
        connection.commit()



標題:如何判別圖片內的字是反轉了?
標籤:python 影像處理 

https://ibb.co/g3zDcpd
https://ibb.co/tMwmLMQ
https://ibb.co/PMW8bgC
以上三張圖，如果90度還知道X/Y的比例去做調整，但如果是最後反轉的情況，
有沒有辦法可以得知他反轉的字，還是正常的字?
不限語言，如果功能在opencv上那就最好XD
求大神給點建議~


標題:python data type 一問
標籤:python 

大家好, 請問一下如果要在python 中表達java 的short 型態


short a = value


判斷是否short data type


是應該怎麼寫, 但Pythonn 沒有short , 在網上說short 是16-bit signed two's complement integer. 真的不太清楚. 希望大家可以幫幫忙, 謝謝


標題:SelectField 求使用方法 !!
標籤:python flask wtforms 

1.html page
<form method='post' action="{{url_for ('Select')}}">   
    {{ form.pla.label }} 
    {{ form.pla}}    
    <input type=submit name="see" value='chinese查詢'>
</form>


2.app page
erro = []
@ app.route('/', methods=['GET','POST'])
def Select():
    if request.method == 'GET': 
        session.clear()
        form = m.SelectForm() 
        return render_template('index.html', form=form)    
    else:
        form = m.SelectForm(request.form) 
        if request.method =='POST' and form.validate():           
            pla = request.form['pla']                      
            detail= m.sql_read()          
            for i in detail:
                if pla in i[0]:
                    erro.append(i)                                 
            return render_template('index.html',form=form,erro=erro)


3.module page
def sql_read(): #this def is successful take sql data
    connection = pymysql.connect(host='xxxxxxxx',
                                 port=xxxxx,
                                 user='root',
                                 password='xxxxxx',
                                 database='xxxxx',
                                 charset='utf8mb4')  
    with connection:
        with connection.cursor() as cursor:
            sql = "SELECT * FROM `Dajia_District` "                                               
            cursor.execute(sql)
            rows=cursor.fetchall()        
        connection.commit()
    return list(rows)   
#==============================================
class SelectForm(Form): 
    add = StringField(
        '輸入路名：', validators=[validators.DataRequired(message='Not Null')])
    pla = SelectField('選取地區', choices=[('Daiaj','大甲區'),('travel','旅遊'),('movie','電影')])


Can anyone please help me on this !!Thanks!!!!


標題:#已解答～ python「遞迴」函式疑問
標籤:python python3 python入門 python系列文章 

在遞迴公式裡遇到問題，前兩題已經找到答案，在第三題遇到了困難




標題:尋找對python熟悉的人幫忙ＱＱ
標籤:python python3 python入門 

尋找對python熟悉的人幫忙ＱＱ
上課老師內容教的不詳細有許多公式寫不出來，想聯繫請教熟悉的人


標題:[Python] find element 問題
標籤:python3 

不好意思 想請問以下python code:
countries = ["USA", "Canada", "India"]
countries[0], countries[1] = countries[1], countries[0]
print(countries)
Output:
['Canada', 'USA', 'India']
想請問output為什麼是這樣？
謝謝!


標題:heroku 下載檔案常常報錯 (檔名是中文) Python Flask 
標籤:heroku python flask 

我寫了一個程式放在heroku上 用Python Flask
利用 send_from_directory 下載我程式所製作的檔案
在我電腦裡測試 都沒什模問題
但是常常 會出現
Not Found
The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
但有時候運作又是正常的 可以正常下載
請問該怎麼解決呢?
(我下載的檔案名稱是中文的)


標題:python selenium彈跳視窗
標籤:python selenium 網頁爬蟲 彈跳視窗 

使用python selenium要做自動登入
連結網頁出現以下畫面,點選<"我了解存在風險但仍想繼續">

然後出現以下視窗!

要點擊『是』,使用alert無效,顯示 no such alert
alert = browser.switch_to_alert()
alert.accept()

改用ActionChains也無效,似乎停留在背景網頁
ActionChains(driver).key_down(Keys.ENTER).key_up(Keys.ENTER).perform()
彈跳視窗按F12沒有出現html
請問有沒有其他解法,找了好久不知道是哪個環節有問題><""


標題:合法的reshape轉換
標籤:python python3 python系列文章 reshape 

如圖，請問怎麼驗證reshape轉換？



標題:heroku 無法使用 openpyxl
標籤:#heroku #python 

openpyxl 無法安裝在 heroku 上 請問各位大大該怎麼解決呢?

-----> Building on the Heroku-20 stack
-----> Using buildpack: heroku/python
-----> Python app detected
-----> Using Python version specified in runtime.txt
!     Python has released a security update! Please consider upgrading to python-3.10.4
Learn More: https://devcenter.heroku.com/articles/python-runtimes
-----> Requirements file has been changed, clearing cached dependencies
-----> Installing python-3.10.3
-----> Installing pip 21.3.1, setuptools 57.5.0 and wheel 0.37.0
-----> Installing SQLite3
-----> Installing requirements with pip
Collecting Flask
Downloading Flask-2.0.3-py3-none-any.whl (95 kB)
Collecting xlrd
Downloading xlrd-2.0.1-py2.py3-none-any.whl (96 kB)
Collecting openpyxl
Downloading openpyxl-3.0.9-py2.py3-none-any.whl (242 kB)
**
ERROR: Could not find a version that satisfies the requirement os (from versions: none)
ERROR: No matching distribution found for os
**
!     Push rejected, failed to compile Python app.
!     Push failed



標題:python二元搜尋法疑問
標籤:python python3 python入門 python系列文章 

如圖

請問該方程式怎麼寫


標題:python 錄音問題(已解決)
標籤:python 錄音 

我參考這篇和這篇
https://www.796t.com/article.php?id=144246
https://zhuanlan.zhihu.com/p/92205480
第一篇會報
OSError: [Errno -9996] Invalid input device (no default output device)
第二篇則是
OSError: [Errno -9998] Invalid number of channels
這兩篇我都去找過了，網上是有人說改input_device_index或是channels的部分
但我改了依舊沒用
有人知道問題在哪嗎?
我沒插MIC所以他偵測不到才會一直報錯......哈哈


標題:java类中的静态变量
標籤:python programming programming language 

我想问一下类中的静态变量是否会为初始化的类添加额外的内存。
我有这样的课
public class Sample{

    public static String NAME[] = {"1", "2", "3", "4"};

    private int id;

    private String uuid;
    private String name;

    public void setUuidString() {
        UUID uuid = UUID.randomUUID();
        this.uuid = uuid.toString();
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setCustomUuid(String uuid) {
        this.uuid = uuid;
    }

    public void setId(int id) {
        this.id = id;
    }

    public int getId() {
        return id;
    }

    public String getUuid() {
        return uuid;
    }

    public String getName() {
        return name;
    }
}

我正在多次创建 Sample 类，对其进行初始化并将其添加到 Sample 类的数组中，静态变量是否会向该类添加额外的内存，或者当它是静态时它只会获得一个内存位置？
正在阅读这篇文章并引发了这个问题，所以在这里问。


標題:Pytest with Fake MongoDB
標籤:python pytest mongodb ven docker 

最近工作上需要寫到測試程式，想問一下 MongoDB 是否有跟關聯式資料庫一樣有類似 in memory 的資料庫可以使用，這樣就不用另外多開一個 docker 來當作測試環境了


標題:有一題colab問題想請大家幫忙解一下  小弟我解不太出來
標籤:python colab 

https://hackmd.io/@justim/HJUO-TCSw


標題:pip3 install line-bot-sdk發生錯誤
標籤:python cpanel pip 

小弟租了一台Cpanel的虛擬主機
在Terminal執行pip3 install line-bot-sdk的時候發生錯誤
Failed to build multidict
ERROR: Could not build wheels for multidict, which is required to install pyproject.toml-based projects

上網爬文無果來這邊尋求大大幫助 感謝~


標題:Django 參數傳遞問題
標籤:django python 

各位好小弟我目前遇到一個問題
我想要將Line Bot接收到的清單資料同步顯示在網頁上
但試了很久都會接收到這個錯誤

以下是我的程式碼
呼叫

回傳


url

HTML

我覺得我應該是犯了一個很簡單的錯誤
還請各位指導一下小弟


標題:新手python買東西的問題
標籤:python 走不出新手村 新手 

服飾店買東西,衣服600,褲子500,裙子700,且衣服3件打9折
請問各位,該如何寫出一個可以計算出購買數量且可以合計消費金額的程式
感謝


標題:Python 使用 tika 遇到了UnicodeDecodeError 問題
標籤:python tika 

有一陣子沒有開啟Visual Studio
之前使用tika parser時都沒問題
但是現在都不能用了 希望各位大大能幫我解答謝謝
# opening pdf file
parsed_pdf = parser.from_file("888.pdf")

# saving content of pdf
# you can also bring text only, by parsed_pdf['text']
# parsed_pdf['content'] returns string
data = parsed_pdf['content']

# Printing of content
print(data)

# <class 'str'>
print(type(data))

報錯
[MainThread  ] [WARNI]  Failed to see startup log message; retrying...
File "c:\Users\abc83\OneDrive\Documents\VScode\edgedriver.py", line 14, in 
parsed_pdf = parser.from_file("888.pdf")
File "C:\Users\abc83\AppData\Local\Programs\Python\Python39\lib\site-packages\tika\parser.py", line 40, in from_file
output = parse1(service, filename, serverEndpoint, headers=headers, config_path=config_path, requestOptions=requestOptions)
File "C:\Users\abc83\AppData\Local\Programs\Python\Python39\lib\site-packages\tika\tika.py", line 336, in parse1
status, response = callServer('put', serverEndpoint, service, f,
File "C:\Users\abc83\AppData\Local\Programs\Python\Python39\lib\site-packages\tika\tika.py", line 531, in callServer
serverEndpoint = checkTikaServer(scheme, serverHost, port, tikaServerJar, classpath, config_path)
File "C:\Users\abc83\AppData\Local\Programs\Python\Python39\lib\site-packages\tika\tika.py", line 598, in checkTikaServer
status = startServer(jarPath, TikaJava, TikaJavaArgs, serverHost, port, classpath, config_path)
File "C:\Users\abc83\AppData\Local\Programs\Python\Python39\lib\site-packages\tika\tika.py", line 686, in startServer
if "Started Apache Tika server at" in tika_log_file_tmp.read():
File "C:\Users\abc83\AppData\Local\Programs\Python\Python39\lib\codecs.py", line 322, in decode
(result, consumed) = self._buffer_decode(data, self.errors, final)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 0: invalid start byte


標題:Python Plotly 如何更改Download圖片檔名
標籤:python plotly 數據資料視覺化 

我在python程式中使用了write_html() 將視覺化資料輸出成html
現在我想從網頁download圖片，而他的預設圖片名稱是'newplot.png'
有甚麼語法可以設定他的預設下載名稱，或是圖案大小嗎?

上網查了資料，好像只有看到Javascripts的語法
https://stackoverflow.com/questions/45104632/plotly-js-modebar-download-as-png-give-png-a-name


標題:python casting 一問
標籤:java python 

大家好, 想問一下在python 可以像java 一樣做class type casting 嗎, 可以怎樣用python 表示?
dcdf = (DCDF_120)arr.get(i);
DCDF_120 是下面code的child class, DCD 是parent class, getCutOffTime 是DCD的class method,
找了好久都找不到方法, 只是看見有人說decorator , 但不太懂, 希望大家幫忙. 謝謝.
public static Date getCutOffTime(ArrayList arr)
	{
		DCDF_120 dcdf = null;
		Date t = null;
		Date tmp = null;
		
		for (int i = 0; i < arr.size(); ++i)
		{
			dcdf = (DCDF_120)arr.get(i);
			tmp = dcdf.getIntime2();
			if (t == null || (tmp != null && tmp.after(t))) t = tmp;
		}
		
		return t;
	}



標題:Django與獨立python連接
標籤:@django @python @mysql 

各位大老大家好,初次使用Django並對於網頁是完完全全的新手所以遇到了一個問題
目前對於Django的了解於是使用 urls連接views,而views在與templates資料夾中的html做連結,使得網頁動作
目前已經有額外寫好的獨立python程式(test.py),我想讓html的submit按下的時候,可以讓(test.py)讀取到html的值,並且回傳運作結果回html顯示.
目前的大致想法是
1.使用Django的自定義標籤 去將原本的(test.py)改寫,就是在app的資料夾下方建立一個新的.py檔案並設成@register.simple_tag
2.使用 action=" python 檔案路徑 ",去看可不可以連接
請問一下上方的想法是正確的嗎,目前沒有找到很適合我想法的文章或是講解,或者有其他解法.


標題:python 如何計算布林通道上緣或者5日線10日線的斜率？
標籤:python 

python 如何計算布林通道上緣或者5日線10日線的斜率？
我有試著用斜率公式計算，但是價格跟天數似乎好像沒辦法用上？
天數我是用日線 三天五天我都試過，算出來的斜率都是錯的。
想請問先進算斜率是什麼算出來的？
有爬過文也只有提供斜率的公式，但沒說是什麼帶進去公式？
謝謝


標題:爬蟲IP被鎖
標籤:@selenum @python 

最近爬台電網站的資料https://hvcs.taipower.com.tw/
結果IP被鎖住，但是過一陣子之後就會解開了
有什麼方式是不會被鎖IP的嗎?
我目前用selenium的方式


標題:python 畫圖 x軸單位不同之畫法
標籤:python pandas.dataframe pandas matplotlib matplotlib.pyplot 

我有兩個df，其中一個x軸是以日為單位，共三十天，另一個x軸則是以分鐘為單位，一樣是30天，格式都是dt.datatime，我想把兩筆資料合併在同一張圖上比較，我該怎做


標題:請問有辦法用python寫出判斷一檔股票爆大量嗎？
標籤:python 

請問有辦法用python寫出判斷一檔股票爆大量嗎？
因為不知道什麼定義爆大量？有時候是一根突然很長
可是有時候又是連續好幾天爆大量 一根比一根長？
想知道有先進有解決的方法了嗎？
謝謝


標題:python for loop 一問
標籤:python 

請問一下如果要用python 表達以下這個for loop 要怎樣寫, 謝謝.
for (int i = start, j = 8 * (cnt - 1); i < start + cnt; ++i, j -= 8)
{
    tmp = arr[i] & 0xff;
    result = (result | tmp << j);
}



標題:新手heroku部屬問題
標籤:python3 flask pymongo 

程式碼
""" from crypt import methods """
from email import message
from http import client
import collections
from lib2to3.pgen2 import driver
from unittest import result
import pymongo
client=pymongo.MongoClient("mongodb+srv://user:user123@new.ky4ln.mongodb.net/myFirstDatabase?retryWrites=true&w=majority")
db=client.member_system
print("連線成功")
from flask import*
app=Flask (
name,
static_folder="public",
static_url_path="/"
)
app.secret_key="any string but secret"
@app.route("/")
def index():
return render_template("index.html")
@app.route("/member")
def member():
if "nickname" in session:
return render_template("member.html")
else:
return redirect("/")
@app.route("/error")
def error():
message=request.args.get("msg","發生錯誤,請聯繫客服")
return render_template("error.html",message=message)
@app.route("/signup",methods=["post"])
def signup():
nickname=request.form["nickname"]
email=request.form["email"]
password=request.form["password"]
collection=db.user
result=collection.find_one({
"email":email
})
if result != None:
return redirect("/error?msg=信箱已被註冊")
collection.insert_one({"nickname":nickname,"email":email,"password":password
})
return redirect("/")
@app.route("/signin",methods=["post"])
def signin():
email=request.form["email"]
password=request.form["password"]
collection=db.user
result=collection.find_one({
     "$and":[
        {"email":email},
        {"password":password}
     ]
 })
if result==None:
    return redirect("/error?msg=帳號或密碼錯誤")
session["nickname"]=result["nickname"]
return redirect("/member")

@app.route("/signout")
def signout():
del session["nickname"]
return redirect("/")
app.run(port=3000)
requirements.txt
Flask
pymongo[srv]
gunicorn
runtime.txt
python-3.10.2
出現的錯誤碼為
! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'https://git.heroku.com/member-tian-wu.git'
之前上傳都正常
剛剛爬文看了一下是buildpack 不兼容
這個要怎麼解呢...

試著用github也一樣...
目前上傳成功了  https://git.heroku.com/member-tian-wu.git
但是變成 Method Not Allowed
但在本機跑 又正常...


標題:(已解決)關於DRF的LimitOffsetPagination設定，Response無法顯示分頁的相關資訊
標籤:#django #ubuntu #python #api #sql 

近日以DRF的框架結合Swagger渲染出一個API的介面，希望能以此Get到資料庫內的內容並以LimitOffsetPagination的分頁方式呈現其資料，目前是已經成功的連接Django與SQL的資料表，並可呈現其資料在頁面上，但Response的部分卻無法出現count、next、previous、results等相關資訊，本以為應該是LimitOffsetPagination預設就會出現的QQ，結果都沒有跑出來。
現在是打算在views.py的return Response的地方做編輯，看是否能夠以此方式顯示count、next、previous等資訊，但是遇到了名為
AssertionError: Expected a Response, HttpResponse or HttpStreamingResponse to be returned from the view, but received a <class 'NoneType'>
還無法解決，想請教各位大大是否能夠協助解決，或是有比較好的設定方式!
此為目前能夠呈現的狀態

此為期望顯示的資訊

views.py

settings.py

目前的錯誤訊息



標題:pandas 處理時間戳 問題
標籤:python3 

想請問 pandas 處理時間戳格式，是否有指令可以直接轉換成一般的日期時間嗎？還是必需要用其它方式先做處理呢？



標題:關於Python與Excel
標籤:excel python 

各位大大好，有問題想詢問...
我只有使用過Excel的VBA處理數據，沒有接觸過Python...
想詢問Python是否能達到在Excel處理中文字型取代以及提取不同sheet中相對應的資料呢？
例如：
sheet1 小明同學 電話1100 住址1234
sheet2 小明同學 （無電話以及住址需從sheet1抓取填入）
不好意思,因為怎麼搜尋都查不到相關資料(｡ﾉω＼｡)..謝謝大大的善心協助，感恩..


標題:新手python網頁問題
標籤:python3 flas html 

各位大大好,想請問一下
https://app-tian-wu.herokuapp.com/
我在網頁輸入了值進到下一個網頁
為甚麼下一個網頁的button並沒有顯示出來呢
是因為我後端寫
@app.route("/test")
def test():
name=request.args.get("n","")
return "是不是想跟我玩遊戲呀!"+name

所產生的問題嗎?
因為我去下一個網頁案檢是網頁原始碼 出來的並不是我寫的HTML
而是return的值


標題:python 取得ping失敗的錯誤訊息(已解決)
標籤:@python @ping 

我參考這篇和這篇
https://ithelp.ithome.com.tw/questions/10196348
https://pypi.org/project/pythonping/
第一篇:
可以取得ping的訊息
但是今天ping不到的話，會報錯反而不會出現錯誤訊息
第二篇:
取得回來的會是英文，但是錯誤訊息會變成
Round Trip Times min/avg/max is 2000/2000.0/2000 ms
這個奇怪的東西
有什麼方法可以取得中文的錯誤訊息?
解決方法請參考
http://www.zhishibo.com/articles/96627.html


標題:python  要怎麼統計 OS 帳號
標籤:python 

python  要怎麼統計 windows OS 帳號
列出超過90天未登入的使用者
有什麼套件可以用


標題:python問題發問求救
標籤:#python求救 #python #python問題 

請幫幫我該如何解答
假設有一個班級總共五個人成績分別是 91,100,70,85,59,65。老師想要將成績分等，100~90為S，89~80為A，79~70為B，69~60為C，不到60分為D。請使用list將五位學生的成績依序存入L[]中，接著使用if Statement將學生的成績等級按照存入的順序印出


標題:想要將爬蟲資料設為line bot quick reply 的變數 
標籤:line bot quick reply python 

各位大大好，小弟初學python三個月左右，正在製作一個line bot，想從fifa網站的資料做到與使用者回傳選擇比賽年分-賽事-比分的動作，想設定QuickReplyButton能夠自己顯示爬蟲的訊息，用for試了很久依舊沒有進展，想請問是否有甚麼方法



標題:python 查看每顆CPU和工作管理員的處理程序
標籤:@python @cpu @工作管理員 @處理程序 

我目前可以抓到CPU,RAM,硬碟空間
但是我想抓的是每顆CPU的使用率和工作管理員的處理程序
查看那些處理程序吃了很重的效能


標題:新手，照片不能显示出来，一开始的登录页面可以，忘记密码页面就出现这个问题了tkinter.TclError: image "pyimage3" doesn't exist。请求大哥们帮忙解决，感恩！
標籤:#python #tkinter #新手求指導 问题 @大神幫幫忙 

from tkinter import *
from PIL import ImageTk,Image
import pickle
from tkinter import messagebox
import webbrowser
window = Tk()
window.title('Login Page')
window.geometry('1397x800')
#BG Image
canvas = Canvas(window,height=800,width=1397)
image_file = ImageTk.PhotoImage(file='C:\Users\User\OneDrive\Pictures\images\nocrime.gif')
image = canvas.create_image(0,0,anchor='nw',image=image_file)
canvas.pack()
#Login Frame
frame_login = Frame(window,bg='white')
frame_login.place(x=800,y=70,height=500,width=500)
#title
title = Label(frame_login,text='Login',font=('Times New Roman',35,'bold'),fg='#3077cc',bg='white')
title.place(x=190,y=20)
#email
email = Label(frame_login,text='Email Address :',font=('Times New Roman',15,'bold'),fg='grey',bg='white')
email.place(x=50,y=120)
text_email = Entry(frame_login,font=('Times New Roman',15,'bold'),fg='black',bg='#87a2bf')
text_email.place(x=50,y=150,width=400,height=35)
#password
password = Label(frame_login,text='Password :',font=('Times New Roman',15,'bold'),fg='grey',bg='white')
password.place(x=50,y=210)
text_password = Entry(frame_login,font=('Times New Roman',15,'bold'),fg='black',bg='#87a2bf',show='*')
text_password.place(x=50,y=240,width=400,height=35)
#register Frame
frame_register = Frame(window,bg='white')
frame_register.place(x=800,y=620,height=100,width=500)
#new user
newuser = Label(frame_register,text='New user?',font=('Times New Roman',15,'bold'),fg='grey',bg='white')
newuser.place(x=125,y=35)
def forgot_password():
window_for = Tk()
window_for.title('Forgot Password Page')
window_for.geometry('1397x800')
#BG Image
canvas = Canvas(window_for,height=800,width=1397)
image_file = ImageTk.PhotoImage(file='C:\\Users\\User\\OneDrive\\Pictures\\images\\nocrime.gif')
image = canvas.create_image(0,0,anchor='nw',image=image_file)
canvas.pack()

#forgot Frame
frame_forgot = Frame(window_for,bg='white')
frame_forgot.place(x=800,y=70,height=550,width=500)

#title
title = Label(frame_forgot,text='Forgot Password',font=('Times New Roman',35,'bold'),fg='#3077cc',bg='white')
title.place(x=80,y=20)

#email
email = Label(frame_forgot,text='Email Address :',font=('Times New Roman',15,'bold'),fg='grey',bg='white')
email.place(x=50,y=120)

text_email = Entry(frame_forgot,font=('Times New Roman',15,'bold'),fg='black',bg='#87a2bf')
text_email.place(x=50,y=150,width=400,height=35)

#password
password = Label(frame_forgot,text='New Password :',font=('Times New Roman',15,'bold'),fg='grey',bg='white')
password.place(x=50,y=210)

text_password = Entry(frame_forgot,font=('Times New Roman',15,'bold'),fg='black',bg='#87a2bf')
text_password.place(x=50,y=240,width=400,height=35)


#comfirm password
comfirm_password = Label(frame_forgot,text='Comfirm Password :',font=('Times New Roman',15,'bold'),fg='grey',bg='white')
comfirm_password.place(x=50,y=300)

text_comfirm_password = Entry(frame_forgot,font=('Times New Roman',15,'bold'),fg='black',bg='#87a2bf')
text_comfirm_password.place(x=50,y=330,width=400,height=35)

#eye button
eyefor_image = PhotoImage(file='C:\\Users\\User\\OneDrive\\Pictures\\images\\show-password (1).png')
eyefor_image_label = Label(frame_forgot,image=eyefor_image,bg='#87a2bf')
eyefor_image_label.place(x=412,y=241)
eyefor_button = Button(frame_forgot,image=eyefor_image,borderwidth=0,bg='#87a2bf')
eyefor_button.place(x=412,y=331)

#reset password button
reset_password_button = Button(frame_forgot,text='RESET PASSWORD',font=('Times New Roman',15,'bold'),borderwidth=10,bg='#3077cc',fg='white')
reset_password_button.place(x=130,y=420,height=60,width=240)

#login button
login_button = Button(frame_login,text='LOGIN',font=('Times New Roman',15,'bold'),borderwidth=10,bg='#3077cc',fg='white')
login_button.place(x=130,y=390,height=60,width=240)
#forget pass btn
forget_button = Button(frame_login,text='Forget Password?',font=('Times New Roman',15,'bold','underline'),borderwidth=0,bg='white',fg='#3077cc',command=forgot_password)
forget_button.place(x=50,y=290)
def hide_eye():
if text_password.cget('show') == '':
text_password.config(show='*')
else:
text_password.config(show='')
#eye button
eye_image = PhotoImage(file='C:\Users\User\OneDrive\Pictures\images\show-password (1).png')
eye_image_label = Label(frame_login,image=eye_image,borderwidth=0)
eye_image_label.place(x=412,y=241)
eye_button = Button(frame_login,image=eye_image,borderwidth=0,bg='#87a2bf',command=hide_eye)
eye_button.place(x=412,y=241)
#create an acc btn
acc_button = Button(frame_register,text='Create an account',font=('Times New Roman',15,'bold','underline'),borderwidth=0,bg='white',fg='#3077cc')
acc_button.place(x=220,y=33)
window.mainloop()


標題:如何在html 中運行python 
標籤:html python 

如題，請教各位大神，我想要做一個能夠顯示我python檔案的網頁，同時還要能運行我一些python的套件(beautiful soup 等等)，請問有甚麼方法?爬了很久文都沒找到>_<


標題:如何用python抓取XML中特定tag的資料 (ETREE)
標籤:xml python etree 

各位好
本人有類似以下的XML檔(output.xml)必須要用python來處理
希望可以擷取特定tag中的值
我的XML檔中有namespace，內容大致如下：
<data xmlns="urn:ietf:params:ns:netconf:base:1.0">
  <interfaces xmlns="http://namespace.net">
    <interface>
      <name>Interface0</name>
    </interface>
    <interface>
      <name>Interface1</name>
    </interface>
  </interfaces>
</data>

我用xml.etree這個library來實現
以下是我的code
from xml.etree import cElementTree as ET

tree = ET.ElementTree(file="output.xml")
root = tree.getroot()

nsmap = {'':'http://namespace.net'}  # namespace

for name in root.iterfind('./interfaces/interface/name', namespaces=nsmap):
   print(name.text)

這個code是可以跑的，但自己希望可以進一步實現：
只抓取Interface1，也就是第二個interface中name的值
我嘗試過將'./interfaces/interface/name'改為'./interfaces/interface[2]/name'
不過這只有在XML中沒有namespace時，才能成功抓取到Interface1
請問各版友，有人知道對於有namespace的xml，如果有重複的tag
要如何只抓第2個tag中的值？會想這樣做是希望能加速
謝謝!


標題:DB API 應用如何做測試
標籤:python pytest 

情境是這樣的：目前開發一個 API 其角色為對 DB 做 Access (CRUD) 的一個界面。
資料流：資料進到 controller，再呼叫 CRUD 函式將資料寫入或讀出 Database。
因為許多運算都是在 SQL 中(PostgreSQL)實現，所以目前使用 Integration testing，可以說是在測試 SQL 是否如預期的邏輯來執行，因此需要將 DB 服務開啟，真實的寫入與讀出 DB。

若為 CUD，則直接在 test function 內定義資料並 call API，並查看 API 執行成功時回傳的資料是否與傳入的資料一致。
若為 R，則需要在 call API 之前先建立情境(代號為 Data1)，例如先插入幾筆訂單，然後 call API 將對應的資料撈出(代號為 Data2)，再比對 Data1 與 Data2 是否相同。

個人在測試 R 時遇到一些疑惑點


建立情境是每個 testing 都要各自建立自己的情境，還是會讓所有 testing 都是一樣的情境？目前個人是在 setup 階段時統一建立情境，在 testing function 中取得 DB 所有資料，再做測試。例如
def test_ordelist(test_app, db_data):
    def ground_truth(orders):
        blablabla... # 做一些運算將 orders 過濾或轉換為想要的格式
    orders = db_data["order"] # 每個 test 的 db_data 都一樣
    response = test_app.get("/order/")
    response_dict = response.json()
    assert response.status_code == 200
    assert response_dict == ground_truth(orders)
    # 等同於 assert Data2 == Data1



這樣的寫法就好像是我使用另一種方法去拼湊出資料，然後測試是否與 SQL 結果一樣。但我看的 testing 案例都是給 literal value，好像沒有見過使用運算後的結果(ground_truth(orders))去當預期的輸出，不知道這樣的測試架構是不是各位有經驗的前輩所樂見的，或者可以提供更好的方向給我 QQ。


為何不用 literal value？是因為 Read 出來的資料都很冗長，我認為若在 test function 中寫出來所有 literal value 會變成不可讀，很難維護。但若前輩們有其他意見可以一起討論！




標題:selenium 無法維持登入 (on ithelp)
標籤:python selenium login session 

如題，最近在使用 selenium 碰到無法維持登入的問題，
但 selenium login 後重新 get ithelp 的其他網址時無法維持登入狀態，
有試過添加 cookies 進去再重新 get 一次還是無法維持，
想請教版上大神
import time

from selenium.webdriver import Chrome
from selenium.webdriver.common.by import By
from webdriver_manager.chrome import ChromeDriverManager


account = ""
password = ""

account_css = "input#account"
password_css = "input#password"
enter_css = "button.btn.btn-agree.btn-margin"

driver = Chrome(ChromeDriverManager().install())
driver.get("https://member.ithome.com.tw/login")

driver.find_element(By.TAG_NAME, account_css).send_keys(account)
driver.find_element(By.TAG_NAME, password_css).send_keys(password)
driver.find_element(By.TAG_NAME, enter_css).click()

time.sleep(5)

_cookies = driver.get_cookies()
print(_cookies)
for _cookie in _cookies:
    driver.add_cookie(_cookie)
    
driver.get("https://ithelp.ithome.com.tw/")

time.sleep(5)




標題:求Python高手幫忙解題(輸入資料整合成期望的輸出)
標籤:python data database 

題目如下：
將下列輸入資料整合成期望的輸出結果。
輸入資料:
const userIds = [‘U01’, ‘U02’, ‘U03’] 
const orderIds = [‘T01’, ‘T02’, ‘T03, ‘T04’] 
const userOrders = [			
    { userId: ‘U01’, orderIds: [‘T01’, ‘T02’] },
 	{ userId: ‘U02’, orderIds: [] },
 	{ userId: ‘U03’, orderIds: [‘T03’] },
]
const userData = { ‘U01’: ‘Tom’, ‘U02’: ‘Sam’, ‘U03’: ‘John’ } 
const orderData = {						
‘T01’: { name: ‘A’, price: 499 }, 
‘T02’: { name: ‘B’, price: 599 },
‘T03’: { name: ‘C’, price: 699 }, 
‘T04’: { name: ‘D’, price: 799 }
} 
輸出結果:
const result = [ 
{
	user: { id: ‘U01’, name: ‘Tom’ }, 
orders: [{ id: ‘T01’, name: ‘A’, price: 499 },
{ id: ‘T02’, name: ‘B’, price: 599 }, 
],
},
…,
]

JS解
有找到JS的解法，求Python的解法，非常感謝！


標題:python 取URL、Cookie、request_headers問題
標籤:python url 

我在python用這種方式才可以抓出資料，但cookie和URL是在手動在網頁中按檢查功能再做動作才會出現。
請問該怎麼用python取得正確的URL、Cookie、request_headers呢

To-ddx先生，因為聊聊功能有限筆數，所以最後還沒回覆你測試結果。


標題:python判斷句問題
標籤:python 

抱歉我是新手,想問各位大大
我在輸入值為++的時候為什麼出來的不是"請重新輸入"
反而是請我去修改fraction=int(input("請輸入分數:"))
fraction=int(input("請輸入分數:"))
print("您的分數為"+str(fraction))
if fraction<60:
print("你好爛")
elif fraction==100:
print("你好棒!")
elif fraction>=60 and fraction<=100:
print("加油好嗎?")
elif fraction>100:
print("來亂的?")
else:
print("請重新輸入")


標題:python爬蟲公開資訊觀測站上的資產負債表
標籤:金融爬蟲 python python爬蟲 

新手請教各位python大神,我參考了網路上的https://yichungcheng.pixnet.net/blog/post/119887086-python-%E5%AD%B8%E7%BF%92%E4%B9%8B%E8%B7%AF---%E7%88%AC%E8%9F%B2%E5%89%8D%E5%BF%85%E5%82%99%E7%9F%A5%E8%AD%98 這篇文章,
想抓取公開資訊觀測站上的資產負債表,在執行以下程式後現金流量表、損益表都有抓成功,但唯獨資產負債表沒有成功表格不完整,請教該如何修改此程式?
import pandas as pd
from bs4 import BeautifulSoup
import requests

payload={
     'encodeURIComponent': 1,
     'step':1,
     'firstin':1,
     'off':1,
     'isQuery':'Y',
     'TYPEK':'sii',
     'year':109, 
     'season':'03', 
     }
headers = {'Host': 'mops.twse.com.tw','User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36'}
url = 'https://mops.twse.com.tw/mops/web/t163sb05'
list_req = requests.post(url, data=payload ,headers=headers)
soup = BeautifulSoup(list_req.content, "html.parser")
stockbroad= soup.find_all('table',{'class': 'hasBorder'})
asset市=pd.read_html(str(stockbroad),header=0)
asset市=pd.concat(asset市, axis=0, ignore_index=True)
print(asset市)

希望得到最後爬蟲的結果像以下損益表的pattern這樣,謝謝!

目前顯示的結果如下圖抓class=_"hasBorder"是只能抓到公司代號、公司名稱等變數,但變數底下的value抓不到(沒有row),用同樣方法抓損益表row和column都有齊全,唯獨資產負債表沒有抓到row的值。

附上損益表部分如下(跟資產負債表一樣有好幾個table)



標題:*args 和 **kwargs 的使用時機
標籤:python 

如題，使用的方法跟邏輯都能理解，但還是搞不太清楚該用在什麼樣的時機
想詢問版上的大神的看法


標題:java to python 一問
標籤:python java 

大家好, 請問一下以下的java 代碼在Python 是怎樣寫?


public void openOracleConnection() throws SQLException, IllegalAccessException, InstatiationException, ClassNotFoundException


java.util.Date


private static final double variableName


public functionname(object param) 的object type


public functionname(Date param) 的date type


public functionname(byte[] param, byte[][] param2) 的byte[], byte[][] type


super()


protected attribute in class


Class1 attribute = new Class1()


謝謝.


標題:python selenium  WebDriverWait 的使用時機 & 如何判斷網頁是否讀取完畢
標籤:python selenium 

想請問 webdriver 的使用時機?
因為如果呼叫 driver.get 後，會等到網頁讀取完才會繼續執行下一行
那 WebDriverWait 是否等同使用 while 迴圈加上最大等待時間去 find_element
# 尋找元素
def check_element(element_name):
    try:
        return browser.find_element_by_class_name(element_name)
    except: # except NoSuchElementException:
        print("找不到 element:"+element_name)
        return False

wait_load_time = 180 # 網頁讀取等待最大秒數(秒)
starttime = datetime.datetime.now()
while (datetime.datetime.now() - starttime < wait_load_time):
    if check_element("xxxx"):
        # do something
        break

雖然有看過網路上有人把 set_page_load_timeout 設定的極短，來跳過網頁讀取時間搭配 WebDriverWait 使用達到效果，但因為不知道後續如何判斷網頁是讀取錯誤(轉調 error page)還是塞車導致需要繼續等待，所以也沒嘗試過這種方法


標題:請問python使用print()出來是這樣�A�n
標籤:python3 python python系列文章 python入門 

with open("tt.txt",mode="w",encoding="utf-8")as file:
file.write("你好\nabcd")
with open("tt.txt",mode="r",encoding="utf-8")as file1:
x=file1.read()
print(x)
請問為何印出來是?
�A�n
abcd
我已使用utf-8


標題:Python函式與迴圈解題疑惑
標籤:python 

我是程式語言新手，在練習解題的時候，發現我得到的答案跟正確答案一致，卻和Google Colab跑出來的結果不同。希望有人能告訴我究竟是哪裡出錯了。
考題：有一函式 func 如下，求 func(7, 4)的回傳值。
def func(a, b):
    s = 0
    if a > b:
        t = a
        a = b
        b = t
    for i in range (0, a):
        for j in range(i, b):
            s += j
        return s # 這一行是我為了看程式運行的結果而添加的。
    print(s) # 這一行是我為了看程式運行的結果而添加的。

func(7, 4)

我自己得到的答案是80，與解答一致。
但是在Google Colab運行的結果是21。
麻煩哪位好心人幫我解惑一下，謝謝。


標題:Python程式包成 EXE 執行檔，執行報錯問題
標籤:exe python 

工作上都是用C#來寫執行檔
最近想試試用python寫個執行檔，實現字串加密的功能
主要就是能讓使用者自行輸入字串，再印出加密後的字串。
參考了此文章
https://ithelp.ithome.com.tw/articles/10226815
在IDE上是可執行成功。
打包成exe檔也是成功的，但在執行exe檔時卻會出現
RuntimeError: input(): lost sys.stdin
的錯誤。
//使用了原文的範例也是此情況
想請問該如何解決呢?


標題:python function argument type 一問
標籤:java python 

大家好, 想請教一下java 的function 要用python 寫的話是轉成怎樣
public static int foundIndex(String[] arr, String key, int skip, boolean cs)

是這樣嗎?
@classmethod
def foundIndex(arr:str[], key: str, skip: int, cs:bool):
    ....

只是看見他是static 和回傳 int , 還有就是str[] 應該是不對, 那python 的list 可以算是java string array 嗎?
如果argument 是date, 可以這樣嗎?
mydate: date
謝謝


標題:Python截圖第二螢幕
標籤:python3 python求救 python 

小弟目前正在使用Python3和pyscreenshot，
做一個截圖程式，
發現無法截取第二螢幕，
請各位大大幫忙一下！
萬分感激！


標題:可否推薦Python 合適的 Web Server 
標籤:python 

小弟剛入學Python想嘗試Linode + Ubuntu架Web Server以利LineBot接傳值，想請教前輩們用NGINX是否合適，或者有更好的方式呢?


標題:急~~~~樹莓派4無法安裝 numpy,opencv
標籤:linux python3 樹莓派 numpy opencv 


如兩張圖片中求救各位好心善良的大大幫幫忙誠心磕頭拜託了
這幾天快被安裝opencv弄到快崩潰了....敘述一下:我這是在樹莓派4架設virtual(虛擬)環境想要安裝opencv,但是要求numpy這相依套件怎麼裝卻裝不起來!很奇怪...指令一跑都是半小時以上跑不掉每天都反覆Error,該要求的相依套件(pip,weel這些套件等~~)都已經安裝到最新版本了!numpy裝不起來等於opencv也不用裝了!這幾天很崩潰吃睡都不好覺得快掛掉了!希望好心大大幫忙拜託了~~


標題:關於heroku的問題
標籤:heroku python3 pymongo flask error 

先附上我的程式碼




部屬到heroku上面之後出現了這些錯誤



上網找了好久還是不清楚如何解決我的問題 希望各位高手可以幫忙 感恩


標題:Python LineBot 處理連續對話 (輸入訂單）
標籤:python line bot line-bot-sdk django 

我想寫一個輸入訂購資料的連續對話 想嘗試使用 while 迴圈去寫
可是訊息只會卡在第一個對話就不會往下執行了

請問是否有別的方法
另外想請教怎麼把這些得到的對話儲存成json


標題:python 爬蟲網頁資料時，無法給select多選項 send value 成功
標籤:python select multiple keyword 

各位高手，以下是我遇到的問題，我想在[證照]這個欄位上，用python輸入國際內部稽核師(CIA)和電腦稽核師CISA。

我試過這幾種用法，都無反應
certificate.send_keys("4006001003")#國際內部稽核師(CIA)
certificate.send_keys("4006001012")#電腦稽核師CISA
operation_key = Select(wait.until(EC.element_to_be_clickable((By.ID, 'certs'))))
operation_key.select_by_value('4006001003')
select = Select(browser.find_element_by_id("certs"))
select.deselect_all()
select.select_by_value('4006001003')
browser.quit()
點選前的畫面：

點選後的畫面：

我是第一次遇到這種選法，而且是多選項的，大家是否有遇過呢?


標題:我想用python寫入excel中但出了問題
標籤:fb python excel 被吃掉 

不知為何我執行後我的貼文全部被吃掉只剩下最後一句，求大神幫個忙 感恩
後來我改用list讀取excel一樣被吃掉呢
<更新提供部分程式碼>
程式碼提供如下:
# 捲動
for x in range(5):
    chrome.execute_script("window.scrollTo(0,document.body.scrollHeight)")
    time.sleep(5)
 
soup = BeautifulSoup(chrome.page_source, 'html.parser')
print("------------我是分隔線---------------")

titles = soup.find_all(
    "div", class_="ecm0bbzt")
for title in titles:
    # 定位每一行標題
    posts = title.find_all("div", dir="auto")
    # 如果有文章標題才印出
    if len(posts):
        for post in posts:
          q1=post.text
          a_list =[q1]
          print(a_list)
          
        print("------------我是分隔線---------------")
import csv
with open('songs.csv', 'w', newline='', encoding="big5") as csvfile:
    # 建立 CSV 檔寫入器
    writer = csv.writer(csvfile)
    # 寫入一列資料
    writer.writerow(["貼文"])
    
    ...
    
    writer.writerow([a_list])        
        
# 建立資料夾
import os
import requests
if not os.path.exists("images"):
    os.mkdir("images")

# 下載圖片
images = soup.find_all(
    "img", class_=["i09qtzwb n7fi1qx3 datstx6m pmk7jnqg j9ispegn kr520xx4 k4urcfbm bixrwtb6", "i09qtzwb n7fi1qx3 datstx6m pmk7jnqg j9ispegn kr520xx4 k4urcfbm"])
if len(images) != 0:
    for index, image in enumerate(images):
        img = requests.get(image["src"])
        with open(f"images/img{index+1}.jpg", "wb") as file:
            file.write(img.content)
        print(f"第 {index+1} 張圖片下載完成!")

# 等待5秒
time.sleep(5)
# 關閉瀏覽器
chrome.quit()




標題:win10工作排程器 無法自動執行
標籤:#工作排程器 #python #自動執行 

各位高手好，我想使用win10工作排程器自動執行(每5分鐘執行一次)py檔(ex_sqlserver_test1.py)的內容(從SQL Server抓取資料更新到MySQL)，手動按執行，執行結果沒問題，自動執行會計算下次執行時間，但是時間到了卻不會真的執行，請問各位高手有什麼可能的原因?或者需要補充什麼其他資訊才能看出原因都可以提出來，先謝謝各位了!!!





新增引數:D:\xampp\htdocs\website_test\ex_sqlserver_test1.py
開始位置:D:\xampp\htdocs\website_test




標題:opencv人臉偵測問題
標籤:facedetector opencv python 

我使用opencv dnn進行人臉偵測
模型為res10_300x300_ssd_iter_140000.caffemodel
但是為何模型輸出的結果*原圖寬、高
有可能會出現超出範圍的狀況
有人有遇過這問題嗎


標題:Python - 如何将文本转换为语音
標籤:python 

Python - 如何将文本转换为语音
from gtts import gTTS from playsound import playsound  s = gTTS("Sample Text") s.save('sample.mp3') playsound('sample.mp3') 

https://www.thecodeteacher.com/howto/9/Python---How-To--Convert-Text-to-Speech-in-Python


標題:python跑不了urllib和json合併的語法
標籤:#python #urllib #網路設定 #json 

各位大大
如題我的python跑不了json和urllib的合併，前面測試過urllib可以，也測試過json可以但一合併就出問題。


類似這樣，謝謝!


標題:請問fb爬蟲假如我不想依靠寫死的方式爬取內文我應該怎爬取內文
標籤:fb python 網路爬蟲 

請問各位高手想問fb爬蟲假如我不想依靠寫死的方式爬取內文我應該怎爬取內文，因寫死的方式會有可能沒抓到全部，希望能給個範例呢感恩


標題:請問如何用python將爬出來的文字放入excel中呢
標籤:python excel fb 顯示更多 

想請各位高手幫忙
第1個問題請問如何用python將爬出來的文字放入excel中呢? 感恩
第2個問題請問如何用python將fb貼文的顯示更多自動點開呢?感恩
程式碼如下:
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from bs4 import BeautifulSoup
import time
options = Options()
options.add_argument("--disable-notifications")
chrome = webdriver.Chrome()
chrome.get("https://www.facebook.com/")
email = chrome.find_element_by_id("email")
password = chrome.find_element_by_id("pass")
email.send_keys('xxxxx')
password.send_keys('xxxxx')
password.submit()
time.sleep(3)
防止跳出通知
chrome.get('https://www.facebook.com/search/top?q=%E7%AB%B9%E8%BC%AA%E9%9B%BB%E5%8B%95%E8%BB%8A')
from selenium import webdriver
options = webdriver.ChromeOptions()
prefs = {'profile.default_content_setting_values':{'notifications': 2}}
options.add_experimental_option('prefs', prefs)
for x in range(1, 4):
chrome.execute_script("window.scrollTo(0,document.body.scrollHeight)")
time.sleep(5)
soup = BeautifulSoup(chrome.page_source, 'html.parser')
print("------------------------我是分隔線------------------------------")
titles = soup.find_all(
"span", class_="d2edcug0 hpfvmrgz qv66sw1b c1et5uql lr9zc1uh a8c37x1j fe6kdd0r mau55g9w c8b282yb keod5gw0 nxhoafnm aigsh9s9 d3f4x2em iv3no6db jq4qci2q a3bd9o3v b1v8xokw oo9gr5id hzawbc8m")
for title in titles:
定位每一行標題
posts = title.find_all("div", dir="auto")
如果有文章標題才印出
if len(posts):
for post in posts:
print(post.text)
print("------------------------我是分隔線------------------------------")
建立資料夾
import os
import requests
if not os.path.exists("images"):
os.mkdir("images")
下載圖片
images = soup.find_all(
"img", class_=["i09qtzwb n7fi1qx3 datstx6m pmk7jnqg j9ispegn kr520xx4 k4urcfbm bixrwtb6", "i09qtzwb n7fi1qx3 datstx6m pmk7jnqg j9ispegn kr520xx4 k4urcfbm"])
if len(images) != 0:
for index, image in enumerate(images):
img = requests.get(image["src"])
with open(f"images/img{index+1}.jpg", "wb") as file:
file.write(img.content)
print(f"第 {index+1} 張圖片下載完成!")
等待5秒
time.sleep(5)
關閉瀏覽器
chrome.quit()


標題:python requests 缺少部分資料片段
標籤:python 爬蟲 資料科學 資料工程 

各位前輩晚上好，小弟在嘗試爬蟲取網頁資料的時候，有成功取到資料，
但唯獨少了< section > 的部分。

想請為什麼html會少這部分的資料呢？
我該如何取得 < section >

目標資料：

程式碼：
import requests
from bs4 import BeautifulSoup

url = 'https://rent.houseprice.tw/'
res = requests.get(url, headers=headers)
html_doc = res.text
soup = BeautifulSoup(html_doc, 'html.parser')
print(soup)

結果：



標題:python 爬蟲網頁資料時無法遇到 type="hidden" 時無法send value 成功
標籤:python send value type="hidden" 

詢問各位大大 ><
我的問題：我想要在網頁先下關鍵字點查詢後，再去爬文回來。但在下關鍵字給條件值的時候遇到一個問題。只要是這種type="hidden" 類型的，我用send_keys都是沒有效果。
這邊該如何調整呢
例如我想在[希望工作地點]輸入高雄市

點完後後，ＸＭＬ呈現的是如下及我的程式碼：



標題:python寄信問題(已解決)
標籤:@python @smtp @email @outlook ＠gmail 

我現在想要用python寄信
但是我找不到可以用gmail寄信到outlook上
或是不用安裝outlook就可以直接寄信到outlook上
有什麼方法可以解決?
我不想在每台主機上裝outlook
這是我的語法....
#準備訊息物件設定
#載入模組
def email(title,body):
    import email.message
    #建立訊息物件
    msg=email.message.EmailMessage()
    #利用物件建立基本設定
    
    
    msg["From"]="outlook.com"
    msg["To"]="outlook.com"
    msg["Subject"]=title
    
    #寄送郵件主要內容
    #msg.set_content("測試郵件純文字內容") #純文字信件內容
    msg.add_alternative(body,subtype="html") #HTML信件內容
    
    acc="@gmail.com"
    password="password"
    
    #連線到SMTP Sevver
    import smtplib
    #可以從網路上找到主機名稱和連線埠
    server=smtplib.SMTP_SSL("smtp.gmail.com",465) #建立gmail連驗
    server.login(acc,password)
    server.send_message(msg)
    server.close() #發送完成後關閉連線

我找到囉
以下是outlook對outlook 且不用安裝
def send_mail(recipient, subject, message):
    import smtplib
    from email.mime.text import MIMEText
    from email.mime.multipart import MIMEMultipart
    username = "xx"
    password = "xx"
    
    msg = MIMEMultipart()
    msg['From'] = username
    msg['To'] = recipient
    msg['Subject'] = subject
    msg.attach(MIMEText(message))

    mailServer = smtplib.SMTP('smtp-mail.outlook.com', 587)
    mailServer.ehlo()
    mailServer.starttls()
    mailServer.ehlo()
    mailServer.login(username, password)
    mailServer.sendmail(username, recipient, msg.as_string())
    mailServer.close()



send_mail('收件人', 'test', 'May the force be with you.')



標題:python語法疑問, ...  and  -> None and  SupportsAbs
標籤:python 

class timedelta(SupportsAbs[timedelta]):

    def __init__(self, days: float = ..., seconds: float = ..., 
                 microseconds: float = ..., milliseconds: float = ...,
                 minutes: float = ..., hours: float = ...,  weeks: float =
                 ..., *, fold: int = ...) -> None: ...

前輩們好, 有三點疑問想問

SupportsAbs
days: float = ...
-> None

想問這三個有什麼含意, 謝謝


標題:關於Python 讀取 json 格式問題
標籤:python 

請教各位 Python 前輩
小弟用 json.load 讀取以下兩個 json 格式
程式只有右圖可以正常讀取
請問有何方法可以將左圖的json 格式化跟右圖?
謝謝



標題:python csv整理資料
標籤:@python @csv 

from selenium import webdriver
import requests
import time
import json
import csv
import re

driver = webdriver.Chrome()
time.sleep(2)
driver.get('https://www.macromicro.me/charts/39415/global-coal-prices')
time.sleep(2)
#cookies
cookie_list = driver.get_cookies()
c = 'PHPSESSID=' + cookie_list[9]['value']
#取得token
p = re.compile(r'<p data-stk="(.*?)">')
B = p.findall(driver.page_source)
driver.close()

request_headers = {
    'Accept': 'application/json, text/javascript, */*; q=0.01',
    'Accept-Encoding': 'gzip, deflate, br',
    'Accept-Language': 'zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7',
    'Connection': 'keep-alive',
    'Authorization': 'Bearer ' + B[0],
    'Cookie': c,
    'Host': 'www.macromicro.me',
    'Referer': 'https://www.macromicro.me/charts/39415/global-coal-prices',
    'sec-ch-ua': '"Google Chrome";v="93", " Not;A Brand";v="99", "Chromium";v="93"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
    'Sec-Fetch-Dest': 'empty',
    'Sec-Fetch-Mode': 'cors',
    'Sec-Fetch-Site': 'same-origin',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36',
    'X-Requested-With': 'XMLHttpRequest'
}
url = 'https://www.macromicro.me/charts/data/39415'
r = requests.get(url, headers=request_headers)
print(r.text)

with open('data.json','w+') as f:
    f.write(r.text)


#讀取json檔
with open('data.json') as f:
    data = json.load(f)
    #'ICE-Newcastle煤 (L)'
    n1 = (data['data']['c:39415']['s'][0])
    #'ICE-Rotterdam煤 (L)'
    n2 = (data['data']['c:39415']['s'][1])
    #'中國-動力煤期貨 (R)'
    n3 = (data['data']['c:39415']['s'][2])
    #'中國-焦煤期貨 (R)'
    n4 = (data['data']['c:39415']['s'][3])

#取得最大值
m = max([len(n1),len(n2),len(n3),len(n4)])

#寫入csv
with open('output.csv', 'w+', newline='',encoding='utf_8_sig') as csvfile:
    # 以逗點分隔欄位，建立 CSV 檔寫入器
    writer = csv.writer(csvfile, delimiter=',')
    writer.writerow(['時間', 'ICE-Newcastle煤 (L)', '時間','ICE-Rotterdam煤 (L)','時間','中國-動力煤期貨 (R)','時間','中國-焦煤期貨 (R)'])
    for i in range(m):
        if i > len(n1)-1:
            d1 = ''
            v1 = ''
        else:
            d1 = n1[i][0]
            v1 = n1[i][1]
            
        if i > len(n2)-1:
            d2 = ''
            v2 = ''
        else:
            d2 = n2[i][0]
            v2 = n2[i][1]
            
        if i > len(n3)-1:
            d3 = ''
            v3 = ''
        else:
            d3 = n3[i][0]
            v3 = n3[i][1]
        if i > len(n4)-1:
            d4 = ''
            v4 = ''
        else:
            d4 = n4[i][0]
            v4 = n4[i][1]
            
        d = [d1,v1,d2,v2,d3,v3,d4,v4]
        writer.writerow(d)

以上是我的程式碼，我把爬取到的資料寫成CSV
然後這是我的CSV

我想整理成時間在最前面的欄位後面就是資料的的欄位
如果那個時間點沒有資料就為空
我有點不知道該怎麼做......


標題:如何用 Python 3.x Matplotlib 畫出動態兩條折線圖 時間軸 (Time) 和分別各是 Commenter Mood (1) /   Commenter Mood (0)?
標籤:python3 python python入門 

不太清楚. 如何用 Python 3.x Matplotlib 畫出動態兩條折線圖 時間軸 (Time) 和分別各是 Commenter Mood (1) /   Commenter Mood (0)? 需要大家幫忙, 提供一下做法. 謝謝.!



標題:python讀取TXT文字檔裡某特定符號後的字串
標籤:python 

TXT檔如下
星期一充電 : [1300~1500,1900~2200]
星期二曬衣服 : [1200~1800,2200~0300]
星期三洗衣 : [1100~1200,1500~2100]
星期四健身房運動 : [0100~0900,2200~2300]
星期五吃飯 : [1300~1600,1900~2000]
星期六賺外快 : [1200~1600,2100~0800]
星期日睡覺 : [0200~0700,0000~0300]
請問該如何寫才能讓讀取TXT文字檔後顯示的輸出只顯示" : "後面的時間點，我查了很多資料還是找不到類似或有關的文章學習，請各位大神幫幫忙


標題:我想要用python讀取柏克萊暢銷榜與試讀榜的所有書籍資料
標籤:python 網路爬資料 beautifulsoup 

我想要用python讀取柏克萊暢銷榜與試讀榜的所有書籍資料
用DataFrame儲存,5個欄位


類型 booktype 暢銷榜/試讀榜


圖 picture


書名 bookname


作者 author


價格 price


兩個榜的url可用一個清單儲存  https://www.books.com.tw/web/sys_cebtopb/cebook  https://www.books.com.tw/web/sys_cebtryb/cebook


圖要下載, 檔名可以用序號重新命名


我東抄西抄，只組合出這樣
import requests
from IPython.display import Image
from IPython.display import Image, display
from bs4 import BeautifulSoup
import pandas as pd

def downloadimg(imgurl, img_name):
    urlcontent = requests.get(imgurl)
    with open(img_name,'wb') as file: 
         file.write(urlcontent.content)
         file.flush() 
         file.close() 
         print('已儲存' + img_name)

url="https://www.books.com.tw/web/sys_cebtryb/cebook"
myrequest = requests.get(url) 
#print(myrequest.content) 
soup=BeautifulSoup(myrequest.content,"html.parser") 
#print(soup)

firstImg = soup.find('img') #取得第1個<img>
print('firstImg:', firstImg)
print('--------------------')

#先跑出柏克萊是讀榜資料=====================================

dvdlist = soup.find_all('img',{'class':'cover'})
count = 0
imglist = []
namelist = []
#print(dvdlist)

#跑出dvdlist跑出dvdlist=================================================

for idx in range(len(dvdlist)):
     count += 1
     print(count)
     print(dvdlist[idx])
     print('圖-->', dvdlist[idx].get('src'))
     imglist.append(dvdlist[idx].get('src'))
     print('書名-->', dvdlist[idx].get('alt'))
     namelist.append(dvdlist[idx].get('alt'))
     print('作者-->', dvdlist[idx].get('b'))#這兩段跑不成功
     namelist.append(dvdlist[idx].get('b'))#這兩段跑不成功

#跑出booklist跑出  另外用來抓作者=================================================
url="https://www.books.com.tw/web/sys_cebtryb/cebook"
myrequest = requests.get(url) 
#print(myrequest.content) 
soup=BeautifulSoup(myrequest.content,"html.parser") 

booklist=soup.find_all('a',{'href':'cover'})# 我是抓錯屬性嗎?
print(booklist)

display(Image(pic))

#上面這段也跑不成功
想要把圖用
只到這裡就卡好久 ~ 看看有沒有高手可以教一下 感謝


標題:line bot如何使用APScheduler定時推播
標籤:line bot python apscheduler heroku 

因為是程式初心者，有很多不太了解的地方，想請問line機器人推播的問題
主要想製作2小時一次的推播和關鍵字回覆的line機器人。
而推播及回覆的文字想以3~5個字串隨機發送，目前僅寫了隨機回覆部分，但在line bot上沒有效果，想請問要怎麼修改呢？
程式碼如下，是參考https://badgameshow.com/steven/line/line-bot-%E6%95%99%E5%AD%B8/
import re
@handler.add(MessageEvent, message=TextMessage)
def handle_message(event):
    message = event.message.text
    if message == "你是誰":
        message = TextSendMessage(
            text = "才不告訴你勒~~"
        )
        line_bot_api.reply_message(event.reply_token,message)
    elif message == "測試":
        message = TextSendMessage(
            text = DrawStraws()
        )
        line_bot_api.reply_message(event.reply_token,message)   
    else:
       line_bot_api.reply_message(event.reply_token,TextSendMessage(message))

def DrawStraws():
    DrawStrawsList = ["A", "B", "C", "D", "E"]
    return DrawStrawsList[random.Randint(0, len(DrawStrawsList) - 1)]

以及使用APScheduler定時
參考https://suyenting.github.io/post/linebot-ceb102-class-helper-heroku/
建立了clock.py 但不太了解推播的部分要如何定時
from apscheduler.schedulers.blocking import BlockingScheduler
import requests

sched = BlockingScheduler()

# 防止睡眠
def DoNotSleep():
    url = "https://xxxxx.herokuapp.com/"
    r = requests.get(url)

# 防止自動休眠
sched.add_job(DoNotSleep, trigger='interval', id='doNotSleeps_job', minutes=20)

sched.start()

希望能有大大解答><！


標題:Python numpy.lib.stride_tricks.as_strided 問題
標籤:python3 numpy 

各位前輩們好
本人在嘗試實作jpeg資料的壓縮方法時使用了numpy的as_strided方法
但是在我把它切割成8x8小塊並且去做DCT和量化後
轉回來時會有位置轉錯的問題 如下圖
在分成(64,64,8,8)時的array長這樣

合併成(512,512)時（前8,8）的array長這樣

自己在測試時使用np.arange丟給to_area和mix_area時卻是正常的
想請問是哪裡出錯了呢？
完整程式碼如下
import numpy as np
from tqdm import *
from PIL import Image


class new_Transformer:
    def __init__(self):
        self.dct_matrix = np.zeros((8, 8))
        for i in range(8):
            c = 0
            if i == 0:
                c = np.sqrt(1 / 8)
            else:
                c = np.sqrt(2 / 8)
            for j in range(8):
                self.dct_matrix[i, j] = c * np.cos(np.pi * i * (2 * j + 1) / 16)

    def DCT(self, matrix):
        transformed = np.dot(self.dct_matrix, matrix)
        transformed = np.dot(transformed, np.transpose(self.dct_matrix))
        return transformed

    def IDCT(self, matrix):
        transformed = np.dot(np.transpose(self.dct_matrix), matrix)
        transformed = np.dot(transformed, self.dct_matrix)
        return transformed

class jpeg:
    def __init__(self, fp):
        self.img = Image.open(fp)
        self.img.convert("RGB")
        self.img_m = np.asarray(self.img)
        self.transformer = new_Transformer()
        self.qy = np.array([
            [16, 11, 10, 16, 24, 40, 51, 61],
            [12, 12, 14, 19, 26, 58, 60, 55],
            [14, 13, 16, 24, 40, 57, 69, 56],
            [14, 17, 22, 29, 51, 87, 80, 62],
            [18, 22, 37, 56, 68, 109, 103, 77],
            [24, 35, 55, 64, 81, 104, 113, 92],
            [49, 64, 78, 87, 103, 121, 120, 101],
            [72, 92, 95, 98, 112, 100, 103, 99]
        ])

        self.qc = np.array([
            [17, 18, 24, 47, 99, 99, 99, 99],
            [18, 21, 26, 66, 99, 99, 99, 99],
            [24, 26, 56, 99, 99, 99, 99, 99],
            [47, 66, 99, 99, 99, 99, 99, 99],
            [99, 99, 99, 99, 99, 99, 99, 99],
            [99, 99, 99, 99, 99, 99, 99, 99],
            [99, 99, 99, 99, 99, 99, 99, 99],
            [99, 99, 99, 99, 99, 99, 99, 99]
        ])

    def to_ycbcr(self, r, g, b):
        y = 0.299 * r + 0.587 * g + 0.114 * b
        cb = 0.5643 * (b - y) + 128
        cr = 0.7133 * (r - y) + 128
        return y, cb, cr

    def to_rgb(self, y, cb, cr):
        r = y + 1.402 * (cr - 128)
        g = y - 0.344 * (cb - 128) - 0.714 * (cr - 128)
        b = y + 1.772 * (cb - 128)
        return r, g, b

    def to_area(self, matrix):
        h, w = matrix.shape[0], matrix.shape[1]
        strides = matrix.itemsize * np.array([w * 8, 8, w, 1])
        return np.lib.stride_tricks.as_strided(matrix, shape=(h // 8, w // 8, 8, 8), strides=strides)

    def mix_area(self, matrix):
        h, w = matrix.shape[0], matrix.shape[1]
        strides = matrix.itemsize * np.array([w * 8, 1])
        return np.lib.stride_tricks.as_strided(matrix, shape=(h * 8, w * 8), strides=strides)

    def encode(self):
        r = self.img_m[:, :, 0]
        g = self.img_m[:, :, 1]
        b = self.img_m[:, :, 2]
        y, cb, cr = self.to_ycbcr(r, g, b)
        self.y_m = self.transform(self.to_area(y), "qy")
        self.cb_m = self.transform(self.to_area(cb), "qc")
        self.cr_m = self.transform(self.to_area(cr), "qc")

    def decode(self):
        h, w = self.y_m.shape[0], self.y_m.shape[1]
        d_y = np.zeros((64, 64, 8, 8))
        d_cb = np.zeros((64, 64, 8, 8))
        d_cr = np.zeros((64, 64, 8, 8))
        progress = tqdm(total=h * w)
        for i in range(h):
            for j in range(w):
                d_y[i, j] = (self.dct_idct(self.inverse_quantize(self.y_m[i, j], mode="qy"), mode="idct"))
                d_cb[i, j] = (self.dct_idct(self.inverse_quantize(self.cb_m[i, j], mode="qc"), mode="idct"))
                d_cr[i, j] = (self.dct_idct(self.inverse_quantize(self.cr_m[i, j], mode="qc"), mode="idct"))
                progress.update(1)

        r = d_y + 1.402 * (d_cr - 128)
        g = d_y - 0.344 * (d_cb - 128) - 0.714 * (d_cr - 128)
        b = d_y + 1.772 * (d_cb - 128)

        ir = Image.fromarray(self.mix_area(r)).convert("L")
        ig = Image.fromarray(self.mix_area(g)).convert("L")
        ib = Image.fromarray(self.mix_area(b)).convert("L")
        img = Image.merge("RGB", (ir, ig, ib))
        img.show()

    def transform(self, matrix, mode):
        h, w = matrix.shape[0], matrix.shape[1]
        progress = tqdm(total=h * w)
        m = []
        for i in range(h):
            row = []
            for j in range(w):
                row.append(self.quantize(self.dct_idct(matrix[i, j], mode="dct"), mode))
                progress.update(1)
            m.append(row)
        return np.asarray(m)

    def quantize(self, matrix, mode):
        quantized_matrix = matrix
        if mode == "qy":
            quantized_matrix = np.round(quantized_matrix / self.qy)
        if mode == "qc":
            quantized_matrix = np.round(quantized_matrix / self.qc)
        return np.asarray(quantized_matrix)

    def inverse_quantize(self, matrix, mode):
        inverse_quantized_matrix = matrix
        if mode == "qy":
            inverse_quantized_matrix *= self.qy
        if mode == "qc":
            inverse_quantized_matrix *= self.qc
        return np.asarray(inverse_quantized_matrix)

    def dct_idct(self, matrix, mode):
        if mode == "dct":
            return self.transformer.DCT(matrix)
        elif mode == "idct":
            return self.transformer.IDCT(matrix)

test = jpeg("LenaRGB.bmp")
test.encode()
test.decode()



標題:python 按鈕 開啟另一個py檔
標籤:python入門 

程式碼打包後，用按鈕開啟另一個.py，不管按　按鈕"2"或按鈕"4"，都是先執行4.py程式，按ｘ關閉4.py程式就跳出2.py程式,請問怎麼解決呢? 謝謝
from tkinter import *
import os
import tkinter as tk

form = tk.Tk()
form.title('test')
form.geometry('800x500')

def callback():
      form.destroy()
      os.system('python 2.py')

def callback1():
      form.destroy()
      os.system('python 4.py')

  
button = tk.Button(form,text="2",command=callback)
button.pack()

button = tk.Button(form,text="4",command=callback1)
button.pack()

form.mainloop()



標題:請問python中的np.random.exponential()函數在c#中是什麼
標籤:c# python numpy 

我不太常寫c#，但由於一些需求需要將程式碼轉成c#
也上網查過c#的Numpy套件無果，希望有大神能回答，感恩。


標題:python 檔案計算問題
標籤:python 

我有一個文字檔，我想計算檔案內助教的時薪
想問我應該要怎麼做才好，文字檔內容如下
以學士時薪180、碩士時薪為200基準，計算出每位助教的當月薪資。
學士的學號開頭為4，碩士則為6。
序列,姓名,學號,本月時數
1,王小明,410612123,30
2,張小偉,410611715,30
3,陳小潔,610727331,40


標題:Python pandas畫折線圖X軸有問題
標籤:python3 pandas 折線圖 

用第一個程式可以畫出長條、橫條和堆疊，但折線圖的話會全部擠在y軸上。雖然照Pandas這網站修改後可以畫出折線圖，還是想請問為什麼第一個程式會畫不出來@@
df=pd.DataFrame([[250,320,300,312,280],
               [280,300,280,290,310],
               [120,280,250,305,250]],
               index=["北部","中部","南部"],
               columns=["2016","2017","2018","2019","2020"])
g1=df.iloc[0].plot(kind="line",xticks=range(2015,2020),title="汽車銷售量",figsize=[10,5])
g1=df.iloc[1].plot(kind="line",xticks=range(2015,2020),title="汽車銷售量",figsize=[10,5])
g1=df.iloc[2].plot(kind="line",xticks=range(2015,2020),title="汽車銷售量",figsize=[10,5])

df_1=pd.DataFrame({"北部":[250,320,300,312,280],
                "中部":[280,300,280,290,310],
                "南部":[120,280,250,305,250]},
               index=["2016","2017","2018","2019","2020"])
print(df_1)
test=df_1.plot(kind="line",title="汽車銷售量",figsize=[10,5])



標題:求救！uninitialized constant (NameError) LineBot問題
標籤:linebot python rails cmd vscode 

require 'line/bot'


class AlarmServicc
  def client
    @client ||= Line::Bot::Client.new do |config|
      config.channel_secret = 'XXX'
      config.channel_token = 'XXX'
    end
  end

  def run
    message = {
      type: "text",
      text: "現在時間：#{Time.current} 趕快起床吧"
    }
    client.push_message('XXX', message)
  end
end

顯示uninitialized constant AlarmService (NameError)，這段程式碼是按照https://ithelp.ithome.com.tw/articles/10201597 的步驟執行，請問程式碼哪邊需要修正的嗎？


標題:1.請用python設計一個fib()函數，此函數可以接收一個參數n，fib()可以傳回費氏數列第n項。
標籤:python 

1.請用python設計一個fib()函數，此函數可以接收一個參數n，fib()可以傳回費氏數列第n項。
ex:0,1,1,2,3,5,8,13,21，fib(0)應傳回0，fib(8)應傳回21。
2.如字典sub所示，請利用python把這些虛擬youtuber的名字按照訂閱數運用迴圈和串列由大排到小，將結果用串列印出來。
sub={"Pekora":1130000,"Korone":1230000,"Fubuki":1160000,"Gura":1870000,"Watame":670000,"Coco":890000,"Marine":941000}


標題:使用range()建立50個小兵，tag是red，score是3，speed是slow。(python)
標籤:python 

使用range()建立50個小兵，tag是red，score是3，speed是slow。


標題:VS Code PyQt5 無法顯示視窗問題
標籤:python pyqt5 

以下為可以正常顯示視窗的程式碼
import sys
from PyQt5 import QtWidgets
if name == 'main':
app = QtWidgets.QApplication(sys.argv)
w = QtWidgets.QWidget()
w.resize(400, 200)
w.setWindowTitle("hello PyQt5")
w.show()
exit(app.exec_())
以下程式碼為 ui 轉 py自動轉換的程式碼，執行時無跳出任何錯誤訊息，但不會顯示視窗，直接就關閉視窗了，想請問要如何解決，謝謝
from PyQt5 import QtCore, QtGui, QtWidgets
class Ui_Dialog(object):
def setupUi(self, Dialog):
Dialog.setObjectName("Dialog")
Dialog.resize(400, 300)
self.pushButton = QtWidgets.QPushButton(Dialog)
self.pushButton.setGeometry(QtCore.QRect(130, 140, 75, 23))
self.pushButton.setObjectName("pushButton")
self.pushButton_2 = QtWidgets.QPushButton(Dialog)
self.pushButton_2.setGeometry(QtCore.QRect(190, 220, 75, 23))
self.pushButton_2.setObjectName("pushButton_2")
self.label = QtWidgets.QLabel(Dialog)
self.label.setGeometry(QtCore.QRect(100, 90, 47, 12))
self.label.setObjectName("label")
    self.retranslateUi(Dialog)
    QtCore.QMetaObject.connectSlotsByName(Dialog)

def retranslateUi(self, Dialog):
    _translate = QtCore.QCoreApplication.translate
    Dialog.setWindowTitle(_translate("Dialog", "Dialog"))
    self.pushButton.setText(_translate("Dialog", "PushButton"))
    self.pushButton_2.setText(_translate("Dialog", "PushButton"))
    self.label.setText(_translate("Dialog", "TextLabel"))



標題:celery 重複派送任務
標籤:python celery async/await 

背景描述:
broker redis
backend redis
worker 數量 5
最近在使用 celery 上碰到同個任務會重複派送兩次
該任務有設定 eta 間格大約是 2 ~ 4 小時
小弟想上來版上詢問有沒有其他人也碰到同樣情況
並且是如何解決的


標題:[Python] pytube 抓 youtube影片 錯誤
標籤:python python3 pytube pytube3 youtube 

求求前輩們 指點錯誤訊息該如何解決??
(弔詭的是 同樣的程式碼、環境，小弟上午時可以執行，一個午休後就壞掉了)
以下為程式碼畫面

#from pytube import YouTube
import pytube

#ask for the link from user
link = input("Enter the link of YouTube video you want to download:  ")
yt = pytube.YouTube(link)

#Showing details
print("Title: ",yt.title)
print("Number of views: ",yt.views)
print("Length of video: ",yt.length)
print("Rating of video: ",yt.rating)
#Getting the highest resolution possible
ys = yt.streams.get_highest_resolution()

#Starting download
print("Downloading...")
ys.download()
print("Download completed!!")


錯誤訊息如下
ImportError: cannot import name 'YouTube' from partially initialized module 'pytube' (most likely due to 
a circular import)

問過GOOGLE大神 其中給的解決方法都是版本解決問題
以下為 pytube版本

有試過 pytube3 pytube各種版本 皆無法解決
跪求大神們求助!!~~~


標題:急救!!!關於Python socket  sever端和client端(SNMP)
標籤:#python 3 

求Python socket "SNMP" sever端和client端
可有兩種實驗可實現
1.Client從Server下戴一個檔案
2.Client上傳一個檔案到Server


標題:(python Streamlit  新手發問)對外部開放?
標籤:(python) streamlit 

請問我用Streamlit 把自己電腦當伺服器 架一個網站 有開才搜尋的到.
Streamlit 本身有自己的語法 像 flask (app.run(host='0.0.0.0',port=8000))這樣對外開放的嗎?
沒有就算了 XD
p.s 做好玩的,因為希望只有自己的朋友搜尋的到,所以不想放到 Heroku上  ~_~
感謝~~~


標題:Line bot 執行問題
標籤:line bot python3 

小弟我最近在研究Line bot互動回話，碰到了python的module無法執行，我也安裝過pip install line-bot-sdk==1.18.0，想請問有沒有解決辦法!!
以下是在ANACONDA環境執行的python程式碼，Api跟Webhook都有確認過
from flask import Flask
app = Flask(__name__)

from flask import request, abort
from linebot import  LineBotApi, WebhookHandler
from linebot.exceptions import InvalidSignatureError
from linebot.models import MessageEvent, TextMessage,TextSendMessage, ImageSendMessage, StickerSendMessage, LocationSendMessage, QuickReply, QuickReplyButton, MessageAction

line_bot_api = LineBotApi('K8ZtF+BSoO60azEoDeIIr1Hh1c16vGq4MNhMs1cu8eoCkFh6kbE2Od8VQk3Vd+p+YCFOPIU/ie89cm2zXxCU0o5el63tf5e/2gIPrsZinTscVK78Djo+TLA2AZ7n4si/qNk8sCO5Z54Zb1B5ofEA2QdB04t89/1O/w1cDnyilFU=')
handler = WebhookHandler('a8aa8257cddbf2e0847ac9f6a84fafff')

@app.route("/callback", methods=['POST'])
def callback():
    signature = request.headers['X-Line-Signature']
    body = request.get_data(as_text=True)
    try:
        handler.handle(body, signature)
    except InvalidSignatureError:
        abort(400)
    return 'OK'

@handler.add(MessageEvent, message=TextMessage)
def handle_message(event):
    mtext = event.message.text
    if mtext == '@傳送文字':
        try:
            message = TextSendMessage(  
                text = "我是 Linebot，\n您好！"
            )
            line_bot_api.reply_message(event.reply_token,message)
        except:
            line_bot_api.reply_message(event.reply_token,TextSendMessage(text='發生錯誤！'))
        
    elif mtext == '@傳送圖片':
        try:
            message = ImageSendMessage(
                original_content_url = "https://i.imgur.com/4QfKuz1.png",
                preview_image_url = "https://i.imgur.com/4QfKuz1.png"
            )
            line_bot_api.reply_message(event.reply_token,message)
        except:
            line_bot_api.reply_message(event.reply_token,TextSendMessage(text='發生錯誤！'))

    elif mtext == '@傳送貼圖':
        try:
            message = StickerSendMessage(  #貼圖兩個id需查表
                package_id='1',  
                sticker_id='2'
            )
            line_bot_api.reply_message(event.reply_token, message)
        except:
            line_bot_api.reply_message(event.reply_token,TextSendMessage(text='發生錯誤！'))

    elif mtext == '@多項傳送':
        try:
            message = [  #串列
                StickerSendMessage(  #傳送貼圖
                    package_id='1',  
                    sticker_id='2'
                ),
                TextSendMessage(  #傳送文字
                    text = "這是 Pizza 圖片！"
                ),
                ImageSendMessage(  #傳送圖片
                    original_content_url = "https://i.imgur.com/4QfKuz1.png",
                    preview_image_url = "https://i.imgur.com/4QfKuz1.png"
                )
            ]
            line_bot_api.reply_message(event.reply_token,message)
        except:
            line_bot_api.reply_message(event.reply_token,TextSendMessage(text='發生錯誤！'))

    elif mtext == '@傳送位置':
        try:
            message = LocationSendMessage(
                title='101大樓',
                address='台北市信義路五段7號',
                latitude=25.034207,  #緯度
                longitude=121.564590  #經度
            )
            line_bot_api.reply_message(event.reply_token, message)
        except:
            line_bot_api.reply_message(event.reply_token,TextSendMessage(text='發生錯誤！'))

    if mtext == '@快速選單':
        try:
            message = TextSendMessage(
                text='請選擇最喜歡的程式語言',
                quick_reply=QuickReply(
                    items=[
                        QuickReplyButton(
                            action=MessageAction(label="Python", text="Python")
                        ),
                        QuickReplyButton(
                            action=MessageAction(label="Java", text="Java")
                        ),
                        QuickReplyButton(
                            action=MessageAction(label="C#", text="C#")
                        ),
                        QuickReplyButton(
                            action=MessageAction(label="Basic", text="Basic")
                        ),
                    ]
                )
            )
            line_bot_api.reply_message(event.reply_token,message)
        except:
            line_bot_api.reply_message(event.reply_token,TextSendMessage(text='發生錯誤！'))

if __name__ == '__main__':
    app.run()




標題:急救!! 關於Python Socket Programming應用(IMAP)
標籤:socket imap python 

題目:
使用Socket Programming (Client-Server架構)
1.IMAP-ClientSocket
2.IMAP-SererSocket
目前想到幾種實驗可實現(請求各位大神支援)
Client 可從 Server 收信,轉信,發信或編輯信
使用python去開發socket(socket=IP address + Port Number)之網路應用
任何程式語言都行(python優先)
拜託各位行行好!!!好人一生平安~~~~
謝謝大家


標題:crontab執行 python 問題
標籤:#crontab #python 

各位大大
我使用crontab -e 執行python script.
我執行
30 15 * * * /usr/bin/python3 /home/creation/python_for_etl/to_server/raw_sys.py
之前也設定過爬蟲的python 檔案都沒有甚麼問題。
但這次我已經試了一整天了 手動執行都會更新但是就是無法讓crontab 幫我執行。
我raw_sys.py 主要是去oracle sql 抓資料灌到Mysql 裡面。
使用 grep CRON /var/log/syslog查看
得到以下結果
目前推測是連線oracle sql的問題
是不是也有可能引用另一個檔案的問題?這個檔案有引用另一個檔案的函數式
請問大大們還有可能是甚麼樣的問題嗎?


標題:python 爬蟲書籍推薦
標籤:python入門 

網路爬蟲書籍推薦


標題:TensorFlow遇到的問題，ImportError: cannot import name 'trace' from 'tensorflow.python.profiler'
標籤:tensorflow anaconda python 

最近需要重現TensorFlow1X版的訓練模型
當我輸入
python train.py --logtostderr --train_dir=training\ --pipeline_config_path=training\ssd_inception_v2_coco.config
時正常來說會去訓練模型
但我卻得到以下錯誤
ImportError: cannot import name 'trace' from 'tensorflow.python.profiler' (C:\Users\88696\anaconda3\envs\tf_gpu\lib\site-packages\tensorflow_core\python\profiler\__init__.py)
求助版上大神 感謝
Windows 10
python 3.7
TensorFlow 1.15.0


標題:[已解決]Python抓網頁抓到特定頁數後會出現IndexError: list index out of range
標籤:python 

在練習作業的時候出現了一個問題，要抓的兩個各自有80頁和41頁，可是在跑到39頁時就都會出現IndexError: list index out of range。
1.看了39頁和40頁以後的網址、原始碼，看起來沒有變？
2.showkind跑完問題是指到showpage，可是print showpage、res都可以印出東西。
想請問接下來要哪邊檢查？先謝謝大家

def showkind(url,kind):
    html=requests.get(url,headers=headers).text
    sp=BeautifulSoup(html,"lxml")
    try:
        pages=int(sp.select(".cnt_page span")[0].text)
        print("Total:",pages,"pages")
        for page in range(1,pages+1):
            pageurl=url+"&page="+str(page).strip()
            print("第",page,"頁",pageurl)
            showpage(pageurl,kind)
    except:
        showpage(url,kind)

def showpage(url,kind):
    html=requests.get(url,headers=headers).text
    sp=BeautifulSoup(html,"lxml")
    res=sp.find_all("div",{"class":"mod type02_m047_m054_wrap clearfix"})[0] #mod_a clearfix / mod type02_m012 clearfix
    items=res.select(".item")
    n=0
    for item in items:
        msg=item.select('.msg')[0] 
        title=msg.select('a')[0].text
        author=msg.select('a')[1].text
        publish=msg.select('a')[2].text
        date=msg.find('span').text.split("：")[-1]
        onsale=item.select('.price .set2')[0].text
        content=item.select('.txt_cont')[0].text.replace(" ","").strip()
        listdata=[kind,title,author,publish,date,onsale,content]
        list1.append(listdata)
        n=n+1
        print("n=",n)
        


def twobyte(kindno):
    kindnostr="01020"+str(kindno)
    return kindnostr


import requests
from bs4 import BeautifulSoup
import openpyxl
from time import sleep

list1=[]
kindno=1
homeurl="https://www.books.com.tw/web/books_bmidm_0102/?o=1&v=1"
mode="/?o=1&v=1"
url="https://www.books.com.tw/web/sys_bbotm/books/"
headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'}
html=requests.get(homeurl,headers=headers).text
sp=BeautifulSoup(html,"lxml")

res=sp.find("ul",class_="sub")
hrefs=res.select("a")
kindno=int(input("請輸入要下載的分類:"))
if 0 < kindno <= len(hrefs):
    kind=hrefs[kindno-1].text
    print("下載的分類編號:{} 分類名稱：{}".format(kindno,kind))
    kindurl=url+twobyte(kindno)+mode
    print(kindurl)
    showkind(kindurl,kind)
    
    print("資料寫入中，請稍等")
    workbook=openpyxl.Workbook()
    sheet=workbook.worksheets[0]
    listtitle=["分類","書名","作者","出版社","出版日期","優惠價","內容"]
    sheet.append(listtitle)
    for item1 in list1:
        sheet.append(item1)
        sleep(0.1)
    workbook.save("book-1228.xlsx")
else:
    print("分類不存在")
print("資料儲存完畢")


IndexError                                Traceback (most recent call last)
~\AppData\Local\Temp/ipykernel_2940/4062216474.py in showkind(url, kind)
      9             print("第",page,"頁",pageurl)
---> 10             showpage(pageurl,kind)
     11     except:

~\AppData\Local\Temp/ipykernel_2940/4062216474.py in showpage(url, kind)
     16     sp=BeautifulSoup(html,"lxml")
---> 17     res=sp.find_all("div",{"class":"mod type02_m047_m054_wrap clearfix"})[0] #mod_a clearfix / mod type02_m012 clearfix
     18     items=res.select(".item")

IndexError: list index out of range

During handling of the above exception, another exception occurred:

IndexError                                Traceback (most recent call last)
~\AppData\Local\Temp/ipykernel_2940/4062216474.py in <module>
     60     kindurl=url+twobyte(kindno)+mode
     61     print(kindurl)
---> 62     showkind(kindurl,kind)
     63 
     64     print("資料寫入中，請稍等")

~\AppData\Local\Temp/ipykernel_2940/4062216474.py in showkind(url, kind)
     10             showpage(pageurl,kind)
     11     except:
---> 12         showpage(url,kind)
     13 
     14 def showpage(url,kind):

~\AppData\Local\Temp/ipykernel_2940/4062216474.py in showpage(url, kind)
     15     html=requests.get(url,headers=headers).text
     16     sp=BeautifulSoup(html,"lxml")
---> 17     res=sp.find_all("div",{"class":"mod type02_m047_m054_wrap clearfix"})[0] #mod_a clearfix / mod type02_m012 clearfix
     18     items=res.select(".item")
     19     n=0

IndexError: list index out of range



標題:Python request.get問題
標籤:python 

Python新手 請各位幫幫忙
我用Python寫Raspberry pi 要呼叫 Arduino
於是我寫了這幾行程式
import requests
r = requests.get('http://192.168.130.108/gpio/0',timeout=3=)
print(r.status_code)
在requests.get這行執行的時候會出現錯誤代碼，但get有成功(Arduino有接收到並且LED燈亮起)
收到的錯誤代碼如下連結內的圖片
https://imgur.com/a/yzeeLnT
但我如果把網址換成https://www.google.com.tw/
就不會出現錯誤。
初學Python還不太會看錯誤碼，請救救我 謝謝


標題:python問題發問
標籤:python python系列文章 python入門 

小明在今年年初的時候買了牛年的生肖高粱酒，高粱酒的價格為10,000元，生肖高粱酒放越久會越值錢，每瓶高粱酒每年以升值5%下去計算，寫一個程式，將牛年生肖酒的逐年價格列印出來，直到隔年鼠年年末
承上題，小明想要知道他要花多少年這一瓶牛年高粱酒的總價值才會超過30,000元?請列印出在哪一年的年末以及該年之高粱酒價值為何?


標題:在爬網站的時候, 如何判斷影片是否有撥放
標籤:測試 python selenium webdriver 

各位前輩好,
想請問我用python + selenium webdriver 操作youtube 網站
雖然我點了video, 但要怎麼知道影片到底有沒有撥放?
因為我從html裡面好像看不出什麼端倪
謝謝, 從時間軸有看到東西了
那我想問另一個 HTML5 video 這種
沒有像youtube這樣, 又該怎麼解析呢? 感謝


標題:(python FLASK 新手發問) html 讀寫 EXCEL ?
標籤:python flask 

請問 我想要用 python FLASK 寫一個 html網頁 去讀寫 EXCEL .
那我要用 PHP , python ,html 哪一種語言去抓比較 大眾?出問題網路比較找的到資料解決?
感謝~~~
以解決~
感謝 ㊣浩瀚星空㊣ 大 ^^b
html確實是前端.
我了解了,來用PHP寫看看 XD
新手期間不能回應 不能傳訊息 所以回在這裡 ~_~


標題:為甚麼一般陣列運算完print出來會有"逗號"，numpy沒有?
標籤:python入門 numpy 

近期初學編程，練習過程中，發現一般陣列進行四則運算，print出來會有"逗號"；numpy則沒有，為甚麼會有這樣的差異?



標題:python~~
標籤:python 

#2. (1) 建立空字串rever
#2. (2) 於螢幕'輸入一小寫英文詞 ', 並存在物件word中
#2. (3) 用length存word的長度
#2. (4) 用含有3個參數的range(,,)函數, 將word的字母由後往前加到rever中
#2. (5) 於螢幕輸出字串rever, 如下兩列的結果
#2. 輸入一小寫英文詞 god
#2. dog
求求大神救救我


標題:ModuleNotFoundError
標籤:scrapy python import modulenotfounderror 

小弟最近在學習 scrapy
在使用 items.py 的時候碰到 ModuleNotFoundError
使用 pycharm 進行 improt 的時候並不會報錯
執行 scrapy crawl 的時候才會產生錯誤訊息
想上來版上詢問
以下是檔案目錄結構、發生錯誤的那行 code 以及錯誤訊息


spiders 目錄下的 huashan.py



PS C:\Users\bear\Desktop\traveler\crawler> scrapy crawl huashan
Traceback (most recent call last):
  File "C:\Users\bear\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "C:\Users\bear\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "C:\Users\bear\Desktop\traveler\venv\Scripts\scrapy.exe\__main__.py", line 7, in <module>
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\cmdline.py", line 144, in execute
    cmd.crawler_process = CrawlerProcess(settings)
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\crawler.py", line 280, in __init__
    super().__init__(settings)
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\crawler.py", line 152, in __init__
    self.spider_loader = self._get_spider_loader(settings)
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\crawler.py", line 146, in _get_spider_loader
    return loader_cls.from_settings(settings.frozencopy())
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\spiderloader.py", line 67, in from_settings
    return cls(settings)
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\spiderloader.py", line 24, in __init__
    self._load_all_spiders()
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\spiderloader.py", line 51, in _load_all_spiders
    for module in walk_modules(name):
  File "c:\users\bear\desktop\traveler\venv\lib\site-packages\scrapy\utils\misc.py", line 80, in walk_modules
    mod = import_module(path)
  File "C:\Users\bear\AppData\Local\Programs\Python\Python310\lib\importlib\__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 992, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1004, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'crawler'
PS C:\Users\bear\Desktop\traveler\crawler>



標題:目前遇到一些return不出數值的情況 ((LeetCode問題 38. Count and Say ))
標籤:python3 #新手求指導 #leetcode #backtrack python 

問題網址: [https://leetcode.com/problems/count-and-say/]
本小弟目前已經解題完成，但是遇到一些疑問，這是我的程式碼。
class Solution(object):
        def countAndSay(self, n):
            if n == 1:  return '1'
            ans = '1'
            for _ in range(1, n):
                ans = self.DD(ans)
            return ans

        def DD(self, s:str):
            ans = ''
            curr = 1
            for i in range(1, len(s)):
                if s[i] == s[i - 1]:
                    curr += 1
                else:
                    ans += str(curr) + s[i - 1]
                    curr = 1

            ans += str(curr) + s[-1]
            return ans

在n = 5 的情況下，答案應該輸出:

而在去掉倒數第二行 ans += str(curr) + s[-1] 的情況下，輸出卻變成了:

最差的情況應該不是少了幾位數字而不是直接空白，請問有大大能夠替我解答嗎?


標題:用正則取得要的部分
標籤:python 正則表達式 正規表示法 

這是我自己寫的正則
i=""
it = re.search('\[(\(?[^](]*)\]* [^[]',i)
print(it.group(1),"\n")

目前確認可以匹配
[要的部分 (不要的)] 不要的 [不要的] [不要的]
[要的部分] 不要的 [不要的] [不要的]
[要 的 部 分 (不要的)] 不要的 [不要的] [不要的]
[要 的 部 分] 不要的 [不要的] [不要的]

但是偶爾會出現這種無法匹配的
或缺少的
有方法改良嗎?
[要的部分(不要的)] 不要的 [不要的] [不要的]
[要 的 部 分(不要的)] 不要的 [不要的] [不要的]




標題:pyqt5 listview 
標籤:python3 pyqt5 listview 

我試著連到網路位置去搜尋pdf檔並用chrome開啟，但奇怪的是第二次搜尋程式會開啟兩個pdf
第三次就會開啟三個pdf，下列程式碼是參考網路上的做法，請各位大神指教!





標題:利用python將程式設計為可以重複詢問使用者鍵與值，並加入字典，直到輸入end才結束程式
標籤:python 

班上成績的字典如下:
Class={"Rena"=65,"Cypher"=72,"Sova"=88,"Omen"=92,"Jett"=43,"Viper"=90,"Killjoy"=39}
將程式設計為可以重複詢問使用者鍵與值，並加入字典，直到輸入end才結束程式


標題:v.s code python偵錯設定檔的路徑無效
標籤:#vscode #python 

我的vscode只要一編譯就會跳出這行 請問該如何解決?


標題:Python for 迴圈問題
標籤:python入門 


all_user_name = input("請輸入名字:")
len_s = len (all_user_name)
start = 0
for i in range(len_s) :
if all_user_name[i] == " ":
all_user_name=all_user_name[start:i-1]
print("Hi"+all_user_name)
start = i+1
可以請各路大神幫小弟找出所寫的程式到底哪裡出了問題?


標題:python 問題須解決
標籤:#python #while 

在執行時會先詢問是否要玩猜數字的遊戲?若輸入y或是yes，則開始遊戲。程式中預先設定好1個1-10的數字做為謎底，然後每次執行讓使用者任意挑選一個數字，並持續詢問，直到猜中數字為止。如果猜中數字，則程式會顯示恭喜的訊息，然後再次詢問是否要繼續此遊戲，若輸入y或yes，則程式會重複上述動作，若輸入其他字元，則結束程式。


標題:python 修改成績後該如何回到串列
標籤:python 

這是已經先打出來的部分 想要在修改完成績後，用其他功能看到修改後的成績
list0=["1號 ","2號 ","3號 ","4號 ","5號 "]
list1= [90,88,92,60,70]
choice = int(5)
def fuc1():
print("依照座號排列結果 :")
for i in range(0,5):
print(list0[i],str(list1[i])+"分")
print()
def fuc2():
print("依照分數排列結果 :")
list1new = sorted(range(len(list1)), key=lambda k: list1[k], reverse=True)
for j in range(0,5):
 print(list0[list1new[j]], str(list1[list1new[j]])+"分")

def fuc3():
s = int(input("請輸入成績："))
howmany = list1.count(s)
print("%d分的人共有%d人"%(s,howmany))
if (s==90):
print("座號為：", list0.pop(0))
elif (s==88):
print("座號為：", list0.pop(1))
elif (s==92):
print("座號為：", list0.pop(2))
elif (s==60):
print("座號為：", list0.pop(3))
elif (s==70):
print("座號為：", list0.pop(4))
else:
print("並沒有這個分數的座號")
print()
def fuc4():
sit = int(input('請輸入要看分數的同學座號：'))
if (sit==1):
print("%d號同學的成績為：%d分"%(sit,list1.pop(0)))
elif (sit==2):
print("%d號同學的成績為：%d分"%(sit,list1.pop(1)))
elif (sit==3):
print("%d號同學的成績為：%d分"%(sit,list1.pop(2)))
elif (sit==4):
print("%d號同學的成績為：%d分"%(sit,list1.pop(3)))
elif (sit==5):
print("%d號同學的成績為：%d分"%(sit,list1.pop(4)))
else :
print("並沒有此座號~")
print()
def change():
fix=int(input("請輸入要更改分數的座號："))
fixs=int(input("請輸入修改的分數："))
if (fix==1):
print("%d號原本的成績為：%d分"%(fix,list1.pop(0)))
print("%d號「更新」後的成績為：%d分"%(fix,fixs))
elif (fix==2):
print("%d號原本的成績為：%d分"%(fix,list1.pop(1)))
print("%d號「更新」後的成績為：%d分"%(fix,fixs))
elif (fix==3):
print("%d號原本的成績為：%d分"%(fix,list1.pop(2)))
print("%d號「更新」後的成績為：%d分"%(fix,fixs))
elif (fix==4):
print("%d號原本的成績為：%d分"%(fix,list1.pop(3)))
print("%d號「更新」後的成績為：%d分"%(fix,fixs))
elif (fix==5):
print("%d號原本的成績為：%d分"%(fix,list1.pop(4)))
print("%d號「更新」後的成績為：%d分"%(fix,fixs))
else :
print("並沒有此座號~")
print()
print('修改完成！')
while choice != 0:
print("    成績查詢系統")
print ("1. 依照座號，列出所有人的座號及分數 (座號由低到高)")
print ("2. 依照分數，列出所有人的座號及分數 (分數由高到低)")
print ("3. 輸入成績，列出所有該分數的座號")
print ("4. 輸入座號，顯示該同學的分數")
print ("5. 輸入座號，修改分數")
print ("0. 離開")
choice = int(input("輸入選項: "))
if choice == 1:
fuc1()
elif choice == 2:
fuc2()
elif choice == 3:
fuc3()
elif choice == 4:
fuc4()
elif choice == 5:
change()
else:
print("請重新輸入0~5的數字")


標題:Python 印出總共有幾個
標籤:python 

n = int(input('請輸入一個整數: '))  # 得到輸入值 n
for i in range(1, n+1):
if i % 3 == 0 or i % 7 == 0:
print(i)
如果要print總共有幾個，而不是全部數字該如何寫。


標題:關於【Python爬蟲】提問
標籤:python 程式碼 網頁爬蟲 #新手疑問 

最近在自學python爬蟲，卻遇到了問題，想請求幫解惑，程式碼如下:


想抓取的是table class="itinerary-controls"底下的第一個tr，但總在第24行出現找不到的錯誤訊息，請問到底是哪裡出錯了?
錯誤訊息如下:

爬蟲的網址:https://www.railway.gov.tw/tra-tip-web/tip/tip001/tip112/querybytime


標題:pandas迴圈儲存
標籤:pandas append python 

如何把迴圈中的pd.DataFrame資料放在一起
from selenium import webdriver
import pandas as pd
path = "C:/Users/jin ru/Desktop/chromedriver.exe"
driver = webdriver.Chrome(path)

for a in range(1,2): 
    df2=pd.DataFrame()
    for page in range(8):
        path2="http://163.29.117.247/port/Portlist.asp?year1=2020&month1=09"+"&day1="+str(a)+"&timer1=01%3A00&timer2=23%3A55&sent=%BDT%A9w&offset="+str(page*40)
        driver.get(path2)
        data=pd.read_html(path2)
        data1_df=data[2]
        data2_df=data[3]  
         #刪除表格列
        data1_df= data1_df.drop([0], axis=0) 
        data2_df= data2_df.drop([0], axis=0)         

        #合併表格
        new_df=pd.concat([data1_df,data2_df],ignore_index=True)
        df2.append(new_df)
        if page == 8:
            break
        else:
            
            continue           
    print(df2)
          

上網頁取一天的表格資料，總共有7頁，每頁已處理好DataFrame資料，但是卻無法把7頁資料存放在一起。儲存出來的資料是空的?
Empty DataFrame
Columns: []
Index: []



標題:append遇到沒有匹配key的欄位如何自動補空值
標籤:python3 

這是我們要做專題所需要用到的資料
資料部分是用kaggle
https://www.kaggle.com/yelp-dataset/yelp-dataset?select=yelp_academic_dataset_business.json
使用其中的
yelp_academic_dataset_business.json"資料
想要把json轉成csv的格式，但也同時要拉第二層巢狀結構的資料上來
前3筆資料結構如下
[{'business_id': '6iYb2HFDywm3zjuRg0shjw',
  'name': 'Oskar Blues Taproom',
  'address': '921 Pearl St',
  'city': 'Boulder',
  'state': 'CO',
  'postal_code': '80302',
  'latitude': 40.0175444,
  'longitude': -105.2833481,
  'stars': 4.0,
  'review_count': 86,
  'is_open': 1,
  'attributes': {'RestaurantsTableService': 'True',
   'WiFi': "u'free'",
   'BikeParking': 'True',
   'BusinessParking': "{'garage': False, 'street': True, 'validated': False, 'lot': False, 'valet': False}",
   'BusinessAcceptsCreditCards': 'True',
   'RestaurantsReservations': 'False',
   'WheelchairAccessible': 'True',
   'Caters': 'True',
   'OutdoorSeating': 'True',
   'RestaurantsGoodForGroups': 'True',
   'HappyHour': 'True',
   'BusinessAcceptsBitcoin': 'False',
   'RestaurantsPriceRange2': '2',
   'Ambience': "{'touristy': False, 'hipster': False, 'romantic': False, 'divey': False, 'intimate': False, 'trendy': False, 'upscale': False, 'classy': False, 'casual': True}",
   'HasTV': 'True',
   'Alcohol': "'beer_and_wine'",
   'GoodForMeal': "{'dessert': False, 'latenight': False, 'lunch': False, 'dinner': False, 'brunch': False, 'breakfast': False}",
   'DogsAllowed': 'False',
   'RestaurantsTakeOut': 'True',
   'NoiseLevel': "u'average'",
   'RestaurantsAttire': "'casual'",
   'RestaurantsDelivery': 'None'},
  'categories': 'Gastropubs, Food, Beer Gardens, Restaurants, Bars, American (Traditional), Beer Bar, Nightlife, Breweries',
  'hours': {'Monday': '11:0-23:0',
   'Tuesday': '11:0-23:0',
   'Wednesday': '11:0-23:0',
   'Thursday': '11:0-23:0',
   'Friday': '11:0-23:0',
   'Saturday': '11:0-23:0',
   'Sunday': '11:0-23:0'}},
 {'business_id': 'tCbdrRPZA0oiIYSmHG3J0w',
  'name': 'Flying Elephants at PDX',
  'address': '7000 NE Airport Way',
  'city': 'Portland',
  'state': 'OR',
  'postal_code': '97218',
  'latitude': 45.5889058992,
  'longitude': -122.5933307507,
  'stars': 4.0,
  'review_count': 126,
  'is_open': 1,
  'attributes': {'RestaurantsTakeOut': 'True',
   'RestaurantsAttire': "u'casual'",
   'GoodForKids': 'True',
   'BikeParking': 'False',
   'OutdoorSeating': 'False',
   'Ambience': "{'romantic': False, 'intimate': False, 'touristy': False, 'hipster': False, 'divey': False, 'classy': False, 'trendy': False, 'upscale': False, 'casual': True}",
   'Caters': 'True',
   'RestaurantsReservations': 'False',
   'RestaurantsDelivery': 'False',
   'HasTV': 'False',
   'RestaurantsGoodForGroups': 'False',
   'BusinessAcceptsCreditCards': 'True',
   'NoiseLevel': "u'average'",
   'ByAppointmentOnly': 'False',
   'RestaurantsPriceRange2': '2',
   'WiFi': "u'free'",
   'BusinessParking': "{'garage': True, 'street': False, 'validated': False, 'lot': False, 'valet': False}",
   'Alcohol': "u'beer_and_wine'",
   'GoodForMeal': "{'dessert': False, 'latenight': False, 'lunch': True, 'dinner': False, 'brunch': False, 'breakfast': True}"},
  'categories': 'Salad, Soup, Sandwiches, Delis, Restaurants, Cafes, Vegetarian',
  'hours': {'Monday': '5:0-18:0',
   'Tuesday': '5:0-17:0',
   'Wednesday': '5:0-18:0',
   'Thursday': '5:0-18:0',
   'Friday': '5:0-18:0',
   'Saturday': '5:0-18:0',
   'Sunday': '5:0-18:0'}},
 {'business_id': 'bvN78flM8NLprQ1a1y5dRg',
  'name': 'The Reclaimory',
  'address': '4720 Hawthorne Ave',
  'city': 'Portland',
  'state': 'OR',
  'postal_code': '97214',
  'latitude': 45.5119069956,
  'longitude': -122.6136928797,
  'stars': 4.5,
  'review_count': 13,
  'is_open': 1,
  'attributes': {'BusinessAcceptsCreditCards': 'True',
   'RestaurantsPriceRange2': '2',
   'ByAppointmentOnly': 'False',
   'BikeParking': 'False',
   'BusinessParking': "{'garage': False, 'street': True, 'validated': False, 'lot': False, 'valet': False}"},
  'categories': 'Antiques, Fashion, Used, Vintage & Consignment, Shopping, Furniture Stores, Home & Garden',
  'hours': {'Thursday': '11:0-18:0',
   'Friday': '11:0-18:0',
   'Saturday': '11:0-18:0',
   'Sunday': '11:0-18:0'}}]

目前我的程式碼如下
import pandas as pd
import json
path = "yelp_academic_dataset_business.json"
reviewList = []
i = 0
with open(path, 'r', encoding='utf-8') as f:
    try:
        
        while i<100:
            line_data = f.readline()
            if line_data:
                data = json.loads(line_data)
                reviewList.append({
                    'business_id': data['business_id'],
                    'name': data['name'],
                    'address': data['address'],
                    'city': data['city'],
                    'state': data['state'],
                    'postal_code': data['postal_code'],
                    'latitude': data['latitude'],
                    'longitude': data['longitude'],
                    'stars': data['stars'],
                    'review_count': data['review_count'],
                    'is_open': data['is_open'],
                    'attributes': data['attributes'],
                    'RestaurantsTableService': data['attributes']['RestaurantsTableService'],
                    'WiFi': data['attributes']['WiFi'],
                    'BikeParking': data['attributes']['BikeParking'],
                    'attributes': data['attributes']['BusinessParking'],
                    'categories': data['categories'],
                    'hours': data['hours']
                })
                i+=1
            else:
                break
    except Exception as e:
        print(e)
        f.close()
i
df = pd.DataFrame(reviewList)
df.to_csv('dataset_business3.csv')

顯示結果如下
'RestaurantsTableService'
輸出的csv資料也只有一行
如下圖

其原因是第二筆資料的['attributes']底下沒有['RestaurantsTableService']這個key
所以造成中斷了資料轉成csv
如果我想讓其如果這筆資料沒有這個key那就補空值或缺失值跑完所有資料，我該怎麼做
想要呈現的結果如下

另外這是在第二層結構下每筆資料可能key不相同

我想要append這筆資料遇到沒有的key自動補缺值讓我能順利輸出每筆資料
先行感謝各位大神


標題:Speech to Text  如何將錄音的檔案變成wav檔案
標籤:python pycharm speech_recognition 

使用的環境為python3.8 pycharm
經過測試
import speech_recognition as sr
r=sr.Recognizer()
test=sr.AudioFile('vatoy-qmmdj.wav')
with test as source:
audio=r.record(source)
print(r.recognize_google(audio,language='zh-tw'))
上列程式碼可以辨識出內容並精確翻譯
想請問 如果使用即時錄音
可以講預設的錄音檔mp3轉wav檔嗎
https://ithelp.ithome.com.tw/articles/10252078?sc=hot
中有提到相關的方向 不知有沒有在pycharm環境下直接設定的步驟
或是更改程式碼的可能


標題:python 抓取cpu溫度
標籤:python cpu 溫度 

最近因為一些原因，需要抓取cpu的溫度
但由於沒接觸過這部分，上網查詢資料後，得知要使用wmi
使用上面的程式碼
import wmi
w = wmi.WMI(namespace="root\wmi")
temperature_info = w.MSAcpi_ThermalZoneTemperature()[0]
print (temperature_info.CurrentTemperature)

總是出現
x_access_denied: <x_wmi: Unexpected COM Error (-2147217405, 'OLE error 0x80041003', None, None)>

想請問各位有這方面的相關內容可以參考嗎，還是有更好的方法來取得溫度


標題:巢狀結構json檔如何轉csv
標籤:python3 

這是我們要做專題所需要用到的資料
資料部分是用kaggle
2022_boston_gov_opendata : https://data.boston.gov/dataset/food-establishment-inspections/resource/4582bec6-2b4f-4f9e-bc55-cbaa73117f4c
因為檔案有6G多所以這邊先將前100筆放進list裡
import json
path = "yelp_academic_dataset_review.json"
reviewList = []
i = 0
with open(path, 'r', encoding='utf-8') as f:
    try:
        while i<100:
            line_data = f.readline()
            if line_data:
                data = json.loads(line_data)
                reviewList.append(data)
                i+=1
            else:
                break
    except Exception as e:
        print(e)
        f.close()
reviewList[:3]

可以得到資料結構大概是
[{'review_id': 'lWC-xP3rd6obsecCYsGZRg',
  'user_id': 'ak0TdVmGKo4pwqdJSTLwWw',
  'business_id': 'buF9druCkbuXLX526sGELQ',
  'stars': 4.0,
  'useful': 3,
  'funny': 1,
  'cool': 1,
  'text': "Apparently Prides Osteria had a rough summer as evidenced by the almost empty dining room at 6:30 on a Friday night. However new blood in the kitchen seems to have revitalized the food from other customers recent visits. Waitstaff was warm but unobtrusive. By 8 pm or so when we left the bar was full and the dining room was much more lively than it had been. Perhaps Beverly residents prefer a later seating.",
  'date': '2014-10-11 03:34:02'},
 {'review_id': '8bFej1QE5LXp4O05qjGqXA',
  'user_id': 'YoVfDbnISlW0f7abNQACIg',
  'business_id': 'RA4V8pr014UyUbDvI-LW2A',
  'stars': 4.0,
  'useful': 1,
  'funny': 0,
  'cool': 0,
  'text': 'This store is pretty good. Not as great as Walmart (or my preferred, Milford Target), but closer and in a easier area to get to.  \nThe store itself is pretty clean and organized, the staff are friendly (most of the time), and BEST of all is the Self Checkout this store has! \nGreat clearance sections throughout, and great prices on everything in the store, in general (they pricematch too!). ',
  'date': '2015-07-03 20:38:25'}]

目前想用類似這樣的方式，做for迴圈
reviewList[55]['review_id']

單筆打印是成功的
'z-6ElnK3yXpn2oNKR7NYtw'
但是想把每列排進去就開始抱錯!
s="review_id,user_id,business_id,stars,useful,funny,cool,text,date\n"
for i in reviewList:
    
    s=s+"{},{},{},{},{},{},{},{},{}\n".format(reviewList[i]['review_id'],reviewList[i]['user_id'],reviewList[i]['business_id'],reviewList[i]['stars'],reviewList[i]['useful'],reviewList[i]['funny'],reviewList[i]['cool'],reviewList[i]['text'],reviewList[i]['date'])

(這部分)出現下方錯誤
TypeError                                 Traceback (most recent call last)
~\AppData\Local\Temp/ipykernel_15668/4124199551.py in <module>
      3     #list2=list(dict())
      4     #print(list2)
----> 5     s=s+"{},{},{},{},{},{},{},{},{}\n".format(reviewList[i]['review_id'],reviewList[i]['user_id'],reviewList[i]['business_id'],reviewList[i]['stars'],reviewList[i]['useful'],reviewList[i]['funny'],reviewList[i]['cool'],reviewList[i]['text'],reviewList[i]['date'])

TypeError: list indices must be integers or slices, not dict

改成for i in range(len(reviewList)):以解決
最後存成csv
fw=open("review.csv","w", encoding='utf-8')
fw.write(s)
fw.close()


但發現檔案輸出結果不是我要的

原因是text的欄位出現許多\n換行符號，
'text': 'This store is pretty good. Not as great as Walmart (or my preferred, Milford Target), but closer and in a easier area to get to.  \nThe store itself is pretty clean and organized, the staff are friendly (most of the time), and BEST of all is the Self Checkout this store has! \nGreat clearance sections throughout, and great prices on everything in the store, in general (they pricematch too!). '

導致檔案欄位沒有對齊，想請問如何解決這個問題，先說謝謝，感謝


標題:使用while迴圈，在def函式中間加入ping的判斷
標籤:python入門 selenium def while ping 

請問各位大神
小弟因工作需求才開始接觸python selenium自動化測試，level:幼幼班
所使用的是while迴圈
想寫的是:
在def函式的中間加入一段ping的判斷式
ping成功則繼續往下將def函式跑完
ping失敗即停止
加入的位置如圖片所示
請問我該如何去實現



標題:python list問題  (解決)
標籤:python python入門 

想請問大家有沒有辦法讓兩個串列能互相呼應？
想要做出照分數排列由高到低，但只會做分數的，不清楚字串要如何跟著一起排列
list0=["1號 ","2號 ","3號 ","4號 ","5號 "]
list1= [90,88,92,60,70]
print("依照分數排列結果 :")
list1new=sorted(list1,reverse=True)
for j in range(0,5):
print(list0[j],str(list1new[j])+"分")
要呈現的樣子：
3號 92分
1號 90分
2號 88分
5號 70分
4號 60分


標題:請問一下這個爬蟲該如何更改才可以把我同意去掉呢?
標籤:python 

如提，小弟最近在寫爬蟲結果他有一個cookie要點選我同意，然而新增了cookie後卻還是依樣出現我同意該如何新增呢?
使用find_class_name 會報錯
請問各位大大，我該如何修改呢?




標題:有沒有大神用過sysrepo?
標籤:python3 python sysrepo ubuntu 

各位前輩好，不知沒有沒熟悉sysrepo這個package的
我想執行此GitHub中的範例(python的)：
https://github.com/sysrepo/sysrepo-python/tree/master/examples
結果如下：

我的linux(Ubuntu)環境已經成功安裝libyang和sysrepo了。附圖為兩個測試的terminal， 希望是能在terminal1 執行applycation.py, 在terminal 2 執行 sysrepocfg.py後, terminal1也能在看到terminal2中變更。現在問題是，terminal 2 中sysrepocfg.py 的後面要放什麼？
我嘗試python3 sysrepocfg.py -R "datastore"，卻只得到error
該github頁面也沒有給予instruction
現在很沒有頭緒，能否提示本人該從哪裡做起，謝謝!


標題:如何在虛擬主機上執行selenium webdriver
標籤:#python #selenium selenium webdriver cpanel 

哈囉各位大大打擾 我是一個Python新手，
最近閒暇之餘寫了一個Line Chatbot，使用的是Godaddy的虛擬主機
Chatbot裡面寫了一段爬蟲程式使用了selenium的webdriver
在本機執行都正常，不過放到虛擬主機上執行這段會發生錯誤
Message: Service chromedriver unexpectedly exited. Status code was: 1

大概是這樣使用
import chromedriver_binary
from selenium import webdriver

url = "https://www.######.com.tw"
driver = webdriver.Chrome()
driver.get(url)

...

不知道是哪裡出了問題，或是有需要提供什麼更詳細的資訊
12.01補充: 我是使用django框架


標題:'module' object is not callable (python)
標籤:python3 python入門 python系列文章 網路爬蟲 網頁爬蟲 

想做一個簡單叫出google的功能
估狗很多方法debug還是無解...

錯誤代碼

python新手, 請大家幫幫忙, 謝謝大家


標題:python pytesseract  圖片無法辨識
標籤:python pytesseract 

這是我的程式碼
import pytesseract as pt
from PIL import Image
pt.pytesseract.tesseract_cmd = r"C:\Program Files\Tesseract-OCR\tesseract.exe"
img = Image.open('123.png')
text = pt.image_to_string(img)
print(text)
這是我的圖片

不知道為何輸出都是一片空白，是我的圖片有問題，還是根本無法辨識呢?
這是我的輸出結果



標題:求救求救！python！！
標籤:python radom 亂數 python系列文章 python入門 

請設計一個能夠比數字大小的函式
利用亂數函式來決定程式要出什麼數字
輸入會有兩個整數Ｚ
第一個數為決定範圍右邊界的數字，左邊界預設為0
第二個數為你要出的數字
範例輸入：
5 2
範例結果：
我出1
你贏了
範例輸入：
10 0
範例結果：
我出2
你輸了
範例輸入：
1 0
範例結果：
我出0
你跟我心意相通
範例輸入：
1 1
範例結果：
你的數字不在範圍內
範例輸入：
-1 5
範例結果：
empty range for randrange() (0,0, 0)


標題:Python 轉換日期時間
標籤:python timestamp 

問題描述:
在一個dataframe的timestamp欄位裡，時間日期的格式如下:

2021-NOV-07-15_43

需求:
轉換時間日期格式為:

%Y%m%d-%H%M
20211107-1543

請問要怎麼把字母的月份(Jan-Dec)轉換成數字月份，並且把底線的時間15_43改成1543，謝謝!


標題:python 3. (anaconda)安裝lightgbm出現錯誤（Mac)
標籤:python3 anaconda 

安裝完成出現下錯誤訊息
網路搜尋試了好多方式還是一樣
有人有解決的方法嗎
求解，謝謝
Traceback (most recent call last):
File "", line 1, in 
File "/opt/anaconda3/lib/python3.8/site-packages/lightgbm/init.py", line 8, in 
from .basic import Booster, Dataset, Sequence, register_logger
File "/opt/anaconda3/lib/python3.8/site-packages/lightgbm/basic.py", line 110, in 
_LIB = _load_lib()
File "/opt/anaconda3/lib/python3.8/site-packages/lightgbm/basic.py", line 101, in _load_lib
lib = ctypes.cdll.LoadLibrary(lib_path[0])
File "/opt/anaconda3/lib/python3.8/ctypes/init.py", line 459, in LoadLibrary
return self._dlltype(name)
File "/opt/anaconda3/lib/python3.8/ctypes/init.py", line 381, in init
self._handle = _dlopen(self._name, mode)
OSError: dlopen(/opt/anaconda3/lib/python3.8/site-packages/lightgbm/lib_lightgbm.so, 6): no suitable image found.  Did find:
/opt/anaconda3/lib/python3.8/site-packages/lightgbm/lib_lightgbm.so: mach-o, but wrong architecture
/opt/anaconda3/lib/python3.8/site-packages/lightgbm/lib_lightgbm.so: mach-o, but wrong architecture


標題:異常檢測田納西伊士曼過程(TEP)之LSTM
標籤:pse lstm 分類 python keras 

各位學長學姊大家好，小弟正在自學LSTM處理分類問題。
我想要重現
https://medium.com/@mrunal68/tennessee-eastman-process-simulation-data-for-anomaly-detection-evaluation-d719dc133a7f
這一篇文章中的結果
使用作者在GitHub提供的code
https://github.com/mrunal46/TEP-Fault-Detection
我有稍微修改TEP-1.ipynb裡面的參數
依據https://github.com/mrunal46/TEP-Fault-Detection/issues/1 的建議
 #修訂後改(1,25) 成 (1,26)
 #修訂後改(26,35) 成 (26,36)
 #修訂後改[160:660] 成 [160:640]
三個迴圈裡面的frame.append(b_i) 我都沒有註解掉
如此得到三個scv檔train,test,cv
接著執行第二個程式LSTM的時候，會出現下列訊息


我該如何修正這個錯誤，才能夠重現作者跑出來的結果？
ps：我是不是應該照https://github.com/mrunal46/TEP-Fault-Detection/issues/1 的建議把frame.append(b_i) 註解掉才正確？
但就算我全部跑原作者未修改的code，程式也無法執行。
我自己弄好久了都搞不定，請求各位大神幫忙解惑，謝謝。


標題:SQLite JSON 型態的欄位無法寫入中文
標籤:sqlite json sqlalchemy python 中文亂碼 

如題，想詢問版上有沒有人有碰過類似的情況有解呢?
附上程式碼:
# -*- coding: utf-8 -*-
import json
from data_struct import Test, create_session
from pprint import pprint

with open("./test_data.json", encoding="utf8") as f:
    data = json.load(f)

    session = create_session()
    for row in data[0]["result"]["records"]:
        data_obj = {"records": row}
        session.add(Test(**data_obj))
        session.commit()
        print(row)
    session.close()

output:



標題:celery 強制停止任務
標籤:celery revoke 非同步 python 排程 

如題，小弟最近在學習 celery 的使用方式，有看到可以使用
revoke 來將任務標記為取消，目前的疑問是將原本排定一天後要執行的任務
標記為 revoke 後，celery 會等到一天後才正式將該 task 取消，
想詢問有沒有辦法可以直接取消不需要等到一天後。
目前環境:
O.S. = windows 10
broker = redis (with docker)
backend = mysql (with docker)


標題:python 成績查詢問題
標籤:建立一個字典記錄同學的成績 成績 python 查詢 

建立一個字典記錄同學的成績
內容如下：
林小明:85
曾山水:93
鄭美麗:67
輸入一個同學的姓名，如果這位同學有在字典裡面的話則輸出他的成績
沒有的話則建立一個新的鍵，並讓使用者輸入其值
輸入：
輸入學生姓名：
---林小明
輸出：
林小明的成績為85
輸入：
輸入學生姓名：
---abc
輸入學生分數：
---100
輸出：
字典內容：{'林小明': 85, '曾山水': 93, '鄭美麗': 67, 'abc': '100'}


標題:無法爬取商品銷售量且出現錯誤碼
標籤:#python #json #api 


想要爬取下方內容裡的numSoldTickets但語法錯誤，想請問要如和修正才能爬取，謝謝!


標題:MS SQL Server 公司內網建置database 與 python 自動更新表格
標籤:sqlserver python3 

背景:
本身略懂python資料自動化和MS SQL Server的使用，但並不是專業IT。找到外包商做資料庫管理前，目前需要替公司建立一個短期的SQL Server資料庫，讓同事們能進入搜尋，並匯入analytics tool做資料分析。
需求:
資料都是由獨立的csv檔案匯集在微軟的SharePoint上，目前使用python自動化小程式，定期下載最新csv並merge成一個Excel或導入至Access，再上傳到SharePoint讓同事使用。未來需要把這個流程改為建立在SQL Server並讓同事們透過內網連進公用電腦搜尋資料。
問題:

免費的SQL Server Express 2019是否能夠將資料庫建立在24小時開啟的公用電腦，並讓同事透過內網連進資料庫? 比方說在Server Name打上xxx.xxx.xxx.xxx\SQLEXPRESS即可連線?
每一個原始的csv檔案含有多個產品資料，會在2-3天內再度被新資料overwrite，如果寫一個Python自動化程式搜尋過去24小時被更新的檔案可以傳入當天csv檔案到SQL Server中，但隔天若有新資料在更新在原始的csv會導致資料庫產生duplicates在同一個產品上，想請問有什麼解決辦法能夠直接overwrite SQL Server同一筆產品資料而不產生duplicate?



標題:如何用pyhton在網頁中呈現可互動的資料視覺化圖形
標籤:python html 

目前用flask架設了一個網頁
後端都用python開發
在網頁輸入搜尋條件後，後端取得資料
並使用python的matplotlib畫好存成png
再將png圖片顯示在網頁上
但現在user希望能夠有像matplotlib內建的圖片呈現
可以動態調整圖片局部縮放、X、Y軸刻度密度調整的功能
上網搜尋了一下matplotlib在網頁的應用
大多都是像我一樣畫好存圖，再呈現到網頁上
有沒有甚麼方法可以在網頁使用matplotlib的這些功能
或是python有其他的模組可以做到類似的事情
另外上網查了之後有看到D3.js這個JS庫似乎能做到這件事
但我對JS語法不太熟悉，撈資料這部分也要重新研究
開發成本有點高，是下下策...


標題:安裝selenium一直出現error
標籤:python3 python selenium 

不太知道為什麼會出現這樣的問題
有人知道要怎麼辦嗎



標題:Python requests 時報錯 certificate verify failed
標籤:#爬蟲 python 反爬蟲 requests wget 

想請問版上大神，前些日子在利用 requests 進行爬蟲時碰到以下問題，
上網查了一下還是不太清楚如何解決，有檢查過環境內有安裝 certifi 模組，
也有試過使用代理 IP，但還是無法解決，想上來問一下有沒有甚麼解法
附上程式碼:
在第二個 requests 的時候出錯
url = "https://data.gov.tw/dataset/146529"
res = requests.get(url)
soup = BeautifulSoup(res.text, "lxml").find_all("script")[0].text
download_url = json.loads(soup)[1]["distribution"][0]["contentUrl"]

res = requests.get(download_url)  # 在這行出錯
print(res.headers)

附上第二個 requestes 的 url:
直接點 url 是能正常下載的
https://apiservice.mol.gov.tw/OdService/download/A17000000J-030268-CMF

附上錯誤訊息:
HTTPSConnectionPool(host='apiservice.mol.gov.tw', port=443): Max retries exceeded with url: /OdService/download/A17000000J-030268-CMF (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:997)')))



標題:python json dumps 一問
標籤:json python3 

大家好,
請問一下如果dictionary 有800000 以上的record, 寫進json花幾天都沒寫完, 如果在不能用database情況下有什麼方法可以更快, 如果要分開json 的話, 在前台寫回完整一個json 也是花時間, 真的不太想到.
謝謝大家幫忙.


標題:有關python write file progress一問
標籤:python3 

大家好, 請問一下如何可以寫一個progress bar 來看file write 了多少,
tqdm 可以怎樣寫, 但網上沒有提過可以用tqdm, 有其他的方法嗎?
謝謝
with open('testing3.geojson', 'w') as f:
f.write(json.dumps(fd,cls=NpEncoder,sort_keys=False, indent=4))


標題:pycharm建立舊版python的環境
標籤:python pycharm 

下載初始的pycharm版本的python是3.9
試過改成3.7成功
但是在改成3.6時有檔案的問題
網路上的解法大部分都沒有詳細教學
麻煩各位大神幫幫忙


標題:<問題>python程式放到localhost上執行bug?
標籤:#python #php #html #cv2 

我需要將python程式放到localhost上執行(因為網頁是php)
abc.py 程式如下
#!D:\Anaconda3\python.exe
import os
import urllib.parse

import numpy as np
import sklearn
import joblib
import cv2
import white_ball as WB
import requests
    
pred=WB.white_ball()

print("Content-Type: text/html\n")
print('Success!')
print('<input value="133" />')

我有先在spyder上執行
結果如下

有印出pred是balance.jpg，且在預設路徑上也有輸出balance_balance.jpg的圖檔
但是在localhost上執行時

是發生錯誤的
然後我試著將
pred=WB.white_ball()註解掉再到localhost上執行
其他的結果是有出來的

而我也有單獨執行white_ball的程式
是有印出balance.jpg且在預設路徑上也有輸出balance_balance.jpg的圖檔
white_ball.py最後一行程式碼是
cv2.imwrite("balance_"+ line[0],balance_img)

想知道問題是出在哪裡
為何在localhost上會印不出balance.jpg且無法預設路徑上輸出balance_balance.jpg的圖檔
(已有將錯誤訊息malformed header from script 'abc.py': Bad header:balance.jpg上網查過 但無找到能解決我問題的解法)


標題:python  matplotlib x軸日期範圍顯示錯誤
標籤:python matplotlib plot 

大家好
我正在撰寫股票爬蟲程式
透過yfinance取得股價資料
在利用matplotlib來繪圖
但是為什麼matplotlib x軸日期範圍是錯誤的
(2007-01-11~2007-01-17)?
matplotlib x軸正確日期範圍應該是要輸出
(2021-11-03~2021-11-12).
我嘗試解決這個問題，但是仍然無法找出原因順利解決
希望大家可以給予協助!! Thank you
程式碼:
import yfinance as yf
import matplotlib.pyplot as plt
import pandas as pd
import matplotlib.dates as mdates 
startday = '2021-11-03' 
endday = '2021-11-12' 
ticker_list = ['2303.TW','2610.TW','2618.TW'] 
data = pd.DataFrame(columns=ticker_list) 
for ticker in ticker_list: 
 data[ticker] = yf.download(ticker, startday,endday)['Adj Close']
ans=data.head()  
data.plot(figsize=(8,12)) 
plt.legend() 
plt.rcParams['font.sans-serif'] = ['Microsoft JhengHei'] 
plt.rcParams['axes.unicode_minus'] = False 
plt.title("股票7天內收盤價變化折線圖", fontsize=16) 
plt.ylabel('收盤價', fontsize=14) 
plt.xlabel('日期', fontsize=14) 
plt.grid(which="major", color='k', linestyle='-.', linewidth=0.5) 
fmt_day = mdates.DayLocator() # provides a list of days 
plt.gca().xaxis.set_major_locator(fmt_day) 
plt.gca().xaxis.set_major_formatter(mdates.DateFormatter("%Y-%m-%d")) 
plt.show()```



標題:python numpy ndarray 一問
標籤:numpy python3 

大家好, 想問一下我有個json,
[
[
[x,y]
[x,y]
[x,y]
[x,y]
[x,y]
]
]
如果
1.要除掉最外面
2.除掉最外兩層
要怎樣寫, 謝謝.


標題:python資料處理請教
標籤:python 資料處理 

下圖是資料表格，對應的資料有對應的條件，RESULT是我想得到的結果。
GROUP-R中，TYPE-A的分數計算為(GOATTIME0.3)
TYPE-B的分數計算為(GOATTIME0.5)
GROUP-W中，TYPE-A的分數計算為(GOATTIME0.4)
TYPE-B的分數計算為(GOATTIME0.3)


目前能想到的只有資料內沒有'/'的解決方法，想請益如果有'/'的話要如何處理，感激不盡！



標題:soup抓取工作內容 104 
標籤:python beautifulsoup 104 

大家好
最近想要爬104職缺的工作內容
舉例網址：https://www.104.com.tw/job/7bbe1?jobsource=jolist_b_relevance
我使用 selenium很快就能抓到想要的
但想利用靜態的 BeautifulSoup 做做看卻遇到了困難
抓下來的都是空的
例如圖中的「工作待遇」，我使用 h3節點下 class也為 h3
soup.find_all('h3', class_ = 'h3')

但抓出來卻沒有東西
想請問各位高手有什麼辦法能夠解決，或是我沒注意到什麼地方，請求開導



標題:python的arima序列預測問題
標籤:python python3 arima matplotlib 

我想請問一下
當我在作arima預測的時候
我的預測圖可以跑出來
但是預測的數字卻無法跑出來

另外我想詢問一下 是否有方法可以修改成
當我滑鼠指到哪裡 可以顯示當天的日期以及股價
以及
標註那兩條線的名稱 橘色是predict藍色是current_actual


標題:YOLO  V4環境建置
標籤:python yolov4 

想請問我在建立好yolo環境之後 進行測試
出現
Could not load library cudnn_cnn_infer64_8.dll. Error code 126
Please make sure cudnn_cnn_infer64_8.dll is in your library path!

該如何解決 網路爬文的方法目前都沒辦法解決
更新:
建置步驟是照影片https://www.youtube.com/watch?v=PVf16gIhnek&t=1898s
在cuda 和cudnn的下載部分我都是用目前最新的版本(cudnn前幾天釋出可支援cuda 11.5)
完整內容:



標題:python 一問
標籤:python3 

if isinstance(val, float):
        modval = float("{:.4f}".format(modval))
    elif isinstance(val,list):
        modval = ["%.4f" % elem for elem in val]

大家好, 想問一下如果要在
["%.4f" % elem for elem in val]
"%.4f" % elem 這個check if elem 是float才"%.4f"
可以怎樣寫,謝謝.


標題:python成績分析系統
標籤:python 程式設計 

題目：設計一個程式，由使用者連續輸入成績(成績輸入-1 以結束輸入)
結束輸入後，程式立即輸出
100分  ?人
90分~99分  ?人
80分~89分  ?人
.....
0分~9分  ?人
(其中一定要用while和串列)
如果想要用串列的索引值來下手的話要怎麼打?
scores = []
inscore = 0
b = int(inscore/10)#這邊想要把數字弄小一點再處理
while(inscore != -1):
inscore = int(input("請輸入學生的成績："))
if (inscore!=-1):
  scores.append(inscore)



標題:python gzip 和 js pako inflate 一問
標籤:python js 

大家好, 想問一下關於python 和JS的問題
首先就是因為我的geojson file 有800000支以上的record, 我用python 的gzip 把它轉成
ascii
with gzip.open('testing.geojson', 'w') as fout:
    fout.write(json.dumps(d).encode("utf-8"))


之後在js 那邊用pako 來inflate
readTextFile('./datasets/testing.geojson');

var allText = rawFile.responseText;
              
                console.log(Buffer.from(allText).toString('base64'))
                var byteArray = new Uint8Array(Buffer.from(allText).toString('base64'));
                //console.log(byteArray)
                setTimeout(function(){
                    alert("Unzipping data...")
                    result = pako.inflate(byteArray, {to: 'string'});
                    console.log(result)
                },2000)

但是在browser f12 裡看到result 是undefined, 請問哪一步我是寫錯了.
或者我不知道可不可以在python 那邊變成gzip , 再在js 那邊解壓GZIP, 但因為我本身是沒有用node.js , 只是用http server


標題:如何利用Python將PostgreSQL中的資料，提取並寫入Google Calendar
標籤:python postgresql google calendar 

請教版上各位前輩
目前已經透過 Google 提供的quickstart還有其他功能做出能成功新建與刪除等功能 https://developers.google.com/calendar/api/quickstart/python
接著面臨到該如何把原本存在資料庫裡的內容提取出來，並寫進Google Calendar 各個欄位
現在的想法是利用flask_sqlalchemy的SQLAlchemy中的功能來選取特定資料表
並且獲得資料庫中的參數來寫進calendar event中各個欄位中
不曉得這樣的方法有沒有使用錯誤的地方


標題:Python倒三角形星星
標籤:python 程式設計 

想用下面這個程式來打出倒三角形，雖然倒了但是沒有在中間都是靠側邊的，要改哪裡才行？
想要的樣子：











x=int(input("請輸入數字："))
for i in range(x,0,-1):
print("* "*i)
print(" ")


標題:python 可以reference dict 嗎
標籤:python 

請教一下大家, 下面的code 因為只有varDictAdd 和varDictExtAdd 是不同, 可以用php 的reference嗎, 還是有其他方法, 謝謝
for key in f.variables.keys():
                        if key == va:
                            # this dimensions refer to variable parameters
                            curDim = f.variables[key][:].ndim
                            if "nCells" in f.variables[key].dimensions:
                                if curDim == 3:
                                    for item in f.variables[key][:]:
                                        varDictAdd[key] = item
                                elif curDim <= 2:
                                    varDictAdd[key] = f.variables[key][:]
                            else:
                                if curDim == 3:
                                    for item in f.variables[key][:]:
                                        varDictExtAdd[key] = item
                                elif curDim <= 2:
                                    varDictExtAdd[key] = f.variables[key][:]



標題:python 處理程序會關閉不完全的問題
標籤:python pyinstaller 

目前利用selenium處理網頁並且是打包過後的執行
裡面也下了driver.quit();c_service.stop()
並且打包使用到--noconsole
但整個結束後處理程序還是會留著一個主控台視窗主機，每執行一次就多一個，該怎麼解決呢
如下圖


標題:pyaudio 執行問題
標籤:python系列文章 pip 

目前是用pycharm的環境 但無法利用程式中pip pyaudio
試過網路上提供的方法 利用終端機下載也失敗
ModuleNotFoundError: No module named 'pyaudio'


標題:python正則表達式模組re.sub，是否能將要替換的字串當作變數代入?
標籤:python 正則表達式 

我想要利用python正則表達式模組-re做字串替換，
具體來說，
欲將一個由英文、數字組成的字串，將數字找出來替換成星號，
例如:
import re
input_str = 'ab1c2d3'
regex = re.compile(r'(\d+)')
output = regex.sub('*', input_str)
print(output)

這樣可以將數字替換成*，得到結果ab*c*d*
但我想要的效果是根據數字決定*的數量，
如看到數字「2」就替換成「2個*」，
範例:
input: 'ab1c2d3'
output: 'ab*c**d***'

欲替換的字串本身想當作變數，用re模組是否能做到，
或有其它推薦的做法呢?謝謝


標題:heroku cleardb 無法使用
標籤:heroku cleardb database python 

小弟我在自己電腦上(windows)使用python存取heroku clearDB資料庫，可以正常存取，也都有讀取到資料，但是將程式上傳至heroku後，卻讀取不到資料一直顯示None，想請問一下該如何解決。





標題:Python pyAutoGUI 轉為EXE後無法辨示圖片
標籤:python pyautogui 

各位前輩大大午安，
小弟最近在測試圖像辨示後，輸入帳號、密碼及登入
在PYTHON上執行都可以順利，但是在轉成EXE後，就無法執行，
程式只會顯示「go」之後停住了。
但是若是直接在cmd內輸入python test.py，圖片都可以正常辨示及輸入帳密。
反而產生了exe後，無法正確執行。
我把錯誤給印出來了，會顯示
The confidence keyword argument is only available if OpenCV is installed.
主要錯誤是在
pic_val = pyautogui.locateOnScreen("img/program.png", confidence=0.99)
這行，但是PNG路徑都有圖。
import pyautogui
import os

os.popen("C:/Users/use/AppData/Local/THE/app.exe")

print("go")

# 以圖片搜尋程式是否啟動
pic_val = None
while pic_val is None:
    try:
        pic_val = pyautogui.locateOnScreen("img/program.png", confidence=0.99)
        if pic_val is not None:
            x, y = pyautogui.center(pic_val)
            print('Found pic @ x:', x , ' y:', y)
            pyautogui.click(pic_val)
            pyautogui.press('tab')
            pyautogui.typewrite('ADMIN')
            pyautogui.press('tab')
            pyautogui.typewrite('12345678')
            pyautogui.press('enter')
        # print(inv_settings)
            break
    except Exception as e:
            print(e)
            pass

print("finished")



標題:Python pose-estimation
標籤:python pose estimation cuda deep learning deeplearning 

最近小弟在找pose-estimation的範例，但試了好多種還是沒有辦法成功，有人可以推薦一些自己成功的範例嗎?
不自己寫是因為剛踏入影像辨識還不會，想先增廣見聞一下
安裝環境
作業系統: Windows10
顯示卡: NVIDIA GeForce RTX 1060
Python = 3.7.6
處理器:I7-7700HQ


標題:python 深度學習 錯誤訊息
標籤:python deep learning cuda gpu 

當我開始調用gpu做深度學習的時候
只要進行model.fit後便會出現
以至於我要將整個vscode關閉後重新開啟
Error: Session cannot generate requests
at w.executeCodeCell (c:\Users\lucie\.vscode\extensions\ms-toolsai.jupyter-2021.8.2041215044\out\client\extension.js:52:301310)
at w.execute (c:\Users\lucie\.vscode\extensions\ms-toolsai.jupyter-2021.8.2041215044\out\client\extension.js:52:300703)
at w.start (c:\Users\lucie\.vscode\extensions\ms-toolsai.jupyter-2021.8.2041215044\out\client\extension.js:52:296367)
at processTicksAndRejections (internal/process/task_queues.js:93:5)
at async t.CellExecutionQueue.executeQueuedCells (c:\Users\lucie\.vscode\extensions\ms-toolsai.jupyter-2021.8.2041215044\out\client\extension.js:52:311160)
at async t.CellExecutionQueue.start (c:\Users\lucie\.vscode\extensions\ms-toolsai.jupyter-2021.8.2041215044\out\client\extension.js:52:310700)

如果關閉調用gpu
import os

os.environ["CUDA_VISIBLE_DEVICES"] = "-1"

就可以正常使用
請問該如何解決這個問題?


標題:Python求解!  大神請幫幫忙
標籤:python 



標題:請教 - 關於geoplot安裝成功卻執行錯誤
標籤:python3 gis geoplot python python入門 

各位大大您們好
如題 當我下載好了Geoplot之後執行程式卻跑出

我上網查有人有類似的問題
裡面是說好像要加入環境變數
我試過之後還是一樣，所以上來請教各位大大
很抱歉第一次發文，哪裡做不好還請指教
謝謝各位大大
2021/10/29更新
各位大大好
這裡先感謝 海綿寶寶 大大的建議
小弟我這個問題
是先照著 海綿寶寶 大大的建議
三個都重裝過了 還是不行
後面我便用
conda install -c conda-forge fiona
conda install -c conda-forge gdal

卻發現 執行後又跑出關於這兩個的問題
於是上網爬文看看
後面發現 Fiona 和 GDAL 有些版本可能不能一起用
國外有人建議 版本用
Fiona-1.8.19 , GDAL-3.2.3
於是就用了
conda install -c conda-forge fiona=1.8.19
conda install -c conda-forge gdal=3.2.3

後面在照 海綿寶寶 大大的步驟重裝
在第二個 Rasterio 後就可以使用了
結論：
雖然當初安裝Geopandas 沒有Fiona、GDAL 的問題
Geopandas、Geoplot
這兩個都需要 Fiona、GDAL
但版本上 有些卻不能一起用
處理好 Fiona、GDAL、Rasterio
應該是沒有問題的
(同時提醒：pip 與 conda 不要混和用)


標題:可以幫我解讀一下這些code嗎？
標籤:python3 python系列文章 

> def myFunction():
>     return 24 - 12
>     
> print(myFunction())

為什麼要print的ㄋ
謝謝


標題:可以幫我解讀一下這些code嗎
標籤:python3 

def printHello(func):
    def wrapper():
        print('Hello')
        return func()
    return wrapper

@printHello
def printWorld():
    print('World')

printWorld()

我的疑問是 為什麼要return func() 然後再return wrapper??
哪位大大可以幫我解答 感謝


標題:python yaml 讀array
標籤:python yaml 

yaml檔裡面長這樣
id:0
array:[[1,1],[1,1],[1,1],[1,1]]

我想要他輸出
[[1,1],[1,1],[1,1],[1,1]]
我參考網路上的答案
with open('data.yaml', 'r') as f:
    data = yaml.load(f)
    print(data['array'])

然後就錯誤:
TypeError:list indices must be intergers or slices,not str
其他人的data都是dict，我的是list? 讀的方式都一樣


標題:Pyinstaller含有pandas就失敗
標籤:pyinstaller python 

在將python打包的過程中，同一個.py檔，在沒有import pandas時是可以成功打包的。但是只要import pandas後再打包就會出現 「tuple index out of range」,請問這種情況怎麼辦？
Pyinstaller是在github下載的,python版本3.10


標題:使用Python3的陣列處理資料問題。
標籤:#python3 

我是用Python3來寫的，一組資料現在是用陣列的方式儲存，如下:
Array01 = [['2,3']  ['1,5']  ['3,7']  ['5,4']]
Array02 = [['7,6']  ['2,3']  ['6,4']  ['3,7']]
我想要比對陣列裡面相同的list，讓結果出現['2,3']  ['3,7'] 這兩個list。
想請問版上的大神有什麼方法可以處理這個問題?
原本是用循序處理，但原本的資料有3萬多筆，花費的時間太久了。


標題:移動多個檔案到相對應資料夾
標籤:移動檔案 移動 python os replace 

我想要將一個資料夾內多個檔案分別移到相對應的資料夾
有一個資料夾叫 D:\pdf下載 裡面有許多pdf檔
要依據檔名的第6到第9個字 分配到別的資料夾
另一個資料夾為 D:\pdf 但是在pdf的下一層還有一個分類才會到達依據檔名分類的那層
我舉個例子 我想將 D:\pdf下載\aaaa_1100_.txt 搬到 D:\pdf\M1\1100底下
因為有多個檔案所以我不知道要如何跳過那個 M1 (其他檔案可能是M2,M3)去做移動
我這樣應該怎麼去寫迴圈呢比較好呢拜託大家幫幫忙了


標題:python 使用xlsxwriter做折線圖，ＸＹ軸值顯示格式該如和做設定？
標籤:python xlsxwriter set_y_axis 

弱弱地想請問一下
我使用xlsxwriter套件作圖
兩張圖程式都一樣
為什麼左邊Ｙ軸式顯示科學記號，和右邊不是？？
我都想要固定顯示科學記號，該怎麼做？？
至於Ｘ軸我想要固定顯示小數點以下第二位

以下是我分別做兩張圖的程式碼
col_chart.set_x_axis({
            'name':'Index (V)',
            'name_font': {'size': 15, 'bold': True},
            'min':min(Vsd),
            'max':max(Vsd),
            
        })
        col_chart.set_y_axis({
            'name':'Value (A)',
            'name_font': {'size': 15, 'bold': True},
            'major_gridlines':{'visible':False},
            'min':min(Isd),
            'max':max(Isd),

        })
        col_chart.set_legend({'position':'none'})

        col_chart_2.set_x_axis({
            'name':'Index (V)',
            'name_font': {'size': 15, 'bold': True},
            'min':min(Vsd),
            'max':max(Vsd),
        })
        col_chart_2.set_y_axis({
            'name':'Value (A)',
            'name_font': {'size': 15, 'bold': True},
            'major_gridlines':{'visible':False},
            'min':min(Isd_normalization),
            'max':max(Isd_normalization),
        })
        col_chart_2.set_legend({'position':'none'})

我查過一些文件
https://xlsxwriter.readthedocs.io/chart.html?highlight=add_series#add_series
但目前只看到固定顯示日期的參數設定
沒有看到科學記號及小數點下第二位？？



標題:提問python轉換
標籤:@python 

for i in range(5)
for j in range(i+1):
print ("*", end ="")
print( )
想問如何把圖形轉成左右相反


標題:python csv reader 問題
標籤:python csv 

大家好, 請問一下如果在csv 中的cell value是一個 array / list ,
要如何寫才能loop 裡面的value , 因為現在run 的時候出現
Traceback (most recent call last):
File "csvToGeojson.py", line 10, in 
for lat, lon in reader:
ValueError: too many values to unpack (expected 2)
import csv
import json
from collections import OrderedDict

li = []
filename = "2021-10-20T11:21:24.651851.csv"
with open(filename, 'r') as csvfile:
    #reader = csv.reader(csvfile, delimiter=',')
    reader = csv.reader(csvfile)
    for lat, lon in reader:
        d = OrderedDict()
        d['type'] = 'Feature'
        d['geometry'] = {
            'type': 'polygon',
            'coordinates': [float(lat), float(lon)]
        }
        d['properties'] = {
            #'weather': weather,
            #'temp': temp
        }
        li.append(d)

d = OrderedDict()
d['type'] = 'FeatureCollection'
d['features'] = li
with open('GeoObs.json', 'w') as f:
    f.write(json.dumps(d, sort_keys=False, indent=4))


	lat	lon
0	[25.836622033457505, 28.410430325667487, 28.41043032285411, 25.836622026461978, 24.27387797739531]	[-172.53182962648194, -173.42204915230943, -176.48384427903602, -177.37406379490844, -174.95294671400498]
1	[28.41043035784942, 28.41043035582884, 25.83662206379337, 24.27387800928079, 25.8366220665818]	[-101.42204851582318, -104.48384364536292, -105.37406316564723, -102.95294607683479, -100.53182899137936]
2	[87.70882731528539, 87.70882731542748, 87.70882732612102, 87.70882732859751, 87.70882732328622]	[-138.95294647987976, -66.95294542784899, 5.047055250818544, 77.047055475697, 149.04705579826077]
3	[-28.4104303256675, -25.836622033457505, -24.27387797739531, -25.836622026462017, -28.41043032285411]	[6.57795237738758, 7.468171903215056, 5.047054815691991, 2.625937734788453, 3.5161572506608585]
4	[-25.83662206379346, -28.410430355828726, -28.410430357849297, -25.836622066581864, -24.273878009280942]	[74.62593836404979, 75.516157884334, 78.57795301387367, 79.4681725383174, 77.04705545286212]
5	[-25.83662202822898, -24.273877977088336, -25.836622035931725, -28.410430325282857, -28.410430323260407]	[-64.53182868435377, -66.95294577445804, -69.37406285950411, -68.48384332992606, -65.42204820513874]
6	[25.836622027575476, 28.410430316588517, 28.410430318900364, 25.836622028343047, 24.27387797066261]	[-28.53182835838805, -29.422047882433912, -32.48384300869947, -33.37406253262465, -30.95294545261275]
7	[-28.41043031658862, -25.836622027575594, -24.273877970662557, -25.836622028342973, -28.410430318900477]	[150.57795364726312, 151.468173171309, 149.0470560770841, 146.62593899707224, 147.5161585209975]
8	[-87.70882731528523, -87.7088273232862, -87.70882732859751, -87.70882732612102, -87.70882731542748]	[41.047055049817224, -30.952945731436255, -102.95294605400001, -174.95294627887847, 113.04705610184801]
9	[28.410430253944263, 25.83662196498084, 24.273877899469607, 25.83662195343901, 28.410430244823132]	[39.51615756723548, 38.62593803275763, 41.04705511941882, 43.46817220533327, 42.57795268824948]
10	[-28.410430244823196, -25.83662195343895, -24.273877899469518, -25.836621964980825, -28.410430253944313]	[-137.42204884144755, -136.5318293243637, -138.9529464102782, -141.37406349693947, -140.48384396246158]




標題:Python程式迴圈怎麼寫
標籤:#python #迴圈 #程式設計 

程式新手 請大家指教指教?
題目：
使用者輸入每個月的存款，程式逐月列出總存款，直到達到100萬元
例如: 輸入每月存款: 50000
第1個月，50000元
第2個月，100000元
第3個月，150000元
這是自己已經先寫的部分,可能錯很多：
n = int(input ("請輸入每月存款："))
m=1
m=m+1
for i in range(n,1000000,n):
print("第%d個月，%d元" %(m,n))
求高手指點


標題:完成新手任務而已
標籤:python 3 

完成新手任務而已


標題:python multiprocessing  問題
標籤:multiprocessing python 

上網爬了幾篇文章，
我的理解是像餐廳，
但廚師只有一位，所以會一道菜一道菜上。
如果是multiprocessing，
就相當於有幾位廚師，各做各的菜不影響對方，
菜不用等上一道煮完再接下一道。
以上只一種任務，多個人做。
我的問題是如果今天有不同種類的任務呢?
我做完功課要到學校上傳作業，
我就要等他上傳完畢才能做一下份。
如果是multiprocessing可不可以我做我的功課，
他上傳他的作業，我們唯一的關係就只有我按上傳作業而已。
是有辦法做到不同任務的multiprocessing嗎?


標題:python警示聲
標籤:python程式問題 

想在python中加入警示聲,用jupyter notebook
winsound該怎麼使用


標題:python list切分問提
標籤:python list 字串處理 

我想要切分下列的list，當某個項超過一定字數後要變為下一項，但要切在最靠近中間的逗號
paragraph = [['今天適合出門','你，我，他他她'],['一二三，四五六七，八，九十']]

#當某項超過6個字後我想將它切分，但我想切分在該項，切分完後變成

paragraph = [['今天適合出門','你，我','他他她'],['一二三','四五六七','八，九十']]

#一二三，四五六七由於還是超過六個字所以在切一次

功力不佳只想到split切字串，但卻又不知道如何下手
for i in range (0,len(paragraph):
    a = 0
    for j in range(0,len(paragraph[i])):
        a = len(paragraph[i][j])
        while a >6:
            #print(a,i,j)

不知道照這方向寫下去可不可行，求求各位大師們幫忙了


標題:python requests 無法下載
標籤:python3 request 

##請問我用requests下載幾個G的檔案，結果到差不多一半就不動了是甚麼原因
from tqdm import tqdm
import requests
url = input()


response = requests.get(url, stream=True)
total_size_in_bytes= int(response.headers.get('content-length', 0))
block_size = 10240 #1 Kibibyte
progress_bar = tqdm(total=total_size_in_bytes, unit='iB', unit_scale=True)
with open(response.headers['Content-Disposition'].split('filename=')[1], 'wb') as file:
    for data in response.iter_content(block_size):
        progress_bar.update(len(data))
        file.write(data)
progress_bar.close()
if total_size_in_bytes != 0 and progress_bar.n != total_size_in_bytes:
    print("ERROR, something went wrong")



標題:ping得到但connection refused
標籤:python socket plc connection 

如題，我在ubuntu系統上ping得到PLC的地址，
但python socket卻連不上去:connection refused
但google上打地址也連不上去，我同事卻可以連上。
這會有什麼原因?
我有jetson nano/主機 都是linux系統都連不上，ping得到
我用另一台筆電windows 就連得上，ping 得到
初部懷疑是liunx的關係，但不確定會是什麼問題
我已關防火牆。


標題:使用 Docker Compose 進行 Django 安裝和執行，server 成功執行後，使用WSL 卻找不到Django的安裝
標籤:docker-compose docker wsl2 python3 django 

小弟我目前按照docker compose以及django的一些教程在進行操作和練習(https://docs.docker.com/samples/django/ )，
目前碰到一個疑惑，當我按照教學進行操作後，可以正常看到djanog建置出來的網站，而在requirement.txt中有設定Django，因此我預期當我使用wsl登入Ubuntu系統後，應該可以進行django的一些指令操作，但系統卻回覆我並沒有安裝django。想請問在requirement.txt設定的套件
並不會完全實作安裝在Linux系統上嗎?
小弟使用的是windows wsl
附上小弟的環境以及查詢方式



標題:請問如何將證交所下載的個股交易資料CSV檔,轉成DatetimeIndex格式
標籤:python 

如標題所述.


標題:Python 搭配條件 計算欄位累計值
標籤:python pandas 

資料範例:

期望輸出:

解說:

欲使用Python pandas新增 Total_Count欄位，根據每日Count_Record累計次數與是否在同一個Site
舉例來說，card C1 從10/12-10/16都在Site A沒換過場地，故Total_Count欄位直接累計當日與前日的差額。
而card C2 在10/13從Site B轉換到Site A，10/13的Count_Record會先"歸零"並在紀錄當日在Site A的增額(即為2)，而Toal_Count則增加為13 (11+2)。card C2 10/14-10/15都在Site A，故Total_Count只是直接累計當日與前日的差額。而後10/16又換到Site B，故"歸零"再紀錄當日增額(即為4)，而Toal_Count則最後增加為28 (24+4)。
若搭配下表每日增額的欄位可能比較好理解:



以下是資料程式碼，想請問怎麼寫出用if 判斷當日是否與前日同Site，再做Total_Count的累計，謝謝!
import pandas as pd
df1 = pd.DataFrame(columns=['site', 'card', 'date', 'count_record'],
          data=[['A', 'C1', '12-Oct', 5], 
                ['A', 'C1', '13-Oct', 10], 
                ['A', 'C1', '14-Oct', 18],
                ['A', 'C1', '15-Oct', 21], 
                ['A', 'C1', '16-Oct', 29],
                ['B', 'C2', '12-Oct', 11],
                ['A', 'C2', '13-Oct', 2],
                ['A', 'C2', '14-Oct', 7],
                ['A', 'C2', '15-Oct', 13],
                ['B', 'C2', '16-Oct', 4]])



標題:Python Tic tac toe遊戲
標籤:python tictactoe 

大家好,我是Python新手,正嘗試做一個tic tac toe遊戲,但我在步驟4有點卡住了,不知道part4這個take turn跟get available square該如何撰寫！謝謝！
class TicTacToeSim:
# Part 1
def __init__(self):
	#Initialize the simulation
	# Set up board as a 2D list, turn to player 1, and ai to false
	self.board = [[0,0,0],[0,0,0],[0,0,0]]
	self.AI = False
	self.turn = 1,2
	while self.AI == True:
		self.turn = 1
		break
	self.AIturn = 1,2

def change_turn(self):
	# Change turn to other player
	while self.AI == False: #not play with AI
		if self.turn == 1:
			self.turn = 2
		if self.turn ==2:
			self.turn = 1
	while self.AI == True: #play with AI
		self.turn = 1
		self.AIturn = 2
	return

def play_game(self):
	# This is the driver method for the simulation
	#Display initial board
	return


# Part 2
def print_board(self):
	# Print the state of the board using X (player 1) and O (player 2)
	self.item = [' ', 'X', 'O']  # O X empty can put in the []
	for i in range(0, 3):
		for j in range(0, 3):
			if j < 2:
				print(self.item[self.board[i][j]], ' | ', end="", flush=True)
			else:
				print(self.item[self.board[i][j]], end="", flush=True)
		print(end="\n")
	print(end="\n")
	return 0

# Part 3
def get_move(self):
	# Get input from user asking for their move as a tuple
	self.row = int(input("Please enter the row(1-3) you want to move:"))
	self.col = int(input("Please enter the col(1-3) you want to move:"))
	self.move = (self.row,self.col)
	return (self.move)

# Part 4
def take_turn(self, player):
#This is the driver method for a players turn
	player = {'X':[],'O':[]}
	self.valid_move = False
	while self.valid_move == True:
		self.valid_move = self.move

	else:
		self.board[self.row][self.col] = player
	self.valid_move = True
	return
def get_available_squares(self):
	# Get a list of available squares as tuples (row,col)
	return None

def make_move(self, move, player):

	return

# Part 5
def check_winner(self):
	# Check if a player has won, there are 8 ways to win.
	# Return the player who won 0 if nobody has won, and -1 if it is a draw
	if self.board[0] == self.board[1] == self.board[2] !=" ": #row winner
		return 0
	elif self.board[3] == self.board[4] == self.board[5] !=" ":
		return 0
	elif self.board[6] == self.board[7] == self.board[8] !=" ":
		return 0
	elif self.board[0] == self.board[3] == self.board[6] !=" ": #col winner
		return 0
	elif self.board[1] == self.board[4] == self.board[7] !=" ":
		return 0
	elif self.board[2] == self.board[5] == self.board[8] !=" ":
		return 0
	elif self.board[0] == self.board[4] == self.board[8] !=" ": #diagonals winner
		return 0
	elif self.board[2] == self.board[4] == self.board[6] !=" ":
		return 0
	else:
		return-1

# Part 6
def random_move(self):
	# Choose a random move from available moves
	return None

# Part 7
def winning_move(self, player):
	# Find a winning move for a player
	return None

def threat_to_lose(self):
	# Run winning_move from other perspective
	return

def smart_move(self):
	# If there is a winning move, win
	# If there is a threat to lose, block
	# Make random move
	return

sim = TicTacToeSim()
sim.print_board()
sim.get_move()


標題:python list和for的問題
標籤:list for python 

想請教一下下面的問題，我現在有下面3個list
kkk = []
ttt = [111,222,333]
yyy = [1,4,8]

我想要把他append到kkk裡面，讓kkk變成
[111,222,222,222,222,333,333,333,333,333,333,333,333]

這樣該怎麼去寫for迴圈呢?


標題:請問要如何在google colab上錄音
標籤:python3 google colab 

小弟今年高中生，要做自主學習，打算做語音助理。
使用的環境是用google colab
但我不知道google colab可不可以錄音?
有找到一篇文章，但我完全看不懂 https://colab.research.google.com/notebooks/snippets/advanced_outputs.ipynb#scrollTo=2viqYx97hPMi
想請教各位大神幫幫我，謝謝。


標題:兩個 dokcer container 彼此連線
標籤:docker container mysql python3 

想請教各位高手如果我有兩個container(例如:一個是python，一個mysql)，我要怎麼讓python那個container可以連線到mysql呢? 該如何取得每個container中的ip呢?


標題:Raspberry Pi 按鈕偵測的中斷(interrupt)相關新手問題
標籤:raspberry pi interrupt gpio 中斷 python 

因對硬體較為不熟悉
查了相關資料看到在Raspberry Pi用Python去做按鈕偵測大多是用RPi.GPIO 套件的add_event_detect來做
這邊有幾個問題想請教:


軟體中斷和硬體中斷我看得有點混亂, 目前的理解是: 軟體中斷是透過程式去不斷去查看GPIO變化(輪詢); 硬體中斷是外部裝置主動發出中斷訊號給CPU, 所以是CPU部分也有寫好類似軟體中斷的功能?


用add_event_detect來偵測GPIO腳位的電位變化, 這個應該是算軟體中斷對吧?


那Raspberry Pi是否可以做硬體中斷呢?


add_event_detect他是多久去偵測一次該GPIO腳位呢? 我試著想更改但找不到可設定參數的地方


如果有理解錯誤還請指正
謝謝


標題:python 如何知道圖片是否垂直翻轉放
標籤:opencv 影像處理 python 

最近在寫opencv辨識
遇到一個問題是假設我要放一張健保卡,身份證
如果他垂直翻轉放，我要怎麼讓電腦知道他放反?


標題:Pandas 複製列並貼上
標籤:python3 pandas 

如題，在下Python自學新手
現在想要複製如圖中H欄位的所有資料並貼在I欄位，要怎麼做到?

估狗只有找到deep_copy = df.copy()這段語法，可是沒有貼上的指令..
請問各位高人要如何做出貼上?
另外假設要把A欄位移動到最前面  除了 reindex(columns=["bike","CAR"......]除了這種指定表頭的移動方式還有另外的方法嗎?


標題:Pressplay 課程資訊，爬蟲抓取失敗
標籤:python爬蟲 

練習爬蟲抓取Pressplay所有的課程資料，最後將資料轉存至excel檔
但是最後課程資訊的迴圈說找不到檔案，請問問題是？
以下是我的code (抱歉，之前網址放錯了）
import requests
from openpyxl import Workbook

wb = Workbook()
ws = wb.active

index = ["name","author","type","description","price","sold"]
ws.append(index)


headers={
    "user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36",
    "cookie":"PHPSESSID=tcsn9k3lq3b9qu9qssiou2nmlr; salt=17c563002ae65-0561a5018abc3c-b7a1b38-144000-17c563002af627; _gcl_au=1.1.1241047029.1633533560; __asc=39103bac17c563004f470c17189; __auc=39103bac17c563004f470c17189; _ga=GA1.2.186048344.1633533560; _gid=GA1.2.2061645999.1633533560; _gat_gtag_UA_73798928_1=1; cto_bundle=1NQF619wbDhuaDVDcmdqQ1o4OHU3UkllZU9TbU9IR1dTJTJCOFpxZzFTJTJCTXJlUUJ2ZWdad2xrMCUyQmJ6dCUyRkdoamU2UGJRUEclMkJrcnc2U3B3Z2FrZnMyeUluNEdSVUtqVWN6UFpCQnN4cURqYTZNQnRsVnQ1OXVXRlZyTW5QJTJCVGJ0JTJGbzdYRGo0; __zlcmid=16QkNvV5RtCBnju",
    
                   }

for page in range(66):
    url = "https://www.pressplay.cc/project?page="
    url = url + str(page)
    print(url)

    
    r = requests.get(url,headers=headers)

    print(r)

    courses = r.json()

    for project in courses['data']:
        list=[]
        list.append(project["project_title"])
        list.append(project["owner"]["nickname"])
        list.append(project["type_name"])
        list.append(project["project_short_desc"])
        list.append(project["offers"]["min"])
        list.append(project["purchase_num"])
        ws.append(list)

    wb.save("pressplay.xlsx")





標題:在 Django Application 新增一個資料夾內含view.py，並且runserver後可以看到內容
標籤:python django 

小弟是python和django新手，按照https://code.visualstudio.com/docs/python/tutorial-django ，參考VScode官方教學內容實作後，突發奇想一個問題
如標題以及下方圖片所示，如果我想在Django Application資料夾中，自己新增一個資料夾並且單獨新增一個view2.py的檔案，那在Django Application的urls.py檔案內該怎麼設定，又或者這種情況是不可行的
下圖中是小弟創建的Djanog的資料結構
其中hello資料夾即為Django Application，testHome則是小弟建立的資料夾名稱裡面含有一個view2.py

view2.py的內容為

那小弟應該在hello/urls.py中如何設定，才能在runserver時看到內容呢?
(預期的網址為http://127.0.0.1:8000/testHome)

如果這樣的想法是不可行的?
那是否可以在原本的Django App資料夾下新增一個新的Django App，並且在原本Django App的urls.py中設定，來得到類似的結果
下圖為例



標題:python 寫入 csv
標籤:python csv 檔案寫入 

我現在有三個list 分別如下
co_id = [111,222,333]
year = [90,80,100]
par = [[ㄅ,ㄆ,ㄇ],[A,B,C,D,E],[甲,乙]]

我現在想要將這三個list寫入csv檔裡面
下面是我想呈現的方式
111 90  ㄅ ㄆ ㄇ
222 80  A  B  C  D  E
333 100 甲 乙

目前兩個問題分別是:
1.我目前想要在上面空一行，在上面打[ID,年份,句子1,句子2......,句子n],但是不知道該怎麼在第一行依照par的長度去算到句子n的長度
2.目前沒有辦法讓csv呈現我想要的樣子
當我寫下列程式碼時:
with open('test.csv', 'w', newline='',encoding='UTF-8-sig') as test_file:
    writer = csv.writer(test_file)
    for i in range (0,len(par)):
        writer.writerow(par[i])
#會呈現下列情況，但是我不知道該如何加上co_id和year
ㄅ ㄆ ㄇ
A  B  C  D  E
甲 乙

但當我寫下列程式碼時:
with open('test.csv', 'w', newline='',encoding='UTF-8-sig') as test_file:
    writer = csv.writer(test_file)
    for x,y,z in zip (co_id,year,par):
        writer.writerow([x,y,z])
#會呈現下列情況,不知道要怎麼將par逐字拆開
111 90  [ㄅ,ㄆ,ㄇ]
222 80  [A,B,C,D,E]
333 100 [甲,乙]

拜託大家幫忙我解決一下了，遭到這問題困擾很久了:(


標題:【問題】Python  selenium
標籤:python selenium xpath css selector click 

造訪網站：https://e-service.cwb.gov.tw/HistoryDataQuery/MonthDataController.do?command=viewMain&station=C0A9C0&stname=%25E5%25A4%25A9%25E6%25AF%258D&datepicker=2018-01

我寫了一個程式，自動造訪該網頁後，
自動點擊【CSV下載】按鈕，
緊接著點擊下一頁的按鈕，
原本之前執行都沒有問題，
但是今天在run程式時，
在nex_button.click()此行顯示錯誤訊息，
跑出此錯誤：
ElementClickInterceptedException: Message: element click intercepted: Element <a id="nexItem" href="#">...</a> is not clickable at point (655, 39). Other element would receive the click: <th colspan="5">...</th>
  (Session info: chrome=94.0.4606.61)

我查詢了相關網站的問題，
也修改了用id、name其他去find_elements，
但都出現一樣的錯誤，
不知道該如何修改？
奇妙的是downloadCSV不會有問題，
(註：原本兩個都是用find_elements_by_css_selector，也是只有nexItem出現錯誤)

完整程式碼：
from selenium import webdriver
from selenium.webdriver.support.ui import Select
import requests
from bs4 import BeautifulSoup
import pandas as pd

#安裝chromedriver，chromedriver存放位置
dr = webdriver.Chrome('C:/Users/User/chromedriver')

#造訪網頁連結
dr.get('https://e-service.cwb.gov.tw/HistoryDataQuery/MonthDataController.do?command=viewMain&station=C0A9C0&stname=%25E5%25A4%25A9%25E6%25AF%258D&datepicker=2018-01')

#自動點選【CSV下載】button
first_buttons = dr.find_elements_by_css_selector('a[id = downloadCSV]') 
#自動點選【下一個月箭頭】button
nex_buttons = dr.find_elements_by_xpath("/html/body/div[1]/table/tbody/tr/td[6]/a") 

for first_button in first_buttons:
    first_button.click()
    
for nex_button in nex_buttons:
    nex_button.click()

更新：
後來發現我只要將我的程式碼順序改變即可完成，
因為換頁時，容易抓不到id，
from selenium import webdriver
from selenium.webdriver.support.ui import Select
import requests
from bs4 import BeautifulSoup
import pandas as pd

#安裝chromedriver，chromedriver存放位置
dr = webdriver.Chrome('C:/Users/User/chromedriver')

#造訪網頁連結
dr.get('https://e-service.cwb.gov.tw/HistoryDataQuery/MonthDataController.do?command=viewMain&station=C0A9C0&stname=%25E5%25A4%25A9%25E6%25AF%258D&datepicker=2018-01')

for first_button in first_buttons:
    #自動點選【CSV下載】button
    first_buttons = dr.find_elements_by_css_selector('a[id = downloadCSV]') 
    first_button.click()
 
for nex_button in nex_buttons:
    #自動點選【下一個月箭頭】button
    nex_buttons = dr.find_elements_by_xpath("/html/body/div[1]/table/tbody/tr/td[6]/a") 
    nex_button.click()



標題:Python 套件版本問題
標籤:python 套件 版本更新 

各位大大好，
小弟近期遇到一個問題，
小弟當前有個Django伺服器，使用的pandas都是使用0.XX版本，
但新的程式檔案需要使用的是1.XX版本，
那請問如果我希望舊的程式可以不需要升級，且新程式使用新版本套件的情況下，
我什麼工具能夠協助我嗎? 或是大大們有什麼升級方面的經驗可以分享。
先在此感謝各位大大不吝指教！！

更新一下問題，抱歉可能小弟說的不夠清楚，
我目前是有一個Django api，套件都放在虛擬環境內，
那假設 http://127.0.0.1/testApi/testA 這個API會呼叫到後端的testA.py檔案(該檔案內使用pandas 0.XX版本)，
另一個 http://127.0.0.1/testApi/testB 這個API會呼叫到後端的testB.py檔案(該檔案使用pandas 1.XX版本)
以上的狀況，如何並行?
或是有什麼好的建議呢?
感謝各位大大！！


標題:<解決>Python str轉Array 
標籤:#python #array #php #html 

還有其他需求所以需要先將str轉Array
但是輸出結果沒有改變
麻煩版上大師們指點一下TT
下圖是網頁輸出結果

<更>已自行解決，先轉list再轉成Array


標題:<解決>php連接python??
標籤:#python #flask #php #html 

這種方式原本是用在html檔上，後來發現改.php也能執行，但是發現頁面上的php語法直接顯露出來，想問是不是代表不能使用這種方式..?(若不能，想問還有甚麼方式@@?)
我想達成的是將在php網頁的表單input值傳給python，然後python經過換算後再傳值回php頁面(以上方法已用flask達成，但我主要的頁面是php頁面)
第一次嘗試連接，若有蠢問題先在這抱歉@@


標題:爬取五頁新聞標題，但匯出至CSV檔時只匯出第五頁的標題？
標籤:python 網頁爬蟲 多頁面 

目前在練習爬蟲抓取新聞標題，並匯出CSV
問題點是此新聞頁面有5頁，我迴圈有抓到5頁的標題與網址，
但是匯出成csv檔時，卻只匯出第五頁的標題?
#爬取聯合新聞網頁面
#問題：動態頁面，雖然有取得網址，但只能得到第五頁的標題
#問題二：code40中的titleLinke為目的網址，需再加上link3的網址才是完整的網頁，但不知道如何合併link3+titleLink

import requests
import bs4
from openpyxl import Workbook


wb = Workbook()
ws = wb.active

list = ["title","view","link"]
ws.append(list)

header = {
    "user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36"
}


link1 = "https://udn.com/api/more?page="
link2= "&id=&channelId=1&cate_id=99&type=breaknews&totalRecNo=15638"
link3 = "https://udn.com/"

for page in range(1,5):                     
    url = link1+str(page)+link2
    print(url)


r = requests.get(url, headers=header)


items = r.json()

for item in items["lists"]:
    headline = []
    #headline.append(item["date"])
    headline.append(item["title"])
    headline.append(item["view"])
    headline.append(item["titleLink"])

    

    ws.append(headline)
wb.save("123.xlsx")




























標題:python發送request給pchome讓商品自動加入購物車
標籤:python requests pchome 

如標題，我在嘗試利用python.requests寫一個自動加入購物車的程式。
但寫到一半就遇到問題。我目前的code如下：
import requests                                                       
import time 

t = int(round((time.time())*1000))

session = requests.session()
get =session.get('https://24h.pchome.com.tw/prod/DGBJAF-A900962EG?fq=/S/DGCV0M')

cookies = get.cookies.get_dict()                                      
headers = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82
Safari/537.36'}

snap_up = session.get(f'https://24h.pchome.com.tw/prod/cart/v1/prod/DGBJAFA900962EG-000/snapup?_{t}',headers=headers, cookies=cookies)  

print(snap_up.text)

print的結果是{"Expire":15,"Status":"ProdLocked","MACExpire":"","MAC":""}
但是在pchome用DevTool看Network的話，會看到正確的response是{"Expire":15,"Status":"OK","MACExpire":"2021/09/21 20:21:07","MAC":"f7cfcd2"}
我覺得一定是我的request有地方錯誤，但我抓不出來，還請各路大神方便的話幫我釐清一下，謝謝!


標題:如何在 matplotlib 的 wx Python  套用 csv file下 使用 click button 點選兩次以上後仍 然呈現同一個視窗(window) 
標籤:python 匯入csv canvas matplotlib.pyplot wxpython 

各位IT邦好:
最近剛碰Python 遇到一些問題，想在這邊請教，程式主要目的是引入csv file 資料後，以視覺化圖示呈現，我遇到問題是 資料上有下拉式選單可以選擇哪一種資訊和呈現圖示，每一次點選 click 後 要如何在相同視窗(figure)內產生新的資料，也就是說內容物有變，但視窗仍然是相同的，不會再另外產生第二個視窗。 我是有用 canvas.draw 但仍然沒有作用。
排版沒有很好，請多多諒解，我會再修改，感謝幫忙!
csv file 圖示

視窗圖示


Code 如下
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.figure import Figure
from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg as FigureCanvas
import sys,getopt
import wx
import csv
def get_max(my_list):
m = None
for item in my_list:
if isinstance(item, list):
item = get_max(item)
if not m or m < item:
m = item
return m
def get_min(my_list):
m = None
for item in my_list:
if isinstance(item, list):
item = get_min(item)
if not m or m > item:
m = item
return m
def  dist_read(file_name,col_index_name):
value_list=[]
i = 0
with open(file_name) as csvfile:
rows = csv.reader(csvfile)
for row in rows:
if i == 0:
col_index=row.index(col_index_name)
else:
try:
value_list.append(float(row[col_index]))
except:
pass
i = i + 1
value_list.pop(0)
return value_list
def hair_group_read(file_name):                     #read hair value from csv file
hair_list=[]
i = 0
with open(file_name) as csvfile:
rows = csv.reader(csvfile)
for row in rows:
if i == 0:
for hair_name in row:
hair_list.append(hair_name)
i = i + 1
hair_list.pop(0)                                #exclude the column of "Body Position"
return hair_list
def plot_dist(file_group,xlabel=None,ylabel='count',bins_size=200):
data_group = []
for file_name in file_group:
data_group.append(dist_read(file_name,xlabel))
bins=np.linspace(get_min(data_group),get_max(data_group),bins_size)
plt.figure()
plt.subplot(311)
for data in data_group:
    hist_max, hist_min, _ = 

plt.hist(np.array(data),bins,alpha=0.5,label=file_group[data_group.index(data)], linewidth=0) #linewidth=0, Bar border width=0
plt.legend(loc='upper right')
plt.title(xlabel)

plt.ylabel(ylabel)
plt.grid()
plt.subplot(312)

boplt=plt.boxplot(data_group,vert=False, patch_artist=True)
#colors = ['lightblue', 'orange','lightgreen','indianred','mediumpurple','rosybrown','plum']

colors=['SlateBlue','MediumSeaGreen','LightCoral','Cyan','Violet','Khaki'] 
for patch, color in zip(boplt['boxes'],colors):
    patch.set_facecolor(color)
plt.xlabel(xlabel)
plt.yticks([1],file_group,rotation=30,fontsize=10)   
plt.grid()
plt.subplot(313)
plt.grid()

class MyForm(wx.Frame):
def __init__(self,hair_group):
    wx.Frame.__init__(self,None, wx.ID_ANY, "Hair Length Data Distribution", size=(500,250))
 

    panel = wx.Panel(self, wx.ID_ANY)
    #self.fig = Figure(figsize=(6, 4), dpi=100)
    #self.canvas = FigureCanvas(self, -1, self.fig)
    sampleList = []
    self.labelChar = wx.StaticText(self, -1, "Choose the one you want to show:" , pos= (0,25))
    self.cb = wx.ComboBox(self, size=wx.DefaultSize, choices=sampleList, pos= (0,50))
    self.widgetMaker(self.cb, hair_group)
                   
    #self.plotSizer.Add(self.panel_plot, 1, wx.EXPAND | wx.ALL, 5)
    #self.figure = Figure()
    #self.canvas = FigureCanvas(self, -1, self.figure)
    #self.sizer.Add(self.cb, 0, wx.ALL, 30)
    #self.SetSizer(self)

    self.labelBin = wx.StaticText(self, -1, "box count:" , pos= (0,95))
    self.size = wx.TextCtrl(self, -1, "200", size=(111,-1), pos= (90,90))
    self.size.SetInsertionPoint(0)

    self.button = wx.Button(self, -1, "Plot", pos= (20,160))
    self.Bind(wx.EVT_BUTTON, self.OnClick, self.button)
    self.button.SetDefault()

    self.labelLimitline = wx.StaticText(self, -1, "Limit", pos= (1,120))
    self.LimitLine_size = wx.TextCtrl(self, -1, "0", pos= (90,120))
    self.LimitLine_size.SetInsertionPoint(0)

 def widgetMaker(self, widget, objects):

    for obj in objects:
        widget.Append(obj)
    widget.Bind(wx.EVT_COMBOBOX, self.onSelect)

def onSelect(self, event):

    print("You selected: " + self.cb.GetStringSelection())
    print_statistics_cal(self.cb.GetStringSelection())
    print("\n--------------------------------------------------------------------")

    def OnClick(self, event):  

plot_dist(file_group,xlabel=self.cb.GetStringSelection(),bins_size=int(self.size.GetValue())+1)
plt.show()
#self.fig.canvas.draw()


標題:python處理csv檔問題
標籤:python csv 匯入csv pandas.dataframe 

小弟目前只學習了基本的python語法，其他套件都還沒完全學會(有開始看pandas用法了)
雖然組長有簡單指導我方向(用for迴圈取值)然後用pandas來做更動，但實在還是不太有頭緒
希望可以請教各位大大我該怎麼做比較好QQ

這是要處理的csv檔的長相，資料分為ID、年分、a~a7這幾項
每筆資料都是某機構在某年某季的資料，組長希望我重新將資料整理成為

改成某機構在a的資料以時間排序 接著在做a2、a3、a4......
目前只想的到可以用isin去抓各個機構在每一季的所有資料然後再慢慢的把它改成組長要的規
格

但資料其實不是只有短短的這幾筆，如果真的這樣做完大概要花上好幾天...
現在會取出a1和年份了 不知道這樣做正不正確

希望大家能指點迷津QQ....


標題:Python讀CSV, 出現1: Syntax error: "(" unexpected問題 (更新)
標籤:ubuntu python 

如題
概況
CSV裡面有英文字跟數字跟簡易的符號
Ubuntu 20.04 (VM)
python version 3.9.5
小弟不才對Ubuntu不熟, 上網查可能是shell script執行是sh or bash產生
所以執行 sudo dpkg-reconfigure dash, 選擇No
再重新執行出現
line 1: syntax error near unexpected token `('
雖然在CSV中 ( 前加上\, 可以跳過這個問題, 但是會導致後續文件的處理找不到字串
所以想問前輩有什麼好解決方式
謝謝
新增:
讀兩個CSV, 帶入function


標題:Outlook 下載副檔並打開移動欄位
標籤:python入門 python 

如題
剛接觸Python
今天我想做，在Outlook上的搜尋欄打入關鍵字後會自動下載副檔，副檔為CSV檔
資料打開假設如圖
想要把原始的資料移到我指定的欄位

目前想法是win32com.client可以操作OUTLOOK，PANDAS可以操作資料，在配上迴圈指令
請問這樣方向是對的嗎?
另外  想請問win32com.client只能在OUTLOOK電腦版上使用嗎?
還是有其他套件可以用?


標題:python爬取圖表的資料
標籤:python selenium 

我想爬取台電裡面的用電量分析
我用selenium來爬取，但是資料是圖表

後來去看了一下network

他那裡面的網址https://hvcs.taipower.com.tw/Portal/Chart/RawDataQuarter
由於是用POST傳出去的所以我直接進入的話會錯誤
我該怎麼做才能爬取到圖表的資料呢?


標題:從Server端得到client的mac address
標籤:python fastapi 

使用FASTAPI建立API
讓使用者對資料庫進行操作
但想限制使用者
有辦法從server端獲取到client端的mac address
進行管控嗎
或有甚麼更好的方法讓使用者操作資料庫呢


標題:Dataframe 時間資料篩選
標籤:python dataframe 篩選 時間格式 

小弟我在篩選Dataframe中的資料困擾住了，想請問一下各位大神，以下是我的code以及資料:
code:
def search_time_FranklinWc(o):
  conn = pymysql.connect(**db_settings)
  command = f"""
  SELECT * FROM Franklin_topic_word_cloud where DATEDIFF(NOW(), start_date) < 14
  """
  df = pd.read_sql(command, conn)
  df['start_date'] = df['start_date'].apply(str)
  df['end_date'] = df['end_date'].apply(str)
  df['start_week'] = df['start_date'].apply(lambda x :datetime.datetime.strptime(x, "%Y/%m/%d").isocalendar()[1])
  df['end_week'] = df['end_date'].apply(lambda x :datetime.datetime.strptime(x, "%Y/%m/%d").isocalendar()[1])
  if o == "week":    
    result = df[df['start_week']!=df['end_week']]
  elif o == "day":    
    result = df[df['start_week']==df['end_week']]
  return result

資料:

我希望能只抓end_date為2021/9/7的資料，所以我將code改為以下:
def search_time_FranklinWc(o):
  conn = pymysql.connect(**db_settings)
  command = f"""
  SELECT * FROM Franklin_topic_word_cloud where DATEDIFF(NOW(), start_date) < 14
  """
  today = datetime.date.today()
  target_day =  str(today- datetime.timedelta(days=2))
  df = pd.read_sql(command, conn)
  df['start_date'] = df['start_date'].apply(str)
  df['end_date'] = df['end_date'].apply(str)
  df['start_week'] = df['start_date'].apply(lambda x :datetime.datetime.strptime(x, "%Y/%m/%d").isocalendar()[1])
  df['end_week'] = df['end_date'].apply(lambda x :datetime.datetime.strptime(x, "%Y/%m/%d").isocalendar()[1])
  if o == "week":    
    target = df[df['start_week']!=df['end_week']]
    result = df[df['end_date']=target_day]
  elif o == "day":    
    result = df[df['start_week']==df['end_week']]
  return result

但它未如期完成，後來我發現可能是因為target_day='2021-9-7'，所以並未匹配到。
我該如何正確處理時間格式，或是有沒有更好的篩選方式，請求各位大神解答qqq

end_date為str格式



標題:html 表格爬蟲如何將轉出的csv檔存到py檔當前路徑,並將csv檔名改為html檔所在資料夾名稱
標籤:html python 匯出csv 

請問python 表格爬蟲有辦法將轉出的csv檔存到py檔當前路徑,並將csv檔名改為html檔所在資料夾名稱嗎?目前只能做出爬當前路徑下html檔
以下是我的程式碼:
import pandas as pd
import os

directoryPath = r"./"
os.chdir(directoryPath)
folderLister = os.listdir(directoryPath)
for folders, sub_folders, file in os.walk(directoryPath):
    for name in file:
        if name.endswith(".html"):
            filename=os.path.join(folders,name)
            print(filename)
            print(name)
            dfs = pd.read_html(filename)
            html_filename = filename.replace('.html', '.csv')

            dfs[3].to_csv(html_filename)




標題:[SQL] 透過複數個條件抓資料庫的資料
標籤:python sql mariadb colaboratory pymysql 

各位大神們好，這邊想要請問一下SQL中的語法問題，以下是我的code:

在我輸入變數後出現了以下的error:

似乎是變數帶入的問題，想請問各位大神如何解決。

操作環境為使用colaboratory import PyMySql對MariaDB進行操作



標題:MariaDB時間資料篩選條件設置
標籤:sql mariadb python pymongo 

各位大神們好，小弟我對於sql語法十分陌生，對於下sql指令還不是很熟悉，以下是我目前資料庫的資料形式:

我希望能夠將資料進行以下兩個步驟的篩選:
第一步是先抓出昨天的一群資料，因為此資料庫中的資料是每天更新的，今日是9/7，那資料庫就會更新9/6與2021/08/31 ~ 2021/09/06的資料，若今日是9/8，那就會新增9/7與2021/09/01 ~ 2021/09/07的資料。
第二步是將剛剛抓的資料分成兩類，一類是單天如上圖中的2021/09/04，另一類則是一周的資料例如上圖中的2021/08/30 ~ 2021/09/05。
希望各位大神能給予身為sql小白的我一些頭緒和辦法，小弟對於sql語法真的不大熟悉，還請各位大神多見諒。


標題:Flask 撰寫問題
標籤:python flask mariadb jupyternotebook 

各位大神們好，小弟在撰寫flask時遇到了一些問題，需要請求各位的幫助，以下是我flask的code:

再下方是我在flask中用到檔案的code:

我測試過上方兩個def皆有data呈現出來:

然而我在flask app.run()之後卻沒抓到資料:

log如下:

請問問題是出在哪，要如何修改??
之後我將POST改成GET:

但仍出現error:



標題:python 打包的EXE檔只執行部分程式就自行結束
標籤:python exe 運算不完全 

python 內容如下:
sp = int(input("金額："))
dp = int(input("倍數："))
DD=sp*dp
if(DD>=70 and dp <=2):
print("倍數金額",DD,"NTD")
print("為正常範圍")
else:
print("倍數金額",DD,"NTD")
print("此數值須注意")
打包過程如下
我是參考這位youtuber的方式https://www.youtube.com/watch?v=38cqMSqkrG0
產出EXE檔結果如下:

但再按一次enter,EXE檔就自己關掉了，並沒有再繼續執行下面的運算
希望可以提供解決方式，謝謝!


標題:為什麼我沒有辦法用pydub撥放音訊??
標籤:python 

我的錯誤訊息長這樣
D:\PythonEditVideo>python play.py
<pydub.audio_segment.AudioSegment object at 0x01AEEA30>
Traceback (most recent call last):
  File "play.py", line 6, in <module>
    play(sound)
  File "C:\Python37-32\lib\site-packages\pydub\playback.py", line 71, in play
    _play_with_ffplay(audio_segment)
  File "C:\Python37-32\lib\site-packages\pydub\playback.py", line 15, in _play_with_ffplay
    seg.export(f.name, "wav")
  File "C:\Python37-32\lib\site-packages\pydub\audio_segment.py", line 867, in export
    out_f, _ = _fd_or_path_or_tempfile(out_f, 'wb+')
  File "C:\Python37-32\lib\site-packages\pydub\utils.py", line 60, in _fd_or_path_or_tempfile
    fd = open(fd, mode=mode)
PermissionError: [Errno 13] Permission denied: 'C:\\Users\\win10\\AppData\\Local\\Temp\\tmpf68zi_mn.wav'

我目前已經嘗試過
安裝pydub
安裝FFmpeg
把FFmpeg加進環境變數
安裝simpleaudio
安裝pyaudio(但是安裝失敗)
用系統管理員身分開啟終端機
請問要怎麼解決這個問題呢?


標題:[SQL] 抓資料庫裡昨天的資料
標籤:sql python mariadb time datetime 

各位大神好，想請問各位Sql的基礎語法問題，我想抓取資料庫裡昨天的資料，例如今天是9/3就抓9/2的資料，若是8/30就抓8/29的資料，以下為我的code以及遇到的error:

，其中end_date為我資料庫裡要抓的欄位，請問要如何修改呢?


標題:利用LINE bot 命令python更新google sheet
標籤:line bot python googlesheet 

請問有辦法在line bot中輸入「更新」，然後背後的指令是讓python去更新google sheet嗎?
因為我在python中已經寫好程式碼，也確認可以執行，但想跟line bot結合就無法執行了
懇請各位幫忙，感謝!!
*補------------------
我是用python寫的
這我的程式碼，放在stock_title.py中，單獨在python中執行是可以的
import gspread
from oauth2client.service_account import ServiceAccountCredentials as SAC
import requests
from bs4 import BeautifulSoup
from datetime import datetime

def stock_name():
    Json =  金鑰
    Url = ['https://spreadsheets.google.com/feeds']
    Connect = SAC.from_json_keyfile_name(Json, Url)
    GoogleSheets = gspread.authorize(Connect)
    Sheet = GoogleSheets.open_by_key('google試算表代號')
    Sheets = Sheet.sheet1
    url = "https://isin.twse.com.tw/isin/class_main.jsp?owncode=&stockname=&isincode=&market=1&issuetype=1&industry_code=&Page=1&chklike=Y"
    res = requests.get(url)
    soup = BeautifulSoup(res.text,"html.parser")
    soup1 = soup.find("table",{"class":"h4"})
    url2 = "https://isin.twse.com.tw/isin/class_main.jsp?owncode=&stockname=&isincode=&market=2&issuetype=4&industry_code=&Page=1&chklike=Y"
    res2 = requests.get(url2)
    soup2 = BeautifulSoup(res2.text,"html.parser")
    soup3 = soup2.find("table",{"class":"h4"})
    s_id = []
    for i in range(len(soup1.find_all("tr"))):
        s_id_ = soup1.find_all("tr")[i].text.split("\n")[3:5]
        s_id.append(s_id_)
    for i in range(len(soup3.find_all("tr"))):
        s_id_ = soup3.find_all("tr")[i].text.split("\n")[3:5]
        s_id.append(s_id_)
    if len(Sheets.get_all_records()) == 0:
        Sheets.append_rows(s_id)
    else:
        Sheets.update(s_id)
    return "{} 更新完成".format(datetime.now().strftime('%Y-%m-%D %H:%M:%S'))


然後line bot的程式碼中我新增了下面這段(elif前面是有其他的關鍵字指令)，但line bot輸入更新後只有已讀沒有其他反映，輸入其他的關鍵字指令還是跑得出結果，就只有這段不行
from stock_title import *
elif re.match('更新',message):
     update = stock_name() 
     line_bot_api.reply_message(
     event.reply_token,TextSendMessage(update))



標題:工作需要繪製等濃度圖
標籤:python software 

想請問論壇上的各位先進
工作上要使用政府開放數據
進行不同時段的等濃度圖的呈現(在網頁上讓上司觀看)
不知道要怎樣處理
購買軟體或者使用，例如PYTUON語言來撰寫解決


標題:一物件(Object)中輸出呈現含有兩個list，如何只取其中一個list？
標籤:python3 python-docx 

目前使用python-docx套件遍歷paragraphs時發現奇怪的事情，明明只呼叫一個paragraph，卻內含兩個物件，如下：
print(doc.paragraphs[i])

<docx.text.paragraph.Paragraph object at 0x00000240DAEC20C8>
<docx.text.paragraph.Paragraph object at 0x00000240DAED0148>

再往內檢查內容型別，是兩個list。
print(type(doc.paragraphs[i].runs))

<class 'list'>
<class 'list'>

然而我只想要第一個list，請問有辦法取出嗎？


標題:Python打包成Dmg 之後還能 讀取檔案嗎？
標籤:python 

小弟最近想做了一個方便自己背單字的小程式，其中會需要寫入檔案跟讀取檔案，最後再把他打包成應用程式。但在自己的測試當中單純讀取檔案的程式在執行後就直接爆錯了。

有什麼方法能讓打包之後的程式也能讀取資料跟寫入資料呢？
或者是資料檔案要放在哪裡呢
註 我是用py2app打包


標題:Pytorch 的 BatchNormaliztion  跟 Tensorflow 的差異很大
標籤:python pytorch tensorflow model batch normalization 

小弟最近因為研究的需要，要把 Pytorch 的 Model Porting 到 TF 來，但是在 BatchNormaliztion 這裡遇到了問題，目前看過他們部分的 Source code 知道一些參數不相同也改了，也試著從 Pytorch 這邊 load weight 到 TF 這裡，還是一樣(如下圖)不行，不知道該如何是好，還請各位大大幫幫忙，感激不禁！



標題:Flask 取得不到資料
標籤:python flask mariadb 

各位好，小弟這邊在編寫flask時遇到了我難以解決的問題，想向各位大神請教，以下使我flask的code以及裡面有用到的code
Flask:

FK_bar與FK_WC:

我這邊設定若沒有設定任何查詢條件時，platform與topic_num預設為第0項，也應該是AUNE跟3。
以下是我app.run得到的回應:

他回程是成功的，是但是bar_result與cloud_result卻是空值，我去查詢了資料，以下為資料庫的情況:

確實有存在AUNE與3的條件的資料存在，但為何app.run會是空值呢??


標題:TypeError: '<' not supported between instances of 'NoneType' and 'str'
標籤:sql pymysql python mariadb 

小弟是剛接觸sql，以前也不常使用python的sql語法，在使用上時遇到了以下的問題，想請各位大神的協助，以下是我的code，是用於查詢資料庫欄位有的選項:

但出現了的錯誤:

我發現會出現此error的原因是她除了抓到選項，還會多抓到none:

而我在網上查詢了解決方法並加入他的code，如下:

但就出現了新的error:

到底該如何處理，HELP


標題:python 爬蟲 問題
標籤:python python爬蟲 網頁爬蟲 crawler ajax 

爬蟲網站：http://www.foodchina.com.tw/model/marketing/AnaChartNew.aspx?id=51&ChkID=297&Page=0&Type=1&cn=False
該網站需要先利用篩選器選擇你要的資料，
(類別：全選，價格：全選，區間：日，2018年1月31日前31天走勢圖)

程式碼執行後會導到

這個畫面，
我想爬蟲
http://www.foodchina.com.tw/model/ajax/getChartData.ashx
內的
type -> data -> datasets -> label -> 價格-地方
type -> data -> datasets -> label -> data -> y -> 價錢
這兩個值，
不知道是不是我data設定錯誤

目前程式碼：
from selenium import webdriver
from selenium.webdriver.support.ui import Select
import requests
from bs4 import BeautifulSoup
import pandas as pd

#安裝chromedriver，chromedriver存放位置
dr = webdriver.Chrome('C:/Users/User/chromedriver')

#造訪網頁連結
dr.get('http://www.foodchina.com.tw/model/marketing/AnaChartNew.aspx?id=51&ChkID=297&Page=0&Type=1&cn=False')

#點選所有類別checkbox
checkboxs = dr.find_elements_by_css_selector('input[type=checkbox]')
for checkbox in checkboxs:
    checkbox.click()

#點選項目checkbox
checkboxs_price = dr.find_elements_by_css_selector('input[checked=checked]')
for checkbox_price in checkboxs_price:
    checkbox_price.click()

#點選指定radiobutton，區間，日
radios = dr.find_elements_by_css_selector('input[value=RB1]')
for radio in radios:
    radio.click()
    
#抓取下拉式選單元件
#年
select_year = Select(dr.find_element_by_id('ctl00_ctl00_cpl_MainContent_cpl_BasicMainContent_ddl_Year1'))
select_year.select_by_value('2018')
#月
select_month = Select(dr.find_element_by_id('ctl00_ctl00_cpl_MainContent_cpl_BasicMainContent_ddl_Month1'))
select_month.select_by_value('1')
#日
select_day = Select(dr.find_element_by_id('ctl00_ctl00_cpl_MainContent_cpl_BasicMainContent_ddl_Day'))
select_day.select_by_value('31') 

#點選查詢button
buttons = dr.find_elements_by_css_selector('input[value=查詢]')
for button in buttons:
    button.click()
    
time.sleep(10)

print("測試爬canvas圖")
print("-----------------------------------------------------------------------------------------")
# type -> data -> datasets -> label -> 價格-地方
# type -> data -> datasets -> label -> data -> y -> 價錢

url = 'http://www.foodchina.com.tw/model/ajax/getChartData.ashx'

data = {
    'Accept': '*/*',
    'Accept-Encoding': 'gzip, deflate',
    'Accept-Language': 'zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,la;q=0.6',
    'Connection': 'keep-alive',
    'Content-Length': '0',
    'Cookie':'__utmz=125772701.1629788009.10.7.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); ASP.NET_SessionId=1axaktzbcclgucnwmpq3snbw; __utmc=125772701; __utma=125772701.969281779.1625105148.1630400475.1630405677.15; __utmt=1; step=9; __utmb=125772701.2.10.1630405677',
    'Host': 'www.foodchina.com.tw',
    'Origin': 'http://www.foodchina.com.tw',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36',
    'X-Requested-With': 'XMLHttpRequest'
}

resp = requests.post(url, data = data)

# 將 HTML 轉成 BeautifulSoup 物件
soup = BeautifulSoup(resp.text, 'html.parser')
 
activities = resp.json().["type"]
print(activities)


目前會在
activities = resp.json().["type"]

這行報錯，
錯誤訊息：
JSONDecodeError: Expecting value: line 1 column 1 (char 0)

我修改很多次依然一直卡在這行。
希望有人可以建議我如何修改，謝謝！


標題:請問如何再網頁上顯示python的輸出？
標籤:php html5 python3 python 3 python 

我從未寫過網頁，最近剛好需要，要在網頁上顯示python的輸出。
例如現在輸出1，網頁上就顯示1，變成輸出3網頁就顯示3，請問這該怎麼做呢？網路上找不到相關的…


標題:python list reverse疑問
標籤:python 3 

a=list(map(int,input().split()))
b=a
print(b)
a.reverse()
print(b)

輸入:
1 2

輸出:
1 2
2 1

我是把a相反
為什麼b也一起相反了?


標題:如何在Python中在文字輸入框中鍵入Backspace刪除鍵?
標籤:python opencv backspace 

最近在用python寫一個虛擬鍵盤，但是不知道要如何設計一個Backspace刪除鍵的按鈕，所以想請問大家如何在python中有沒有方法打代表刪除鍵。


標題:windows python 版本問題
標籤:python 

想請問大大們，我下載+安裝的python是3.9.5，但是運行中的python版本卻是3.8.8，目前本機只有一個python，想問問這是怎麼回事，要怎麼讓它統一




標題:如和在python opencv解決網路攝影機畫面左右相反問題
標籤:python3 python opencv 網路攝影機 

我在python中使用cv2顯示我的外接攝影機即時畫面，但是不知為何在python執行中和在一般Windows使用時畫面都會左右相反，請問該如何解決。


標題:請問如何在spyder上 執行github的程式 
標籤:github python spyder 


如上圖，github上有許多的資料夾，
裡面又有各式各樣的程式碼，
還有許多不是程式碼的資料，
我想在spyder執行這些python的程式碼，
要如何操作?


標題:[python]要如何擷取重複的字串?
標籤:python 

給你兩個字串，要如何找出最長重複部分?
例如
輸入:
abbdf
abdfsv

輸出:
ab



標題:python 爬蟲 如何爬canvas上的資料
標籤:python 網頁爬蟲 crawler python爬蟲 爬蟲 

爬蟲目的網站(首頁/現貨行情/蛋/養雞協會雞蛋交易行情/行情圖)：http://www.foodchina.com.tw/model/marketing/AnaChartNew.aspx?id=51&ChkID=297&Page=0&Type=1&cn=False
該網站需要先利用篩選器選擇你要的資料，
(類別：全選，價格：全選，區間：日，2018年1月31日前31天走勢圖)
我目前利用
from selenium import webdriver
from selenium.webdriver.support.ui import Select

開啟該網站，並下指令去操作篩選器，
目前完整程式碼：
from selenium import webdriver
from selenium.webdriver.support.ui import Select


#安裝chromedriver，chromedriver存放位置
dr = webdriver.Chrome('C:/Users/User/chromedriver')

#造訪網頁連結
dr.get('http://www.foodchina.com.tw/model/marketing/AnaChartNew.aspx?id=51&ChkID=297&Page=0&Type=1&cn=False')

#點選所有類別checkbox
checkboxs = dr.find_elements_by_css_selector('input[type=checkbox]')
for checkbox in checkboxs:
    checkbox.click()

#點選項目checkbox
checkboxs_price = dr.find_elements_by_css_selector('input[checked=checked]')
for checkbox_price in checkboxs_price:
    checkbox_price.click()

#點選指定radiobutton，區間，日
radios = dr.find_elements_by_css_selector('input[value=RB1]')
for radio in radios:
    radio.click()
    
#抓取下拉式選單元件
#年
select_year = Select(dr.find_element_by_id('ctl00_ctl00_cpl_MainContent_cpl_BasicMainContent_ddl_Year1'))
select_year.select_by_value('2018')
#月
select_month = Select(dr.find_element_by_id('ctl00_ctl00_cpl_MainContent_cpl_BasicMainContent_ddl_Month1'))
select_month.select_by_value('1')
#日
select_day = Select(dr.find_element_by_id('ctl00_ctl00_cpl_MainContent_cpl_BasicMainContent_ddl_Day'))
select_day.select_by_value('31') 

#點選查詢button
buttons = dr.find_elements_by_css_selector('input[value=查詢]')
for button in buttons:
    button.click()

run程式後，會開啟chrome，並篩選我需要的指令，
結果跑出canvas圖，

但是我想要爬梳的是canvas圖上的折點數值，
值包在http://www.foodchina.com.tw/model/ajax/getChartData.ashx 內，
我先簡單撰寫爬蟲程式，但爬梳的結果卻沒有爬到值data的y值，
目前爬梳程式碼：
import requests
from bs4 import BeautifulSoup
import pandas as pd

url = 'http://www.foodchina.com.tw/model/ajax/getChartData.ashx'

headers = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36'}

resp = requests.post(url)

# 將 HTML 轉成 BeautifulSoup 物件
soup = BeautifulSoup(resp.text, 'html.parser')

print(soup)

想詢問我可以如何修改我的程式碼，
才可以爬到我要的值呢？謝謝


標題:python requests爬ASP button 下載檔案
標籤:python python3 python 3 requests 

目前遇到button2是個下載按鈕，但沒有連結，這樣要怎麼透過爬蟲下載呢?



標題:存在兩種分隔符號delimiter，資料前處理
標籤:delimiter pandas python 

DATA如下，想請問
我的程式碼，透過sep='\t'
import pandas as pd

df = pd.read_csv(r'test.txt', encoding='utf-8', sep="\t", header=None)
print(df.head())


OUTPUT:

若是我想要同時把前面透過\t切，後面又透過,切，切好後成一筆資料，這樣要怎麼撰寫程式碼。
謝謝，DATA如下
DATA:
2021/03/30 08:45:35	CD2	M,3500-N1-70-BB,0,553850,41275,183,15226,-6737450
2021/03/30 08:45:35	STD2	N,21966150,21963900,21964200
2021/03/30 08:45:35	ACD2	4955,4951,4951,2970
2021/03/30 08:44:07	AB1	M,2000-N1-50-DD,0,751350,56297,247,15281,-6541700
2021/03/30 08:44:06	STD1	N,21825500,21823500,21823400
2021/03/30 08:44:06	ACD1	4945,4941,4941,2964
2021/03/30 08:41:53	FAT	COMPLETE,1,0,1
2021/03/30 08:41:07	SP	RESUME_PROCESS,FULL_AUTO,1,0,1
2021/03/30 08:39:47	CAN	002,120,800,0,0,60,1800,MIX_FLUID
2021/03/30 08:36:01	CUT_HA_SN	14599,0,2951,0
2021/03/30 08:36:01	CUT	002,5489,37302,148,37302,148,OK,300,177,85,A
2021/03/30 08:34:55	NG2	112,OK XY2:Line=34,39547,230,-10,130,250,20,0,256,201413750
2021/03/30 08:34:55	KFCFLAG	1,1,2,KERF200 0 0 Z2 2
2021/03/30 08:34:44	KC1	178,OK XY2:Line=38,55524,290,20,140,260,20,0,0,0
2021/03/30 08:34:44	KFCFLAG	1,1,2,KERF200 0 0 Z1 2
2021/03/30 08:34:26	OPENKFC	2,2,2,2,0,0,1,1
2021/03/30 08:33:41	CD2	N,3500-N1-70-BB,0,556600,38722,171,15224,-6741950
2021/03/30 08:33:41	AB1	N,2000-N1-50-DD,0,758600,54826,239,15274,-6546600
2021/03/30 08:33:40	STD2	N,21967250,21965950,21965950
2021/03/30 08:33:40	STD1	N,21823500,21821100,21821050



標題:python pptx模組問題
標籤:python 

近來有需要大量將副檔名為ppt檔轉換為pptx檔的需求，
查到stack overflow的問答- Convert ppt file to pptx in Python
範例如下:
import win32com.client
App = win32com.client.Dispatch("Powerpoint.Application")
App.Visible = True
PPtPresentation = App.Presentations.Open('./test.ppt')
PPtPresentation.SaveAs('./test.pptx')
PPtPresentation.close()
App.Quit()
print('Program End')

這段程式在轉換普通的ppt檔沒有問題，
然而若是碰到加密過的ppt檔(加密方法: PowerPoint 簡報的密碼保護)，
程式會卡住停在那邊，Office則會跳出一個視窗說「請輸入ppt的密碼」，
程式也不會報錯，
需要手動將ppt的視窗關掉程式才會繼續往下走。
能否讓程式跳過加密過的ppt檔不要處理呢?
嘗試解法- 包try-except
一般來說，python的例外處理為try-except，
但我嘗試直接用try-except是無效的，
因此程式會停在那邊而不會報錯，直到手動將ppt的視窗關掉
import win32com.client
try:
    App = win32com.client.Dispatch("Powerpoint.Application")
    App.Visible = True
    PPtPresentation = App.Presentations.Open('./test.ppt')
    PPtPresentation.SaveAs('./test.pptx')
    PPtPresentation.close()
    App.Quit()
except Exception as e:
    print(e)
print('Program End')

目前我嘗試google許久，仍找不到有效的解法
其它可能的方向
目前有朝幾個方向去思考，但目前苦於找不到資料:

是否有可能用python判斷ppt檔有沒有被加密，以避免開啟加密檔讓程式hang住?
是否有可能在開啟ppt檔一段時間後，發現久未回應則自動關閉ppt檔?
是否有其它模組能做ppt to pptx的轉檔，以繞過直接用Office開檔的行為?



標題:[PYTHON ]方陣最大值
標籤:python3 


----- 以上是題目 -----
我想到有一種方法可以找到
交換後具有最大正值的圖型
去計算所有行列的+
根據+的數量交換位置
那麼最大子方陣就會存在於交換後的圖型得一個角落
也就是根據+的數量來排序
但是這並不能求出最小交換次數
請問各位這題要怎麼解?


標題:heroku排成問題 ，已經寫了day_of_week='mon-fri', hour='8-14'，可是還是每天24小時跑
標籤:python 

已經參考範例修改如下，也真的會在早上八點出現This job is run every weekday at 8am.'問題是他不會在14點停止，而是24小時無間段的執行????
請問有先進遇到過嗎???謝謝
sched = BlockingScheduler()
@sched.scheduled_job('interval', minutes=8)
def timed_job():
print('This job is run every three minutes.')
goldjob()
@sched.scheduled_job('cron', day_of_week='mon-fri', hour='8-14')
def scheduled_job():
print('This job is run every weekday at 8am.')
sched.start()


標題:[已解決]python 列表輸入多個整數?
標籤:python python3 

眼殘少打括號，已解決


標題:利用Python怎麼登入google並送出POST指令?
標籤:python3 google post 

大家好,
我是要對Google表單進行POST，現在針對沒有需要帳號登入的表單，已經可以自動填入表單
但若是需要登入帳號的表單就無法填寫，想問有人知道怎麼登入google帳號並送出POST指令嗎?
程式碼如下：
       url = url_adress
       payload = {
           data
       }
       res = rq.post(url, data=payload)
       res.status_code
        # 判斷式
        if res.status_code == 200 or res.status_code == 201 :
            mes = "SUCCESS! Status Code:%s" % ( res.status_code )
            logger.info(mes)
            print(mes)



標題:python 計算均線有誤差
標籤:python 

不管我用rolling(20).mean()還是用talib.sma算出來得到的20線是跟下單軟體有誤差的
有看到有大陸文章說talib算的是ma 不是sma，有人知道要如何計算出跟台灣下單軟體一樣的均線嗎???謝謝
stockpd["ma20"]= stockpd["Close"].rolling(20).mean()
print(stockpd["ma20"])
stockpd["ma20sma"]= talib.SMA(stockpd["Close"], timeperiod=20)
print(stockpd["ma20sma"])



標題:[問題] Python的PIP更新
標籤:#python 

RT
(使用visual code)
我原本在終機端要pip install selenium的模組
可是執行後，它跑出：
「WARNING: You are using pip version 21.1.3; however, version 21.2.4 is available.
You should consider upgrading via the 'c:\users\sting\appdata\local\programs\python\python39\python.exe -m pip install --upgrade pip' command.」
這個要理它嗎？還是要怎麼解決？
我有嘗試過更新但我不會用


標題:請問此python程式碼哪裡出問題了
標籤:python python3 python入門 python 3 python系列文章 

import cv2
from urllib.request import urlopen
import numpy as np
stream = urlopen('http://localhost:8080/?action=stream')
#此處localhost我執行時有改成自己的IP
bytes = ''
while True:
    bytes += stream.read(1024)
    #此處都會有ERROR，TypeError，改成str(stream.read(1024))才不會ERROR
    #但我總覺得不能這樣改
    a = bytes.rfind('\xff\xd8')
    b = bytes.rfind('\xff\xd9')
    if a != -1 and b != -1:
        #此處a以及b一直都是-1
        jpg = bytes[a:b+2]
        bytes = bytes[b+2:]
        i = cv2.imdecode(np.fromstring(jpg, dtype=np.uint8),cv2.IMREAD_COLOR)
        #error: (-215:Assertion failed) !buf.empty() in function 'imdecode_'
        cv2.imshow('i', i)
        if cv2.waitKey(1) == 27:
            exit(0)

這是我在網路上找的python程式碼，要從mjpg-streamer取得畫面並用opencv做後續處理，但是用python3執行後，都會出現這些問題，請問是哪裡出問題了呢？


標題:PYTHONE DAY13 多線呈中代碼疑問
標籤:pythone菜鳥問題 

網路教材:
下面的例子演示了100个线程向同一个银行账户转账（转入1元钱）的场景，在这个例子中，银行账户就是一个临界资源，在没有保护的情况下我们很有可能会得到错误的结果。
from time import sleep
from threading import Thread


class Account(object):

    def __init__(self):
        self._balance = 0

    def deposit(self, money):
        # 计算存款后的余额
        new_balance = self._balance + money
        # 模拟受理存款业务需要0.01秒的时间
        sleep(0.01)
        # 修改账户余额
        self._balance = new_balance

    @property
    def balance(self):
        return self._balance


class AddMoneyThread(Thread):

    def __init__(self, account, money):
        super().__init__()
        self._account = account
        self._money = money

    def run(self):
        self.account.deposit(self.money) ###
        這段為什麼會被運行呢


def main():
    account = Account()
    threads = []
    # 创建100个存款的线程向同一个账户中存钱
    for _ in range(100):
        t = AddMoneyThread(account, 1)
        threads.append(t)
        t.start()
    # 等所有存款的线程都执行完毕
    for t in threads:
        t.join()
    print('账户余额为: ￥%d元' % account.balance)


if __name__ == '__main__':
    main()


其中###這段程式碼為何會被運行，在main()中並沒有呼叫run 程式是如何運作完成將創建帳戶的1元存入，有大大能稍微解說下嗎(感恩


標題:關於python解題程式碼的問題
標籤:#python 3 

題目:使用python語言寫一個無窮波浪，然後按下ctrl + c停止
    ********
   ********
  ********
 ********
********
 ********
  ********
   ********
    ********

以下為我的程式碼:
import time, sys
indent = 0 #how many space to indent
indentIncreasing = True

try:
    while True: #The main program loop.
        print(' ' * indent, end='')
        print('********')
        time.sleep(0.1) #pause for 1/10 of a second.

    if indentIncreasing:
        #increase the number of spaces:
        indent = indent + 1
        if indent == 20:
            #change direction
            indentIncreasing = False
        else:
            #Decrease the number of space:
            indent = indent - 1
            if indent == 0:
                #change direction:
                indentIncreasing  = True
except KeyboardInterrupt:
    sys.exit()


用我的程式碼輸出為寬八顆星，長無窮大的長方形，
請問是哪裡出錯了呢?找了很久還是找不到問題...
謝謝


標題:python 算布林通道有誤差
標籤:python 

python 算布林通道跟下單軟體，玩股網有誤差
程式碼    thelow=stock['Close'][i].mean()-stock['Close'][i].std()*2
print(thelow)
或者用talib去帶出布林通道值都跟下單軟體有誤差
不知道有先進遇到過嗎???謝謝


標題:想在JUPYTER上開啟csv檔案，卻一直失敗><
標籤:python3 jupyternotebook 開啟 檔案路徑 

剛學python就遇到大問題QQ，想請各位幫幫忙，我想在JUPYTER上用絕對路徑開啟csv檔，卻怎麼樣都不行，爬了好多開檔案的文還有影片，卻還是找不出問題，想麻煩各位指導我哪裡不對~感恩~
import pandas as pd
data=pd.read_csv(r"‪C:\Users\chans\Desktop\googleplaystore.csv")
print(data)


標題:python 自動點擊網頁相關問題
標籤:python selenium click 

想要用python裡的Selenium寫一個點擊圖中"繼續"的程式

原本寫成 driver.find_element_by_class_name("rewardResumebutton").click()
但是會出現 NoSuchElementException
感覺跟一般的button不太一樣
一般的button滑鼠放上去會變成

但當把滑鼠放到"繼續"上面它還是維持

有方法可以點到"繼續"嗎?


標題:google drive 用 selenium 將滾輪滾到最底
標籤:selenium google drive python 

最近想要把google drive的資料夾內容名稱全部爬下來，但發現用一般滾輪下拉的方式都沒辦法成功，後來想說使用鍵盤操作按下鍵，雖然沒有出現錯誤但卻沒作用，爬出來的東西就是沒有滾動的樣子，還是說我x_path找錯地方了？
(還是有辦法可以找出滾輪js的資訊做or鼠標進行拖拉的方式來成功？
import requests 
from bs4 import BeautifulSoup
import pandas as pd
from selenium import webdriver
import time
from datetime import datetime
from selenium.webdriver.common.keys import Keys

chrome_options = webdriver.ChromeOptions()  
prefs = {"profile.default_content_setting_values.notifications" : 2}
chrome_options.add_experimental_option("prefs",prefs)
driver = webdriver.Chrome(chrome_options=chrome_options)  

url = google driver的網址
driver.get(url)


div = driver.find_element_by_xpath('//*[@class="PolqHc sd-ph"]/div')
div.send_keys(Keys.DOWN)

soup = BeautifulSoup(driver.page_source) 

for title in soup.select('.Q5txwe'):
    print(title.text)

js="var action=document.documentElement.scrollTop=100000"
driver.execute_script(js)
在其他網站都能滾，但在google drive就不行了



標題:python  使用.update_cell 更新google試算表，有時會變append有時候不會????
標籤:python 

最近在python寫了讀取寫入google試算表程式
使用update_cell去更新想要的欄位
如果原有的欄位是 B，今天使用update_cell更新為A，是可以work的
大部分時候是正常的，
但最近發現有些欄位不知道為何更新的時候會變成AB，就是原有資料還在，
新增的資料變成附加上去不會把舊資料蓋掉？
想問有人知道如何遇過嗎???因為要就是全部都蓋掉，不然全部附加，怎麼會發生有時候是附加值上去??


標題:Leetcode 1660. Correct a Binary Tree 的問題
標籤:python leetcode tree binary tree 刷題 

各位高人好，本人在刷leetcode 1660，以下是本人的Python程式碼，但不知為何會有錯。
我的想法是使用BFS，逐個level找題目所要的invalid node。找到的話就將invalid node的本身，以及其左右子樹設為None。
# Definition for a binary tree node.
# class TreeNode(object):
#     def __init__(self, val=0, left=None, right=None):
#         self.val = val
#         self.left = left
#         self.right = right
class Solution(object):
    def correctBinaryTree(self, root):
        """
        :type root: TreeNode
        :rtype: TreeNode
        """
        queue = collections.deque([root])
        
        while queue:
            visited = set()
            for _ in range(len(queue)):
                curr = queue.popleft()
                
                visited.add(curr)
                
                if curr.right in visited:
                    curr.left = None
                    curr.right = None
                    curr = None
                    continue
                    
                if curr.right:
                    queue.append(curr.right)
                if curr.left:
                    queue.append(curr.left)
        
        return root

但是，對於這個test case
[1,2,3]
2
3

我所return的還是原本的樹：[1,2,3]，顯然invalid node沒有被設為None。請問是為什麼呢？ 先謝謝各位願意看完我的問題，有不清楚的地方我會再補充!


標題:Scrapy MailSender TLS安全連線問題
標籤:python scrapy sendmail tls 

在學習Scrapy發送Email時遇到以下錯誤：
[scrapy.mail] ERROR: Unable to send mail: To=['mymail@gmail.com'] Cc=[] Subject="news" Attachs=1- 502 Server does not support secure communication via TLS / SSL

我也剛學Scrapy沒多久，程式碼部分是參考教學的，功能是Email攜帶附件CSV檔案傳送。
 def close_spider(self, spider):
        self.exporter.finish_exporting()
        self.file.close()

        mail = MailSender(
            smtphost=settings.MAIL_HOST,
            smtpport=settings.MAIL_PORT,
            smtpuser=settings.MAIL_FROM,
            smtppass=settings.MAIL_PASS,
            smtptls=settings.MAIL_TLS,
        )
        attach_name = "posts.csv"
        mime_type = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        file_object = open("posts.csv", "rb")

        return mail.send(
            to=["mymail"],
            subject="news",
            body="",
            attachs=[(attach_name, mime_type, file_object)]
        )

setting部分如下
MAIL_HOST = "smtp.gmail.com"
MAIL_PORT = 587
MAIL_FROM = "mymail"
MAIL_PASS = "**********"
MAIL_TLS = True

看錯誤訊息應該和TLS連線有關，上網爬文後還是找不到解答，請問有人可以告訴我哪裡出錯嗎?
或有任何的指教都很歡迎~

我的環境是Python 3.8.8 / Scrapy 2.5.0


標題:python selenium 問題
標籤:python selenium webdriver 

最近練習自動登入ig，不過每次都卡在是否關閉通知的頁面，在第40行的時候報錯，之前是使用絕對路徑有時候會卡住就必須要重新貼上絕對路徑，儘管他們貼上之前或之後都長得一樣，現在改成相對路徑之後每次都會卡在40行的地方報錯就卡住了連.quit瀏覽器都沒反應，請問是我的相對路徑打錯了嗎??
我是使用firefox
這是我的代碼


這是ig是否關閉通知的html
這是程式報錯



標題:python 如何在迴圈裡邊輸入變數邊計算
標籤:python python3 python入門 

我目前在學python，想請教如何在for迴圈裡一邊輸入一邊進行運算（因為input的數量會根據測資的不同而改變）。
這題是要算總價，不同區間的價格分別有所不同。
以下是第一個測資
3 級距個數（每個測資的級距個數都不一樣）
45 要購買的數量
10 第一個級距的範圍（0-10）
55 第一個級距區間的價錢
30 第二個級距的範圍（10-30）
40 第二個級距區間的價錢
1000 第三個級距的範圍（30-1000）
35 第三個級距區間的價錢
我不明白的是，當我要輸入第二個級距30時，我要如何扣掉第一個級距的範圍（0-10），以及第三個級距又要如何扣掉前兩個級距的範圍？
以下是目前已經沒轍的程式碼，有嘗試先不管第三個級距，單純先在輸入第二個級距時想辦法把第一個的範圍扣掉（abs那行），但再下去就沒辦法連貫了，如果能給我一點方向的話真的非常感謝
num_tier = int(input()) #級距數量
least_kgs = int(input()) #要購買的數量
tier_n = 0 #級距的範圍
price_n = 0 #級距的價錢
total_cost = 0 #總價
for i in range(num_tier):
tier_n = abs(tier_n - int(input()))
price_n = int(input())
print(tier_n)
if tier_n <= least_kgs:
total_cost = total_cost + tier_n * price_n
else:
total_cost = total_cost + tier_n * price_n
print(total_cost)


標題:opencv crop裁切"多張圖片"卡關
標籤:python opencv crop cv2 


我的目標:opencv讀取圖片->轉換成許多個frame的圖片檔->裁切這些圖片檔->將裁切好的圖片檔寫檔
目前階段除了裁切(crop)之外的步驟都完成了(已測試過),但我將裁切的code寫入迴圈後,就不停遇到bug,且讓我很頭痛的是怎麼debug都de不成功,求救各位大大解救python苦手謝謝!


標題:證交所爬蟲問題
標籤:python beautifulsoup 

爬蟲證交所的股票排行時，無法讀取到資料
不確定是不是BeautifulSoup的解析問題
請問該如何解決 
進行按種類爬蟲時 是沒有出錯的



標題:If.. else 的邏輯問題 (Python)
標籤:python3 程式邏輯 

各位前輩好, 小弟最近在研究人臉辨識的專案
最近寫了一個UI介面有個邏輯問題卡關
部分的代碼如下
 if recording:
            ret, frame = cap.read()
            frame,name = frf.recognize(frame, face_detector, face_encoder, encoding_dict)
            imgbytes = cv2.imencode('.png', frame)[1].tobytes()  # ditto
            window['image'].update(data=imgbytes)

            # 顯示 PASS 或 NG, 送訊號開鎖或off
            if name == 'unknown':
                # 紅燈
                window['NG'].update(visible=True)
                window['PASS'].update(visible=False)
            else:
                # 綠燈
                window['PASS'].update(visible=True)
                window['NG'].update(visible=False)
            # 燈號亮後 10 秒熄滅
            # if window['PASS'].visible==True or window['NG'].visible==True:
            #     time.sleep(10)
            #     window['PASS'].update(visible=False)
            #     window['NG'].update(visible=False)

想要的結果是:當辨識失敗, 設定的 NG 燈號會亮起, 反之成功則 PASS 燈號亮起
後面註解的是我想要在亮起後的 10 秒沒有其他動作的話就使兩個燈號 False,
但是條件設定成某個燈號亮起就倒數 10 秒的話會讓整個程式卡住, 因為直接進入這個 if 了, 請教各位前輩有沒有其他適合的條件, 或是相關的建議呢? 非常感謝!


標題:Python --- Conway's game of life 問題 
標籤:#python 3 

目前用 Python自動化的樂趣 這本書寫到 Conway's game of life 問題
以下是書中的解答
def conway_game_of_life1():
    import random, time, copy
    WIDTH  = 30
    HEIGHT = 10
        
    # Create a list of list for the cell
    nextCells = []
    for x in range(WIDTH):
        column = []    # Create a new column
        for y in range(HEIGHT):
            if random.randint(0, 1) == 0:
                column.append('#')
            else:
                column.append(' ')
        nextCells.append(column)        
    
    while True :    # This is Main loop.   
        print('\n\n\n\n\n')    # Separate each step with newlines.
        currentCwlls = copy.deepcopy(nextCells)
    
        # Print currentCells on the screen :
        for y in range(HEIGHT):
            for x in range(WIDTH):
                print(currentCwlls[x][y], end = '')    # Print the 0 or 1.
            print()    # Print a newline at the end of the row.    
    
        # Calculate the next step's cells based on current step's cells :
        for x in range(WIDTH):
            for y in range(HEIGHT):
                # Get neigboring coordinates:
                # use " % WIDTH " can ensure leftCoord is always between 0 and WIDTH - 1.
                leftCoord  = (x - 1) % WIDTH
                rightCoord = (x + 1) % WIDTH
                aboveCoord = (y - 1) % HEIGHT
                belowCoord = (y + 1) % HEIGHT
            
                # Count the number of living neighbors:
                numNeighbors = 0
                **# 在下一行出錯**
                if currentCwlls[leftCoord][aboveCoord] == '#' :
                    numNeighbors += 1
                if currentCwlls[x][aboveCoord] == '#' :
                    numNeighbors += 1    
                if currentCwlls[rightCoord][aboveCoord] == '#' :
                    numNeighbors += 1                
                if currentCwlls[rightCoord][y] == '#' :
                    numNeighbors += 1                                
                if currentCwlls[leftCoord][y] == '#' :
                    numNeighbors += 1
                if currentCwlls[rightCoord][belowCoord] == '#' :
                    numNeighbors += 1
                if currentCwlls[x][belowCoord] == '#' :
                    numNeighbors += 1 
                if currentCwlls[leftCoord][belowCoord] == '#' :
                    numNeighbors += 1    
                                        
                                        
                # Set cell based on Conway's Game of Life rules:
                if currentCwlls[x][y] == 1 and (numNeighbors == 2 or numNeighbors == 3) :
                    nextCells[x][y] = '#'
                elif currentCwlls[x][y] == 0 and numNeighbors == 3 :
                    nextCells[x][y] = '#'
                else:
                    currentCwlls = ' '
                
        time.sleep(1)

但是出現了 string index out of range 這個錯誤
請問如何更改呢 (我用的是Anaconda的Spyder)


標題:Python/ mac OS 下載chromedriver 的路徑
標籤:python chromedriver macos 

使用macOS系統，想在pycharm 上安裝seleuim 和下載chromedriver, 但是卻找不到/usr/local/bin 這個路徑。應該說 電腦上無“bin“這個folder可以讓我把下載的chromedriver 移到這個資料夾。請問路徑應該如何寫？又或者是應該把下載下來的檔案放在哪裡比較正確？
我的/urs/local/裏面沒有“bin"這個資料夾，如圖：



標題:anaconda指令 出現錯誤
標籤:@python @anaconda 


下載完anaconda後在anaconda prompt裡輸入了conda update --all 後跳出了這項錯誤，查了一些資料依舊沒頭緒，請問可能是哪裡出了問題呢?


標題:python 寫法風格與改寫
標籤:python excel 

目前程式如下:
這是處理Excel 貼圖的模組(其實還沒寫完整)
https://github.com/cj044/Git-exp2/blob/master/good_picture.py
這是主要的程式
https://github.com/cj044/Git-exp2/blob/master/tabe.py
目前問題有3個
1.如何把tabe.py的 col=0 的部分替換成
https://i.imgur.com/dd8QK2q.png
good_picture.py 的wb= load 的部分取代掉
https://i.imgur.com/zATbK6O.png

還是直接把good_picture.py  變成import 套件方式
引用?

3.tabe.py 的直接寫法，跟good_picture.py 的def 先宣告寫法的方式，後者包起來寫的法是差別在維護性嗎?
謝謝!


標題:python  os.rename  問題
標籤:python 3 

想抓取影片檔的拍攝日期，之後更改檔名。
但程式跑到rename時直接停住，也沒有跳出錯誤訊息，想請前輩們幫忙看一下是哪裡出錯...

#取得影片檔建立日期(mp4 mov)
import os
import time
import pytz
import datetime
from win32com.propsys import propsys, pscon

movPath = r"D:\test"

for filename in os.listdir(movPath):
    old_path = os.path.join(movPath, filename)

    properties = propsys.SHGetPropertyStoreFromParsingName(old_path)
    dt = str(properties.GetValue(pscon.PKEY_Media_DateEncoded).GetValue())

    new_name = dt[0:10] + "_" + filename

    new_path = os.path.join(movPath, new_name)

    print(old_path, " -> " ,new_path)

    os.rename(old_path, new_path) ##### 程式到這行不運行，也沒出現錯誤
    



標題:python flask send_from_directory的使用問題
標籤:#python #flask 

@app.route("/resume_result",methods=['POST','GET'])
def resume_result():
api=request.form['apiname']
    jsondata=request.form['userinput好']
    res=requests.post(apilist[api], json=json.loads(jsondata))
    filename=api+str(datetime.now()).replace(' ', '').replace(':','')
    if not os.path.exists('file'):
        os.mkdir('file')
    with open(f'file/{filename}.odt','wb') as f:
        f.write(res.content)
    return render_template('result.html', link=f'{filename}.odt')
@app.route('/download/<path:filename>',methods=['POST','GET'])
def download(filename):
    return send_from_directory(directory='file',filename=filename)

以上是部分的程式碼，上面的做法是把檔案下載到file資料夾後，跳轉到result.html頁面並提供一條下載連結，
此下載連結檔案會利用send_from_directory，把file內的檔案回傳。
我想請問的是我能夠把以上程式碼改成以下
@app.route("/resume_result",methods=['POST','GET'])
def resume_result():
    api=request.form['apiname']
    jsondata=request.form['userinput好']
    res=requests.post(apilist[api], json=json.loads(jsondata))
    filename=api+str(datetime.now()).replace(' ', '').replace(':','')
    if not os.path.exists('file'):
        os.mkdir('file')
    with open(f'file/{filename}.odt','wb') as f:
        f.write(res.content)
    return send_from_directory(directory='file',filename=filename)

把提交過來的表單內容處理完後建完檔案直接回傳，而不用再提供一個頁面提供下載連結，但是程式的回傳結果會是錯誤的"POST /resume_result HTTP/1.1" 404。
我想請問是哪邊的想法有問題和為什麼不能這樣做?


標題:python  有關tkinter的疑問
標籤:@python 

import tkinter
from tkinter import messagebox
def showMsg():
i = radio_v.get()
messagebox.showinfo('選取結果', '您最想去的國家為: '+country[i])
win = tkinter.Tk()
win.title('最想要旅遊的國家調查')
win.geometry('300x150')
label = tkinter.Label(win, text='請選取你想要去的國家: ').pack()
country = {0: '土耳其', 1: '英國', 2: '日本', 3: '埃及'}
radio_v = tkinter.IntVar()
radio_v.set(0)
for i in range(len(country)):
tkinter.Radiobutton(win, text=country[i],variable=radio_v,value=i).pack()
tkinter.Button(win, text='確定', command=showMsg).pack()
win.mainloop()
想請教一下，這個範例中當按下其中一個選項按鈕時，variable會有怎樣的變化，跟value有關係嗎?  還有為什麼Checkbutton沒有像Radiobutton一樣有value這個參數呢?


標題:google爬蟲，多個url問題
標籤:爬蟲 google map python 

大家好，近日想爬取多個商家的google留言，但是卡在for迴圈該怎麼包
單間門市的code>>可執行，完全沒問題
import requests
from bs4 import BeautifulSoup
import time #for sleep 禮貌
import json
import pandas as pd
import numpy as np
from datetime import datetime

'輸入URL'
mos_url = ['https://www.google.com.tw/maps/preview/review/listentitiesreviews?authuser=0&hl=zh-TW&gl=tw&pb=!1m2!1y3777493749147037723!2y8534284370484108607!2m2!1i'+str(i*10)+'!2i10!3e1!4m5!3b1!4b1!5b1!6b1!7b1!5m2!1sS1ECYffLOIXDmAXwxYL4Bg!7e81','https://www.google.com.tw/maps/preview/review/listentitiesreviews?authuser=0&hl=zh-TW&gl=tw&pb=!1m2!1y3776609519000852551!2y14246988762960797572!2m2!1i'+str(i*10)+'!2i10!3e1!4m5!3b1!4b1!5b1!6b1!7b1!5m2!1sS1ECYffLOIXDmAXwxYL4Bg!7e81']

#%%
'預設1500篇'
for url in mos_url :
    null = np.nan #將api裡的null變成nan，不然會報錯
    final = []
    end = 0
    i = 0
    while end == 0: #判斷何時停止
        if i%5 == 0 : print(i,end='->')
        # 摩斯
        print(url) # chk有在動
        req_text = requests.get(url)
        res = eval(req_text.text.replace(')]}\'\n','')) #整理一下
        if type(res[2]) == float: #評論資訊是nan就停止，代表沒留言了
            print('stop')
            end = 1 
        else:
                for data in res[2]: #評論資訊都在這
                #         print(len(data))
                    res_dict = {}
                    for j in range(len(data)):
                        res_dict[j] = data[j]
                        res_dict['scrap_time'] = datetime.now().strftime("%Y/%m/%d %H:%M:%S")
                    final.append(res_dict)      
        i+=1    
        if i > 150: #避免無線迴圈，要爬多少則留言(留言數 = i*10)
            end = 1
        time.sleep(1) #禮貌啦哪次不禮貌

# print(final)
df = pd.DataFrame(final)
#將epoch time轉成時間 (建議用df apply但我不會...QQ)
arr = []
for i in range(len(df)):
    arr.append(time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(int(round(df[27][i]/1000)))))
        
    df['post_time'] = arr
    
    new_df = df[[0,3,4,10,11,12,14,16,18,27,30,32,39,'post_time','scrap_time']] #篩選重要欄位
    new_df_columns = ['用戶資料', '留言內容', '評分', '某id1', '某id2',
                      '用戶資訊詳細','圖片資訊詳細', '讚數', '圖片清單連結', '貼文epoch時間',
                      '恩災(感覺重要)', '語言','恩災2','貼文時間','爬蟲時間'] #欄位重新命名
    new_df.columns = new_df_columns
    
    new_df
        
        #new_df.to_csv('D:/mos全省爬蟲.csv',encoding="utf-8-sig")

#exit()
#%%
'chk'
new_df['評分'].mean()
new_df['評分'].count()



標題:python 深度學習 圖片標準化
標籤:python 深度學習 

想請問在圖片進行標準化之後 資料的筆數有明顯的不正確
看起來是next那一行出了問題 該如何修改呢
https://ithelp.ithome.com.tw/upload/images/20210804/20137034fFcRlVAysD.png


標題:[已解決] [Python]  找出最接近二千萬的質數?
標籤:python3 

我的程式碼
for i in range(20000000):
    c=0
    for j in range(int((20000000-1-i)**0.5)-1):
        c+=1
        if (20000000-1-i)%c==0:
            continue
        if (20000000-1-i)%c!=0:
            if c==int((20000000-1-i)**0.5)-1:
                print(20000000-1-i)
                break

我嘗試自己寫了一下，但是我感覺我自己寫出來的程式1.無效率2.有錯誤(但我找不出錯在哪裡)
請問大神能幫我除錯嗎?


標題:如何用python取得user-agent
標籤:python 

想取得自己電腦的瀏覽器user-agent
網上很多方法都是要開啟瀏覽器後F12或開啟網址
然後再複製到python中
from fake_useragent import UserAgent測試過不行
他取得的瀏覽器user-agent和我電腦的瀏覽器user-agent不一樣
有什麼方法取得自己瀏覽器的user-agent嗎


標題:DNN 神經網路小問題 python
標籤:python dnn 

想請問為甚麼訓練出來的模型 預測的結果都是一樣的
預測的目標是 spal length
model = Sequential()
model.add(Dense(256, activation="sigmoid", input_dim=4))
model.add(Dense(128, activation="relu"))
model.add(Dense(1))
model.compile(optimizer = optimizers.SGD(learning_rate=0.1), loss = "mse", metrics="mse")
history = model.fit(feature_train, result_train, epochs=5, verbose=1, batch_size=2)
score = model.evaluate(feature_train, result_train)
print(f"loss:{score[0]}, mse:{score[1]}")
print(mean_squared_error(result_test, model.predict(feature_test)))

到這裡應該都沒有問題
可是當我要測試的時候 預測出來的結果卻都是一模一樣的
print( model.predict(feature_test))



標題:Python 根據字串條件 substring 
標籤:python if-else 

嘗試將多個csv檔案concatenate在一起，其中一個字串欄位含有RE或沒有RE，想嘗試擷取日期和時間。使用IF-ELSE敘述 但兩者substring的結果是一樣位置的字串，想請問我的IF-ELSE敘述哪裡寫錯了，請幫忙指證，謝謝! 目前輸出的結果如下圖所示。
import pandas as pd
import numpy as np
import os

path_dataset = r'C:\Users\test'

def get_file(path_dataset):
    files = os.listdir(path_dataset) #check file list
    files.sort() #sort file
    file_list = []
    for file in files:
        path = path_dataset + "\\" + file
        if (file.startswith("test")) and (file.endswith(".csv")):
        file_list.append(path)
    return (file_list)

read_columns = ['NAME']

read_files = get_file(path_dataset)

all_df = []

for file in read_files:
    df = pd.read_csv(file, usecols = read_columns)

    if (str(df['NAME'].astype(str).str[23:25]) == 'RE-'):
        df['DATE_TIME'] = df['NAME'].astype(str).str[26:40]
    else:
        df['DATE_TIME'] = df['NAME'].astype(str).str[22:37]
    
all_df.append(df)

Concat_table = pd.concat(all_df, axis=0)
Concat_table = Concat_table.sort_values(['DATE_TIME'])

Concat_table.head()
Concat_table.to_csv(os.path.join(path_dataset, 'Concate_all.csv'), index=False)

執行以上程式碼的結果:

預期跑出的結果:



標題:python程式問題
標籤:python 


想請問sys.argv[1] IndexError: list index out of range問題該如何解決


標題:通過Python執行Excel巨集
標籤:#python #excel #vba 

請問各位大神
我想要在Python 中使用 EXCEL VBA巨集 請問該怎麼做呢?
有爬文大概了解了需要使用win32com.client
還是不了解具體的寫法
有範例可以讓我參考嗎? 謝謝
巨集 是個人巨集


標題:ta-lib的算出來的KD值跟看盤軟體不同
標籤:python 

程式碼如下

以日月光為例，也確認資料都正確，close價格都對

可是算出來的KD值卻跟看盤軟體或者玩股網之類的網站不同

也沒有把周末計算在內，不懂問題出在那哩，還請先進指點一下
謝謝


標題:[新手發問]在gcp上解析xml並存成csv失敗
標籤:python爬蟲 #gcp xml轉csv 

在GCP中希望可以將先前上傳到值區的檔案解析後在別的值區另存成csv檔
修改後會顯示OSError: [Errno 30] Read-only file system: 'emic_text_1628469624.xml.csv'
不太懂新增一個csv檔為什麼會被回報只能讀
請問問題出在哪呢，謝謝各位大大
#開啟先前上傳的檔案
def main(event, context):
  download_blob(event['bucket'], event['name'], '/tmp/'+event['name'])
  filename = f"{event['name']}.csv"
  pat = '/tmp/'+event['name']
  _emic_csv_writer(pat , filename)
  upload_blob("emic-csv-cla", "/tmp/"+filename, filename)

#將該檔案解析後儲存為csv檔
def _emic_csv_writer(pat , filename):
  xmlparse = ET.parse( pat )
  root = xmlparse.getroot()
  rows = []
  cnt = 0

  for i in root[1].findall('{http://emic.eoc.gov.tw/disaster_info}DISASTER_DATA'):
      print(cnt)
      cnt += 1
      CASE_ID = i.find("{http://emic.eoc.gov.tw/disaster_info}CASE_ID").text
      CASE_DT = i.find("{http://emic.eoc.gov.tw/disaster_info}CASE_DT").text
      CASE_LOC = i.find("{http://emic.eoc.gov.tw/disaster_info}CASE_LOC").text
      DISASTER_MAIN_TYPE_NODE = i.find("{http://emic.eoc.gov.tw/disaster_info}DISASTER_MAIN_TYPE")
      DISASTER_MAIN_TYPE = "None" if DISASTER_MAIN_TYPE_NODE is None  else DISASTER_MAIN_TYPE_NODE.text
      CASE_DESCRIPTION = i.find("{http://emic.eoc.gov.tw/disaster_info}CASE_DESCRIPTION").text
      print(CASE_ID)
    
    
      rows.append({"CASE_ID": CASE_ID,
                   "CASE_DT": CASE_DT,
                   "CASE_LOC": CASE_LOC,
                   "DISASTER_MAIN_TYPE": DISASTER_MAIN_TYPE,
                   "CASE_DESCRIPTION": CASE_DESCRIPTION
                   })
    
  df = pd.DataFrame(rows)
  df.to_csv( filename , encoding = 'utf-8')



標題:請問為甚麼while 裡面的 time 並不會累加到 self.cook.time 中呢?
標籤:python 

1.定義類別: 初始化屬性、被考核添加條掉的方法，顯示對象的信息str
class SweetPotato():
def init(self):
# 烤的時間
self.cook_time = 0
# 地瓜的狀態
self.cook_state = '生的'
# 調料列表
self.condiments = []
def cook(self, time):
    """烤地瓜的方法"""
    # 烤的時間，狀態
    self.cook_time += time
    if 0 <= self.cook_time < 3:
        self.cook_state = '生的'
    elif 3 <= self.cook_time < 5:
        self.cook_state = '半生不熟'
    elif 5 <= self.cook_time < 8:
        self.cook_state = '熟了'
    else:
        self.cook_state = '燒焦了'

def add_condiments(self, condiment):
    """用戶意願的調料追加到調料列表"""
    self.condiments.append(condiment)

def __str__(self):
    return f"這個地瓜總共烤了{self.cook_time}分鐘，狀態是{self.cook_state},調料有{self.condiments}"

2.創建對象，並調用對應的方法
i = 0
while i < 8:
sweetPotato = SweetPotato()
time = int(input('預烤時間為:'))
sweetPotato.cook(time)
condiment = input('調料為:')
sweetPotato.add_condiments(condiment)

print(sweetPotato)
i += time



標題:python 無法使用pip  No module named pip
標籤:pip python spyder 

spyder突然不能開，重新下載python跟spyder，python下載的時候也有選加到環境變數裡，之後要用spyder下載模組出現No module named pip，可是直接開cmd幫pip升級卻成功了，而且用cmd pip pygame卻又顯示成功，不過在spyder裡用pygame卻又顯示 No module named 'pygame' 已經重新下載ide跟python好幾次了，請問pip是哪裡出錯了..
版本是python 3.9.6


標題:python pyinstaller/auto-py-to-exe打包問題
標籤:python dist exe pyinstaller auto-py-to-exe 

想把一個遊戲打包，遊戲碼在spyder跑都沒問題，要打包的時候分別用過pyinstaller跟auto py to exe，請問為什麼最後都會跑出
AttributeError: Module 'PyQt5' has no attribute 'version'
installer打包完後有build、dist資料夾跟spec檔，但dist裡卻沒有執行檔，auto py to exe則是什麼都沒跑出來最後只有顯示上面的錯誤代碼而已


標題:如何把Python裡的資料儲存到網路
標籤:python 資料儲存 



標題:初學 Python 欄位字串更改及排序問題
標籤:#python #csv #字串 

大家好，如下圖截圖，想詢問：
A欄中相同的數字視為一群組，如果每一群組中，B欄的C前面沒有A，那A欄的數字就要替換成上一個數字

像這張圖，A欄的5就會全部變成1；30就會全部變成8
已上網爬文許久且試了許多方法，但還是跑不出來，想請大家幫忙解答，謝謝！


標題:Python如何改寫If 判斷式 若dataframe 欄位為動態
標籤:python if 

我有很多csv檔案需要定期做樞紐分析pivot_table，這些csv的某個欄位的內容轉為樞紐後成為樞紐表格的欄位，但每次並不固定。程式的最後需要使用IF判斷式做輸出，但因為樞紐表格的欄位是動態的，無法用單一寫法，請問如何改寫?謝謝幫忙。
我的簡化範例如下，假設df為我讀取的csv檔案，在這個例子下可以執行IF判斷式做輸出。
import pandas as pd
import numpy as np

dic = {
"Category": ['Math', 'Math', 'Math', 'Math', 'Math', 'Math', 'History', 'History','History','History','History','History','Physics','Physics','Physics','Physics','Physics','Physics'], 
"Name": ['John', 'Mary', 'Scott','Kevin','Judy','Lee','John', 'Mary', 'Scott','Kevin','Judy','Lee','John', 'Mary', 'Scott','Kevin','Judy','Lee'],
"Scores": [59,64,50,33,80,20,30,44,65,66,78,80,94,56,55,61,12,11]}

df = pd.DataFrame(dic)

df2=df.pivot_table(index= ['Name'], columns="Category", values=['Scores'])
 
df2.columns=df2.columns.droplevel(0)

if ((df2['History'] > 60) | (df2['Math'] > 70) | (df2['Physics'] > 50)).any():
     print ('send email')
else:
    print ('all scores under subject limit, dont send email)

可能會遇到的形況如下，讀入的df並沒有History這個Category，此時造成IF判斷式無法輸出。
import pandas as pd
import numpy as np

dic = {
"Category": ['Math', 'Math', 'Math', 'Math', 'Math', 'Math','Physics','Physics','Physics','Physics','Physics','Physics'], 
"Name": ['John', 'Mary', 'Scott','Kevin','Judy','Lee','John', 'Mary', 'Scott','Kevin','Judy','Lee'],
"Scores": [59,64,50,33,80,20,30,44,65,66,78,80]}

df = pd.DataFrame(dic)

df2=df.pivot_table(index= ['Name'], columns="Category", values=['Scores'])
 
df2.columns=df2.columns.droplevel(0)

if ((df2['History'] > 60) | (df2['Math'] > 70) | (df2['Physics'] > 50)).any():
     print ('send email')
else:
    print ('all scores under subject limit, dont send email)

請問如何改寫IF判斷式，讓他能夠動態偵測我有哪些欄位。需注意的是，我的每個欄位都附帶分數的篩選條件。謝謝幫忙!


標題:簡單的python問題
標籤:python3 

要怎麼讓我的輸出
「A,B,C,D,F」在同一行
這是我的程式
def calc_average(n):
average = (a+b+c+d+e)/5
print(average)
return average
def determine_grade(n):
if n >= 90:
print("A")
elif n >= 80 and n < 90:
print("B")
elif n >= 70 and n < 80:
print("C")
elif n >= 60 and n < 70:
print("D")
else:
print("F")
def grade(n):
n = int(input())
determine_grade(n)
return n
a=grade(1)
b=grade(2)
c=grade(3)
d=grade(4)
e=grade(5)
calc_average(a+b+c+d+e)


標題:如何用selenium載入全部的google map評論
標籤:python selenium webdriver selenium google map 網路爬蟲 

------更新------
我剛剛用了一個超笨的方法成功了!
我先算評論的總數然後除10的數字，再讓迴圈跑評論的總數/10次 就可以到底了!!
不好意思打擾各位><
我想寫一個程式可以爬取某店家所有google map的評論，並存到excel裡面
但是google map的評論一次只能顯示10條
其他的評論要滑到最下面才看的到
我用selenium寫爬蟲的程式，但到了拉到評論最下方卻一直失敗
部分程式碼如下:
from selenium import webdriver
import time
from selenium.webdriver.common.by import By

options = webdriver.ChromeOptions()
prefs = {
    'profile.default_content_setting_values':
        {
            'notifications': 2
        }
}
options.add_experimental_option('prefs', prefs) 
options.add_argument("disable-infobars") 

driver = webdriver.Chrome(options=options)
driver.maximize_window() 

driver.get("https://www.google.com.tw/maps/place/%E5%AF%8C%E9%82%A6%E7%94%A2%E9%9A%AA_%E5%85%A7%E6%B9%96%E9%80%9A%E8%A8%8A%E8%99%95/@25.0715679,121.5690505,15z/data=!4m9!1m2!2m1!1z5a-M6YKm5Lq65aO9!3m5!1s0x3442ac7b98a115e9:0x38f556ed9e9e62a!8m2!3d25.0737343!4d121.5756891!15sCgzlr4zpgqbkurrlo70iA4gBAZIBEWluc3VyYW5jZV9jb21wYW55?hl=zh-TW")

time.sleep(2)
driver.find_element_by_class_name("widget-pane-link").click()
time.sleep(2)

#pane = driver.find_element_by_xpath('//*[@id="pane"]/div/div[1]/div/div/div[2]')
#driver.execute_script("arguments[0].scrollTop = arguments[0].scrollHeight", pane) ps.這個是成功可以滑動的，但是我不知道要怎麼讓她偵測滑到最底部停止
driver.execute_script("var q=document.documentElement.scrollTop=10000") #這個完全沒用，完全不會滑動

我上網查了超多資料都失敗 請問我是哪一步做錯了呢?
謝謝大家幫忙!


標題:nnn
標籤:python 

1


標題:python的if問題
標籤:python入門 #python求救 if 

各位大大好，我是今天剛開始學python的小菜雞，我今天剛看完一部教學，想說自己寫個簡易計算機來測試看看，想要順便練習file的用法，於是就想用txt檔做計算，分別抓數字回來，但是在計算判斷的時候，不管怎樣他都偵測不到我的運算符號，我在文檔中打+，我用print來自己看有沒有抓到符號，是有抓到的，可是在if裡面卻是沒有偵測到直接跑到最後的否則了，小弟我嘗試許久都沒有辦法就來這邊求救了(剛開始學請不要鞭的太用力)
#抓取題目

with open("calculator.txt",mode="r",encoding="utf-8") as file:
    #數字一
    num1 = float(file.readline())
    #運算符號
    cal = file.readline()
    #數字二
    num2 = float(file.readline())

#運算
Ans = None
print(cal)
if cal=="+":
        Answer = (num1 + num2)
elif cal=="-":
        Answer = (num1 - num2)
elif cal=="*":
        Answer = (num1 * num2)
elif cal=="x":
        Answer = (num1 * num2)
elif cal=="/":
        Answer = (num1 / num2)
else:
    Answer= "我還沒寫這個算法"
print(str(Answer))
#將答案覆寫回去    
with open("calculator.txt",mode="w",encoding="utf-8") as file:
    file.write(str(num1))
    file.write("\n"+cal)
    file.write(str(num2))
    file.write("\n=")
    file.write("\n"+str(Answer))
    




標題:python的模組twstock的fetch_from參數是不是會被擋
標籤:python 

原本帶入twstock模組後，都可以成功地去抓我要的股票資訊並且發出line notify訊息

可是當我加上fetch_from 以後就出現錯誤訊息了

請問是我前面測試line nofify訊息太多次，還是現在有擋fetch_from???
謝謝
後來過了幾分鐘後 只要不執行fetch_from是可以撈股票資訊的，但是只要執行fetch_from就被擋掉了。


標題:LSTM 預測船舶路徑
標籤:lstm python 

最近剛開始學習各種演算法 沒想到第一關我就卡住了...
教授丟給我一筆資料叫我去跑看看 但我總是跑不出來預測的資料準確度
想請問各位學長姊 我應該怎麼做



import pandas as pd   #表格
import numpy as np    #維度陣列與矩陣運算
import string         #字串
import matplotlib.pyplot as plt   #匯入數學算式
from sklearn.model_selection import train_test_split
import tensorflow 
from tensorflow.keras import backend as k 
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.layers import LSTM
from tensorflow.keras.layers import Dropout
import math
import h5py
from keras import optimizers
from keras.callbacks import EarlyStopping


def getDistance(latA, lonA, latB, lonB):
    ra = 6378140  # 赤道半徑
    rb = 6356755  # 極半徑
    flatten = (ra - rb) / ra  # Partial rate of the earth
    # change angle to radians
    radLatA = math.radians(latA)
    radLonA = math.radians(lonA)
    radLatB = math.radians(latB)
    radLonB = math.radians(lonB)

    pA = math.atan(rb / ra * math.tan(radLatA))
    pB = math.atan(rb / ra * math.tan(radLatB))
    x = math.acos(math.sin(pA) * math.sin(pB) + math.cos(pA) * math.cos(pB) * math.cos(radLonA - radLonB))
    c1 = (math.sin(x) - x) * (math.sin(pA) + math.sin(pB)) ** 2 / math.cos(x / 2) ** 2
    c2 = (math.sin(x) + x) * (math.sin(pA) - math.sin(pB)) ** 2 / math.sin(x / 2) ** 2
    dr = flatten / 8 * (c1 - c2)
    distance = ra * (x + dr)
    distance = round(distance / 1000, 4)
    return distance

def mape(act,pred):  
    diff = abs((act - pred) / (abs(act)))
    # print(diff)
    return 100. * np.mean(diff)

def rmse(act,pred):
    return math.sqrt(np.mean((pred - act)**2))

#def cal_distance(lon1, lat1, lon2, lat2):
   #  lon1, lat1, lon2, lat2 = map(math.radians, [lon1, lat1, lon2, lat2])
   #  dlon = lon2-lon1
   #  dlat = lat2-lat1
   #  a = math.sin(dlat/2)**2 + math.cos(lat1)*math.cos(lat2)*math.sin(dlon/2)**2   
   #  c = 2*math.asin(math.sqrt(a))
   #  r = 6371
   #  return c * r * 1000

dataframe = pd.read_csv(r'C:\Users\Song You Chen\Desktop\vessels\TEST_data.csv')
dataframe = dataframe[["Lon","Lat"]]
dataframe = dataframe.dropna(axis='rows')
dataframe = dataframe.drop_duplicates(keep = 'first' , inplace= False)

dataset = dataframe.values
data = dataframe.values
data_scaler = dataset.astype('float64')
plt.scatter(data[:, 0], data[:, 1], c='r', marker='o', label='pre_true')

train,test = train_test_split(dataset,test_size=0.1,random_state=0)
def create_dataset(dataset, look_back):
    dataX, dataY = [], []
    for i in range(len(dataset) - look_back - 1):
        a = dataset[i:(i + look_back)]
        dataX.append(a)
        dataY.append(dataset[i + look_back])
    return np.array(dataX), np.array(dataY)

#reshape into X = t, Y = t+1 //建立落後期
look_back = 2
trainX, trainY= create_dataset(train, look_back)
testX, testY= create_dataset(test, look_back)

#LSTM網路輸入結構:(資料集, 時間步長, 特徵) 一維
#reshape input to be [sample, time, features]
trainX = np.reshape(trainX, (trainX.shape[0], trainX.shape[1], 2))
testX = np.reshape(testX, (testX.shape[0], testX.shape[1], 2))





model = Sequential() #使用Window Method的堆疊LSTM層
#keras.layers.normalization.BatchNormalization(momentum=0.99, epsilon=0.001, center=True, scale=True, beta_initializer='zeros', gamma_initializer='ones', moving_mean_initializer='zeros', moving_variance_initializer='ones', beta_regularizer=None, gamma_regularizer=None, beta_constraint=None, gamma_constraint=None)
model.add(LSTM(256, input_shape=(look_back, 2), 
               #activation='relu', 
               return_sequences=True,
               recurrent_activation='relu',
               ))
# model.add(Conv1D(filters=64, kernel_size=2, activation='relu'))
# model.add(BatchNormalization())
model.add(LSTM(128, activation='relu',
               return_sequences=True,
               # recurrent_activation='relu',
               # kernel_regularizer=keras.regularizers.l1(0.001),
               # kernel_regularizer=keras.regularizers.l1(0.001),
               dropout = 0.0))
model.add(LSTM(128, activation='relu',
               return_sequences=False,
               # recurrent_activation='relu',
               # kernel_regularizer=keras.regularizers.l1(0.001),
               # kernel_regularizer=keras.regularizers.l1(0.001),
               dropout = 0.0))

'''
model.add(LSTM(2, activation='relu',
               recurrent_activation='tanh',
               dropout = 0.2))
'''
#建立全連接層
# model.add(Dense(10, kernel_initializer ='normal', activation='relu'))
# model.add(Flatten())
# model.add(Dense(10))
model.add(Dense(2))

#優化器調參及選擇
# sgd = optimizers.SGD(lr=0.00001, decay=1e-6, momentum=0.9, nesterov=True)
#adam = optimizers.Adam(lr=0.00001, beta_1=0.9, beta_2=0.999, epsilon=None, decay=1e-5)
adam = optimizers.Adam(lr=0.001)
# rmsprop = optimizers.RMSprop(lr=0.001, rho=0.9, epsilon=None, decay=1e-6)
model.compile(loss='mean_squared_error', optimizer = 'adam')
model.summary()

train_history = model.fit(trainX, trainY,
                       epochs=100,
                       batch_size=64,
                       validation_split=0.2,
                       verbose=2)

#earlystopping建立, 模型訓練
model.save(r'C:\Users\Song You Chen\Desktop\vessels\loss046_049.h5')
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)

print("MAPE:",mape(testY,testPredict))
print("RMSE:",rmse(testY,testPredict))

plt.clf()
plt.scatter(testY[:, 0], testY[:, 1], c='g', marker='o', label='true')
plt.scatter(testPredict[:, 0], testPredict[:, 1], c='r', marker='p', label='Predict')
plt.legend(loc='upper right')
plt.grid()
plt.show()
#print("直線距離(KM):",cal_distance(testY[:1,0],testY[:1,1], testPredict[:1,0], testPredict[:1,1]))


number = 0
for i  in range(len(testY)):
        X = getDistance(testY[i,0],testY[i,1],testPredict[i,0],testPredict[i,1]) 
        number = number + X 
score = number / len(testY)


但跑出來的圖卻是背離

算出來的距離相差了28km  但老師的答案卻只有400m


標題:用 python 爬蟲ajax 動態頁面 
標籤:python 網路爬蟲 爬蟲 網頁爬蟲 

爬蟲網站連結：https://m.coa.gov.tw/Transaction/PoultryTrans/Index

第一次接觸爬蟲ajax資料，真的有些難度，
找了很多資料，目前卡在這裡，
程式碼提供：
import requests
from bs4 import BeautifulSoup
import pandas as pd

url = 'https://m.coa.gov.tw/Transaction/PoultryTrans/Index'

headers = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36'}

resp = requests.post(url, headers = headers)

# 將 HTML 轉成 BeautifulSoup 物件
soup = BeautifulSoup(resp.text, 'html.parser')

table = soup.find_all("table", {"id":"searchtable"})
tr = soup.find_all('tr')

for trr in tr:
    tdlist = trr.find_all('td')

result = []    
activities = resp.json()["rows"]
for activity in activities:
    # 交易日期
    date = activity["TradeDate"]
 
    # 雞蛋產地價格
    price = activity["Column4Data"]

    result.append(
        dict(date = date, price = price))
print(result) #爬到的值  
case_dataframe = pd.DataFrame(result, columns = ['交易日期', '雞蛋產地價格'])
print(case_dataframe) #放入dataframe


print出結果：
[{'date': '110/07/19', 'price': '52'}, {'date': '110/07/12', 'price': '52'}, {'date': '110/07/05', 'price': '52'}, {'date': '110/06/28', 'price': '52'}, {'date': '110/06/07', 'price': '52'}, {'date': '110/06/07', 'price': '52'}, {'date': '110/05/31', 'price': '52'}, {'date': '110/05/24', 'price': '52'}, {'date': '110/05/24', 'price': '52'}, {'date': '110/05/17', 'price': '52'}, {'date': '110/05/17', 'price': '52'}, {'date': '110/05/10', 'price': '52'}, {'date': '110/05/10', 'price': '52'}, {'date': '110/05/03', 'price': '51.1'}, {'date': '110/04/26', 'price': '50'}, {'date': '110/04/19', 'price': '50'}, {'date': '110/04/19', 'price': '50'}, {'date': '110/04/12', 'price': '50'}, {'date': '110/04/05', 'price': '50'}, {'date': '110/03/29', 'price': '50'}]
    交易日期  雞蛋產地價格
0    NaN     　　NaN
1    NaN     　　NaN
2    NaN   　　  NaN
3    NaN   　　  NaN
4    NaN   　　  NaN
5    NaN   　　  NaN
6    NaN   　　  NaN
7    NaN  　　   NaN
8    NaN  　　   NaN
9    NaN  　　   NaN
10   NaN   　　  NaN
11   NaN  　　   NaN
12   NaN   　　  NaN
13   NaN  　　   NaN
14   NaN   　　  NaN
15   NaN  　　   NaN
16   NaN  　　   NaN
17   NaN   　　  NaN
18   NaN  　　   NaN
19   NaN  　　   NaN


因為我想爬2018年1月1日至2021年5月31日這區間日期的資料，
但是我還沒設定區間，他會產生出從110/03/29每7天的資料，
我不理解這7天是哪裡來的？
以及為什麼明明爬到資料了，
但放入dataframe後卻顯示NaN？


標題:檔案自動化 Windows PowerShell 與 Python的選擇
標籤:powershell python 

以Windows目錄下的檔案移動、XML修改、程序自動化來說
Windows PowerShell 與 Python 哪一個比較適合學習??
目前我是用command bash寫了一個改xml的工作用的小工具
但是執行效率不佳，語法很冗長，而且不利於加工維護


標題:Python日期缺失，日期與其欄位資料補0。
標籤:python 

小弟寫了一個Python空缺補0的程式碼(缺7/6)，但是遇到為兩筆資料7/1~7/10連續排序，導致填0時只顯示上排的7/1~7/10，不知有什麼方法解決。



標題:【已解決】python 爬蟲網頁選取區間資料 問題
標籤:python crawler 爬蟲 網頁爬蟲 python爬蟲 

我要爬梳的網站連結：https://m.coa.gov.tw/Transaction/PoultryTrans/Index

我想爬梳2018年1月1日至2021年5月31日區間的資料，
但是目前print出來的值會以{xxxx}的方式呈現
(我需要的欄位是交易日期與雞蛋(產地價))，
我不理解為什麼？
程式碼提供：
import requests
from bs4 import BeautifulSoup
import pandas as pd

payload = {
    'StartDate':'2018/06/26',
    'EndDate':'2021/07/26',
    'DataSource': 1,
    'NoRest':'false',
    'NowPage':1,
    'SortAction':'DESC',
    'SortField':'TradeDateTime',
    'PageSize': 20
}

url = 'https://m.coa.gov.tw/Transaction/PoultryTrans/Index'

headers = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36'}

resp = requests.get(url, data = payload)

# 將 HTML 轉成 BeautifulSoup 物件
soup = BeautifulSoup(resp.text, 'html.parser')

table = soup.find_all("table", {"id":"searchtable"})

print(table)


目前結果：
[<table class="table table-hover row mx-0 LCGD" id="searchtable">
<thead class="w-100">
<tr class="row mx-0 LCGD_Header" id="Title2">
<th class="col-sm" data-sortname="TradeDate" id="col1" scope="col">交易日期</th>
<th class="col-sm-1" id="col2" scope="col">農曆</th>
<th class="col-sm" id="col3" scope="col">白肉雞(2.0Kg以上)</th>
<th class="col-sm" id="col4" scope="col">白肉雞(1.75-1.95Kg)</th>
<th class="col-sm" id="col5" scope="col">白肉雞(門市價高屏)</th>
<th class="col-sm" id="col6" scope="col">雞蛋(產地)</th>
<th class="col-sm mobile-none" id="col7" scope="col" style="display:none"> </th>
<th class="col-sm mobile-none" id="col8" scope="col" style="display:none"> </th>
<th class="col-sm mobile-none" id="col9" scope="col" style="display:none"> </th>
<th class="col-sm mobile-none" id="col10" scope="col" style="display:none"> </th>
<th class="col-sm mobile-none" id="col11" scope="col" style="display:none"> </th>
</tr>
</thead>
<tbody class="w-100">
<tr class="row mx-0 LCGD_Template" id="Result">
<td class="col-sm" scope="row"><span class="d-inline-block d-sm-none">交易日期：</span><a class="btn-detail" data-tradedate="{TradeDate}">{TradeDate}</a></td>
<td class="col-sm-1"><span class="d-inline-block d-sm-none">農曆：</span>{LunarCalendar}</td>
<td class="col-sm"><span class="d-inline-block d-sm-none dataTitle1">白肉雞(2.0Kg以上)：</span>{Column1Data} <span class="price-data1"><i class="far"></i> {Column1DataGain}</span> </td>
<td class="col-sm"><span class="d-inline-block d-sm-none dataTitle2">白肉雞(1.75-2.0Kg)：</span>{Column2Data} <span class="price-data2"><i class="far"></i> {Column2DataGain}</span> </td>
<td class="col-sm"><span class="d-inline-block d-sm-none dataTitle3">白肉雞(高屏門市價)：</span>{Column3Data} <span class="price-data3"><i class="far"></i> {Column3DataGain}</span> </td>
<td class="col-sm td-border" id="data4">
<span class="d-inline-block d-sm-none dataTitle4">雞蛋(產地價)：</span>
                        {Column4Data}
                        <span class="price-data4">
<i class="far"></i>
                            {Column4DataGain}
                        </span>
</td>
<td class="col-sm" id="data5" style="display:none">
<span class="d-inline-block d-sm-none dataTitle5"></span>
                        {Column5Data}
                        <span class="price-data5">
<i class="far"></i>
                            {Column5DataGain}
                        </span>
</td>
<td class="col-sm" id="data6" style="display:none">
<span class="d-inline-block d-sm-none dataTitle6"></span>
                        {Column6Data}
                        <span class="price-data6">
<i class="far"></i>
                            {Column6DataGain}
                        </span>
</td>
<td class="col-sm" id="data7" style="display:none">
<span class="d-inline-block d-sm-none dataTitle7"></span>
                        {Column7Data}
                        <span class="price-data7">
<i class="far"></i>
                            {Column7DataGain}
                        </span>
</td>
<td class="col-sm" id="data8" style="display:none">
<span class="d-inline-block d-sm-none dataTitle8"></span>
                        {Column8Data}
                        <span class="price-data8">
<i class="far"></i>
                            {Column8DataGain}
                        </span>
</td>
<td class="col-sm td-border" id="data9" style="display:none">
<span class="d-inline-block d-sm-none dataTitle9"></span>
                        {Column9Data}
                        <span class="price-data9">
<i class="far"></i>
                            {Column9DataGain}
                        </span>
</td>
</tr>
</tbody>
</table>]


目前我先以page 1的資料撰寫，
後續再拉長日期區間。


標題:python sql語法 在command 裡加入變數
標籤:#mariadb python sql def 參數 

不好意思，小弟剛使用mariaDB，這邊是使用python進行操作，但不大熟悉裡面的指令與操作，希望請求各位大神的幫助

我想把上方的程式定義成function，能夠查詢platform跟topic兩個column中不重複的值，試了以下兩種方式都失敗:
1.

2.

想知道上方的code如何改正，麻煩各位大神回答了


標題:jupyter notebook matplolib下載問題
標籤:python 


如圖 請問這樣為何無法import


標題:關於macOS下Python版本的問題
標籤:google cloud platform python3 python gcp macos 

如題，因為要使用GCP的SDK，谷歌官方文件說需要Python 3 ，我之前已經有載好Python 3了，但是在terminal輸入 python -v 出現的是

This version is included in macOS for compatibility with legacy software.
Future versions of macOS will not include Python 2.7.
Instead, it is recommended that you transition to using 'python3' from within Terminal.

我知道macOS本身就有自帶的Python 2 但照上面的意思，是不是需要修改環境變數呢？
還是說我電腦裡有Python 3下載的Google Cloud SDK 他有辦法自己抓到Python 3呢？
（OS版本是Big Sur 本身沒有在開發Python, 純粹都是第三方軟體需要）
還請前輩們幫忙指點一下，感恩了！


標題:如何讓 Python 的 input() 省略按 Enter 鍵？
標籤:python3 input() 不要enter 

Python 在文字模式下使用 input() 時
不論敲入什麼東西
最後都要按下 Enter 鍵（大陸稱為回車鍵）
輸入的字串才會被接受，程式繼續往下走。
請問各位大大
有沒有辦法
改設定為固定敲入幾個字元
就自動接收，不用再多按那個 Enter 鍵
例如：程式執行到
input('同意與否？ Y/N')
使用者只要按 Y 或 N 其中一個鍵程式就繼續
不需要按 Y 再按 Enter


標題:generative adversarial network 的 spectual normalization 是什麼意義呢？謝謝！
標籤:python generator generative adversarial network adversarial gan 

已知原生 generative adversarial network 的目標函數，等價於優化生成數據的分布 pg 與真實數據的分布 pr 之間的 js 散度
模型分布的支持與目標分布（指的就是真實照片）與支持不相交時，存在能夠很好區分模型分布與目標分布的 discriminator ，在這種情況下， discriminator 對輸入的導數為零，也就代表 discriminator 很早就進入了理想狀態，總能完美地分辨出真假，因此無法給 generator 提供梯度信息


標題:Python selenium  driver 多進行續 
標籤:python 多執行緒 driver 關閉 

各位午安
因小弟是新手Python
目前再嘗試多進行續，程式碼如下
一開始使用quit()去進行關閉，卻只會關閉一個視窗，改用.close()和.join()卻會出現ValueError: Pool is still running 的錯誤
想像各位大師求救是哪裡有問題，拜託了
from selenium import webdriver
from selenium.webdriver.support import expected_conditions as EC
import sqlite3
import xml.etree.ElementTree as ET
#讀取xml檔
import threading
#儲存driver開啟時的變數資料
from multiprocessing.pool import ThreadPool
#多行程
def read_sql(input_value):
conn = sqlite3.connect(input_value)
cursor = conn.execute("SELECT id, name, phone, email  from Usertable") 
return cursor

def read_xlm(input_value):
tree = ET.parse(input_value)
root = tree.getroot()
obj=root.findall('A')
return obj    

def read_browser(input_value):
browser = getattr(threadLocal, 'browser', None)
if browser is None:
    headers = {
        'User-Agent': 'Googlebot',
        'From': 'YOUR EMAIL ADDRESS'
    }
    option = webdriver.ChromeOptions()
    option.add_argument('disable-gpu')
    option.add_argument('blink-settings=imagesEnabled=false')
    browser=webdriver.Chrome(chrome_options=option)
    browser.implicitly_wait(5)

    setattr(threadLocal, 'browser', browser)
url=input_value
browser.get(url)
return browser

def read_program(input_value):
xlm_obj=read_xlm('filename.xml')
browser=read_browser('https://www.clue.com.tw/webinars/LandingPage/Get/mD6hD')

try:
    username=browser.find_element_by_name(xlm_obj[0][0].text)
    username.send_keys(input_value[1])
    
    userFull_cphone=browser.find_element_by_name(xlm_obj[0][1].text)
    userFull_cphone.send_keys(input_value[2])

    usermail=browser.find_element_by_name(xlm_obj[0][2].text)
    usermail.send_keys(input_value[3])

    browser.find_element_by_id('btn_submit').click()
    result = EC.alert_is_present()(browser)

    if result :
        alert = browser.switch_to.alert 
        result=alert.text
        alert.accept()
    else:
        try:
            title = browser.title
            if title == "SaveSuccess - TransferMVC":
                result="成功輸入"     
        except:
            try:
                title = browser.title
                if title == "SaveSuccess - TransferMVC":
                    result="成功輸入"
            except:
                result="其他錯誤"
except:
        browser.quit()               
        result="異常中斷"
        print(result)

   
csv_result=(input_value[1],input_value[2],input_value[3],result)
return csv_result ,browser    
    

if name == 'main':
threadLocal = threading.local()
sql_cursor=read_sql('Users(alert).db')

program= ThreadPool(2).map(read_program,sql_cursor)

ThreadPool(2).close()
ThreadPool(2).join()

#program[0][1].quit()
#直接使用只會關閉一個視窗

資料庫的部分



標題:python dataframe 計算
標籤:python pandas dataframe calculator column 

----------原本表格-------------
   總數1  總數2
0    1    3
1    2    4
2    3    5

(總數1)/6
(總數2)/12
----------希望呈現-------------
   總數1  百分比1  總數2  百分比2
0    1     0.16     3     0.25
1    2     0.33     4     0.33
2    3     0.5      5     0.41

我想利用變數，將總數1欄位每筆資料除以該變數後，新增百分比1欄位，並將剛剛計算完的資料insert到該欄位對應格子內。


標題:無法安裝chatterbot
標籤:無法安裝chatterbot python chatterbot 

想要安裝python裡的chatterbot，但試了網路上的方法一直裝不起來，最後都會出現一堆紅字(如圖)，不懂是因為版本嗎還是有其他問題？求解......



標題:python geopandas 安裝成功，但import不出來
標籤:python geopandas pip import anaconda 

我已經在電腦成功安裝geopandas了

但是當我使用python import geopandas時，
import sys
import geopandas as gpd
import pandas as pd
from shapely.geometry import Point
from math import radians, cos, sin, acos
import time, pymssql, datetime

卻顯示此錯誤訊息，
Traceback (most recent call last):
  File "C:\Users\User\six\IDW.py", line 2, in <module>
    import geopandas as gpd
ModuleNotFoundError: No module named 'geopandas'

geopandas非常複雜，
安裝很久終於成功後，
現在卻還是import不到...


標題:python flask 登錄系統
標籤:python3 flask login 

請問一下如何用python製作網站的登錄系統（我是個小白）


標題:heroku時區問題，已經修改了，但是在log仍然看到時區+00，
標籤:python 

我打了heroku config:add TZ="Asia/Taipei"指令後，也在Heroku網頁中的"Settings"。接著點擊 "Reveal Config Vars"，。然後在 "Config Vars"如下圖，也在這裡確認有修改成功了

可是在log的地方卻仍然看到時間是+00，還是這樣是正常的嗎???
謝謝



標題:安裝 python GDAL 版本問題
標籤:python gdal geopandas anaconda pip 

我搜尋我電腦的Python版本為3.9.2且我電腦是64位元
C:\Users\User>python
Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.

所以我應該下載

我將此whl檔下載後，放入anacondas內Scripts資料夾內(照著網路教學實作)，
開啟anaconda prompt，輸入pip install 並將我的檔案拉進去，如下：
(base) C:\Users\User>pip install C:\Users\User\anaconda3\Scripts\GDAL-3.3.1-cp39-cp39-win_amd64.whl

但卻出現版本不相容問題
ERROR: GDAL-3.3.1-cp39-cp39-win_amd64.whl is not a supported wheel on this platform.

後來我改下載38版本的，

結果居然安裝成功，
(base) C:\Users\User>pip install C:\Users\User\anaconda3\Scripts\GDAL-3.3.1-cp38-cp38-win_amd64.whl
Processing c:\users\user\anaconda3\scripts\gdal-3.3.1-cp38-cp38-win_amd64.whl
GDAL is already installed with the same version as the provided wheel. Use --force-reinstall to force an installation of the wheel.

請問有人知道為什麼嗎？
但我的python明明是39版本，
網路上還沒看到跟我一樣的


標題:python 算列平均值
標籤:python 資料整理 

大家好:
附圖是某個字詞檔案，index欄位是字詞，我想要以列為單位，抓出>0的值，計算平均值，如第一列的均值應該是0.0343731，但目前code只能算整列平均值

test['均值'] = test.mean(axis=1)



標題:Python 錯誤 SyntaxError: invalid syntax  書籍中的範例
標籤:python3 machine learning 

請問 SyntaxError: invalid syntax的錯誤，是指哪邊錯了
print("Here is what learned: {}".format(10.get_weights()))
另外我是用gooogle的Colab 不知道有沒有關係?
以下的內容是來自書籍歐萊禮出版的"從程式員到AI專家" page 18頁
import tensorflow as tf
import numpy as np
from tensorflow.keras import Sequential
from tensorflow.keras.layers import Dense

10 = Dense(units=1, input_shape=[1])
model = Sequential([10])
model.compile(optimizer='sgd', loss='mean_squared_error')     

xs = np.array([-1.0, 0.0, 1.0, 2.0, 3.0, 4.0], dtype=float)
ys = np.array([-3.0, -1.0, 1.0, 3.0, 5.0, 7.0], dtype=float)

model.fit(xs, ys, epochs=500)

print(model.predict([10.0]))
print("Here is what learned: {}".format(10.get_weights()))

  File "<ipython-input-1-1b6e69b84ead>", line 16
    print("Here is what learned: {}".format(10.get_weights()))
                                                         ^
SyntaxError: invalid syntax



標題:如何用python寫傅立葉轉換?
標籤:python3 傅立葉轉換 

想請教各位前輩該如何用python寫傅立葉轉換?
(如: 波長方波 -> 時域)
以下是程式碼:
import numpy as np
import seaborn
from matplotlib import pyplot as plt
from scipy.fftpack import fft


x = np.linspace(-100,100, 1000)
y = np.array([1 if abs(t)<=50 else 0 for t in x])
yf = np.fft.fft(y)
xf = np.linspace(-4*np.pi,4*np.pi,1000)

#背景格線
plt.grid(color = 'black', linestyle = '--', linewidth = 0.5)
#方波
plt.plot(xf,abs(yf))

plt.savefig('wronganswer.png')
plt.show()

希望能跑出波浪狀的圖 (如圖)

但如果用fft會跑出另一種圖片(如圖)

請問該如何撰寫會比較好?


標題:Python 回傳Function迴圈內判斷式的值
標籤:python 

我是Python新手，抱歉這個問題可能過於簡單，但摸索了幾個小時還是達不到想要的成果。
想請問懂Python的大大幫忙回答。
這是我的dataframe:

問題(1):
寫了一個Function想要回傳一個list，把符合條件的Wafer列出來，這是我的Code:

預期能夠回傳如以下的list，在JupytorNoteBook可以顯示，然而print的結果在圖片最底下卻出現None。請問怎麼解決回傳list的問題？

問題(2):
我的這個Function def check_df_col，要怎麼動態的讀取colume的header? 而不是一個Bin一個Bin指定。 例如我的df3並沒有Bin column 2 或 3， 此時我的check_df_col會出錯，有什麼方式能改寫這個判斷回圈？
謝謝大大指教！


標題:需要0900到下午1330自動排程，schedule.every()可以設定????
標籤:python 

請問是在迴圈裏頭寫入判斷幾點幾就開始執行，還是schedule.every()，本身就可以設定出
0900到1300每隔五分鐘執行一次呢???謝謝



標題:PYTHON寫入GOOGLE EXCEL的問題
標籤:python 

有Sheets.append_row，卻沒有Sheets.append_COL????
要如何Sheets.append_row 寫在第二航或者第二列呢???
從excel讀第一行列或者第一列寫到陣列中已經沒問題了
可是當我想把資料寫到第二行或者第二列，甚至工作表2卻發生問題。
真的已經摸了好幾小時了。還是搞不定，希望先進能指點一下，謝謝



標題:python 移除list的問題
標籤:python 

比如說我寫了一個del.py檔案
然後裏頭寫了下面程式碼
程式進行中的確是刪除了,可是下次檔案打開他還在??
其實這個陣列變數也還在，
因為無窮迴圈每一分鐘執行一次這個job，可是a=[3,4,5]都還在
def(job)
a = [4, 3, 5]
a.pop(0)
a.pop(1)
a.pop(2)


標題:class="title"出了什麼問題? 
標籤:python3 bs4 find() beautifulsoup python beautifulsoup 

各位大神們好:
Python 3.9.6
BeautifulSoup 4.9.3
我跟著YT影片練習，附上影片截圖
YT影片 23分37秒處
https://www.youtube.com/watch?v=9Z9xKWfNo7k&list=PL-g0fdC5RMboYEyt6QS2iLb_1m7QcgfHk&index=19&t=1234s

目前我照著影片編碼，現在練習到要找PTT電影板中第一個標題，就在div標籤中的class="title"
附上PTT截圖

我的編碼
import urllib.request as req
url="https://www.ptt.cc/bbs/movie/index.html"
request=req.Request(url, headers={
"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"
})
with req.urlopen(request) as response:
data=response.read().decode("utf-8")
import bs4
root=bs4.BeautifulSoup(data, "html.parser")
titles=root.find("div", class="title")  #<=======這句有問題??
print(titles)
跑出來的結果有問題，篩選class="title"倒底出了什麼問題? 在這句之上的都跑過都沒問題。
titles=root.find("div", class="title")
^
SyntaxError: invalid syntax
沒法跑出跟影片中的一樣

希望大大們能幫忙找出問題，為什麼我的bs4卻find不到? 就算改成find_all也找不到? 因為YT影片是2019年的，是不是bs4有更新過? 感謝。


標題:python 連接 monogodb有問題
標籤:python 

ServerSelectionTimeoutError: cluster0-shard-00-02.loi5o.mongodb.net:27017: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1125),cluster0

以及請問連接字串中的myFirstDatabase這個地方是不是需要修改，但後來也改過也不行，不知道是否有人可以指點一下，謝謝，是否有先進修改過這個地方 謝謝

程式碼如下

網路也設定全開了，但是從頭到尾都是用手機網路測試，也用過telnet cluster0-shard-00-02.loi5o.mongodb.net 27017 是可以連上的

我有把myFirstDatabase改成箭頭中所指處，可是還是一樣無法連接



標題:python coding style & design pattern & DS 參考書｜工具書請益
標籤:#參考書籍 python3 

各位大神好，這裡是下下週要onboard的死大學生，因為公司貌似很高的程式碼品質需求（因為入社測試好多哲學性的題目），所以前來請益。
小弟因為對js,java,C++都有比較深的了解，所以深知coding style（還有其他零零總總的“精神”）的重要性，為了上班後不要被電爆所以希望IT幫的大大們可以賜與我一盞明燈。
另外，小弟前半年～一年的工作是處理CICD的自動化（不知道實際內容，但直覺告訴我是用python的感覺），但小弟的經驗都是都躲在實驗室裡面做的（而且不是用py做）。也不太知道外面的世界長什麼樣子，如果有前輩願意推薦相關的書籍，希望不要被電爆嗚嗚嗚。


標題:python merge後變空值
標籤:自學python merge 

請問為什麼從證交所抓下來的csv檔合併後的df總是會有一邊的資料會是空白呢??
改過merge的參數都還是會有一邊空白,用pandas.read_csv解析出來的感覺也沒甚麼問題,還請各位指教了!
這個是合併後的df總是有一邊會空白

這個是合併到df的df1
這個是code



標題:python tensorflow-gpu
標籤:tersorflow gpu rtx3060 spyder python 


我是使用RTX3060的顯卡可是都沒辦法正常的執行程式
都會跑出restarting kernel
拜託各位幫幫小弟
非常感謝


標題:如何用python取得檔案的詳細資料
標籤:python 

有辦法取得檔案中的詳細資料嗎

我目前找不到什麼方法能抓到這個頁面的資料


標題:有關自製簡易API給APP使用
標籤:flutter 爬蟲 python node.js api 

最近在學習flutter，想要實作一個簡單的APP：只要輸入某平台的帳號密碼，就能夠幫使用者即時查詢他在該平台上的資訊
那好像就得要先用外部資源，幫我把資料整理好，再靠flutter幫我顯示在APP上
所以資料抓取和處理的部分，我目前的想法是爬蟲+自製API
但是對於要選哪種語言學習感到很徬徨，我爬文後得到兩種選項：

Python + Flask
Node.JS

雖然知道兩者都能爬蟲，但是不知道哪種方法比較適合我
有python爬蟲和JS的基本知識，至於Node.JS和Flask則是完全沒有概念
還是有其他更好的方法，拜託大神們邦幫我
第一次在it發言，還請大家見諒


標題:cannot import name 'MongoClient' from partially initialized module 'pymongo
標籤:python 

anaconda已經是裝最新版的了，然後Spyder 4.2.5版
然後再mlab申請500mb免費資料庫連結如下
https://mlab.com/
但使用Python連結資料庫卻發生import有問題，不知道是否有先進知道如解決該問題
謝謝，原本裝舊版本anaconda換成新版的也是如此，也把整個os換成新的，因為是虛擬機還原很快。
ImportError: cannot import name 'MongoClient' from partially initialized module 'pymongo' (most likely due to a circular import)




標題:python 修改dataframe的值後出現Nan
標籤:python dataframe 

大家好，最近剛開始學python，想請問為什麼將df1的資料引用到df後會出現NaN呢?? 還請各位指教
for i in df['證券代號']:
for x in df1['證券代號']:
if i == x:
df.at[df.index[df['證券代號'] == i].tolist(), "殖利率(%)"] =df1.loc[df1.index[df1['證券代號'] == i].tolist(),'殖利率(%)']
在這段代碼之後CSV檔的殖利率(%)會出現空白而不是出現對應證券代號的殖利率


標題:如何將大量url檔匯入書籤
標籤:chrome firefox 書籤 匯入書籤 python 

我有大量URL檔
現在想匯入chrome或firefox的書籤
但是他們匯入的要求是html
雖然有把URL檔放到我的最愛再匯入的方式
但畢竟IE沒了
以後可能連我的最愛也會消失
所以再找其他方法
如果是直接把URL檔拉到書籤
一次只能拉一個
也不能拉資料夾
所以想問
有沒有辦法把大量的URL檔包含資料夾的目錄
轉成一個html檔


標題:python 如何利用 for 迴圈 印出table內所有 td值？
標籤:python 網頁爬蟲 td table 迴圈 

import requests
from bs4 import BeautifulSoup

payload = {
    '_EVENTTARGET':'',
    '__EVENTARGUMENT':'',
    '__LASTFOCUS':'',
    '__VIEWSTATEGENERATOR': '02BC70F4',
    '__SCROLLPOSITIONX': 0,
    '__SCROLLPOSITIONY': 791.2000122070312,
    '__VIEWSTATE':'/wEPDwUKMTU5MDY1ODkxMw9kFgJmD2QWAgIDD2QWAgIDD2QWCAIDDxBkDxYDZgIBAgIWAxAFA+ihqAUBMGcQBQnntbHoqIjlnJYFATFnEAUN6KGoK+e1seioiOWclgUBMmdkZAIHD2QWHAIBDxBkDxYaZgIBAgICAwIEAgUCBgIHAggCCQIKAgsCDAINAg4CDwIQAhECEgITAhQCFQIWAhcCGAIZFhoQBQQxOTk2BQQxOTk2ZxAFBDE5OTcFBDE5OTdnEAUEMTk5OAUEMTk5OGcQBQQxOTk5BQQxOTk5ZxAFBDIwMDAFBDIwMDBnEAUEMjAwMQUEMjAwMWcQBQQyMDAyBQQyMDAyZxAFBDIwMDMFBDIwMDNnEAUEMjAwNAUEMjAwNGcQBQQyMDA1BQQyMDA1ZxAFBDIwMDYFBDIwMDZnEAUEMjAwNwUEMjAwN2cQBQQyMDA4BQQyMDA4ZxAFBDIwMDkFBDIwMDlnEAUEMjAxMAUEMjAxMGcQBQQyMDExBQQyMDExZxAFBDIwMTIFBDIwMTJnEAUEMjAxMwUEMjAxM2cQBQQyMDE0BQQyMDE0ZxAFBDIwMTUFBDIwMTVnEAUEMjAxNgUEMjAxNmcQBQQyMDE3BQQyMDE3ZxAFBDIwMTgFBDIwMThnEAUEMjAxOQUEMjAxOWcQBQQyMDIwBQQyMDIwZxAFBDIwMjEFBDIwMjFnZGQCAw8QZA8WGmYCAQICAgMCBAIFAgYCBwIIAgkCCgILAgwCDQIOAg8CEAIRAhICEwIUAhUCFgIXAhgCGRYaEAUEMTk5NgUEMTk5NmcQBQQxOTk3BQQxOTk3ZxAFBDE5OTgFBDE5OThnEAUEMTk5OQUEMTk5OWcQBQQyMDAwBQQyMDAwZxAFBDIwMDEFBDIwMDFnEAUEMjAwMgUEMjAwMmcQBQQyMDAzBQQyMDAzZxAFBDIwMDQFBDIwMDRnEAUEMjAwNQUEMjAwNWcQBQQyMDA2BQQyMDA2ZxAFBDIwMDcFBDIwMDdnEAUEMjAwOAUEMjAwOGcQBQQyMDA5BQQyMDA5ZxAFBDIwMTAFBDIwMTBnEAUEMjAxMQUEMjAxMWcQBQQyMDEyBQQyMDEyZxAFBDIwMTMFBDIwMTNnEAUEMjAxNAUEMjAxNGcQBQQyMDE1BQQyMDE1ZxAFBDIwMTYFBDIwMTZnEAUEMjAxNwUEMjAxN2cQBQQyMDE4BQQyMDE4ZxAFBDIwMTkFBDIwMTlnEAUEMjAyMAUEMjAyMGcQBQQyMDIxBQQyMDIxZ2RkAgcPEGQPFhpmAgECAgIDAgQCBQIGAgcCCAIJAgoCCwIMAg0CDgIPAhACEQISAhMCFAIVAhYCFwIYAhkWGhAFBDE5OTYFBDE5OTZnEAUEMTk5NwUEMTk5N2cQBQQxOTk4BQQxOTk4ZxAFBDE5OTkFBDE5OTlnEAUEMjAwMAUEMjAwMGcQBQQyMDAxBQQyMDAxZxAFBDIwMDIFBDIwMDJnEAUEMjAwMwUEMjAwM2cQBQQyMDA0BQQyMDA0ZxAFBDIwMDUFBDIwMDVnEAUEMjAwNgUEMjAwNmcQBQQyMDA3BQQyMDA3ZxAFBDIwMDgFBDIwMDhnEAUEMjAwOQUEMjAwOWcQBQQyMDEwBQQyMDEwZxAFBDIwMTEFBDIwMTFnEAUEMjAxMgUEMjAxMmcQBQQyMDEzBQQyMDEzZxAFBDIwMTQFBDIwMTRnEAUEMjAxNQUEMjAxNWcQBQQyMDE2BQQyMDE2ZxAFBDIwMTcFBDIwMTdnEAUEMjAxOAUEMjAxOGcQBQQyMDE5BQQyMDE5ZxAFBDIwMjAFBDIwMjBnEAUEMjAyMQUEMjAyMWdkZAIIDxBkDxYMZgIBAgICAwIEAgUCBgIHAggCCQIKAgsWDBAFATEFATFnEAUBMgUBMmcQBQEzBQEzZxAFATQFATRnEAUBNQUBNWcQBQE2BQE2ZxAFATcFATdnEAUBOAUBOGcQBQE5BQE5ZxAFAjEwBQIxMGcQBQIxMQUCMTFnEAUCMTIFAjEyZ2RkAgoPEGQPFhpmAgECAgIDAgQCBQIGAgcCCAIJAgoCCwIMAg0CDgIPAhACEQISAhMCFAIVAhYCFwIYAhkWGhAFBDE5OTYFBDE5OTZnEAUEMTk5NwUEMTk5N2cQBQQxOTk4BQQxOTk4ZxAFBDE5OTkFBDE5OTlnEAUEMjAwMAUEMjAwMGcQBQQyMDAxBQQyMDAxZxAFBDIwMDIFBDIwMDJnEAUEMjAwMwUEMjAwM2cQBQQyMDA0BQQyMDA0ZxAFBDIwMDUFBDIwMDVnEAUEMjAwNgUEMjAwNmcQBQQyMDA3BQQyMDA3ZxAFBDIwMDgFBDIwMDhnEAUEMjAwOQUEMjAwOWcQBQQyMDEwBQQyMDEwZxAFBDIwMTEFBDIwMTFnEAUEMjAxMgUEMjAxMmcQBQQyMDEzBQQyMDEzZxAFBDIwMTQFBDIwMTRnEAUEMjAxNQUEMjAxNWcQBQQyMDE2BQQyMDE2ZxAFBDIwMTcFBDIwMTdnEAUEMjAxOAUEMjAxOGcQBQQyMDE5BQQyMDE5ZxAFBDIwMjAFBDIwMjBnEAUEMjAyMQUEMjAyMWdkZAILDxBkDxYMZgIBAgICAwIEAgUCBgIHAggCCQIKAgsWDBAFATEFATFnEAUBMgUBMmcQBQEzBQEzZxAFATQFATRnEAUBNQUBNWcQBQE2BQE2ZxAFATcFATdnEAUBOAUBOGcQBQE5BQE5ZxAFAjEwBQIxMGcQBQIxMQUCMTFnEAUCMTIFAjEyZ2RkAg4PEA8WAh4HVmlzaWJsZWhkZGRkAg8PEA8WAh8AaGQPFhpmAgECAgIDAgQCBQIGAgcCCAIJAgoCCwIMAg0CDgIPAhACEQISAhMCFAIVAhYCFwIYAhkWGhAFBDE5OTYFBDE5OTZnEAUEMTk5NwUEMTk5N2cQBQQxOTk4BQQxOTk4ZxAFBDE5OTkFBDE5OTlnEAUEMjAwMAUEMjAwMGcQBQQyMDAxBQQyMDAxZxAFBDIwMDIFBDIwMDJnEAUEMjAwMwUEMjAwM2cQBQQyMDA0BQQyMDA0ZxAFBDIwMDUFBDIwMDVnEAUEMjAwNgUEMjAwNmcQBQQyMDA3BQQyMDA3ZxAFBDIwMDgFBDIwMDhnEAUEMjAwOQUEMjAwOWcQBQQyMDEwBQQyMDEwZxAFBDIwMTEFBDIwMTFnEAUEMjAxMgUEMjAxMmcQBQQyMDEzBQQyMDEzZxAFBDIwMTQFBDIwMTRnEAUEMjAxNQUEMjAxNWcQBQQyMDE2BQQyMDE2ZxAFBDIwMTcFBDIwMTdnEAUEMjAxOAUEMjAxOGcQBQQyMDE5BQQyMDE5ZxAFBDIwMjAFBDIwMjBnEAUEMjAyMQUEMjAyMWcWAQIZZAIQDxAPFgIfAGhkDxYMZgIBAgICAwIEAgUCBgIHAggCCQIKAgsWDBAFATEFATFnEAUBMgUBMmcQBQEzBQEzZxAFATQFATRnEAUBNQUBNWcQBQE2BQE2ZxAFATcFATdnEAUBOAUBOGcQBQE5BQE5ZxAFAjEwBQIxMGcQBQIxMQUCMTFnEAUCMTIFAjEyZxYBZmQCEQ8QDxYCHwBoZA8WA2YCAQICFgMQBQbkuIrml6wFATFnEAUG5Lit5pesBQIxMWcQBQbkuIvml6wFAjIxZxYBZmQCEg8PFgIfAGhkZAITDxAPFgIfAGhkDxYaZgIBAgICAwIEAgUCBgIHAggCCQIKAgsCDAINAg4CDwIQAhECEgITAhQCFQIWAhcCGAIZFhoQBQQxOTk2BQQxOTk2ZxAFBDE5OTcFBDE5OTdnEAUEMTk5OAUEMTk5OGcQBQQxOTk5BQQxOTk5ZxAFBDIwMDAFBDIwMDBnEAUEMjAwMQUEMjAwMWcQBQQyMDAyBQQyMDAyZxAFBDIwMDMFBDIwMDNnEAUEMjAwNAUEMjAwNGcQBQQyMDA1BQQyMDA1ZxAFBDIwMDYFBDIwMDZnEAUEMjAwNwUEMjAwN2cQBQQyMDA4BQQyMDA4ZxAFBDIwMDkFBDIwMDlnEAUEMjAxMAUEMjAxMGcQBQQyMDExBQQyMDExZxAFBDIwMTIFBDIwMTJnEAUEMjAxMwUEMjAxM2cQBQQyMDE0BQQyMDE0ZxAFBDIwMTUFBDIwMTVnEAUEMjAxNgUEMjAxNmcQBQQyMDE3BQQyMDE3ZxAFBDIwMTgFBDIwMThnEAUEMjAxOQUEMjAxOWcQBQQyMDIwBQQyMDIwZxAFBDIwMjEFBDIwMjFnFgECGWQCFA8QDxYCHwBoZA8WDGYCAQICAgMCBAIFAgYCBwIIAgkCCgILFgwQBQExBQExZxAFATIFATJnEAUBMwUBM2cQBQE0BQE0ZxAFATUFATVnEAUBNgUBNmcQBQE3BQE3ZxAFATgFAThnEAUBOQUBOWcQBQIxMAUCMTBnEAUCMTEFAjExZxAFAjEyBQIxMmcWAWZkAhUPEA8WAh8AaGQPFgNmAgECAhYDEAUG5LiK5pesBQExZxAFBuS4reaXrAUCMTFnEAUG5LiL5pesBQIyMWcWAWZkAgkPZBYEAgEPEGQQFQMS55Si5Zyw6L6y5aC05YO55qC8EuW4guWgtOaLjeizo+WDueagvAzpm7bllK7lg7nmoLwVAwExATYBMxQrAwNnZ2cWAWZkAgUPDxYCHgRUZXh0BVZDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMF8wLENoZWNrQm94TGlzdF9wcm9kdWN0TGlzdF8xXzAsQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzJfMGRkAhkPDxYCHwEFDzxkaXY+DQoNCjwvZGl2PmRkGAIFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYuBTRjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCRDaGVja0JveF9pc1Nob3daZXJvBUJjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y190aW1lU2VsZWN0b3IkUmFkaW9uQnV0dG9uX3llYXIFQmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3RpbWVTZWxlY3RvciRSYWRpb25CdXR0b25feWVhcgVCY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyX2NvbnRlbnQkdWNfdGltZVNlbGVjdG9yJFJhZGlvQnV0dG9uX21vbnRoBU9jdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3ByaWNlVHlwZSQwBU9jdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3ByaWNlVHlwZSQxBU9jdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3ByaWNlVHlwZSQyBU9jdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3ByaWNlVHlwZSQyBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQwBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQxBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQyBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQzBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQ0BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQ1BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQ2BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzBfMCQ2BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQwBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQxBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQyBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQzBVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQ0BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQ1BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQ2BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQ3BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQ4BVVjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQ5BVZjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzFfMCQxMAVWY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyX2NvbnRlbnQkdWNfcHJvZHVjdExpc3RfbWl4VmVyJENoZWNrQm94TGlzdF9wcm9kdWN0TGlzdF8xXzAkMTAFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDAFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDEFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDIFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDMFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDQFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDUFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDYFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDcFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDgFVWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDkFVmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDEwBVZjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzJfMCQxMQVWY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyX2NvbnRlbnQkdWNfcHJvZHVjdExpc3RfbWl4VmVyJENoZWNrQm94TGlzdF9wcm9kdWN0TGlzdF8yXzAkMTIFVmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDEzBVZjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzJfMCQxNAVWY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyX2NvbnRlbnQkdWNfcHJvZHVjdExpc3RfbWl4VmVyJENoZWNrQm94TGlzdF9wcm9kdWN0TGlzdF8yXzAkMTUFVmN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcl9jb250ZW50JHVjX3Byb2R1Y3RMaXN0X21peFZlciRDaGVja0JveExpc3RfcHJvZHVjdExpc3RfMl8wJDE2BVZjdGwwMCRDb250ZW50UGxhY2VIb2xkZXJfY29udGVudCR1Y19wcm9kdWN0TGlzdF9taXhWZXIkQ2hlY2tCb3hMaXN0X3Byb2R1Y3RMaXN0XzJfMCQxNgUuY3RsMDAkQ29udGVudFBsYWNlSG9sZGVyX2NvbnRlbnQkR3JpZFZpZXdfZGF0YQ9nZI9/vLFhJBF3/2K93uFjQMORqOl7370jwt/xucvXQKD7',
    '__EVENTVALIDATION':'/wEdALIB+tCT0j963R5gH77mhKCIO8uqrlOvjGbeK3Kejm0PYRJOfSuEl5g7yXUwS6ZETTwgotu/Y3EykpHi+8YB7qZnzHoMd6I/WrX7g+80YsNS+q7Juy4ZedNRfWYgfV8n1mAdhHofKVSmLmaSynodQaHwL8YXdmWyOHJ/ZtDM9ox/c0o5Fw8t2KHuNKN+kcpoVOCK9oH4cJyS5tK7cGqEEugICDYRtft9xqdIWoyx8uguGe4r1BHwTpmbd03lgvTAEkRSdOO2gIxp9XYzJdDx28Mrs+R4nbiIxhANJoBc4/D96g+sulvF5uuYwcUN6yskSUU99bJkmKy3m+dqkYOzCOWPXtn/mvqHLFRXlUsIq5do0H0/D9wTf10afzG7XCzRMxcJLDhMt5sFqro97xh0IQVfLu7fs0c5VglWvBBVh669xXlinqluy/89i66mZXuiLvCFvbrFAPpmVEJetG0XteF0Wug4dixyofLqf39nu9wCtvgVjDiRAyjQmspkvPusGAU2bS7Fge7IOpaeSeaM/gr2X+OcWQNHg0lupenQKr2Tsr0h2aJE45WwYzXNx8y9x3euNnDXrkuI5ae9uY5lo4PnLhuDB4CJWh6Jk4Dihu3tnkAyNGYBpfEW+B5fSjR7YppFlsfjOu5n0yV/C0f4ajU9jK2Iiooq8fcAig9XauhJA+EL9ZN70chL6XQGJDUfJf/tp9aYKOMxpgYovMNS7Qo8WmHMh+jyvuPzJO+2Ta/Jcr/MOtdh4j/2q4wlijhNwfnLpGoYav3soFpXGV+S183UjCjcAvSdecOS1I37DGfJG8/qJWj+IE+3iFTQVK+3qR9Jsl27w6VRotCagC8CBG7jPmztIMC5OT0gjmA9X0CpwS382KrToRiGuHyRXk7wlKCL0aK/XGLm5yAKxu5tRRhNJufGoWfUalVEYJ3pLvJpKB5Vbd2ubW9fdxglMqBHo/OkpWKtrzr9cy+5+2ZMg8HLKzcAkLTYSw945J/G/YlLY4Dw4Dd5vql86U8ehX02aRm5dxghBsVsuESiTbQRZZyBKHvuE2yljg8K1tJV/kiCickWtc4r/rSp85rsxpHecA/MPzYHVEhq9I8ALemP8TNbrgxwzzmX+apShlDEmgiQ5J27hTgoN40NIKAVTYOVg9KYrTCLDL8DnJqsbZcCC4y6z5FR4cS4WC0Ylb/Q/41i0Hukvcmc1I5kT/eGhRM21Wpeq76XfojAhj3UDEug32RHTbrmdYyFBd8xKy+Ko8pb7G7SjvZED5OlxRAcSZ0OGNTIH7dCVm8nhk9dCegtiIGmEnkq1rDPWg9DbL3krlTtmdrg/D+y8MbBnDuOY9v5eLB9FF1JqPD8XNYbk+KD2mDMhdYlsvX/dBSGzlXCGVs0Dh3/V+qiRAGcRADQvfZbWt36CpomechNH1GSFUIyTY9+LutvzNLQPxQnvBEo9A0jgCwpfIr/K7lW/POJAEUbJD1FZ5YR6ki6fgW+kwZ+lJInoWE3FCnaDXHvu6JKr+uIk52lA4vHX0WTyEC3IMoxY0XXhxLgrL+sfZfjILSWh/YHgL+gDJU+hzZTySgRORjNxaMhtJma84p2Y2qn7CHvuirInDDboR9mAfBEseoxcFtyywjULQfZFoe1aj+eMLRLS+fCw69DSeAv4QzEkyXwnEfixzBjm5bQ+WRO1A9AlKe1jYn5q11biUhoUqAeFaVzBUeB0vRAd33xm1vmn8HD8CYIFCr00yN9YsB1ILDXjkQ8haZp6T4u5c6bo1ylvqeWyAdqsGHs0eVsNY/lnMWBxPnY5+IIWQSIATzfFrL5cU7m3HvSCjBTPwIVsDkUWd8GkLWnQnyd+BxImJS0BIpeon4XDgERAkHzF2+h+qgtudjfTDllAqsdka+gvQXE27VZYs2iFvPZSwFpBz2ydnw4D90uwQZ4w28t4w7FGgTn7bptTzBw5XjME294Ne8wBHPr4aRrsu15+TP8vql1+Jp1A69JcQJDfpx6MFYOe2NlGpOtT+pC9uZ4VUAsLnXcxHvyzeA08jGUPd7TyHhpbbVrvIlWdqq6yttGJazRTSzXqZ2OetGohNvCPEQ9l3OYGGqWnR3jqNVeUOmh0tvcaRNBI88W/bS1JivJmDJjhX7Dt5lX6Iu6FTKulhwwn7G/JrsDYypC1FNLG7FQu1F5AI+5ba34qy2fCcz8SX+tyx4mo11ov3SfNkRBHEC7wKleJKNPggFx/Kp4SoBWNPq4eagX+A6xe5ECwLz/YtdxsmG8eowTqTFORynbHub1LXuiIid8kzxO5bwJAM83cHPqGHDVxgTpIo5VDfy2Fhq4Xj9Re8SUDPUxmEij38jo1kbNMuqjbWuGiZVKBJT41DM8N0y/KrRq0/Hl3GYsYjXfKpE9k5tGyB8D0ykpMJ0xSKvaOuIvPKaDP1Qt4KBQWI0DVax6MTc8E/r9/0WoEDsPGeWyjKo5EWLa52z5YC4I+ltRcgFD2QL/+oraejyTWU3wqHdgFvoovWhZu4GQPlpRQSXflCqWQMtn8z0oiNlKA109ajEUXlOMwWOWo13avtQQQ+bZQA6UM+07oUG/mBdhfoKWB9eOKEP/qar/3FIo9yKotTwlAAGTVlFL5bZE6eMTfUpxQhDC/NLDGPIOO6Gha67a+DKiliI87kehaxe08KLz6LOSFo4fI+JaADllF9OwObePPmawX0yl6sxMlZn5p36Iwxvaz8Mez+KRa0lkJsEIgir96W9gf2n4ihv/hL7DcD4LtfyEnUNEBTg/s8w/uPai9vQDODfRZQGwc14KYW5sZJ7sqOi0l7/Oq0trGBMVL+bixQOQUBEXJA2ChAEsR8QUkkRCaMdPWV9L12TUWZDk1PsXSmZcX3o8boeEPOUrlwlVPBPH0D1zDVVy/eNRdMI94HO1Fxf6DObXjxk1nJAxpW6+go9ltSPcEHjTYnc6Z5f+L4dZL32o8eMLWtTfkSNAeQ+fWeeYWh5smw1CT2cbTOzqE4+qMCj4k6oh0Z72sTeJATMzjEneWV4g/255TG4F1hqF9Pdgl2CR7DhOv0m/iDDDyMEQl0womhnETTsBiS4LoJbGzp/VR9PLbHUKjdkddTafr4Yd2tDu4QXw42VyAqNyboI4GkON+gIRoQSUEE6U3lSs0HU3PeCrxRqoNJdFroFoZblO6TS1O8ObYydjpRVdFhCgRKoFkXxgvHrX3z+NmC8Cu8bNaJFRTlDHnc3q9jlx1fbAt5qk9sdeBdXKDZ2gfgaAqv+r8fcSCW+sKOegHMkRBuyUu7Z1u5DB49zqRnSxL1RWrNLS1pNq1J0Kzkd7e5QrzkSANtaECxM5GS0A5MvpX1MKHYinXh3xoSSXRGHXeevlfhi6G0AqErGdp2iDPa/4+HvxQJyNeo4pa2rfqZ+TijV1KhPZ9t112+wKWgCgUx+90LoKanCA5KPcWQfAgoH6KepdFYaEkToqLP8vQk/5Mt1SgLU+UhCEm5dtO/aqHvneN02hRfoErusn7owDi/6EaUR99VWuBLGMeIbAuquA5IigBbI17Rxp7yuFkFI50Mb+9p3THIrOa9ncmClF8noovKG4awSV383ucXO68AYV4R/NAp0Mf1jseZzrICE+kAHE9RDztg5LWrPrAa0v4eW005XcLM4j/U5VK680L6vSj5qzN4MKPJeqofGOT3sknP5NH0RZEqt5a5rKR0Bz9DwotEEVtmE6nxaUjAgbDxxfUOMDkHeZxX3/MLwlCTvwl8r714CO5OwwWsO0xXcjVkWJGCLkFZo/JPVuewb9aXnZN9w6Xmoa1oyZxp76oo1zVd/0USzB8H7Akxx7SciDog/2wbZyWEALgAvCoBCEsGNw',
    'ctl00$ContentPlaceHolder_content$RadioButtonList_resultType': 0,
    'ctl00$ContentPlaceHolder_content$uc_timeSelector$DropDownList_startYear': 2021,
    'ctl00$ContentPlaceHolder_content$uc_timeSelector$DropDownList_endYear': 2021,
    'ctl00$ContentPlaceHolder_content$uc_timeSelector$time':'RadioButton_month',
    'ctl00$ContentPlaceHolder_content$uc_timeSelector$DropDownList_month_startYear': 2018,
    'ctl00$ContentPlaceHolder_content$uc_timeSelector$DropDownList_month_startMonth': 1,
    'ctl00$ContentPlaceHolder_content$uc_timeSelector$DropDownList_month_endYear': 2021,
    'ctl00$ContentPlaceHolder_content$uc_timeSelector$DropDownList_month_endMonth': 5,
    'ctl00$ContentPlaceHolder_content$uc_productList_mixVer$CheckBoxList_priceType$0': 1,
    'ctl00$ContentPlaceHolder_content$uc_productList_mixVer$CheckBoxList_productList_1_0$8': 13,
    'ctl00$ContentPlaceHolder_content$Button_query':'查詢'
}

url = 'http://price.naif.org.tw/Query/Query_now.aspx'

headers = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'}

resp = requests.post(url, data = payload)


# 將 HTML 轉成 BeautifulSoup 物件
soup = BeautifulSoup(resp.text, 'html.parser')

table = soup.find_all("table", {"id":"ContentPlaceHolder_content_GridView_data"})

print(table[0])

我利用上方程式碼印出
<table align="Center" border="1" cellspacing="0" class="queryBoxNew" id="ContentPlaceHolder_content_GridView_data" rules="all" width="100%">
<tr>
<th rowspan="3"><div style="max-width:140px;min-width:100%;">時間</div></th><th colspan="1">產地農場價格</th>
</tr><tr>
<th colspan="1">家禽類</th>
</tr><tr>
<th><div style="max-width:120px;min-width:100%;">雞蛋</div></th>
</tr>**<tr>
<td>2018年1月</td><td>45.35</td>
</tr><tr>
<td>2018年2月</td><td>38.63</td>
</tr><tr>
<td>2018年3月</td><td>38.58</td>
</tr><tr>
<td>2018年4月</td><td>43.06</td>
</tr><tr>
<td>2018年5月</td><td>46.32</td>
</tr><tr>
<td>2018年6月</td><td>44.33</td>
</tr><tr>
<td>2018年7月</td><td>47.34</td>
</tr><tr>
<td>2018年8月</td><td>51.75</td>
</tr><tr>
<td>2018年9月</td><td>55.39</td>
</tr><tr>
<td>2018年10月</td><td>55.83</td>
</tr><tr>
<td>2018年11月</td><td>55.83</td>
</tr><tr>
<td>2018年12月</td><td>55.83</td>
</tr><tr>
<td>2019年1月</td><td>57.93</td>
</tr><tr>
<td>2019年2月</td><td>57.26</td>
</tr><tr>
<td>2019年3月</td><td>59.87</td>
</tr><tr>
<td>2019年4月</td><td>50.78</td>
</tr><tr>
<td>2019年5月</td><td>44.17</td>
</tr><tr>
<td>2019年6月</td><td>38.94</td>
</tr><tr>
<td>2019年7月</td><td>37.39</td>
</tr><tr>
<td>2019年8月</td><td>45.19</td>
</tr><tr>
<td>2019年9月</td><td>45.50</td>
</tr><tr>
<td>2019年10月</td><td>42.18</td>
</tr><tr>
<td>2019年11月</td><td>46.17</td>
</tr><tr>
<td>2019年12月</td><td>46.91</td>
</tr><tr>
<td>2020年1月</td><td>39.22</td>
</tr><tr>
<td>2020年2月</td><td>42.96</td>
</tr><tr>
<td>2020年3月</td><td>48.84</td>
</tr><tr>
<td>2020年4月</td><td>49.17</td>
</tr><tr>
<td>2020年5月</td><td>44.92</td>
</tr><tr>
<td>2020年6月</td><td>40.83</td>
</tr><tr>
<td>2020年7月</td><td>38.47</td>
</tr><tr>
<td>2020年8月</td><td>45.13</td>
</tr><tr>
<td>2020年9月</td><td>46.78</td>
</tr><tr>
<td>2020年10月</td><td>41.05</td>
</tr><tr>
<td>2020年11月</td><td>43.72</td>
</tr><tr>
<td>2020年12月</td><td>43.84</td>
</tr><tr>
<td>2021年1月</td><td>45.67</td>
</tr><tr>
<td>2021年2月</td><td>42.86</td>
</tr><tr>
<td>2021年3月</td><td>51.48</td>
</tr><tr>
<td>2021年4月</td><td>52.94</td>
</tr><tr>
<td>2021年5月</td><td>46.69</td>
</tr>**
</table>

我想要將標粗那些td數值print出來
像這樣呈現
d = {'時間': ['2021年1月', '2021年2月'], '雞蛋產地價格(元/公斤)': [45.67, 42.86]}
df = pd.DataFrame(data = d)
df

      時間	 雞蛋產地價格(元/公斤)
0	2021年1月	       45.67
1	2021年2月	       42.86

我想利用for迴圈來撰寫
我找到這段程式碼可以print下一筆td資料
egg = soup.find("td", text = "2018年1月").find_next_sibling("td").text

可是他的text內要直接打該值
i = soup.find("td", text = egg).find_next_sibling("td").text

若將text = egg，但egg是變數，這方法會失敗，
有什麼方法可以一直print出td的值，
謝謝！


標題:OpenCV python 相片修正
標籤:#opencv python pycharm 

https://github.com/linghugoogle/CarND-Advanced-Lane-Lines
小弟於本網址中學習車道辨識
不過在一開始的相機校正中無法正常運作
參考大量文章後依舊無法解決
煩請大神指點
import cv2
import numpy as np

img=cv2.imread('C:/Users/humaolin/PycharmProjects/pythonProject/camera_cal/calibration1.jpg')
gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)

objpoints=[]
imgpoints=[]
img_size=gray.shape[1::-1]

ret, corners = cv2.findChessboardCorners(gray, (9,6),None)
ret, mtx, dist, rvecs, tvecs = cv2.calibrateCamera(objpoints, imgpoints, img_size,None,None)
undistort_img = cv2.undistort(img, mtx, dist, None, mtx)


cv2.imshow('gq',undistort_img)
cv2.waitKey()```
以上是我的程式碼
下方為報錯訊息
C:\Users\humaolin\PycharmProjects\pythonProject\venv\Scripts\python.exe C:/Users/humaolin/PycharmProjects/pythonProject/123.py
Traceback (most recent call last):
  File "C:/Users/humaolin/PycharmProjects/pythonProject/123.py", line 12, in <module>
    ret, mtx, dist, rvecs, tvecs = cv2.calibrateCamera(objpoints, imgpoints, img_size,None,None)
cv2.error: OpenCV(4.5.2) C:\Users\runneradmin\AppData\Local\Temp\pip-req-build-_8k9tw8n\opencv\modules\calib3d\src\calibration.cpp:3694: error: (-215:Assertion failed) nimages > 0 in function 'cv::calibrateCameraRO'


Process finished with exit code 1



標題:ModuleNotFoundError: No module named 'RPi'
標籤:raspberry pi raspberry #raspberry pi 4 raspberrypi b+ python3 

最近要使用到AlphaBot2，照著使用手冊編譯python檔案，但import RPi.GPIO as GPIO出現了ModuleNotFoundError: No module named 'RPi'這個錯誤訊息，可我使用的python版本是"Python 3.9.4"而且已經有安裝RPi了，因為我是使用mac OS，我想請教這是否跟電腦作業系統有關？我看使用手冊Linux都可以使用了...
如果是因為mac OS無法執行RPi.GPIO的話請問是否有其他解決辦法？


標題:初學者 利用python爬蟲網站表格值 顯示空值 找不到問題
標籤:python python系列文章 python爬蟲 網路爬蟲 表格爬蟲 

import requests
from bs4 import BeautifulSoup

url = 'http://price.naif.org.tw/Query/Query_now.aspx'

headers = {'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'}

resp = requests.get(url, headers=headers)

# 設定編碼為 utf-8 避免中文亂碼問題
resp.encoding = 'utf-8'

# 根據 HTTP header 的編碼解碼後的內容資料（ex. UTF-8），若該網站沒設定可能會有中文亂碼問題。所以通常會使用 resp.encoding 設定
raw_html = resp.text

# 將 HTML 轉成 BeautifulSoup 物件
soup = BeautifulSoup(raw_html, 'html.parser')

print(soup.select('html > body > #form1 > div.wrap > div.contant > div:nth-child(7) > div > #ContentPlaceHolder_content_GridView_data > tbody > tr:nth-child(4) > td:nth-child(2)'))

上方是我的程式碼，
我要爬蟲的網站：http://price.naif.org.tw/Query/Query_now.aspx
我要爬蟲該表格的值，

但我利用上方的程式碼print出來的值顯示「[]」空值，
嘗試過許多方法結果都一樣，
不知道我是不是缺少什麼，
謝謝！


標題:SQLite如何在不同的table架構中找尋特定格式的column名稱
標籤:sqlite sqlite3 python3 android 

最近在研究各種即時通訊軟體APP的data base
如果我想要明確地把對話紀錄內容等資料拿出來
基於各種APP的table架構跟名稱都不太一樣
要先去確認table、column名稱後再query
例如Line的對話紀錄在"chat_history"這張table，文字內容在"content"這個column
Messenger的對話紀錄在"messages"這張table，文字內容在"text"這個column
我的需求是：有沒有什麼query方式或套件，能讓我在不知道APP的table、column名稱下，去找出有特定資料格式的column，並把該column的資料都拿出來？
例如對話紀錄的資料格式通常是字串、可能會有標點符號等等。
目前在網路上爬文比較沒有提到相關的需求，
感謝


標題:python符號問題
標籤:python3 python 符號問題 leetcode 

本題為LeetCode, 136題
找出沒有重複兩次的數字
class Solution(object):
    def singleNumber(self, nums):
        sum=0
        for i in nums:
            sum=sum^i
        return sum
                
d = Solution()
g = d.singleNumber([4,1,2,1,2])
print(g)

然後我要問 "sum^i"   的 " ^ " <<<
他不是平方欸，我去網路上還有官方python資料庫都找不到
" ^ " <<<  到底是甚麼算法呢求助於大大們


標題:關於pyautogui截圖的問題
標籤:python pyautogui 螢幕截圖 

小弟我第一次用python寫程式
想用pyautogui寫個一鍵自動截圖存檔，檔名從001遞增的程式
import pyautogui
import keyboard
x = 0
while keyboard.read_key('q'):    //當按下鍵盤Q時執行
pyautogui.screenshot('test{x}.PNG',region=(409,221,305,442))
// 這裡的檔名會變成test{x}.PNG
x = x+1
if keyboard.read_key('w'): //當按下鍵盤w時結束
break
想請問各位大神這個函數不能套用變數的話 要怎麼樣寫才能達到每按一次+1的效果呢


標題:文章裡有這個字，for...in 卻找不到
標籤:python, @import for or while loop 

大家好，
想請教，以下的 f 包含 list 中的 "三大政策性銀行"，但跑出來沒有結果，不知是為何：
-- coding: utf-8 --
f = open(r'C:\Users\USER\Desktop\財經語料.txt','r',encoding="utf-8-sig")
list=["三大政策性銀行","代理行","清算行"]
for i in list:
if i in f:
print(i)
我有確認過，"f" 可以 print 出，因此是抓得到的。
謝謝！：D


標題:發生無法導入模組的問題
標籤:python 

from finlab.data import Data
data = Data()
ImportError: cannot import name 'Data' from 'finlab.data' (C:\Users\ANT\anaconda3\lib\site-packages\finlab\data.py)


標題:eclipse編譯器出錯
標籤:python eclipse 

想請問一下
本來可以正常使用 但程式執行到一半編譯器卻突然停用
想要重新加入卻一直失敗



標題:PHP語法改成python 
標籤:php python zip pycharm xml 

因為目前找到一個接近Excel 上傳的程式碼，很有力的線索
也不知道算不算是SOAP架構?
但是，PHP能力有限，想求助版友
如以下所示:
https://gist.github.com/davidtsadler/4041969
但是是以PHP的語法所寫出來的
參考https://www.awaimai.com/2601.html
目前大概修改如下:
以16行為例
PHP:
$taskReferenceId = 00000000000;
python:
去掉$，分號;改成冒號:
taskReferenceId = 00000000000:
以39行為例
PHP:
$request = <<<XML
python:
這行改不出來
以124行為例
PHP
$data = base64_encode(gzencode($request, 5));
python 分號改成冒號?
data = base64.encode(gzencode($request, 5)):
感謝修改~


標題:flask sqlalchemy with sqlite 提交後無資料寫入
標籤:#flask #html #python3 #sqlalchemy 

大大們好，
於輸入完name, height, weight並按下"提交"後，
在SQLite上仍然看不到data被寫入(DB、Column創建是有成功的)，
想請教是在提交按鈕做錯，還是flask的連結邏輯錯誤，或是其他問題?
再麻煩大大們指正了，感謝解惑~
Python code
from datetime import datetime

from flask import flash
from flask import Flask
from flask import redirect
from flask import render_template
from flask import request
from flask import url_for
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)

# SQLite datebase link
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False
app.config['SQLALCHEMY_DATABASE_URI'] = r'sqlite:///tmp\test.db'

db = SQLAlchemy(app)

class UserFrame(db.Model):
    __tablename__ = "member"
    ids         = db.Column(db.Integer    , primary_key=True)
    name        = db.Column(db.String(60))
    height      = db.Column(db.Integer)
    weight      = db.Column(db.Integer)
    update_time = db.Column(db.DateTime   , default=datetime.now)

    def __init__(self, name, height, weight):
        self.name = name
        self.height = height
        self.weight = weight

@app.route("/", methods=["POST"])
def index():
    db.create_all()
    return render_template(("index.html"),
index_res =UserFrame.query.order_by(UserFrame.update_time.desc()).all())

@app.route("/add", methods=["POST","GET"])
def add():
    if request.method == ["POST"]:
        res = UserFrame(request.form["name"],
                        request.form["height"],
                        request.form["weight"])
        db.session.add(res)
        db.session.commit()
        return redirect(url_for("index"))
    else:
        return render_template("add.html")

if __name__ == "__main__":
    app.run(debug = True)

HTML
index.html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test</title>
  </head>
  <body>
    <h1>Hi</h1>
    <form method="POST" action="{{ url_for('add') }}">
      <button type="submit"> 進入會員申請頁面 </button>
    </form>
  </body>
</html>

add.html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test</title>
  </head>
  <body>
    <h1>Hi</h1>
    <form method="POST" action="{{ url_for('index') }}">
      <label> 請輸入名稱: </label>
      <input type="text"
              placeholder="在這邊輸入"
              name="name"
              value="{{ request.form.name }}">
      <label> 請輸入身高: </label>
      <input type="text"
              placeholder="在這邊輸入"
              name="height"
              value="{{ request.form.height }}">
      <label> 請輸入體重: </label>
      <input type="text"
              placeholder="在這邊輸入"
              name="weight"
              value="{{ request.form.weight }}">
      <button type="submit" name="submit" value="submit">提交</button>
    </form>
</html>

(以上，參考下方連結，我把它改成自己初學能理解的實作方法)
(試過原著的code，在index()加上create_all()就可以跑)
Reference:https://github.com/pallets/flask-sqlalchemy/tree/main/examples


標題:[已解決]  python sql 預存程序 多個結果集 & 單個返回值
標籤:python sql proc 

各位大大好，小弟目前在練習sql預存程序遇到以下狀況

如果預存內有兩個sql結果集，該怎麼接收?
如果預存內有單獨的值，該怎麼接收?

-- sql創建預存程序
CREATE PROCEDURE  usp_testProc
@key NVARCHAR(10) = 'a'
@result int output
AS
    set @result = '100'
    SELECT * FROM [Test].[dbo].[test]
    WHERE [testTest] = @key
    SELECT * FROM [Test].[dbo].[test]
GO

使用sql操作如下
BEGIN
    declare @result int
    EXEC usp_testProc '1', @result output
    print(@result)
END



如上圖所示，小弟希望在python中取得

2個結果集
@result 數值100

conn = pymssql.connect(
    server = 'ip',
    user = 'testUser',
    password = 'testPassword',
    database = 'test',
    charset = 'utf8'
)
cursor = conn.cursor(as_dict = True)

# 請問此處該如何撰寫，才能得到以上
# 小弟已能夠正常獲取單個結果集
# cursor.execute(...)
# cursor.callproc('usp_testProc', ('1',))

再請各位大大們不吝指教！！
－－－－－－－－－－－－－－－－－－－－－－－－－－－－
解決方法，在不同的資料庫中有部分ＤＢ支持返回多個結果集，
於是再調用時使用
print(cursor.fetchall()) # 第一個結果集

cursor.nextset() # 將光標移至下一個結果集，如果沒有則會報錯

print(cursor.fetchall()) # 因為光標已移至下一個，所以得到第二個結果集

以上，感謝回答的兩位大大。


標題:Javascript 轉成 Python語言
標籤:python3 js thonny 演算法 

目前小弟正在讀演算法的部分
遇到這題卡關...
想看程式一步步是怎麼走的
但現在好像只有Thonny這個IDE有這樣的親民功能
所以希望大大可以幫我換成python ><
程式如下 謝謝
isSubsequence("book", "brooklyn");

function isSubsequence(str1, str2) {
    if (str1.length == 0) {
        return true;
    }

    let pointer1 = 0;
    let pointer2 = 0;
    while (pointer2 < str2.length) {
        if (str1[pointer1] == str2[pointer2]) {
            pointer1++;
        }
        if (pointer1 >= str1.length) {
            console.log(true);
            return true;
        }
        pointer2++;
    }
    console.log(false);
    return false;
}




標題:GCP免費版cron會消失
標籤:cron job python gcp google cloud platform 

目前在Google Cloud開了個免費專案，用途是測試用小專案，所以沒開付費。
功能是cron每日特定時間去執行一支python腳本
但發現cron設定好後隔段時間就會消失，這個有解嗎？
僅個人測試用途不想開付費呀


標題:python backtrack的問題
標籤:#新手求講解 #python #python 3 #backtrack 

    def generateParenthesis(self, n):
        ans = []
        def backtrack(S, left, right):
            if len(S) == 2 * n:
                ans.append(''.join(S))
                return 
            if left < n:
                S.append('(')
                backtrack(S, left+1, right)
                S.pop()
                
            if right < left:
                S.append(')')
                backtrack(S, left, right+1)
                S.pop()
                

本題為LeetCode第22題
請問在這個回朔法(backtrack)裡面的S.pop()是怎麼運作的，
在我的認知裡面一旦呼叫backtrack之後就不會再呼叫S.pop()了，
我看了很多外國的YT影片都沒運用到類似的技巧
所以來跟大家求救這個S.pop()到底是怎麼運作的
#本人非本科，自學菜雞求救


標題:python抓youtubeAPI，找不同頻道的訂閱人數
標籤:python api youtube 急 網路爬蟲 

import requests
import pprint

base_url = "https://www.googleapis.com/youtube/v3/"
api_function = "videos"                               
query = {
    "key":"",   
    "chart":"mostPopular",         
    "maxResults":50,
    "regionCode":"TW",
    "part": "snippet,contentDetails,statistics",

}

response = requests.get(base_url + api_function, params=query)

if response.status_code == 200:
    response_dict = response.json() 
    results1 =  {
        i+1: response_dict["items"][i]["snippet"]["channelTitle"]
        for i in range(0,50)
        } 
    results2 =  {
        i+1: response_dict["items"][i]["statistics"]["viewCount"]
        for i in range(0,50)
        } 
    results3 =  {
        i+1: response_dict["items"][i]["snippet"]["channelId"]
        for i in range(0,50)
        } 
   
# pagination
    if "nextPageToken" in response_dict.keys():
      query['pageToken'] = response_dict["nextPageToken"]
      response = requests.get(base_url + api_function, params = query)
 
      if response.status_code == 200:
        response_dict = response.json()
        for i in range(0,50):
            results1.update( {i+51: response_dict["items"][i]["snippet"]["channelTitle"] } )
      if response.status_code == 200:
        response_dict = response.json()
        for i in range(0,50):
            results2.update( {i+51: response_dict["items"][i]["statistics"]["viewCount"] } )     
      if response.status_code == 200:
        response_dict = response.json()
        for i in range(0,50):
            results3.update( {i+51: response_dict["items"][i]["snippet"]["channelId"] } )    

pprint.pprint(results1)
pprint.pprint(results2)
pprint.pprint(results3)



import requests
import pprint

base_url = "https://www.googleapis.com/youtube/v3/"
api_function = "channels"                               
query = {
    "key":"",   
    "part": "snippet,statistics",
    "id": "UCwWXGnvVmi-6Sfx2wf8S8tQ",
    
}

response = requests.get(base_url + api_function, params=query)

if response.status_code == 200:
     response_dict = response.json()
     results3_list = [ response_dict["items"][0]["statistics"]["subscriberCount"] ]
print(results3_list)  


python課程學習中~
我正在著手yt前百大影片頻道的訂閱人數，
目前有找到前百大影片的頻道名稱和個別id，但不知道怎麼寫loop去替換"id"，
進而從個別頻道找到訂閱數
QQ
感謝大家的提醒!!!


標題:如何將本機HTML檔案特定表格抓取前五大的數字
標籤:python 網路爬蟲 html beautifulsoup python3 

不好意思下了這麼拗口的標題><
想請問各位大大python有甚麼方法可以把下圖紅框處的部分抓前五名的數字呢?

我一開始的想法是用BeautifulSoup套件將指定表格的內容爬出來
再將紅框數字部份存到陣列裡取前五名
結果不幸的事發生了
這份HTML檔案所有table的class name和格式都一樣
也完全沒有id
所以我完全沒辦法去指定我要抓的特定表格
每個table間唯一不一樣的地方只有下圖紅框處的"summary"

請問這種HTML是不是不能用BeautifulSoup去爬呢?
如果是的話要用甚麼方式完成比較好呢?
謝謝各位大師的幫忙!
下列連結為HTML檔案:
https://drive.google.com/file/d/1ul6c6fUaszUw3cwYHcN9rww6iOH0ptiD/view?usp=sharing
我自己目前寫的程式碼如下:
import bs4 
path = './B2BDB1.html' 
with open(path, 'r') as f: 
    soup = bs4.BeautifulSoup(f.read(), 'html.parser') 
    titles = soup.find_all("table")[29]
for title in titles: 
    print(titles) 




標題:如何在利用selenium登入網銀後，繼續控制網頁
標籤:python selenium 網路銀行 

前面經過一連串開啟網頁+登入(本人使用第一銀行測試)(python+selenium)
進來網銀之後，網頁自動開啟一個"視窗"，不是分頁
但利用下面兩行程式，成功返回網銀那頁視窗
baidu_handle = driver.window_handles
driver.switch_to.window(baidu_handle[0])
但接下來，網銀成功登入的那一個分頁，都無法使用selenium來控制
也有使用過driver.execute_script，來控制
但一樣沒辦法，都會顯示以下訊息
Message: no such element: Unable to locate element
請問各位大大有什麼方法，可以讓selenium繼續控制網址?


標題:已解決！jupyter notebook 無法執行python
標籤:jupyter notebook python3 python anaconda #新手求指導 

-----更-----
發現python真的不允許C槽下使用者的名字為中文，原本來僥倖說安裝在D槽不會有事...
解決辦法：新增一個英文的使用者，再重新安裝，不但解決了jupyter notebook無法自動開啟瀏覽器，以及ln[]呈現空白的問題
如果曾經是中文去帳號改為英文，C/使用者 依然會是中文喔！
https://answers.microsoft.com/zh-hant/windows/forum/all/%E9%97%9C%E6%96%BCc%E6%A7%BD%E5%85%A7%E4%BD%BF/6ddfd8b6-e2f7-4007-920d-682e30bab29e
謝謝大家的回覆d(`･∀･)b
-----正文-----
為什麼在進入到jupyter notebook選擇python3後無法run，也重啟過kernal但問題依舊
請問版上有人可以替小妹解惑嗎

anaconda prompt上可以確認python已安裝且能看到版本
python 3.8.8
tornado 6.1


瀏覽器 google chrome(是透過複製jupyter notebook底下網址複製貼上)



標題:pygame磚塊遊戲如何做兩顆球體可以一起移動
標籤:python pygame 

請問有人知道怎麼做嗎Q_Q


標題:如何解決藍芽裝置斷線造成讀取程序凍結
標籤:python ble bleak 藍芽 

目前使用python+bleak撰寫藍芽ble讀取，但發現在裝置斷線時，會造成程序卡在讀取，並不會偵測到裝置離線而跳出。
以下是參考的bleak sample code，裝置確認連線後進行client.start_notify,倘若裝置在這當中斷線，程式便會卡死在這。
import asyncio
from bleak import BleakClient, discover
import sys

BLE_DEVICE_NAME = 'test'  # 
NORDIC_TX = "6e400000-b5a3-f393-e0a9-e50e24dcca9e"


class TXCallback:
    def __init__(self, name):
        self.name = name

    def callback(self, sender, data):
        print(f'收到 "{self.name}" 傳來：{data.decode()}')


async def select_device():
    ble_list = []
    devices = await discover()
    print("搜尋裝置…")
    for d in devices:
        print(f"{d.name} @ {d.address}")  
        if d.name.find(BLE_DEVICE_NAME) != -1:
            ble_list.append({'name': d.name, 'address': d.address})
            print('發現目標：', d.name)

    return ble_list


async def run():
    ble_list = await select_device()

    if len(ble_list) == 0:
        print('找不到裝置')
        loop.stop()
        return

    print("準備連線～")
    for d in ble_list:
        client = BleakClient(d['address'])
        try:
            await client.connect()
            cb = TXCallback(d['name'])
            await client.start_notify(
                NORDIC_TX, cb.callback
            )
        except Exception as e:
            print(e)


if __name__ == "__main__":
    try:
        loop = asyncio.get_event_loop()
        asyncio.ensure_future(run())
        loop.run_forever()
    except KeyboardInterrupt:
        loop.stop()
        print("關閉程式")

請問有無較好的處理方式？

更新：經測試，發現都卡在start_notify子程序當中，後來更換成 bluepy後已有解決，裝置斷線也能回傳disconnect。


標題:如何利用Python控制馬達
標籤:#python 

各位大安好
小弟目前就讀高中，還是初學者
想用Python控制自走車
但爬了蠻多文，幾乎大部分是有關Arduino的程式
小弟想在此詢問
各位大們 知道說有那些關鍵詞有關Python控制機器的相關文章
所使用的是Nodemcu V3的開發版


標題:ebay API
標籤:python ebay_api stackoverflow api ebay 

雖然版上老鷹大已經穎相關資料，但是拜讀之後
但是拜讀之後，發現不適合，且無法使用，因為是舊版以及使用PHP，我是使用python
目前我有一個excel檔案 如此所示
或許目前ebay 已經有一個自己的上傳系統
基於對ebay API 我還是想要使用 python 設計我自己的一套簡單系統
Q1:
這是我寫到一半的代碼
from ebaysdk.finding import Connection as finding



api = finding(appid = XXXXXXXXX-Excelupl-SBX-4a5abeab0-863358a0 ,config_file = None)

但是我參考了ebay API
以下似乎都沒有關於 excel 上傳的API，導致以下的API我不知道如何選擇
startUploadJob ， https://reurl.cc/XW5WG3 ，https://reurl.cc/kZqZyr ?
第二個問題:
Q2: GitHub  哪一個解答率會比較高?
還是有第三個可以發問的地方，效果也不錯?
目前已經到或是stackoverflow  reddit發問都沒結果，謝謝!


標題:python 跟 Excel 的單位換算?
標籤:python excel img 尺寸 圖片 

因為最近在學寫python 網路爬蟲，但是寫到一半，需要調參數如附件所示
裡面的 width=20 以及 heigh=50 還有col+8
其中方框中的數字，單位是? cm ? mm?還是?
https://imgur.com/t3AxBoX
圖片跟表格大小如何得知? pt =  公分?
https://imgur.com/CGoWEG8
CELL大小如何對應到python參數裡?
https://imgur.com/LZkkrIN
我看EXCEL裡面都是寫公分?
該如何測量圖片的尺寸? 3Q!


標題:複製串列及append問題請益
標籤:python3 append 

你好
我是python初學者 在複製串列的地方想個別加入不同項目而用了append

但執行後出現

爬文後得知'tuple'是不可變動的，所以不能加append
但是我買的參考書是可以加入的
找不到其他錯的原因
想麻煩大大們解答 謝謝


標題:python 基本語法
標籤:python 

某一班級分為 A、B 及 C 班，每班學生 60 人，一年級學生 共 180 人。今欲依照學生的座號進行編班，若學生座號為 1 號則編入 A 班、2 號 則編入 B 班、3 號則編入 C 班，4 則編入 A 班，餘此類推。
(1) 請利用 input 函式，提醒輸入的座號，並利用所輸入座號判別學生的班別。
(2) 請利用自建函式，依照所輸入的座號，判別學生的班別。
(3) 請利用迴圈，將 180 位學生的座號編排出來，進而利用座號予以分班。
(4) 假設要將座號尾數 5 及 5 的倍數的學生(如 5、15、20…等)，另編成一班─D 班，則 A、B 及 C 班剩下的學生人數為何？
(5)導師想由學生的座號中隨機找學生當班長，請試著用 Python 語法將三班班長的座號找出。
請問有沒有好心人士能幫小女解決問題


標題:急   python 爬蟲突然遭受阻擋
標籤:python 爬蟲 阻擋 

我需要爬取foodpanda網站做作業
之前完全沒問題 就在剛剛突然無法獲得資料
於是我改變程式碼尋找問題



import bs4
import requests
def foodpanda( city_name):
    #建立縣市相對應網址字典
    city = {"台北市":"taipei-city", "新北市":"new-taipei-city", "台中市":"taichung-city","高雄市":"kaohsiung-city",
            "新竹市":"hsinchu-city", "桃園市":"taoyuan-city", "基隆市":"keelung","台南市":"tainan-city",
            "苗栗市":"miaoli-county", "嘉義市":"chiayi-city", "彰化市":"changhua", "宜蘭縣":"yilan-city",
            "屏東縣":"pingtung-city", "雲林縣":"yunlin-county", "花蓮市":"hualien", "南投市":"nantou-county",
            "台東市":"taitung-county","澎湖縣":"penghu-city", "金門縣":"kinmen-city"}
    
    if city_name in city:
        city_url = city[city_name]
        url = "https://www.foodpanda.com.tw/city/"+city_url
        #如果輸入名稱在字典內,取得相對應網址
        
        header = {"User-Agent":"Moziilla/5.0 (Windows NT 6.1; WOW64)\AppleWebKit/537.6 (KHTML, like Gecko) Chrome/45.0.2454.101\
            Safari/537.36"}
        url = requests.get(url, headers = header)
        #下載網頁
        search = bs4.BeautifulSoup(url.text, "lxml")
        #解析下載後的網頁

        print(search.text)
       
foodpanda("台北市")

結果是
Please verify you are a human
Access to this page has been denied because we believe you are using automation tools to browse the website.
This may happen as a result of the following:
Javascript is disabled or blocked by an extension (ad blockers for example)
Your browser does not support cookies
Please make sure that Javascript and cookies are enabled on your browser and that you are not blocking them from loading.
Reference ID: #b9b6dc10-d32d-11eb-b71e-e1e76f2daa6e
Powered by PerimeterX, Inc.
請問我該如何解決


標題:google map 爬蟲
標籤:爬蟲 python python爬蟲 google 

大家好，小弟用下方API成功爬到google的商家評論，但只有一間門市，而且每次都要改url，想詢問怎麼一次爬完所有分店(以麥當勞為例的話)，另外這個API要錢嗎(覺得怕)
import requests
from bs4 import BeautifulSoup
import time #for sleep 禮貌
import json
import pandas as pd
import numpy as np
from datetime import datetime

'預設1500篇'
null = np.nan #將api裡的null變成nan，不然會報錯
final = []
end = 0
i = 0
while end == 0: #判斷何時停止
    if i%5 == 0 : print(i,end='->')
     url ='https://www.google.com.tw/maps/preview/review/listentitiesreviews?authuser=0&hl=zh-TW&gl=tw&pb=!1m2!1y3765757233225575679!2y9104663542408472851!2m2!1i'+str(i*10)+'!2i10!3e2!4m5!3b1!4b1!5b1!6b1!7b1!5m2!1scXLQYLygDom2mAW94IjYBw!7e81'
    # 留言處> F12> network> 滑動看新增甚麼> url複製過來> 3e1改3e2> li拆兩段
    print(url) # chk 搜尋會下載個txt檔
    req_text = requests.get(url)
    res = eval(req_text.text.replace(')]}\'\n','')) #整理一下
    if type(res[2]) == float: #評論資訊是nan就停止，代表沒留言了
        print('stop')
        end = 1 
    else:
        for data in res[2]: #評論資訊都在這
            res_dict = {}
            for j in range(len(data)):
                res_dict[j] = data[j]
                res_dict['scrap_time'] = datetime.now().strftime("%Y/%m/%d %H:%M:%S")
            final.append(res_dict)      
    i+=1    
    if i > 150: #避免無線迴圈，要爬多少則留言(留言數 = i*10)
        end = 1
    time.sleep(.5) #禮貌啦哪次不禮貌

# print(final)

df = pd.DataFrame(final)

#將epoch time轉成時間 (建議用df apply但我不會...QQ)
arr = []
for i in range(len(df)):
    arr.append(time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(int(round(df[27][i]/1000)))))

df['post_time'] = arr

new_df = df[[0,3,4,10,11,12,14,16,18,27,30,32,39,'post_time','scrap_time']] 
#篩選重要欄位
new_df_columns = ['用戶資料', '留言內容', '評分', '某id1', '某id2',
                  '用戶資訊詳細','圖片資訊詳細', '讚數', '圖片清單連結', 
                  '貼文epoch時間','恩災(感覺重要)', '語言','恩災2',
                  '貼文時間','爬蟲時間'] #欄位重新命名
new_df.columns = new_df_columns

new_df

new_df.to_csv('D:/Gmap爬蟲檔案範例.csv',encoding="utf-8-sig")




標題:如何用python刪除txt內多餘的空白行
標籤:#python 3 #python #python求救 

如提
最近再做txt的資料整理
但是遇到一個問題
如下圖 我有大量的txt檔案 要給程式讀取
但是有些會有多餘的空白行 導致程式讀取的時候
會顯示index error 意思就是不能有空白行
想寫個程式 把空白行都殺掉 上網沒有太多有用資訊
想問一下大佬們 有什麼方法可以提供給我嗎?



標題:想請問呼叫def後的函數觸發條件
標籤:python python3 dfs #新手求指導 

於leetcode.46 Permutations
想請問為甚麼在其中的For迴圈裡呼叫backtrace
後面的pop到底是造成了甚麼條件才會觸發呢?
是因為滿足了前兩個條件才觸發POP的嗎?
麻煩大大幫忙
class Solution(object):
    def permute(self, nums):
        result = []
        path = []
        def backtrace(nums, index):
            if len(path) > len(nums):
                return
            if len(path) == len(nums):
                result.append(path[:])
                return
            for i in range(index, len(nums)):
                if nums[i] in path:
                    continue
                path.append(nums[i])
                backtrace(nums, 0)
                path.pop()
        backtrace(nums, 0)
        return result



標題:請問 ARIMA 模型中的 φ θ 係數是怎麼運用 MLE 決定出來的？
標籤:python arima 

https://stackoverflow.com/questions/44301263/python-arma-mle-implementing-algorithms-from-literature
已知外國有人他自己看 literature 實做出來 ARIMA ，這樣就不用 import 別人早就寫好的 python statsmodel 的 ARIMA 類別與方法，讓自己讀懂 literature ，知道 ARIMA 究竟想要做什麼，實現自己想要的情境，請問下述的 code 具體執行了什麼？謝謝！
import numpy as np
import statsmodels.api as sm
import statsmodels.tsa.arima_model
import scipy.optimize

class ARMA(object):
    def __init__(self, endo, nar, nma):
        np.random.seed(0)
        # endogenous variables
        self.endo = endo
        # Number of AR terms
        self.nar = nar
        # Number of MA terms
        self.nma = nma
        # "Dimension" of the ARMA fit
        self.dim = max(nar, nma+1)
        # Current ARMA parameters
        self.params = np.zeros(self.nar+self.nma, dtype='float')

    def __g(self, ma_params):
        '''
        Build MA parameter vector
        '''
        g = np.zeros(self.dim, dtype='float')
        g[0] = 1.0
        if self.nma > 0:
            g[1:self.nma+1] = ma_params
        return g

    def __F(self, ar_params):
        '''
        Build AR parameter matrix
        '''
        F = np.zeros((self.dim, self.dim), dtype='float')
        F[:self.nar, 0] =  ar_params
        for i in xrange(1, self.dim):
            F[i-1, i] = 1.0
        return F

    def __initial_P(self, R, T):
        '''
        Solve for initial P matrix

        Solves P = TPT' + RR'
        '''
        v = np.zeros(self.dim*self.dim, dtype='float')
        for i in xrange(self.dim):
            for j in xrange(self.dim):
                v[i+j*self.dim] = R[i]*R[j]
        R = np.array([R])
        S = np.identity(self.dim**2, dtype='float')-np.kron(T, T)
        V = np.outer(R, R).ravel('F')
        Pmat = np.linalg.solve(S,V).reshape(self.dim, self.dim, order='F')
        return Pmat

    def __likelihood(self, params):
        '''
        Compute log likehood for a parameter vector

        Implements the Pearlman 1980 algorithm
        '''
        # these checks are pilfered from statsmodels
        if self.nar > 0 and not np.all(np.abs(np.roots(np.r_[1, -params[:self.nar]]))<1):
            print 'AR coefficients are not stationary'
        if self.nma > 0 and not np.all(np.abs(np.roots(np.r_[1, -params[-self.nma:]]))<1):
           print 'MA coefficients are not stationary'
        ar_params = params[:self.nar]
        ma_params = params[-self.nma:]
        g = self.__g(ma_params)
        F = self.__F(ar_params)
        w = self.endo
        P = self.__initial_P(g, F)
        n = len(w)
        z = np.zeros(self.dim, dtype='float')
        R = np.zeros(n, dtype='float')
        a = np.zeros(n, dtype='float')
        K = np.dot(F, P[:, 0])
        L = K.copy()
        R[0] = P[0, 0]
        for i in xrange(1, n):
            a[i-1] = w[i-1] - z[0]
            z = np.dot(F, z) + K*(a[i-1]/R[i-1])
            Kupdate = -(L[0]/R[i-1])*np.dot(F, L)
            Rupdate = -L[0]*L[0]/R[i-1]
            P -= np.outer(L, L)/R[i-1]
            L = np.dot(F, L) - (L[0]/R[i-1])*K
            K += Kupdate
            R[i] = R[i-1] + Rupdate
            if np.abs(R[i] - 1.0) < 1e-9:
                R[i:] = 1.0
                break
        for j in xrange(i, n):
            a[j] = w[j] - z[0]
            z = np.dot(F, z) + K*(a[i-1]/R[i-1])
        likelihood = 0.0
        for i in xrange(n):
            likelihood += np.log(R[i])
        likelihood *= -0.5
        ssum = 0.0
        for i in xrange(n):
            ssum += a[i]*a[i]/R[i]
        likelihood += -0.5*n*np.log(ssum)
        return likelihood

    def fit(self):
        '''
        Fit the ARMA model by minimizing the loglikehood

        Uses scipy.optimize.minimize
        '''
        sm_arma = statsmodels.tsa.arima_model.ARMA(endog=self.endo, order=(self.nar, self.nma, 0))
        params = statsmodels.tsa.arima_model.ARMA._fit_start_params_hr(sm_arma, order=(self.nar, self.nma, 0))
        opt = scipy.optimize.minimize(fun=self.__likelihood, x0=params, method='L-BFGS-B')
        print opt

# Test the code on statsmodels sunspots data
nar = 2
nma = 1

endo = sm.datasets.sunspots.load_pandas().data['SUNACTIVITY'].tolist()
arma = ARMA(endo=endo, nar=nar, nma=nma)
arma.fit()



標題:進階爬蟲問題
標籤:網頁爬蟲 python 股票交易機器人 網頁架構 

是否有不一樣的方法來爬資料呢?
我最近在寫一個自動交易股票的機器人，想當然需要抓趨勢圖中現在的股價。至於這個操作簡單，可以用python 的 requests 、 selenium 來達到。但問題是，如果要及時得到資料，就必須不斷向對方server 提出request ，有很大機率會被對方server鎖IP。
我有另一個想法是，是否可以透過對方server push 過來資料，我就不需要一直提request了。
會有這種想法是因為，當我在看盤的時候，趨勢圖中的股價是隨時變動的。但我沒有request資料，為何瀏覽器上的股價會隨時變動? 是不是代表交易所的server隨時會push 資料過來，使我的瀏覽器可以即時呈現資料?
那我該如何透過此方法獲得即時的股價資訊呢?
如圖片所示，該區塊是一直變動的(代表對方server 在 push 資料過來?)。



標題:時間序列機器學習預測
標籤:python machine learning time series 


想請問各位前輩，資料為連續十個小時的量測值，
共有四個特徵f1、f2、f3、f4。
十個小時結束後會進行檢測，result為檢測結果(Pass、Fail)。以其中一筆資料為例，
想請問若每筆資料都是十個小時，這種資料要怎麼進行機器學習，那若是資料不一定剛好都是十個小時，這樣又要怎麼辦？


標題:有關Python樹梅派的問題
標籤:python 樹梅派 

import spidev # To communicate with SPI devices
from numpy import interp  # To scale values
from time import sleep  # To add delay
import RPi.GPIO as GPIO
import time

GPIO.setmode(GPIO.BCM)
GPIO.setwarnings(False)
relaypin_light = 5
relaypin_Moisture=6
GPIO.setup(relaypin_light,GPIO.OUT) #設定GPIO5 為輸出
GPIO.setup(relaypin_Moisture,GPIO.OUT) #設定GPIO6 為輸出
# Start SPI connection
spi = spidev.SpiDev() # Created an object
spi.open(0,0)
# Read MCP3008 data
def analogInput(channel):
  spi.max_speed_hz = 1350000
  adc = spi.xfer2([1,(8+channel)<<4,0])
  data = ((adc[1]&3) << 8) + adc[2]
  return data
while True:  
  
  output_Moisture = analogInput(0) # Reading from MCP3008 CH0 
  output_Moisture = interp(output_Moisture, [0, 1023], [100, 0])
  output_Moisture = int(output_Moisture) 
  print("Moisture:", output_Moisture)
  GPIO.output(relaypin_Moisture,0)
  sleep(0.5)

  if output_Moisture >= 40: 
    GPIO.output(relaypin_Moisture,1)
    time.sleep(0.5)
  else:
    GPIO.output(relaypin_Moisture,0)
    time.sleep(10)
    GPIO.output(relaypin_Moisture,1)
    
    
  output_light = analogInput(1) # Reading from MCP3008 CH1
  output_light = interp(output_light, [0, 1023], [0, 500])
  output_light = int(output_light)
  print("light:", output_light)
  sleep(0.5)

  if  output_light>= 400:
    GPIO.output(relaypin_light,1) 
    time.sleep(0.5)
  else:
    GPIO.output(relaypin_light ,0) 
    time.sleep(0.5)
  



請問各位大神，要怎麼把output_Moisture和output_light的資料繪製成圖
去網上看了一下 不知道要怎麼去指定這些數值
往上大都好像都是給固定的數字繪圖


標題:ridge公式解與sklearn ridge regression套件，實驗結果不同
標籤:ridge linear regression regression python 

資料參考來源於:https://ithelp.ithome.com.tw/articles/10240750
Ridge regression 權重公式: B= [(X_TX)^-1+ lamb*I(單位矩陣)]X_TY
def parameter(X, Y, lamb=1):
    return np.dot(np.linalg.inv(np.dot(X.T,X)+lamb*np.eye(X.shape[1])),np.dot(X.T,Y))

from sklearn import linear_model
ridge_regressor = linear_model.Ridge(alpha=1, solver = 'auto')
ridge_regressor.fit(X, Y)

於python使用此行程式碼，設置lamb=0，可得結果與sklearn linear regression相符。
可是將lamb=1，得出結果與sklearn ridge regression不同。
希望各位邦友幫忙解惑，謝謝。


標題:PYQT中combobox的問題
標籤:pyqt5 pyqt python 

各位高手好，我用PYQT寫了一個combobox，然後功能是只要切換選項就會把對應的SQL資料顯示到editline上，但是combobox好像只能對應一個參數，請問有辦法讓一個combobox對應多個參數或是怎樣寫可以達成一個combobox可以顯示出多個editline內容?
以下是我的程式碼
def __init__(self):
    super(AddCoopWindow, self).__init__()
    self.setupUi(self)
    self.setWindowModality(Qt.ApplicationModal)
    self.setWindowFlags(Qt.WindowCloseButtonHint)
    self.setWindowTitle('新增資料')
    self.add_book_pushButton.clicked.connect(self.add)
    self.setWindowIcon(QIcon(APP_ICON))
    self.add_book_pushButton.setProperty('class', 'Aqua')
    self.setStyleSheet(SYS_STYLE)
    self.hr_name_comboBox.currentIndexChanged.connect(self.hr_email)
    self.hr_name() #自行新增函數要加入到__init__進行初始化


def hr_name(self):
    db = DBHelp()
    count_coop4hr, res_coop4hr = db.query_all_coop4hr(table_name='hr')
    for row in res_coop4hr:
        un, email, phone = row
        self.hr_name_comboBox.addItem(un, email)

def hr_email(self):
      self.hremail_lineEdit.setText(self.hr_name_comboBox.currentData()) #抱歉，原本的是這樣，自己在試的時候多加了self.hr_name

忘記補充，這是我另一邊的SQL程式碼
def query_all_coop4hr(self, table_name):
    sql_coop4hr = 'select human_name,email,phone from hr'
    count_coop4hr = self._cur.execute(sql_coop4hr)
    res_coop4hr = self._cur.fetchall()
    return count_coop4hr, res_coop4hr



標題:[Python] Line Notify Emoji
標籤:python line notify emoji 

想在Line Notify通知增加Emoji符號，但測試Emoji符號一直傳送失敗，還請高手們指點。
    def lineMessage(self, msg):
        p1 = {"message": msg, "stickerPackageId": 2, "stickerId": 520}   
        p2 = {"message":{
            "type": "text",
            "text": "$ LINE emoji $",
            "emojis": [
                {
                "index": 0,
                "productId": "5ac1bfd5040ab15980c9b435",
                "emojiId": "001"
                }
            ]
        }}
        r1 = requests.post(self.url, headers = self.headers, params = p1)
        r2 = requests.post(self.url, headers = self.headers, params = p2)
        return r1.status_code+ r2.status_code



標題:在學習python時不知哪裡錯 求大神幫忙
標籤:python入門 




標題:股票即時資訊
標籤:python stock 

我在網路上找了爬取股票即時資訊的方法 但結果執行時表格卻出不來
請問是否有解決的方法 或者有沒有其他更好的爬取方式
現在使用的是Eclipse python3.9

這是範例給的結果



標題:請問Vue怎麼實作Admin權限才能登入的頁面(role based access)
標籤:vue vue.js python fastapi 

各位大大好 小弟最近在實作vue admin角色登入才能看到的頁面，但不知道怎麼在前端實現，還請各位大時指點迷津：
我在backend做了一個endpoint "/users" 這裡會去判斷user是不是superuser如果是True的話才能進入 程式碼如下：
@router.get("/users", response_model=List[schemas.User])
def read_users(db: Session = Depends(get_db),
               current_user: models.User = Depends(get_current_user_from_token)):
    if current_user.is_superuser:
        users = user_crud.get_users(db)
        return users
    raise HTTPException(status_code=status.HTTP_401_UNAUTHORIZED, 
                        detail="You are not permitted!!")

請問在Vue Login頁面要怎麼去判斷登入者是不是superuser，然後直接導到UserList頁面？ 還是說有其他方式可以實現role based access這種判斷登入者的其他方法呢？
以下為Vue Login 頁面的程式碼：
<script>
import { mapActions } from "vuex";

export default {
  name: "Login",
  components: {},
  data() {
    return {
      form: {
        username: "",
        password: "",
        is_superuser:"",
      },
      showError: false
    };
  },
  methods: {
    ...mapActions(["LogIn"]),
    async submit() {
      const User = new FormData();
      User.append("username", this.form.username);
      User.append("password", this.form.password);
      User.append("is_superuser", this.form.is_superuser);
      try {
          await this.LogIn(User);
          this.$router.push("/");
          this.showError = false
      } catch (error) {
        this.showError = true
      }
    },
  },
};
</script>



標題:python自動化學習路線
標籤:python selenium qa 自動化測試 

各位前輩好，目前以學習python基礎與法，也學了selenium，操控網頁上的各元素執行元素的各種操作，請問接下來該學習甚麼呢?


標題:Python coding:判斷成績是否及格
標籤:python coding求解 

寫個程式，判斷一個人的成績是否及格(大學部及格分數為60分，研究所為70分)
令使用者輸入學籍與成績
若是學籍使用者輸入的不是1或是2便輸出錯誤訊息並結束程式
若是分數使用者輸入的不是介於0~100便輸出錯誤訊息並結束程式
若以上輸入皆正確就判斷其成績是否及格並輸出
當學籍輸入的不是1或是2便輸出錯誤訊息並結束程式
Input：學藉 (1:大學部 2:研究所)、成績
Output Format：若學籍有錯誤就輸出role error/ 若分數有錯誤就輸出score error/ 若皆正確就輸出pass或fail
新手請問這題coding怎麼寫？


標題:Python爬蟲Table欄位問題 
標籤:網路爬蟲 python爬蟲 財報 

def eps_get(request):
     if request.method == 'POST':
        stockID = request.data.get("StockID",0)
        res = requests.get(url+stockID+name,headers = headers)
        res.encoding = "utf-8"
        soup = BeautifulSoup(res.text,"lxml")
        data = soup.find("table",class_="tb-stock text-center tbBasic")
        dfs = pd.read_html(data.prettify())
        df = dfs[0]
        Eps2021Q1 =df.iloc[0,9]
        Eps2020Q4 =df.iloc[0,8]
        Eps2020Q3 =df.iloc[1,8]
        Eps2020Q2 =df.iloc[2,8]
        Eps2020Q1 =df.iloc[3,8]
        Eps2019Q4 =df.iloc[0,7]
        Eps2019Q3 =df.iloc[1,7]
        Eps2019Q2 =df.iloc[2,7]
        Eps2019Q1 =df.iloc[3,7]

目前是抓固定欄位去取得當年當季的EPS

可是如果這支股票是2013年後上市上櫃的 那麼欄位就會往前移

有想過先抓第一列的年份再取下去的欄位
不過年份的Table跟EPS的Table是分開的
參考網址https://histock.tw/stock/6547/%E6%AF%8F%E8%82%A1%E7%9B%88%E9%A4%98
感謝各位大大解答


標題:<解決>影像處理-讀取影片檔案錯誤
標籤:#opencv #影 #python 

這隻程式原本是啟動自己的相機
cap = cv2.VideoCapture(0)
但現在我想要用讀取影片的方式
影片可以出來但一樣播完之後錯誤就出現了

下面是程式碼跟要圖取的影像(.avi)資料夾位置
希望大師們可以幫幫忙 謝謝
有嘗試將路徑改成
cap = cv2.VideoCapture('E:\\Computer\\Final\\color_recognition-master\\src\\3.avi')
但跟上面一樣影片可以出來但一樣播完之後錯誤就出現了


標題:不使用Tensorflow、Scikit_learn、pytorch如何進行影像分類
標籤:non-linear classfication python 

期末作業有一題
不使用Tensorflow、Scikit_learn、pytorch...等non-linear的解法，
但可以使用PCA主成分分析
這樣該如何進行影像分類(3類的圖片)
可以給點方向，或關鍵字讓小弟去鑽研一下
完全沒有方向
謝謝各位前輩


標題:文章不懂 求救!!!!
標籤:python系列文章 py求助 老人家求教! 窮老人有問題 

尋求問題點原因跟解法
問題點:資料推不過去
參考網站:https://ithelp.ithome.com.tw/articles/10217350

我python版本是3.8
我requirement.txt文件是跟網站設定的一樣
py檔是複製使用


標題:Python 不會解釋
標籤:python 

有沒有大神可以幫我解釋每一句意義
animal=[]
n=eval(input(“請輸入動物個數：“))
for I in range(n):
x =input(“請輸入第%d個動物:”%(i+1))
animal.append(x)
For I in range(len(animal)):
pirnt(“animal [%d]=%s”%(i,animal[i]))


標題:python求救!!!!
標籤:聊天機器人 老人家求教! python3 蟒蛇 

希望有人可以教我製作聊天機器人


標題:Python骰子問題
標籤:程式設計 python 

擲一個骰子(利用python中產生亂數的方法),並印出每一次所擲的點數,當點數為5時，程式停止執行，否則繼續執行。
請問要怎麼寫?


標題:除了使用 python tesseract 來辨識車牌 還有什麼方法嗎？謝謝！
標籤:python tesseract 辨識車牌 車牌辨識 opencv 


import cv2
import imutils
import numpy as np
import pytesseract
pytesseract.pytesseract.tesseract_cmd = r'C:\Program Files\Tesseract-OCR\tesseract.exe'
img = cv2.imread('02.jpeg',cv2.IMREAD_COLOR)
img = cv2.resize(img, (600,400) )
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY) 
gray = cv2.bilateralFilter(gray, 13, 15, 15)
edged = cv2.Canny(gray, 30,150)
cv2.imshow('edged',edged)
cv2.waitKey(0)
contours=cv2.findContours(edged.copy(),cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE)
contours = imutils.grab_contours(contours)
contours = sorted(contours,key=cv2.contourArea, reverse = True)[:20]
screenCnt = None
for c in contours:
    peri = cv2.arcLength(c, True)
    approx = cv2.approxPolyDP(c, 0.018 * peri, True)
    if len(approx) == 4:
        screenCnt = approx
        break
print(screenCnt)
mask = np.zeros(gray.shape,np.uint8)
new_image = cv2.drawContours(mask,[screenCnt],0,255,-1,)
new_image = cv2.bitwise_and(img,img,mask=mask)
cv2.imshow('new_image',new_image)
cv2.waitKey(0)
(x, y) = np.where(mask == 255)
(topx, topy) = (np.min(x), np.min(y))
(bottomx, bottomy) = (np.max(x), np.max(y))
Cropped = gray[topx:bottomx+1, topy:bottomy+1]
text = pytesseract.image_to_string(Cropped, config='--psm 11')
print("programming_fever's License Plate Recognition\n")
print("Detected license plate Number is:",text)
img = cv2.resize(img,(500,300))
Cropped = cv2.resize(Cropped,(400,200))
cv2.imshow('car',img)
cv2.imshow('Cropped',Cropped)
cv2.waitKey(0)
cv2.destroyAllWindows()



標題:用zipfile壓縮成EPUB檔
標籤:python 

我在測試時研究不出為什麼我壓縮出來的EPUB檔無法開啟
於是參考了其他人的程式碼發現
我只要將
zf = zipfile.ZipFile('{}.epub'.format(path), 'a', zipfile.ZIP_DEFLATED)
改成
zf = zipfile.ZipFile('{}.epub'.format(path), 'a', zipfile.zlib.DEFLATED)
EPUB就能成功打開了
這是什麼原理啊
可以解說一下嗎


標題:python 終端機問題..
標籤:vscode python 

小弟正從網路學習平台學習python
在輸入print 指令時下方終端機沒有輸出網路爬文也找不到原因
請求各位幫忙謝謝


標題:救救資訊作業...
標籤:python 

解到剩兩題，想破頭都寫不出來，可以請各位大神救救我嗎?....
第一題
若串列A = [ [1, 2, 3, 0], [4, 5, 6, 0], [7, 8, 9, 0] ]，串列B = [ [2, 4, 6, 0], [1, 3,5, 0], [0, -1, -2, 0] ]；
試產生一個相同尺寸的串列C，且其內容為A + B (矩陣相加)的結果。
第二題
英文字母中的母音共有"a","e","i","o","u"等五個字母，若將同樣字母的大小寫視為相同字元。試設計一程式，當使用者輸入某一個字串時，程式會列印出字串中的五個母音出現的個數。
例如: 輸入AazoroiIiyfUu, 則輸出a:2  e:0  i:3  o:2  u:2,


標題:#新手python 學習字串遇到問題
標籤:python #新手求指導 

題目是撰寫一段程式碼，從鍵盤輸入一個數字(>=100)，找出該數字的百位數的數字，並將結果顯示在畫面上。
輸入輸出範例:輸入100,會print出100=1
而我自己寫出來後，也跑過答案是對的，但是題庫一直顯示是錯誤的，可以幫我看一下哪裡出錯嗎?
n=int(input())
if n<1000:
print(n,"=",n//100)
else:
print(n,"=",n%1000//100)


標題:請問高手 將整個DOS CLIPPER5系統 轉換 改成 PYTHON 架構 容易嗎?
標籤:python 

請問高手:
希望 將整個 CLIPPER5 DOS系統 轉換 改成 PYTHON 架構 容易嗎?


標題:# python問題 
標籤:python 

想請問一下各位大大1個問題~~
目前我寫的程式碼如下
但好像還是不太對~
麻煩了><
撰寫一個猜數字遊戲程式。由程式產生一個介於 1 到 100 的隨
機整數，玩遊戲者可輸入最多 10 次猜數字。每次輸入的數如果不
對，可給出偏大或偏小提示。如果猜到正確數字，給出恭喜資訊。
如果猜了 10 次都不正確，遊戲結束，給出失敗資訊。
import random

numbers  = [for i in range(100)]



標題:#python  如何用遞迴函數 畫出等腰三角形 
標籤:python 

各位大大不好意思想請問一下
如何使用遞迴函數來畫出等腰三角形
目前會使用for迴圈 來畫出等腰三角形
n = int(input(' 請輸入一個正整數 :'))
for i in range(0 , n):
    print(" * " * (i+1))


使用者輸入6 就會跑出像是這樣的圖形
 * 
 *  * 
 *  *  * 
 *  *  *  * 
 *  *  *  *  * 
 *  *  *  *  *  * 

但我試了蠻多次還不太會用遞迴函數來寫程式
def fac (num):
    if num <=0:
        return 1
    else:
        return num * fac(num-1)

num = int(input('請輸入一個正整數 :'))
print( "*" * fac(num))


跑出來的結果跟我要的好像不太一樣..
麻煩大大幫我指出問題
謝謝
。


標題:python import cpp的問題 猜測與makefile有關
標籤:cpp python makefile 

第二問-由於昨天是凌晨問的所以想說曝光度不高
我從網路上抓了一個text-detection的專案來用自己的train data訓練
不過其中遇到了cpp的問題,該段程式碼如下
他在from .pse import pse_cpp, get_points, get_num會跳出下面的錯誤訊息
from .pse import pse_cpp, get_points, get_num ModuleNotFoundError: No module named 'post_processing.pse'
此外該資料夾如下

我猜測需要使用到makefile 不過我看不太懂裡面的代碼
另外我所抓的專案github為:https://github.com/WenmuZhou/PAN.pytorch
CXXFLAGS = -I include  -std=c++11 -O3 $(shell python3-config --cflags)
LDFLAGS = $(shell python3-config --ldflags)

DEPS = $(shell find include -xtype f)
CXX_SOURCES = pse.cpp

LIB_SO = pse.so

$(LIB_SO): $(CXX_SOURCES) $(DEPS)
	$(CXX) -o $@ $(CXXFLAGS) $(LDFLAGS) $(CXX_SOURCES) --shared -fPIC

clean:
	rm -rf $(LIB_SO)


這是我出問題的程式
def decode(preds, scale=1, threshold=0.7311, min_area=5):
    """
    在输出上使用sigmoid 将值转换为置信度，并使用阈值来进行文字和背景的区分
    :param preds: 网络输出
    :param scale: 网络的scale
    :param threshold: sigmoid的阈值
    :return: 最后的输出图和文本框
    """
    from .pse import pse_cpp, get_points, get_num
    preds[:2, :, :] = torch.sigmoid(preds[:2, :, :])
    preds = preds.detach().cpu().numpy()
    score = preds[0].astype(np.float32)
    text = preds[0] > threshold  # text
    kernel = (preds[1] > threshold) * text  # kernel
    similarity_vectors = preds[2:].transpose((1, 2, 0))

    label_num, label = cv2.connectedComponents(kernel.astype(np.uint8), connectivity=4)
    label_values = []
    label_sum = get_num(label, label_num)
    for label_idx in range(1, label_num):
        if label_sum[label_idx] < min_area:
            continue
        label_values.append(label_idx)

    pred = pse_cpp(text.astype(np.uint8), similarity_vectors, label, label_num, 0.8)
    pred = pred.reshape(text.shape)

    bbox_list = []
    label_points = get_points(pred, score, label_num)
    for label_value, label_point in label_points.items():
        if label_value not in label_values:
            continue
        score_i = label_point[0]
        label_point = label_point[2:]
        points = np.array(label_point, dtype=int).reshape(-1, 2)

        if points.shape[0] < 100 / (scale * scale):
            continue

        if score_i < 0.93:
            continue

        rect = cv2.minAreaRect(points)
        bbox = cv2.boxPoints(rect)
        bbox_list.append([bbox[1], bbox[2], bbox[3], bbox[0]])
    return pred, np.array(bbox_list)



標題:python3巢狀import問題
標籤:python3 import 

假設我有一個專案叫做bar，結構長這樣
bar
├── __init__.py
├── lib
│   ├── __init__.py
│   └── bar_lib_file.py
└── bar_file.py

bar_file.py裡面有一行import
from lib.bar_lib_file import funcion_in_bar_lib_file

現在我有個新專案想將這整個專案import進來，結構長這樣
foo
├── lib
│   └── bar
│       ├── __init__.py
│       ├── lib
│       │   ├── __init__.py
│       │   └── bar_lib_file.py
│       └── bar_file.py
└── foo_file.py

在foo_file.py裡試著import
from lib.bar.bar_file import funcion_in_bar_file

就會出現error
Traceback (most recent call last):
  File "foo_file.py", line 1, in <module>
    from lib.bar.bar_file import funcion_in_bar_file
  File "/home/llinyanbin/桌面/project/tmp/foo/lib/bar/bar_file.py", line 1, in <module>
    from lib.bar_lib_file import funcion_in_bar_lib_file
ModuleNotFoundError: No module named 'lib.bar_lib_file'

我知道可以去bar_file.py裡去修改成相對位置來解決
from .lib.bar_lib_file import funcion_in_bar_lib_file

但我想問有沒有辦法在不動到bar裡面的source code來解決，我不太確定是不是要編寫bar裡面的__init__.py
謝謝各位大大。


標題:python 使用cpp的問題
標籤:python cpp compile 

我從網路上抓了一個text-detection的專案來用自己的train data訓練
不過其中遇到了cpp的問題,該段程式碼如下
他在from .pse import pse_cpp, get_points, get_num會跳出下面的錯誤訊息
from .pse import pse_cpp, get_points, get_num ModuleNotFoundError: No module named 'post_processing.pse'
此外該資料夾如下

另外我所抓的專案github為:https://github.com/WenmuZhou/PAN.pytorch
def decode(preds, scale=1, threshold=0.7311, min_area=5):
    """
    在输出上使用sigmoid 将值转换为置信度，并使用阈值来进行文字和背景的区分
    :param preds: 网络输出
    :param scale: 网络的scale
    :param threshold: sigmoid的阈值
    :return: 最后的输出图和文本框
    """
    from .pse import pse_cpp, get_points, get_num
    preds[:2, :, :] = torch.sigmoid(preds[:2, :, :])
    preds = preds.detach().cpu().numpy()
    score = preds[0].astype(np.float32)
    text = preds[0] > threshold  # text
    kernel = (preds[1] > threshold) * text  # kernel
    similarity_vectors = preds[2:].transpose((1, 2, 0))

    label_num, label = cv2.connectedComponents(kernel.astype(np.uint8), connectivity=4)
    label_values = []
    label_sum = get_num(label, label_num)
    for label_idx in range(1, label_num):
        if label_sum[label_idx] < min_area:
            continue
        label_values.append(label_idx)

    pred = pse_cpp(text.astype(np.uint8), similarity_vectors, label, label_num, 0.8)
    pred = pred.reshape(text.shape)

    bbox_list = []
    label_points = get_points(pred, score, label_num)
    for label_value, label_point in label_points.items():
        if label_value not in label_values:
            continue
        score_i = label_point[0]
        label_point = label_point[2:]
        points = np.array(label_point, dtype=int).reshape(-1, 2)

        if points.shape[0] < 100 / (scale * scale):
            continue

        if score_i < 0.93:
            continue

        rect = cv2.minAreaRect(points)
        bbox = cv2.boxPoints(rect)
        bbox_list.append([bbox[1], bbox[2], bbox[3], bbox[0]])
    return pred, np.array(bbox_list)



標題:LSTM 股價預測序列問題
標籤:python3 lstm time series 

大家好，最近初學神經網路，目前正在練習用LSTM做股價預測，遇到了一些問題想請教大家。
手邊的資料集是某股票2010年至2020年的股價資料（新聞標題情感分數、開盤價、成交價、最高價、最低價、震幅、成交量），正規化後如下：

想要用過去30天的資料預測第31天的震幅，以2010~2018年做訓練集，2019~2020年做驗證，在製造訓練集序列時遇到了錯誤，請問該如何修改呢？
n = 30
feature_names = list(norm_data.drop('Change%', axis=1).columns)
X = []
y = []
indexes = []
norm_data_x = norm_data[feature_names]
for i in tqdm.tqdm_notebook(range(0,len(norm_data)-n)): 
  X.append(norm_data_x.iloc[i:i+n]. values) 
  y.append(norm_data['Change%'].iloc[i+n-1])
  indexes.append(norm_data.index[i+n-1]) 

X_train = X[indexes < datetime.datetime(2018,1,1)]
y_train = y[indexes < datetime.datetime(2018,1,1)]

TypeError: '<' not supported between instances of 'list' and 'datetime.datetime'
另外想再詢問，若我想用30天資料預測第31-33天的收盤價，這算是輸出入長度不同的多對多序列嗎？該如何改寫呢？謝謝


標題:pygsheets 的範本 運行錯誤
標籤:#pygsheets #python 

https://pygsheets.readthedocs.io/en/stable/
他上面給的範本
# open a worksheet as in the first example.

header = wks.cell('A1')
header.value = 'Names'
header.text_format['bold'] = True # make the header bold
header.update()

# The same can be achieved in one line
wks.cell('B1').set_text_format('bold', True).value = 'heights'

# set the names
wks.update_values('A2:A5',[['name1'],['name2'],['name3'],['name4']])

# set the heights
heights = wks.range('B2:B5', returnas='range')  # get the range
heights.name = "heights"  # name the range
heights.update_values([[50],[60],[67],[66]]) # update the vales
wks.update_value('B6','=average(heights)') # set get the avg value


heights.name = "heights"  # name the range
顯示錯誤
TypeError: create_named_range() missing 2 required positional arguments: 'start' and 'end'
請問是哪邊有問題呢?


標題:請教Python2.7問題
標籤:python2.7 window10 tomowarp2 

各位IT前輩們好~~~
我目前在日本讀研究所的留學生。
因為研究的需要，需要利用Python編寫程式。
主要是希望透過這個編寫程式(towarp2)，來了解實驗對象的變形量等研究
但我對於編寫程式一竅不通，所以在編寫時遇到許多困難。
希望可以請各位前輩幫幫我。
對於該提供甚麼資訊，我也不是很清楚，所以我先附上我出問題的地方。
如果有資訊不足的話，請各位前輩跟我說，我再補足
麻煩各位~~~
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Python27\lib\lib-tk\Tkinter.py", line 1547, in __call__
    return self.func(*args)
  File "C:\TomoWarp2\gui\postprocFrame.py", line 371, in show_displacements
    number_of_nodes = self.kinematics.shape[0]
AttributeError: Postproc_setup instance has no attribute 'kinematics'



標題:Python  用Closure解決兩個參數相乘問題
標籤:#python #closure #code #python3 

我想問 要怎麼用closure function 寫出加權分數
例如現在有三個原始分數10,35,67，權重分別為2,3,4
要怎麼print出加權分數為20,105,268呢？
一定要用Closure喔！拜託大家了 我研究好久都不會嗚嗚嗚...


標題:問題解決
標籤:python3 

學習來源：
https://ithelp.ithome.com.tw/articles/10221205
執行段：
from sklearn.preprocessing import StandardScaler # 標準化套件
sc = StandardScaler()　# 創建一個標準化的物件
sc.fit(dummies) # 針對df的資料進行計算
dummies_std = sc.transform(df) # 生成標準化資料
錯誤訊息：
ValueError                                Traceback (most recent call last)
 in ()
1 sc = StandardScaler() # 創建一個標準化的物件
2 sc.fit(dummies) # 針對df的資料進行計算
----> 3 dummies_std = sc.transform(df) # 生成標準化資料
4 frames
/usr/local/lib/python3.7/dist-packages/numpy/core/_asarray.py in asarray(a, dtype, order)
81
82     """
---> 83     return array(a, dtype, copy=False, order=order)
84
85
ValueError: could not convert string to float: 'high'


標題:opencv 減少圖片顏色數量，python 用 ctypes 呼叫 C dll ,  OSError: exception: access violation reading
標籤:python c dll ctypes access violation 

標題
opencv 減少圖片顏色數量，python 用 ctypes 呼叫 C dll ,  OSError: exception: access violation reading 0x00000276A3EEB130
環境：



項目
版本規格




win10
x64 21H1


python
3.9.2


gcc(MinGW)
10.2.0


opencv
4.5.2



目標：
想要減少圖片中所出現的顏色數，用 HSV 色域調整，該過程要極短時間完成。
程式碼
這裡有三個版本
第一個是原版，可以正常使用但真的有點慢
1k 圖片處理要花上 7.8s
第二個是用 numpy 迭代改良版
1k 圖片要處理 3.9s
但三個版本是打算用 c dll + ctypes 加速
但是一直有問題
第一版
import time
import ctypes
import datetime

import cv2
import numpy as np

# ⇓要嘗試的話這裡要改一下路徑，隨意一張圖即可。
frame = cv2.imread("./material/ttt.png")

max_type_quantity = 256
h_type_quantity = 16
s_type_quantity = 16
v_type_quantity = 16
_wn = 'HSV_assort'
photo_number = 0

h_par = int(max_type_quantity / h_type_quantity)
s_par = int(max_type_quantity / s_type_quantity)
v_par = int(max_type_quantity / v_type_quantity)

hsv_f = cv2.cvtColor(frame, cv2.COLOR_BGR2HSV)
hsv_f_1D = np.reshape(hsv_f, (hsv_f.shape[0] * hsv_f.shape[1], 3))

# ⇓最主要要加速的地方
for i in hsv_f_1D:
    i[0] = round(i[0] / h_par) * h_par
    i[1] = round(i[1] / s_par) * s_par
    i[2] = round(i[2] / v_par) * v_par
# ⇑最主要要加速的地方

frame = cv2.cvtColor(frame, cv2.COLOR_HSV2BGR)
cv2.imshow(_wn, frame)
key = cv2.waitKey(0)
if key == ord('q'):
    pass
elif key == ord('g'):
    st = datetime.datetime.fromtimestamp(
        time.time()).strftime('%Y%m%d_%H%M%S')
    imwrite_path = f'./{st}_nb{photo_number}.jpg'
    print('get_photo. ' + imwrite_path)
    cv2.imwrite(imwrite_path, frame)
    photo_number += 1
cv2.destroyAllWindows()

第二版(替換第一版部分)
# ⇓最主要要加速的地方
n = 0
with np.nditer(hsv_f_1D, op_flags=['readwrite']) as it:
    for i in it:
        # print(i[...])
        if n == 0:
            i[...] = int(i / h_par) * h_par
            n = 1
        elif n == 1:
            i[...] = int(i / s_par) * s_par
            n = 2
        elif n == 2:
            i[...] = int(i / v_par) * v_par
            n = 0
# ⇑最主要要加速的地方

第三版(1/2 - C 的部分)
#include <stdio.h>
#include <stdlib.h>

void hsv_assort(int  *matrix, int rows, int cols, int h_par, int s_par, int v_par){
    int i, j;
    printf("rows = %d\n", rows);
    printf("columns = %d\n", cols);
    printf("h_par = %d\n", h_par);
    printf("s_par = %d\n", s_par);
    printf("v_par = %d\n", v_par);

    for (i = 0; i < rows; i++) {
        for (j = 0; j < cols; j++) {
          if (j==0) {
            matrix[i * rows + j] = matrix[i * rows + j] / h_par * h_par;
          } else if (j==1) {
            matrix[i * rows + j] = matrix[i * rows + j] / s_par * s_par;
          } else {
            matrix[i * rows + j] = matrix[i * rows + j] / v_par * v_par;
          }
        }
    }
    printf("hsv_assort end");
}

編譯指令:gcc -shared hsv_assort_accelerate.c -o hsv_assort_accelerate.dll
第三版(2/2 - Python 的部分)
import time
import ctypes
import datetime

import cv2
import numpy as np

# 參考自 https://blog.csdn.net/MCANDML/article/details/80426914
def Convert1DToCArray(TYPE, ary):
    arow = TYPE(*ary.tolist())
    return arow


def Convert2DToCArray(ary):
    ROW = ctypes.c_int * len(ary[0])
    rows = []
    for i in range(len(ary)):
        rows.append(Convert1DToCArray(ROW, ary[i]))
    MATRIX = ROW * len(ary)
    return MATRIX(*rows)


def ShowCArrayArray(caa):
    for row in caa:
        for col in row:
            print(col)


frame = cv2.imread("./material/ttt.png")
dll = ctypes.CDLL("./hsv_assort_accelerate.dll")

max_type_quantity = 256
h_type_quantity = 16
s_type_quantity = 16
v_type_quantity = 16
_wn = 'HSV_assort'
photo_number = 0

h_par = int(max_type_quantity / h_type_quantity)
s_par = int(max_type_quantity / s_type_quantity)
v_par = int(max_type_quantity / v_type_quantity)

hsv_f = cv2.cvtColor(frame, cv2.COLOR_BGR2HSV)
hsv_f_1D = np.reshape(hsv_f, (hsv_f.shape[0] * hsv_f.shape[1], 3))


rows = hsv_f_1D.shape[0]
cols = hsv_f_1D.shape[1]

hsv_f_1D = hsv_f_1D.astype('int32')
caa = Convert2DToCArray(hsv_f_1D)

# ⇓ 嘗試無果，註解掉
# dll.hsv_assort.argtypes = [ctypes.c_int, ctypes.c_int,
#                            ctypes.c_int, ctypes.c_int,
#                            ctypes.c_int, ctypes.c_int]
# dll.hsv_assort.restype = None
dll.hsv_assort(caa,
               rows, cols,
               h_par, s_par, v_par)
print("dll.hsv_assort END")
print(np.array(caa))

frame = np.reshape(np.array(caa), frame.shape)
frame = cv2.cvtColor(frame, cv2.COLOR_HSV2BGR)
cv2.imshow(_wn, frame)
key = cv2.waitKey(0)
if key == ord('q'):
    pass
elif key == ord('g'):
    st = datetime.datetime.fromtimestamp(
        time.time()).strftime('%Y%m%d_%H%M%S')
    imwrite_path = f'./{st}_nb{photo_number}.jpg'
    print('get_photo. ' + imwrite_path)
    cv2.imwrite(imwrite_path, frame)
    photo_number += 1
cv2.destroyAllWindows()

##結果
這裡執行下去很奇怪，可以發現理論上要嘛直接噴錯，要嘛成功執行(會有 opencv 視窗)
但是他卻是在跑 C 的 dll 時突然結束(沒有執行到 printf("hsv_assort end");)
然後持續執行幾次後會隨機出現記憶體位置出錯

在 stackoverflow 上有一些人有出現類似的，結論好像是說要注意要輸入 ctypes 的型別
所以我其實有把加 hsv_f_1D = hsv_f_1D.astype('int32') 看看能不能轉成符合規則的
還有改動 函式- Convert2DToCArray 的 ROW = ctypes.c_int * len(ary[0]) 改成其他 ctypes
但發現這應該沒有用。

不過有的弔詭的是
我其實有先做最小實現
最小實現程式碼(1/2 - C 部分)
#include <stdio.h>

void show_matrix(int * matrix, int rows, int columns){
    int i, j;

    for (i = 0; i < rows; i++) {
        for (j = 0; j < columns; j++) {
            matrix[i * rows + j] = matrix[i * rows + j] + 1;
            printf("matrix[%d][%d] = %d\n", i, j, matrix[i * rows + j]);
        }
    }
}

最小實現程式碼(2/2 - Python 部分)
# from ctypes import *
import ctypes
import numpy as np


def Convert1DToCArray(TYPE, ary):
    arow = TYPE(*ary.tolist())
    return arow


def Convert2DToCArray(ary):
    ROW = ctypes.c_int * len(ary[0])
    rows = []
    for i in range(len(ary)):
        rows.append(Convert1DToCArray(ROW, ary[i]))
    MATRIX = ROW * len(ary)
    return MATRIX(*rows)


def ShowCArrayArray(caa):
    for row in caa:
        for col in row:
            print(col)


# a = np.array([[1, 2, 2], [1, 3, 4]], dtype=np.uint8)
a = np.array([[1, 2, 2], [1, 3, 4]])
type(a[0][0])
# ary = a
caa = Convert2DToCArray(a)
ShowCArrayArray(caa)
a.shape

lib = ctypes.cdll.LoadLibrary("./t1.dll")
lib.show_matrix(caa, a.shape[0], a.shape[1])
print('======')
print(a)
# print(caa)

print(np.array(caa))
# 結果有變化
# [[2 3 4]
#  [2 4 4]]



再看了 2 次感覺上也沒有跟我那個差太多
但是這個有修改到 Orz...
然後寫問題到這裡的當下發現怪怪的...
我預期的效果是 每個陣列內的值+1
但是 row 1,col 3 的值變+2(2->4)
但是 row 2,col 3 的值變+0(4->4)
##求問各位

最小實現程式碼的部分出了什麼問題 Orz....
第三版要怎麼修改才會正常呢?
第二版的 numpy 方案還有辦法修改更快嗎?

謝謝你看到這裡 m(_ _)m


標題:<解決>顏色辨識Color-Recognizer-master錯誤，但無錯誤訊息
標籤:#color #python #spyder #pandas 


執行程式後會將圖片中滑鼠游標移到的地方之顏色顯示出來
但是我執行過後只有圖片來，游標放上去沒有任何東西
但又無任何的錯誤訊息不知錯在哪，麻煩指點謝謝


標題:<解決>影像辨識的錯誤
標籤:#影像處理 #python spyder 

剛開始接觸影像辨識的部分
所以有先找code來試試
但是有一個程式在執行有發生錯誤
上網查找錯誤訊息也不懂是哪裡出錯




標題:python index error
標籤:index error python3 

Dict1 = {}#name
Dict2 = {}#grade
Dict3 = {}#special
def modified_grade():
    return min(max(score*3/2-10, 0), 100)
def modified_spec_grade():
    return min(max(score*5/2-20, 0), 100)
while True:
    try:
        n = input().split()
        if n[0] == "i":
            Dict1[int(n[1])] = n[2]
            Dict2[int(n[1])] = int(n[3])
            Dict3[int(n[1])] = int(n[4])
        elif n[0] == "d" :
            del Dict1[int(n[1])]
            del Dict2[int(n[1])]
            del Dict3[int(n[1])]
        elif n[0] == "qg":
            print(Dict2[int(n[1])])
        elif n[0] == "qn":
            print(Dict1[int(n[1])])
        elif n[0] == "pg":
            for key, value in sorted(Dict1.items()):
                print(key, value, Dict2[key])
        elif n[0] == "pm":
            if n[4] == "1":
                print("true")
            elif inline[4] == 0:
                    print("bad")
    except KeyError:
        print("ID",n[1],"does not exist!")
    except:
        break
    
```如題，以下為我的程式碼，想請問第27行為什麼即使我input 為1，但輸出出來他卻說index error(下面print true 跟print bad是我先隨意打的一個指令）
ex. 我inpiut輸入：i 1 ryan 90 1 之後輸入pm 這時卻跳出index error 並告訴我 line 27: index out of range![https://ithelp.ithome.com.tw/upload/images/20210531/20137974n5HFGMhlgQ.png](https://ithelp.ithome.com.tw/upload/images/20210531/20137974n5HFGMhlgQ.png)



標題:關於LINE BOT 發送資料給GOOGLE SHEET
標籤:#heroku #linebot #python 

我利用了 HeroKu 平台 創造了 一個LINE BOT
請問要怎麼把資料傳到GOOGLE 表單上面呢?
麻煩各位大神回答了
我用的語言是Python


標題:LineBotApi 如何取得  Datetime picker action 的值
標籤:#python #linebot #flask 

我只知道 他回傳的是Postback event直接傳到sever 端
但是我想要取的上面的日期讓使用者發送給LINE BOT
請問一下 要如何取得Datetime picker action 的值呢?
@handler.add(MessageEvent, message=TextMessage)
def handle_message(event):
    msg = event.message.text
    if '我要預約' in msg:
        message = buttons_message()
        line_bot_api.reply_message(event.reply_token, message)

    elif '預約資訊' in msg:
        message = buttons_message()
        line_bot_api.reply_message(event.reply_token, message)
    elif '最新消息' in msg:
        message = TextSendMessage(text=msg)
        line_bot_api.reply_message(event.reply_token, message)
    else:
        message = TextSendMessage(text=msg)
        line_bot_api.reply_message(event.reply_token, message)


在buttons_message() 我放了 一個
 DatetimePickerTemplateAction(
                    label="標籤",
                    data="input_A",
                    mode='datetime',
                    initial='2021-05-28T00:00',
                    max='2023-01-01T00:00',
                    min='2021-05-28T00:00'
                )

不知道該如何取得使用者所選擇的日期
煩請各位大神回復指教 !


標題:#新手python 學習函式遇到問題
標籤:python 新手上路 #新手求指導 

在做題目的時候遇到瓶頸，不好意思能請幫我解答一下嗎?
這是題目
［試設計一個python函式pt，它有兩個參數a,b, 兩個參數皆為3個位數的整數,函式pt能列印出a到b之間(包含a與b)，構成數值的三個位數均為偶數的整數所構成的串列(list)。］
我一直解不出來，只能寫到印出100~400的雙數，但弄不出三個數字都是都是2的倍數的
只能寫到這
def pt(a,b):
ans=[for i in range(a,b+1) if i%2==0]
print(ans)
pt(100,200)


標題:Python 有辦法把公開資訊觀測站的單季Eps儲存到變數嗎
標籤:python pandas 股票 公開資訊觀測站 python 

爬了幾天文 都只有把整個報表列印下來而已雖然可以儲存指定欄位 可是每季的EPS欄位位子都不同...


標題:有什麼線上 python  編譯小工具   用來 寫點小CODE 分享給其他工程師 看的
標籤:python 

有什麼線上 python  編譯小工具   用來 寫點小CODE 分享給其他工程師 看的
希望可以讀資料檔功能  CSV  TXT  這種功能 上傳文字檔到該網站
我找的這個滿爛的
https://www.w3schools.com/python/trypython.asp?filename=demo_compiler


標題:python matplotlib
標籤:python 問題 matplotlib 


請問該如何用python matplotlib 繪製出此表散佈圖
想要顯示出相關性
謝謝


標題:透過 flask 取得mongodb的資料
標籤:flask python mongodb 

大家好，小弟最近剛接觸flask，想由此寫API抓出mongodb的資料，但卻一直跑不出來，想請問code是不是有寫錯的地方，已確定client & 資料庫沒錯，想藉由資料庫的id欄位(key)呼資料，只是呼不出來
from flask import Flask, jsonify, request #request網路參數用
from pymongo import MongoClient

client = MongoClient() 
# 帳號:密碼@ip:porter(服務在哪個端口)
wine = client['']['']#[] # 資料庫 + 資料表

app = Flask(__name__) #命名

'define function，這支API要做的事情'
# http://my.domain.com/denny
@app.route('/denny', methods=['GET']) #取得網址，/ = url，get取得網頁方式

def test():
    
    text_id = request.args.get('text_id') 
    #網址參數，'網站上打的東西'
    
    data = wine.find_one({'id':text_id},{'_id':0}) 
    #'key(欄位)': value(值)
    #Fund_id:欄位名稱>串網址參數，0 >> 不要_id欄位
    
    #上述做法會有空值，故要有個測試
    if data is None:
        msg = {
            'Result': None,
            'Status': {
                'Code' : 404,
                'Msg' : 'Data Not Found'
            }
        }
        return jsonify(msg), 404
    else:
        msg = {
            'Result': data,
            'Status': {
                'Code': 200,
                'Msg': 'Operation Successful'
            }
        }
        return jsonify(msg), 200 #確保傳回前端為json格式，200代表成功
#%%
'執行 http://127.0.0.1:5000/denny?text_id=235395820'
app.run()

http://127.0.0.1:5000/denny?text_id=235395820 想由此拉出資料



標題:使用Googletrans Python模組，出現"< AttributeError: 'NoneType' object has no attribute 'group' >"
標籤:@python @google 

請教一下各位前輩，再練習Python時，使用了上述Googletrans模組，想要進行文字翻譯。但是打完程式碼之後，出現了以下錯誤

AttributeError: 'NoneType' object has no attribute 'group'

上網爬了許多文之後，只知道好像是Google翻譯更改了API導致，googletrans版本為3.0.0，解析返回包失败，但是具體這個錯誤為甚麼會發生還是沒有搞懂。
所以在這邊還請各位前輩替小弟解答一下 謝謝!! 
以下是程式碼
from googletrans import Translator

translator = Translator()

#中翻英
print(translator.translate("您好").text) # Hello

#英翻中
print(translator.translate("Hello",dest="zh-TW").text) # 你好

#英文翻譯成日文
print(translator.translate("Hello",dest="ja").text)  # こんにちは 

#日文翻譯成中文
print(translator.translate("こんにちは",dest="zh-TW",src="ja").text) # 你好



標題:python操作google sheet新增一列，無法從第一行開始
標籤:python3 google sheet #google spreadsheet heroku 

如題
最近開始試學習python來操作google sheet
也已成功操作
但現在遇到一個問題
就是新增一列資訊時，無法從第一行開始
我的狀況是會從第AH欄位新增一列
程式碼如下
scope = ['https://spreadsheets.google.com/feeds',
            'https://www.googleapis.com/auth/drive']
credentials=ServiceAccountCredentials.from_json_keyfile_name('xxx123.json', scope)
gc = gspread.authorize(credentials)
wks = gc.open("xxx").sheet1
wks.append_row('x','x','x')

請問大家有遇過相同的問題嗎？


標題:#新手python 學習Neural Network遇到問題
標籤:python3 python系列文章 python入門 

安裝pip install os-win時
最後出現了以下錯誤
  ERROR: Command errored out with exit status 1:
   command: 'C:\Users\sandr\anaconda3\python.exe' -u -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '"'"'C:\\Users\\sandr\\AppData\\Local\\Temp\\pip-install-n5pera4z\\netifaces_770591b64df945149020b26d80733631\\setup.py'"'"'; __file__='"'"'C:\\Users\\sandr\\AppData\\Local\\Temp\\pip-install-n5pera4z\\netifaces_770591b64df945149020b26d80733631\\setup.py'"'"';f = getattr(tokenize, '"'"'open'"'"', open)(__file__) if os.path.exists(__file__) else io.StringIO('"'"'from setuptools import setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' bdist_wheel -d 'C:\Users\sandr\AppData\Local\Temp\pip-wheel-jhplv897'
       cwd: C:\Users\sandr\AppData\Local\Temp\pip-install-n5pera4z\netifaces_770591b64df945149020b26d80733631\
  Complete output (5 lines):
  running bdist_wheel
  running build
  running build_ext
  building 'netifaces' extension
  error: Microsoft Visual C++ 14.0 or greater is required. Get it with "Microsoft C++ Build Tools": https://visualstudio.microsoft.com/visual-cpp-build-tools/
  ----------------------------------------
  ERROR: Failed building wheel for netifaces
  Running setup.py clean for netifaces
Failed to build netifaces
Installing collected packages: netifaces, netaddr, iso8601, debtcollector, stevedore, oslo.utils, oslo.serialization, oslo.context, oslo.config, fasteners, dnspython, wmi, PyMI, oslo.log, oslo.concurrency, eventlet, os-win
    Running setup.py install for netifaces ... error
    ERROR: Command errored out with exit status 1:
     command: 'C:\Users\sandr\anaconda3\python.exe' -u -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '"'"'C:\\Users\\sandr\\AppData\\Local\\Temp\\pip-install-n5pera4z\\netifaces_770591b64df945149020b26d80733631\\setup.py'"'"'; __file__='"'"'C:\\Users\\sandr\\AppData\\Local\\Temp\\pip-install-n5pera4z\\netifaces_770591b64df945149020b26d80733631\\setup.py'"'"';f = getattr(tokenize, '"'"'open'"'"', open)(__file__) if os.path.exists(__file__) else io.StringIO('"'"'from setuptools import setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' install --record 'C:\Users\sandr\AppData\Local\Temp\pip-record-hzgramn4\install-record.txt' --single-version-externally-managed --compile --install-headers 'C:\Users\sandr\anaconda3\Include\netifaces'
         cwd: C:\Users\sandr\AppData\Local\Temp\pip-install-n5pera4z\netifaces_770591b64df945149020b26d80733631\
    Complete output (5 lines):
    running install
    running build
    running build_ext
    building 'netifaces' extension
    error: Microsoft Visual C++ 14.0 or greater is required. Get it with "Microsoft C++ Build Tools": https://visualstudio.microsoft.com/visual-cpp-build-tools/
    ----------------------------------------
ERROR: Command errored out with exit status 1: 'C:\Users\sandr\anaconda3\python.exe' -u -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '"'"'C:\\Users\\sandr\\AppData\\Local\\Temp\\pip-install-n5pera4z\\netifaces_770591b64df945149020b26d80733631\\setup.py'"'"'; __file__='"'"'C:\\Users\\sandr\\AppData\\Local\\Temp\\pip-install-n5pera4z\\netifaces_770591b64df945149020b26d80733631\\setup.py'"'"';f = getattr(tokenize, '"'"'open'"'"', open)(__file__) if os.path.exists(__file__) else io.StringIO('"'"'from setuptools import setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' install --record 'C:\Users\sandr\AppData\Local\Temp\pip-record-hzgramn4\install-record.txt' --single-version-externally-managed --compile --install-headers 'C:\Users\sandr\anaconda3\Include\netifaces' Check the logs for full command output.

請問是哪裡出問題呢@@


標題:#Python  骰子問題
標籤:python 

import random

numbers  = [random.randint(1,6) for i in range(100)]
result_dict = {}
print (numbers)
for num in numbers:
    count = numbers.count(num)
    result_dict[num] = count
     
h = max(result_dict.values())
for item in result_dict.items():
     value =item[1]
     if value == h:
        key = item[0]
        print('1~6哪一個點數出現最多次:')
        print(key)
        print('共出現幾次? :')
        print(value)

s = min(result_dict.values())
for item in result_dict.items():
     value =item[1]
     if value == s:
        key = item[0]
        print('1~6哪一個點數出現最少次:')
        print(key)
        print('共出現幾次? :')
        print(value)

不好意思想請問一下各位大神
目前我只有辦法列出 出現最多次和最少次的點數
如果想要列出像這樣:
1: 出現 16次
2: 出現 28次
.
.
.
6: 出現 17次
類似這樣方式的話
程式碼要從哪個地方修改呢
謝謝~


標題:Leetcode 1650 (有個多變數賦值的問題)
標籤:python leetcode 

各位邦友好，以下連結是題目
https://leetcode.com/problems/lowest-common-ancestor-of-a-binary-tree-iii/
以及我參考Discuss寫出來的code:
"""
class Node:
    def __init__(self, val):
        self.val = val
        self.left = None
        self.right = None
        self.parent = None
"""

        while p.parent:
            p.parent, p = None, p.parent
            
        while q:
            if not q.parent:
                return q
            else:
                q = q.parent

請問各位，p.parent, p = None, p.parent 這樣寫是ok的，但改成 p, p.parent = p.parent, None 就不行了。請問是為什麼呢？ 本人查了一些Python多變數賦值的資料，都沒有查到原因。
先謝謝各位熱心的邦友願意看完本人的問題


標題:python 無法安裝 googletrans
標籤:python3 python入門 python求救 

我嘗試安裝了這個googletrans但一直遇到問題
! pip install googletrans




標題:如何同時訓練數值與影像 
標籤:python 機器學習 影像分析 深度學習 數值分析 

最近一直被同一個問題困擾 想詢問一下
如果同時有照片又有數值 怎麼一起訓練模型？
因為照片轉成RPG矩陣後會變成很大的矩陣
不知道該怎麼加入變數列 一起成為輸入資料進去模型
如
csv檔裡面含有照片路徑、性別、年齡等數值
照片切割成50x50，照片總共有100張
那進去訓練的資料大小就會是(100,50,50,3)
要怎麼再加入excel上的數值資料(像是年紀啊、性別啊)一起訓練啊
數據使用：https://www.kaggle.com/andrewmvd/ocular-disease-recognition-odir5k
讀取函式庫
import pandas as pd
import numpy as np
from tensorflow.keras.applications.vgg16 import VGG16
from tensorflow.keras.preprocessing import image
from tensorflow.keras.applications.vgg16 import preprocess_input
from tensorflow.keras import layers
from tensorflow.keras.models import Model
%pylab inline
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
from tensorflow.keras.applications.vgg16 import preprocess_input
from keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Dropout, InputLayer
from keras.models import Sequential
from keras import optimizers
from imblearn.over_sampling import RandomOverSampler
from collections import Counter
from sklearn.datasets import make_classification
from imblearn.over_sampling import SMOTE

讀取csv資料
data = pd.read_csv(r"/content/drive/MyDrive/full_df.csv")
data.head()

設定Y
df_label = data[['N','D','G','C','A','H','M','O']]
y = np.array(df_label)

*** 影像模型 ***
讀取照片並轉成RPG (6392, 50, 50, 3)
# Read images and merge them into the training data X.
len_data = len(data)
X = np.array([])
path = '/content/drive/MyDrive/ODIR-5K/ODIR-5K/Training Images/'
for i in range(len_data):
  input_path = path + data['filename'][i]
  # Load image and Resize into (50, 50) 
  img = image.load_img(input_path, target_size=(50, 50))
  # Add one dimension and Become to (1, 224, 224, 3), which the last dimension is color.
  img2 = image.img_to_array(img)
  img2 = np.expand_dims(img2, axis=0)
  #print(img2.shape)
  if len(X.shape) == 1:
      X = img2
  else:
      # Combine the pixels of all images
      X = np.concatenate((X, img2), axis=0)

X = preprocess_input(X)

使用VGG16模型訓練照片
# Set VGG16 Model
base_model = VGG16(weights='imagenet', include_top=False)

# Connect My Layer
x = base_model.output
#x = layers.Flatten()(x)
x = layers.GlobalAveragePooling2D()(x)
#x = layers.Dropout(0.2)(x)
x = layers.Dense(256, activation='relu')(x)
#x = layers.Dropout(0.2)(x)
x = layers.Dense(64, activation='relu')(x)
x = layers.Dense(7, activation='sigmoid')(x)

# Set New Model inputs/outputs
model = Model(inputs=base_model.input, outputs=x)

# Original layers of VGG16 are not retrained
for layer in base_model.layers:
    layer.trainable = False
    
model.compile(optimizer='adam', loss='binary_crossentropy')

訓練照片模型
pic_output = model.fit(X, y, epochs=5, validation_split=0.2, verbose=2)

*** 數值模型 ***
資料輸入格式是 (6392, 3)
# Ｘ：病人性別
# 把Patient Sex轉成dummy code
label_encoder = preprocessing.LabelEncoder()
data['Patient Sex'] = label_encoder.fit_transform(data["Patient Sex"])

# Ｘ：病人年紀
data['Patient Age']

# Ｘ：眼睛左邊/右邊
for i in range(len_data):
  if 'right' in data['filename'][i]:
    data.loc[i,'side'] = 0
  else:
    data.loc[i,'side'] = 1
    
# 數值部分的dataframe
X_Numerical = data[['Patient Sex','Patient Age','side']]
X_Numerical_array = np.array(X_Numerical)

數值使用KNN模型(?)
knn = KNeighborsClassifier()
numerical_output = knn.fit(X_Numerical_array,y)

*** 我想要合併，但會出錯 ***
output_combined = concatenate([pic_output, numerical_output])

影像模型的參考網站大概如下，模型是參考他的，但因為自己還有數值資料，想加入一起分析，不知道該怎麼做，所以來求助
https://ithelp.ithome.com.tw/m/articles/10237020?sc=iThomeR
再麻煩指教！萬分感激！


標題:python自動化學習請益
標籤:自動化 自動化測試 python 

各位前輩好，本人約兩年mis資歷，近期想要嘗試接觸自動化領域，上網爬了相關資料，大多數推薦學習python，請問各位前輩學習自動化的路線?
因python應用領域廣，有為運、測試、ai等，哪個領域會比較有發展性呢?


標題:如何不被搜尋引擎發現我是爬蟲??爬蟲新手
標籤:python 網路爬蟲 

import requests
url='https://www.google.com.tw/search'
keyword=input('輸入關鍵詞')
try:
    kv={'q':keyword}
    ev={'user-agent':'Mozilla/5.0'}
    r=requests.get(url,params=kv,headers=ev)
    print(r.request.url)
    r.enconding=r.apparent_encoding
    r.raise_for_status()
    print(len(r.text))
except:
    print('爬取失敗')



標題:基本python 輸出入問題
標籤:#python 

這照理說不該有問題的，但無法輸出入
我檔案也都有放在同一個目錄下面
https://ithelp.ithome.com.tw/upload/images/20210522/20119136kKMQiqkgiR.jpg


標題:把123變321的程式，很EZ，不耗很多時間
標籤:python 

def converse(x):
    y=[]
    for i in x:
        y=i+y
converse([1,2,3,4])

上面的程式跑出來會出現下面的結果:
TypeError: unsupported operand type(s) for +: 'int' and 'list'
那我應該怎麼改比較恰當??


標題:Python新手 仿造銀行存錢提錢，查餘額
標籤:python 

這個程式:輸入存款，提款查餘額，可是run出來，他最後都print0給我，是我後面哪裡寫錯了嗎??
class Account:
def init(self,name):
self.name=name
self.balance=0
def deposit(self):
x=int(input('你要存入多少錢?'))
while x<0:
print('Error')
break
else:
self.balance+=x
return self.balance
def withdraw(self):
y=int(input('你要提取多少錢?'))
while y<0:
print('Error')
break
else:
self.balance-=y
return self.balance
Account('Sam').deposit()
Account('Sam').withdraw()
while Account('Sam').balance<0:
print('Error')
break
else:
print(Account('Sam').balance)


標題:如何優化我寫的程式，很簡單 新手發問
標籤:python3 

目的是輸入兩個向量相加，用sim_list得到答案，但可以直接問(x1,y1)=多少，(x2,y2)=多少，而不是一個質一個質問??
x1=float(input('輸入a向量x質'))
y1=float(input('請輸入a向量y質'))
x2=float(input('輸入b向量x質'))
y2=float(input('輸入b向量x質'))
a=(x1,y1)
b=(x2,y2)
def sum_list(a,b):
return (a[0]+b[0],a[1]+b[1])
print(sum_list(a, b))
sum_list(a, b)


標題:Python Flask 跟 使用dreamweaver開發的網站的疑惑
標籤:# python # flask dreamweaver 

最近正在學習Python，剛好有一小部份開始介紹到Python Flask上傳到heroku，但開始產生了一個小問題:
感覺起來，用Python 去寫一個網站，跟 我用dreamweaver把網頁寫一寫再用FTP上傳上去，那後者不是會比較簡單一點嗎? 因為顯示出來的結果不是都一樣? 如果是用Python去寫網頁，有什麼是比較實際的考量嗎??例如說安全性或是什麼之類的嗎?
** Python Flask ** 這個目前我只學習了2天，所以如果我問的這個問題感覺被冒犯了，希望能請見諒，因我想要知道的是，這一塊是否有值得再繼續鑽研


標題:<已解決> 建立捷徑
標籤:#anaconda #python spyder 

之前在安裝Anaconda時裝在E外接硬碟上
今天筆電重灌想問要如何建立Anaconda 的捷徑
(目前空間有C有36G，D有800G)


標題:[詢問] Python相簿批次爬取 無法自動下載
標籤:python 大數據 #新手求指導 

網上各位大神好,我是程式新手!跟著"Python大數據特訓班"的範例打了程式,明明都照著做,但就是跑不出書上的結果,希望有大神能指導一下哪裡出了問題QQ
目前我在想是不是網頁的連結錯誤?
import requests,os
from bs4 import BeautifulSoup
from urllib.request import urlopen

url='https://running.biji.co/index.php?q=album&act=photo_list&album_id=30668&cid=5791&type=album&subtitle=第三屆埔里跑 Puli Power 山城派對馬拉松 - 向善橋(約34K)'
html=requests.get(url)

soup=BeautifulSoup(html.text,'html.parser')
title=soup.find('h1',{'class':'album-title flex-1'}).text.strip()

url='https://running.biji.co/index.php?pop=ajax&func=album&fename=load_more_photos_in_listing_computer'
payload={'type':'ablum','rows':'0','need_rows':'20','cid':'5791','album_id':'30668'}
html=requests.post(url,data=payload)

soup = BeautifulSoup(html.text,'html.parser')

images_dir=title + "/"
if not os.path.exists(images_dir):
    os.mkdir(images_dir)

photos = soup.select('.photo_img')
n=0
for photo in photos:
    src=photo['src']
    
    if src != None and ('.jpg' in src):
        full_path = src
        filename = full_path.split('/')[-1] 
        print(full_path)
       
        try:
            image = urlopen(full_path)
            with open(os.path.join(images_dir,filename),'wb') as f:
                f.write(image.read())
            n+=1
        except:
            print("{} 無法讀取！".format(filename))
        
print("共下載",n,"張圖片")

--我的結果顯示--

--書上要的結果--

麻煩大家了〒▽〒


標題:不確定這樣的 hough transform 效果是不是對的
標籤:python 霍夫轉換(hough transform) hough transform hough opencv 

直接呼叫原生的 cv 2 hough 函式 cv.houghline()

implement self 實作 def(): 再現

# -*- coding: utf-8 -*-
import cv2
import math
import numpy as np
def myhough(img):
    thetas = np.deg2rad(np.arange(-90.0, 90.0,1)).astype(int)
    cost = np.cos(thetas)
    sint = np.sin(thetas)
    row,column = np.nonzero(img)
    rhoss = []
    for i in range(len(thetas)):
        r = row[i]
        c = column[i]
        rho = r*cost[i]+c*sint[i]
        rho = rho.astype(int)
        rhoss.append(rho)
    return rhoss,thetas

img = cv2.imread("2.png")
img = cv2.resize(img,(1000,500))
img = cv2.GaussianBlur(img,(3,3),0)
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
edges = cv2.Canny(gray, 50, 150, apertureSize=3)
lines = cv2.HoughLines(edges,1,2,100)
r,h = myhough(edges)
cv = img.copy()
my = img.copy()
ano = img.copy()
for z,w in zip(r,h):
    a = np.cos(w)
    b = np.sin(w)
    x0 = z * a
    y0 = z * b
    x1 = int(x0 + 1000 * (-b))
    y1 = int(y0 + 1000 * a)
    x2 = int(x0 - 1000 * (-b))
    y2 = int(y0 - 1000 * a)
    results = cv2.line(my, (x1, y1), (x2, y2), (0, 0, 255), 1)

for line in lines:
    rho, theta = line[0]
    '''
    if(theta<90 or theta >270):
        pt1 = (int(rho/np.cos(theta)),0)
        pt2 = (int((rho-ano.shape[0]*np.sin(theta))/np.cos(theta)),ano.shape[0])
        cv2.line(ano, pt1, pt2, (255))
    else:
        pt1 = (0,int(rho/np.sin(theta)))
        pt2 = (ano.shape[1], int((rho-ano.shape[1]*np.cos(theta))/np.sin(theta)))
        cv2.line(ano, pt1, pt2, (255), 1)
    '''
    a = np.cos(theta)
    b = np.sin(theta)
    x0 = rho * a
    y0 = rho * b
    x1 = int(x0 + 1000 * (-b))
    y1 = int(y0 + 1000 * a)
    x2 = int(x0 - 1000 * (-b))
    y2 = int(y0 - 1000 * a)
    result = cv2.line(cv, (x1, y1), (x2, y2), (0, 0, 255), 1)
    
cv2.imshow("01", results)
cv2.waitKey(0)
cv2.destroyWindow('01')



標題:python hough transform 不能直接呼叫 cv2.HoughLines() 函式 而是要 implement self
標籤:python hough transform hough 霍夫轉換(hough transform) opencv 

請問這個 cv2.HoughLines() 如何寫 def(): 再現出來？謝謝！
#coding=utf-8
import cv2
import numpy as np  
 
img = cv2.imread("/home/sunny/workspace/images/road.jpg", 0)
 
img = cv2.GaussianBlur(img,(3,3),0)
edges = cv2.Canny(img, 50, 150, apertureSize = 3)
lines = *cv2.HoughLines*(edges,1,np.pi/180,118) #这里对最后一个参数使用了经验型的值
result = img.copy()
for line in lines[0]:
	rho = line[0] #第一个元素是距离rho
	theta= line[1] #第二个元素是角度theta
	print rho
	print theta
	if  (theta < (np.pi/4. )) or (theta > (3.*np.pi/4.0)): #垂直直线
                #该直线与第一行的交点
		pt1 = (int(rho/np.cos(theta)),0)
		#该直线与最后一行的焦点
		pt2 = (int((rho-result.shape[0]*np.sin(theta))/np.cos(theta)),result.shape[0])
		#绘制一条白线
		cv2.line( result, pt1, pt2, (255))
	else: #水平直线
		# 该直线与第一列的交点
		pt1 = (0,int(rho/np.sin(theta)))
		#该直线与最后一列的交点
		pt2 = (result.shape[1], int((rho-result.shape[1]*np.cos(theta))/np.sin(theta)))
		#绘制一条直线
		cv2.line(result, pt1, pt2, (255), 1)
 
cv2.imshow('Canny', edges )
cv2.imshow('Result', result)
cv2.waitKey(0)
cv2.destroyAllWindows()



標題:#新手python 學習人臉辨識遇到問題
標籤:python3 python系列文章 python入門 


上網查過許多 但是看不太懂@@....


標題:[python] 程式出現 CERTIFICATE_VERIFY_FAILED  ，但用瀏覽器瀏覽該網頁的 SSL 是正常的！
標籤:certificate_verify_failed python 

import requests
url = 'https://go.nkust.edu.tw'

req = requests.get(url)

requests.exceptions.SSLError: HTTPSConnectionPool(host='go.nkust.edu.tw', port=443): Max retries exceeded with url: / (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1123)')))

請教各位為什麼會這樣～
在瀏覽器瀏覽該網站是正常的，但用 requests 就 error，說找不到 issuer 的憑證
但另一個同家 CA 的網站就不會出現這個 error
import requests
url = 'https://www.ly.gov.tw/Home/Index.aspx'

req = requests.get(url)

想知道為什麼會這樣～～！


標題:#Python while迴圈問題～
標籤:python while 

小女目前自學Python
碰到書上一題練習題，苦難想不出來沒有結果ＱＱ
不知道是不是我把它搞複雜了，還請大家幫幫忙了！！感謝你們。
題目：
利用while設計一個程式。輸入一個正整數後，顯示由1到該整數的所有偶數。(<even.py>)

請輸入正整數n的值：8 / 顯示結果：2 4 6 8
請輸入正整數n的值：25/ 顯示結果：2 4 6 8 10 12 14 16 18 20 22 24



標題:想請教Python list 及dict的問題
標籤:python入門 list dictionary 基礎語法 

請教以下問題：


如果我有A與B的dict及c的list，該如何得到C的結果：
A = {'a': 1, 'b':2}
B = {'b': 2, 'c':3, 'd':4}
C = [{'a': 1, 'b':2}, {'b': 2, 'c':3, 'd':4}]


那如果有多個dict，該如何將這些多個dict放入c裡面，變成類似c的結果。


以上，謝謝。


標題:外包製作這樣程式約多少錢
標籤:python 

製作群發給客戶訊息程式
我要自行製作群發訊息程式 , 使用python ，我有問題在請問你 , 如果我做不出來 , 妳要可以給程式碼 , 製作程式不會違反蝦皮規定，可正常使用 , 要製作以下功能
1 . 群發客戶訊息程式
2 . 可以針對購買特定產品客戶群發訊息


標題:鉅亨網基金新聞 - python 爬蟲問題
標籤:python 爬蟲 網路爬蟲 python爬蟲 

大家好，小弟是個爬蟲菜鳥，只會美麗的湯，近日爬鉅亨發現都只能爬出相同的文章標題，附件是我的code，謝謝大家~
#鉅亨基金新聞爬蟲 
#https://news.cnyes.com/news/cat/fund
#https://news.cnyes.com/news/id/4646317 #每篇id
#假日無文，先爬五月份 5/1~5/16
import requests
from bs4 import BeautifulSoup
import time #for sleep 禮貌
#import datetime #計算爬蟲時間，未完
start_page = 4623040 #2020-01-02 4429138 2021-01-01 4555021
end_page =   4646459 #2021-05-14 
title =[]
content = []
hashtag = []
date =[]
presenter =[]
#%%
'1萬篇 23:17 '
for page in range(start_page, end_page): 
    url = 'https://news.cnyes.com/news/id/4623040'#需更新
    url = url.replace('x', str(start_page))
    res = requests.get(url)#200 正常
    soup = BeautifulSoup(res.text, 'html.parser') 
    #開爬 不乾淨，後面.text清除
    title_get = soup.select('._uo1n h1') 
    content_get = soup.select('._2E8y')
    hashtag_get = soup.select('._1E-R') #含相關個股(拆不掉)
    date_get = soup.select('._1R6L time')
    presenter_get = soup.select('._3lKe')
    for items in range(len(title_get)):
        title.append(title_get[items].text.replace('\n', '').replace(' ', ''))
        content.append(content_get[items].text.replace('\n', '').replace(' ', ''))
        hashtag.append(hashtag_get[items].text.replace('\n', '').replace(' ', ''))
        date.append(date_get[items].text.replace('\n', '').replace(' ', ''))
        presenter.append(presenter_get[items].text.replace('\n', '').replace(' ', ''))
        print('時間:' ,date)
    time.sleep(0.1) #通常設1或.5
print(title,content,hashtag,date,presenter)
#%%
import pandas as pd
df = pd.DataFrame({'title':title, 'content':content, 'hashtag':hashtag, 'date':date, 'presenter':presenter})

df.to_csv('D:/2021-01-01~2021-05-17鉅亨.csv',encoding='utf_8_sig')




標題:#python 輸入一串沒空格的英文，輸出時要保留第一個單字大寫，其餘單字用空格隔開。
標籤:python 

不好意思，想請問一下
如果要讓使用者輸入隨便一段沒空格的英文像是: youarebeautiful
但輸出時要變成: You are beautiful
輸入: WEAREFAMILY
要輸出成:We are family
我有嘗試過 \t 和 space 但好像都出現邏輯錯誤 >< (本人剛初學兩個禮拜)
還請大大指教
以下是我的程式碼
s = input (' Enter a sentence : ' )
    print(s.capitalize())

單純這樣輸入的時候，沒辦法run出來
但如果輸入成另一種形式就可以run出來
def main():
    s = input (' Enter a sentence : ' )
    print(s.capitalize())

main()

我不太知道 為什麼定義後就可以run出來 ><
目前遇到的問題是輸出後，沒辦法有空格。
還請大大點出我的問題
非常感謝。


標題:關於sqliteman的展示問題
標籤:python sqlite3 sqliteman 

最近上了一門關於django的課
有一個問題想請教一下大家
就是關於sqliteman
老師在用sqliteman的時候，直接點左邊面板的選項，右邊就會直接展示資料的內容，
而我必須寫一個sql的語法才會展示出來，這是為甚麼
這是老師的

我的

我的加上sql語法

所以說為甚麼我的還要加上語法才可以看到資料???
而且，我的右邊面板，那些圖示都是暗的，是我哪邊沒做到嗎?
網路上查不到資料，所以才來這裡問問看，希望有人能回答，謝謝。


標題:請問要怎爬取IG紛絲專頁的留言說讚的用戶
標籤:python爬蟲 ig #新手求指導 


如上圖所示，只要名字就好，我用selenium抓不到


標題:python的csv檔案內特定項目匯入遇到大難題
標籤:python csv 匯入csv 

import csv
with open('108年產業及社福外籍勞工人數_縣市.csv',newline = '') as csvfile:
csvreader = csv.DictReader(csvfile)
for old in csvreader:
print(old['產業及社福外籍勞工人數'])
其顯示錯誤：
Traceback (most recent call last):
File "c:\Users\Eric Chang\Eric\python\108labor.py", line 5, in 
print(old['產業及社福外籍勞工人數'])
KeyError: '產業及社福外籍勞工人數'


標題:請問我的vscode  已安裝flask  突然無法執行
標籤:#flask python 


想請問如何解決這個問題 是使用者部分嗎 還是需要更改什麼? 謝謝


標題:Python自動連上 protocol port
標籤:python 

各位大大們，小弟新手自學
近期想做一個自動連線TCP/IP的功能
目前進度已可以讀取到所有的port
因不需要的port太多，如下圖
請大大們解惑，有甚麼方式可以連接上


標題:pandas isin 順序問題
標籤:pandas python 

我利用第一個dataframe用isin去抓我食譜食材的資料，但不管怎麼樣isin好像會直接由小到大排序?


我希望顺序是第一張dataframe的Dishes_id的排序，不知道有沒有什麼好方法


標題:請問 ARIMA 模型中的 φ θ 係數是怎麼計算出來的？
標籤:python dataframe pandas 

import pandas as pd
from statsmodels.tsa.arima_model import ARIMA
import warnings
warnings.filterwarnings('ignore')
dates = pd.date_range('2012-07-09','2012-07-19')
series = [20,22,25,30,40,50,65,88,112,120,115]
res = pd.Series(series, index=dates)
print(res)
r = ARIMA(res,(2,1,0))
model_fit = r.fit(disp=0)
print(model_fit.summary())
pred = model_fit.predict(start ='2012-07-20', end ='2012-07-20', typ='levels')
print(pred)

想知道 ar.L1.D.y = 1.1533 是怎麼算出來的
以及 ar.L2.D.y = 0.7973



標題:請問 ARIMA 模型中的 φ θ 係數是怎麼決定出來的？
標籤:python pandas pandas.dataframe 

請問 ARIMA 模型中的 φ θ 係數是怎麼決定出來的？
已知 ARIMA 的 AR auto regress 部分是 yt = c + φ1yt−1 + φ2yt−2 + ...... +φpyt−p + white noise
已知 ARIMA 的 MA move average 部分是 yt = µ + θ1t−1 + θ2t−2 + ...... + θqt−q + white noise
那麼 ARIMA 的 AR auto regress 部分的 φ 是基於什麼原理決定出來的？
那麼 ARIMA 的 MA move average 部分的 θ 是基於什麼原理決定出來的？


標題:這樣發訊息的流程圖行得通嗎 ?
標籤:python 

我用 python 寫 , 這樣流程圖還有要加強的嗎 ? 照這樣做做得出來嗎 ?
還是用其他方法會比較好做

更改如下 , 是否正確



標題:PyMySQL連接不上database
標籤:database pymysql python 

我想請問為什麼連線成功 卻無法連接上資料庫
要做的內容是將Navicat for MySQL中的資料庫的內容
輸出至myeclipse
連接至資料庫錯誤

連線是成功的


MySQL也可以看到有我新增的pythonstock


使用到的程式
myeclipse 2020.9.16
python3.9
Navicat 15 for MySQL
mysql-8.0.24
因為有點急 所以能幫忙解決的人 匯款200元以示感謝


標題:為什麼同樣大小的png檔，有時候pytesseract會看不到?
標籤:python3 tesseract pytersseract ocr 

為什麼這個圖檔的數字，pytesseract 會漏字(第5個數字，44)？

import PIL
from PIL import Image
import pytesseract
image = Image.open('OCRs/pft_post_001.png')
display(image)
print('image size: {}X{}'.format(image.width, image.height))
txt = pytesseract.image_to_string(image)
print(txt)

請問我要如何解決這個問題呢？謝謝


標題:python 對人臉以外 做顏色轉變
標籤:影像辨識 人臉辨識 python python3 opencv 

最近在學習影像辨識，才發現影像的資源好少...，所以想上來詢問一下。
如果我想做到「除了人臉以外的背景都灰階」，該怎麼做呢？
我使用的圖是復仇者聯盟～
#colab
from google.colab.patches import cv2_imshow
import numpy as np
import cv2

face_cascade = cv2.CascadeClassifier('/usr/local/lib/python3.7/dist-packages/cv2/data/haarcascade_frontalface_default.xml')
img = cv2.imread('/content/drive/MyDrive/pic.jpg')
cv2_imshow(img)

#灰階
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

#人臉辨識
faces = face_cascade.detectMultiScale(
    gray,
    scaleFactor=1.08,
    minNeighbors=6,
    minSize=(10, 10))
    
# 繪製人臉部份的方框（能不能不要方匡啊，要輪廓就好）
for (x, y, w, h) in faces:
    cv2.rectangle(img, (x, y), (x + w, y + h), (0, 255, 0), 2)
    
# 顯示成果
cv2_imshow(img)



標題:virtualenv activate  (venv)顯示問題
標籤:python virtualenv 

一般來說如果成功啟動venv的話不是應該顯示出(venv)在下行輸出嗎?
(如圖)
但我的畫面完全沒有動靜(第三行)，但好像有成功進到虛擬環境，不知道有甚麼方法可以重新讓(venv)顯示出來

拜託了各位!!


標題:7. Reverse Integer 為什麼這一筆測資過不了
標籤:python python3 leetcode 

題目連結:
leetcode.com/problems/reverse-integer
我的程式碼如下:
class Solution:
    def reverse(self, x: int) -> int:
        if x > 0:
            return int(str(x)[::-1])
        if x == 0:
            return 0
        if x < 0:
            return (int(str(-x)[::-1])*-1)

錯誤訊息為
Input
1534236469
Output
9646324351
Expected
0
WA
為麼正確答案是0?
不是應該是9646324351嗎?
求救大佬


標題:剛學Python、Tkinter Demo，懇請指導
標籤:python tkinter 

目的:藉由學號輸入框索引，比對CSV刪除資料，
如沒有就顯示輸入學號錯誤，請重新輸入。
問題一、按下刪除鈕刪除學號"111"，CSV內的學號 "111"是有的，但是直接跳過直接顯示輸入        錯誤。
問題二、結束程式後，
每次都會再次儲存writeR.writerow(["學號","姓名","國文","英文","數學"])，
下次新增時，有別的方式檢查，假如有的話就不再疊加嗎?


import tkinter as tk
import tkinter.messagebox
import csv

#新增
def _hit2():
    itemList = [enTry1.get(),enTry2.get(),enTry3.get(),enTry4.get(),enTry5.get()]
    pttList.append(itemList)   
    enTry1.delete(0,tk.END)
    enTry2.delete(0,tk.END)
    enTry3.delete(0,tk.END)
    enTry4.delete(0,tk.END)
    enTry5.delete(0,tk.END)
    enTry1.focus()
    enTry2.focus()
    enTry3.focus()
    enTry4.focus()
    enTry5.focus()
#檢視    
def _hit3():
    csvFile = open("abc.csv","r",newline="",encoding="utf-8-sig")
    listFile=csv.reader(csvFile)
    for iteM in listFile:
        lb.insert(tk.END,iteM)             
    csvFile.close()
#刪除
def _hit4():
    if enTry1.get() in pttList: 
        del pttList[enTry1.get()]     
        tk.messagebox.askokcancel("提示", "确定删除"+enTry1.get()+"吗？")
        enTry1.delete(0,tk.END)
    else:
        tk.messagebox.showerror("錯誤", "你的學號錯誤，請重新输入！？")
        enTry1.delete(0,tk.END)
#儲存 CSV 資料
def _hit5():   
    csvFile = open("abc.csv","a",newline="",encoding="utf-8-sig")
    writeR=csv.writer(csvFile)
    writeR.writerow(["學號","姓名","國文","英文","數學"])
    writeR.writerows(pttList)
    csvFile.close()
    qQ=tk.messagebox.askokcancel("提示","確定要結束程式嗎???")
    if qQ:
        wiN.destroy()    
#介面設定
wiN = tk.Tk()
wiN.title("學校成績系統[測試版]!!!")
wiN.geometry("550x700+500+50")
wiN.resizable(width=False, height=False)

titlE=tk.Label(wiN,text="學校成績系統",font=('Arial',35),width=15,height=1) 
titlE.place(x=70,y=15)
#標籤、輸入框設置
global enTry1,enTry2,enTry3,enTry4,enTry5
namE1=tk.Label(wiN,text="學號",font=('Arial',15),bg="yellow",fg="black") 
namE1.place(x=100,y=80)
enTry1 = tk.Entry(wiN,font=('Arial',10),bg="Aqua",width=35,bd=4)
enTry1.place(x=150,y=80)

namE2=tk.Label(wiN,text="姓名",font=('Arial',15),bg="yellow",fg="black")
namE2.place(x=100,y=120)
enTry2 = tk.Entry(wiN,font=('Arial',10),bg="Aqua",width=35,bd=4)
enTry2.place(x=150,y=120)

namE3=tk.Label(wiN,text="國文",font=('Arial',15),bg="yellow",fg="black")
namE3.place(x=100,y=160) 
enTry3 = tk.Entry(wiN,font=('Arial',10),bg="Aqua",width=35,bd=4)
enTry3.place(x=150,y=160)

namE4=tk.Label(wiN,text="英文",font=('Arial',15),bg="yellow",fg="black") 
namE4.place(x=100,y=200)
enTry4 = tk.Entry(wiN,font=('Arial',10),bg="Aqua",width=35,bd=4)
enTry4.place(x=150,y=200)

namE5=tk.Label(wiN,text="數學",font=('Arial',15),bg="yellow",fg="black")  
namE5.place(x=100,y=240)
enTry5 = tk.Entry(wiN,font=('Arial',10),bg="Aqua",width=35,bd=4)
enTry5.place(x=150,y=240)
#按鈕設置
global btn1,btn2,btn3,btn4,btn5,lb
btn1 = tk.Button(wiN, text="開啟", font=("Arial", 10), width=5, height=1,fg="black")
btn2 = tk.Button(wiN, text="新增", font=("Arial", 10), width=5, height=1,command=lambda:_hit2(),fg="black")
btn3 = tk.Button(wiN, text="檢視", font=("Arial", 10), width=5, height=1,command=_hit3,fg="black")
btn4 = tk.Button(wiN, text="刪除", font=("Arial", 10), width=5, height=1,command=lambda:_hit4(),fg="black")
btn5 = tk.Button(wiN, text="結束", font=("Arial", 10), width=5, height=1,command=_hit5,fg="black")
btn1.place(x=100,y=280)
btn2.place(x=170,y=280)
btn3.place(x=240,y=280)
btn4.place(x=310,y=280)
btn5.place(x=380,y=280)
#清單設置
sBar=tk.Scrollbar(wiN)
sBar.pack(side=tk.RIGHT,fill=tk.Y)
lb=tk.Listbox(wiN, font=("Arial", 20),yscrollcommand=sBar.set,bg="yellow",width=30)
lb.place(x=50,y=320)
sBar.config(command=lb.yview)

pttList=[]
  
wiN.mainloop()



標題:[已解決] 使用python + Flask 在 pgAdmin 建置資料庫 但是資料庫一直無法顯示出來
標籤:#python 3 #flask #資料庫 

如題，使用python + Flask 在 pgAdmin 建置資料庫
遇到為題為：執行程式碼後，卻發現pgAdmin中資料庫沒有建立，但是程式執行後，開啟瀏覽器瀏覽服務的頁面，卻可看到連線成功訊息。
想請問一下各位前輩是程式碼本身少了甚麼，還是說有哪個步驟錯誤了嗎?
謝謝!
以下是程式碼
from flask import Flask 
from flask_sqlalchemy import SQLAlchemy

#連結testdb資料庫
app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URL'] = 'postgresql://admin:2286@127.0.0.1:5432/testdb'
db = SQLAlchemy(app)

#定義資料模型:資料表明為students, sid為主索引欄位, 型態為整數。
#name為姓名、tel為電話、addr為住址、email為電子郵件、型態都為字串
class students(db.Model):
    __tablename__ = 'students'
    sid = db.Column(db.Integer, primary_key = True)
    name = db.Column(db.String(50), nullable = False)
    tel = db.Column(db.String(50))
    addr = db.Column(db.String(200))
    email = db.Column(db.String(100))
    
    def __init__(self, name, tel, addr, email):
        self.name = name
        self.tel = tel
        self.addr = addr
        self.email = email
        
#在預設頁面啟動前，建立資料表物件
@app.route('/')
def index():
    db.create_all()
    return "資料庫連線成功 !"
    
if __name__ == '__main__':
        app.run()



標題:python 爬蟲 youtube熱門影片
標籤:python 網路爬蟲 youtube 

小的我想要爬取youtube熱門影片的影片相關資訊
現在可以成功透過youtube_dl套件成功得到資訊，但一次只能獲得一支影片的資訊
from pprint import pprint
import youtube_dl


def get_video_info(youtube_url):
    video_info = {}

    with youtube_dl.YoutubeDL() as ydl:
        info = ydl.extract_info(youtube_url, download=False)
        video_info['ID'] = info.get('id')
        video_info['標題'] = info.get('title')
        video_info['影片縮圖'] = info.get('thumbnail')
        video_info['上傳者'] = info.get('uploader')
        video_info['上傳者網址'] = info.get('uploader_url')
        video_info['影片長度(秒)'] = info.get('duration')
        video_info['觀看次數'] = info.get('view_count')
        video_info['留言數'] = info.get('comment_count') # -
        video_info['喜歡數'] = info.get('like_count')
        video_info['不喜歡數'] = info.get('dislike_count')
        video_info['平均評分'] = info.get('average_rating')
        video_info['描述'] = info.get('description')
        video_info['標籤'] = info.get('tags')
        video_info['網頁網址'] = info.get('webpage_url')
        video_info['上傳日期'] = info.get('upload_date')
    pprint (video_info)

因此我必須先獲得每部影片的網址才可以連續獲得所有影片資訊
目前程式碼沒辦法成功得到影片網址
import bs4
import requests
header = {"User-Agent":"Moziilla/5.0 (Windows NT 6.1; WOW64)\AppleWebKit/537.6 (KHTML, like Gecko) Chrome/45.0.2454.101\
            Safari/537.36"}
url = "https://www.youtube.com/feed/trending?bp=6gQJRkVleHBsb3Jl"
download = requests.get(url, headers = header)
analyze = bs4.BeautifulSoup(download.text, "lxml")
a = analyze.find_all("div")
base = "https://www.youtube.com"
for i in a:
        href = i.get('href')
        url = base + href 
        print(url)

現在我只知道可以透過api獲得
但使用方法在爬文之後還是不了解
希望各位可以幫幫忙 謝謝


標題:關於Machine Learning選擇程式語言的衡量
標籤:#machine learning #program language #python #c++ #c 

各位大大好~
目前正在學習ML，有和其他人討論了一下選擇Python和C/C++的利弊。我個人是基於Traning速度上的考量而偏好C/C++，但我同學覺得Python的套件比較多，在建立model的時候會花比較少的時間在程式上，想了一下覺得好像兩個都沒錯，只是出發點不同而已。
想問一下各位大大有沒有在選擇Python或C/C++時其他考量的點?


標題:python tk 問題
標籤:python tkinter 

寫了一個tk 程式如下，但遇到兩個問題一直想解不掉，想請前輩們指導
問題1:使用admin_root.destroy()，為什麼關不掉視窗?只能關掉Frame呢?
問題2:為何ID.get()取得的是空值呢?
import tkinter as tk
from tkinter import ttk
from tkinter import Frame
from tkinter import messagebox
import os

#ID內容判斷
def ID_judg():
        aa = ID.get() ############問題2:取得的是空值?
        messagebox.showinfo(aa)
        
#建立介面
def ID_ADD():
    global ID
    id_Root=tk.Tk()
    id_Root.title("建立")
    id_Root.geometry("300x150+380+380")
    id_Root.resizable(width=False, height=False)

    userlable = tk.Label(id_Root,              
                text = "請輸入文字",     
                font = ('微軟正黑體', 12) )
    userlable.grid(row=0, column=0,columnspan=2,pady= 10) 

    ID = tk.StringVar()

    userID = tk.Entry(id_Root, textvariable=ID,width = 15)
    userID.grid(row=1, column=0,columnspan=2,pady= 10)

    BUT1 = tk.Button(id_Root, text = "送出", height = 1, bg = "AliceBlue",width = 10,command=ID_judg)
    BUT1.grid(row=2, column=0,padx= 35,pady= 10)

    BUT2 = tk.Button(id_Root, text = "結束", height = 1, bg = "AliceBlue",width = 10,command=id_Root.destroy)
    BUT2.grid(row=2, column=1,padx= 35,pady= 10)

    id_Root.mainloop()

# 判斷密碼
def netest():
    number = entry.get()
    if number != "123456":
        messagebox.showerror("錯誤", "密碼錯誤")
    else:
        admin_root.destroy()  ############問題1: 為什麼關不掉視窗?只能關掉Frame?
        ID_ADD()


admin_root=tk.Tk()
admin_root.title("login check")
admin_root.geometry("600x270+380+380")
admin_root.resizable(width=False, height=False)

admin_root=ttk.Notebook()
admin_root.place(relx=0.02, rely=0.02, relwidth=0.95, relheight=0.876)


tab1=Frame(admin_root)
tab1.place(x=0,y=30)
admin_root.add(tab1,text='User')

label = tk.Label(tab1,                 
                text = "請輸入密碼",    
                font = ('微軟正黑體', 13) ) 
label.pack(pady=20) 

entry = tk.Entry(tab1, width = 15,show='*') 
entry.pack(pady=7) 

tk.Button(tab1, text = "送出", height = 2, bg = "AliceBlue",width = 10,command=netest).pack(pady=7)


tab2=Frame(admin_root)
tab2.place(x=0,y=30)
admin_root.add(tab2,text='Admin')

label = tk.Label(tab2,                 
                text = "frame2",    
                font = ('微軟正黑體', 13) ) 
label.pack(pady=20) 

admin_root.mainloop()



標題:django  如何訂閱Redis訊息
標籤:django python redis pubsub 

各位大大好，
小弟目前有多個獨立python執行程式 & django server，
有一隻py程式會發佈訊息，其餘各個執行程式 & server需要接收訊息，
目前使用Redis做中間溝通，在獨立的python能夠正常執行，
此為發送程式
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Variables definition

import json
import sys
import time

import redis

REDIS_SERVER_CONF = {
    'servers': {
        'main_server': {
            'HOST': '127.0.0.1',
            'PORT': 6379,
            'DATABASE': 11
        }
    }
}


class RedisWrapper():
    shared_state = {}

    def __init__(self):
        self.__dict__ = self.shared_state

    def redis_connect(self, server_key):
        redis_server_conf = REDIS_SERVER_CONF['servers'][server_key]
        connection_pool = redis.ConnectionPool(host=redis_server_conf['HOST'], port=redis_server_conf['PORT'],
                                               db=redis_server_conf['DATABASE'])
        return redis.StrictRedis(connection_pool=connection_pool)


if __name__ == "__main__":

    import random

    r_server = RedisWrapper().redis_connect(server_key='main_server')

    seeds = {
        "EMMA1": 'J7-21-01-065',
        "EMMA2": 'J7-21-01-067',
        "EMMA3": 'J7-21-01-063_1',
        "EMMA4": 'J7-21-01-129_1',
        "EMMA5": ''
    }

    while True:
        try:

            print("SEND")

            wipSeed = random.choice(list(seeds.keys()))
            sleepTime = random.randint(3, 9)

            data = {
                'wip': wipSeed,
                'materialname': seeds[wipSeed]
            }

            r_server.publish(
                'Share_News',
                json.dumps(data)
            )
            print("SEND CH:{} MSG:{}".format('Share_News', data))

            time.sleep(sleepTime)

        except KeyboardInterrupt:

            sys.exit(0)


此為接收程式
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Variables definition
import json
import sys
import threading

import redis

REDIS_SERVER_CONF = {
    'servers': {
        'main_server': {
            'HOST': '127.0.0.1',
            'PORT': 6379,
            'DATABASE': 11
        }
    }
}


class RedisWrapper():
    shared_state = {}

    def __init__(self):
        self.__dict__ = self.shared_state

    def redis_connect(self, server_key):
        redis_server_conf = REDIS_SERVER_CONF['servers'][server_key]
        connection_pool = redis.ConnectionPool(host=redis_server_conf['HOST'], port=redis_server_conf['PORT'],
                                               db=redis_server_conf['DATABASE'])
        return redis.StrictRedis(connection_pool=connection_pool)

def redis_sub(r_server):

    print("WAIT RECEIVE")

    sub = r_server.pubsub()
    sub.subscribe('Share_News')

    for message in sub.listen():
        print(message)
        if (message.get("type") == "message"):
            data = json.loads(message.get("data"))
            print("RECEIVE CH:{} MSG:{}".format(
                data.get("wip"), data.get("materialname")))


if __name__ == "__main__":

    r_server = RedisWrapper().redis_connect(server_key='main_server')

    try:

        processW1 = threading.Thread(
        target=redis_sub, args=(r_server, ))
        processW1.setDaemon(True)
        processW1.start()

        while (True):
            pass

    except KeyboardInterrupt:

        sys.exit(0)


以上小弟目前已經能夠將獨立的python做溝通，
但如果接收或發送的對象是django呢?
該如何啟動服務?
在請各位大大賜教，感謝感謝!!


標題:python 如何製作群發程式 
標籤:python 

我是要先把客戶與產品資料匯出 , 然侯選取要群發的客戶 , 再登入進到拍賣網群發
還是直接登入拍賣網站 , 然後點選客戶群發訊息 , 應該是怎樣的步驟會比較有效又省事
當選上面其中一種方式 , 接下來的製作步驟應該如何


標題:python 爬蟲問題
標籤:python 網路爬蟲 

我是剛開始學爬蟲的新手
想從https://xn--i0yt6h0rn.tw/channel/%E5%8F%B0%E8%A6%96/
得到節目表的文字部分

import requests
import bs4
url = "https://xn--i0yt6h0rn.tw/channel/%E5%8F%B0%E8%A6%96/"
header = {"User-Agent":"Moziilla/5.0 (Windows NT 6.1; WOW64)\AppleWebKit/537.6 (KHTML, like Gecko) Chrome/45.0.2454.101\
            Safari/537.36"}
tv_show = requests.get(url, headers = header)
tv_show.encoding = "utf-8"
tv_show = bs4.BeautifulSoup(tv_show.text, "html.parser")
item = tv_show.find_all("div",class_="time ng-binding")
for i in item:
    print(i.text)

以上是我的程式碼
一直沒按法成功抓取
請大神幫幫忙 謝謝


標題:python  Chrome正在受到自動軟體的控制
標籤:python 


我找到下面文章 , 但還是無法解決
https://kknews.cc/zh-tw/code/3bqpyyy.html
from selenium import webdriver
optons=webdriver.ChromeOptions()
optons.add_argument('disable-infobars')
driver=webdriver.Chrome(chrome_options=optons)
driver.maximize_window()
driver.get
driver = webdriver.Chrome("D:\python\chromedriver.exe")
drvier.get("http://www.google.com")
dlement=driver.find_element_by_class_name("gLFyf.gsfi")
element.send_keys("Selenium Python")

D:\python>[11632:12292:0427/225437.236:ERROR:device_event_log_impl.cc(214)] [22:54:37.236] USB: usb_device_handle_win.cc:1054 Failed to read descriptor from node connection: 連結到系統的某個裝置失去作用。 (0x1F)
[11632:12292:0427/225437.296:ERROR:device_event_log_impl.cc(214)] [22:54:37.297] USB: usb_device_handle_win.cc:1054 Failed to read descriptor from node connection: 連結到系統的某個裝置失去作用。 (0x1F)
[11632:12292:0427/225437.299:ERROR:device_event_log_impl.cc(214)] [22:54:37.299] USB: usb_device_handle_win.cc:1054 Failed to read descriptor from node connection: 連結到系統的某個裝置失去作用。 (0x1F)
[16120:9008:0427/225631.057:ERROR:gpu_init.cc(426)] Passthrough is not supported, GL is disabled



標題:【點餐系統】break無法成功結束迴圈
標籤:python 




menu_list =[
{"id":1, "name":"1.漢堡","price":60,"colaries":294.9,"$":"元","kcal":"大卡"},
{"id":2, "name":"2.米漢堡","price":80,"colaries":217.7,"$":"元","kcal":"大卡"},
{"id":3, "name":"3.薯條","price":30,"colaries":311.9,"$":"元","kcal":"大卡"},
{"id":4, "name":"4.沙拉","price":45,"colaries":62,"$":"元","kcal":"大卡"},
{"id":5, "name":"5.可樂","price":20,"colaries":37.5,"$":"元","kcal":"大卡"},
{"id":6, "name":"6.紅茶","price":15,"colaries":1,"$":"元","kcal":"大卡"}]
order_list = []
print('==========歡迎光臨本餐廳,祝您用餐愉快==========')
print('今日菜單:')
for menu in menu_list:
print(menu.get('name'),menu.get('price'),menu.get('$'),menu.get('colaries'),menu.get('kcal'))
while True:
print('='*50)
print('1.點餐\n2.取消點餐\n3.確認菜單\n4.結帳')
serve = int(input("請選擇服務:"))
if serve == 1:
while True:
menu_add = input("請輸入菜名編號或者輸入X結束點餐:")
if menu_add != "X":
for i in menu_list:
if i.get('id')== int(menu_add):
order_list.append(i)
else:
print('==========已完成點餐=========')
bill = 0
for order in order_list:
print(order.get('name'),order.get('price'),order.get('$'),order.get('colaries'),order.get('kcal'))
bill += int(order.get('price'))
print('          小計:{}元'.format(bill))
break
elif serve == 2:
menu_del = input("請輸入要取消之菜名:")
order_list.remove(order)
print('==========已完成點餐=========')
bill = 0
for order in order_list:
print(order.get('name'),order.get('price'),order.get('$'),order.get('colaries'),order.get('kcal'))
bill += int(order.get('price'))
print('          小計:{}元'.format(bill))
elif serve == 3:
print('==========已完成點餐=========')
bill = 0
for order in order_list:
print(order.get('name'),order.get('price'),order.get('$'),order.get('colaries'),order.get('kcal'))
bill += int(order.get('price'))
print('          小計:{}元'.format(bill))
elif serve == 4:
print('==========您的消費明細==========')
bill = 0
for order in order_list:
print(order.get('name'),order.get('price'),order.get('$'))
bill += int(order.get('price'))
print('          總計:{}元'.format(bill))
print('==========謝謝光臨，歡迎再來==========')
break
輸入X依舊無法break
謝謝大家...


標題:Python 文字解析問題
標籤:python3 string parser 文字處理 

各位大大好
最近小弟嘗試用 Python 寫一個文字(xpath)解析的工具
主要是讓 user 可以自行輸入需要的 xpath 組(輸入方式是預先定義的格式)
我的 function 會進行解析，將格式轉成程式可讀取的資料結構
Input 如下：(這會從 Excel 上面擷取)(string 內可以是 tuple 或單一元素)
sig = "(xpath_1_1, xpath_1_2), (xpath_2_1, xpath_2_2), xpath_3..."

預期 Output 進行如下轉換：(轉換成內含tuple 或單一元素的 List 資料格式)
[(xpath_1_1, xpath_1_2), (xpath_2_1, xpath_2_2), xpath_3...]

目前一組測資如下：
sig = "(//div[@style='font-family:Arial;float: left;width:930px;font-size:12px;' and ./span[contains(text(),'005930')]], //table[@id='gv_flow_krKS0 1']),(//div[@style='font-family:Arial;float: left;width:930px;font-size:12px;' and ./span[contains(text(),'000660')]],  //table[@id='gv_flow_krKS0 2'])"

想請問有沒有甚麼比較好的轉換策略呢？
目前不考慮使用 eval()，因為資安問題
所以打算用基本的字串處理方式，但自己苦苦想不太到解法，所以才上來請教大大們，看有沒有更好的解析方法
感恩感恩


標題:Python 這是怎麼回事 TypeError
標籤:python 

第二行哪裡有錯
driver=webdriver.chrome("desktop\chromedriver")

程式碼
from selenium import webdriver
driver=webdriver.chrome("desktop\chromedriver")
drvier.get("http://www.google.com")
dlement=driver.find_element_by_class_name("gLFyf.gsfi")
element.send_keys("Selenium Python")


錯誤訊息
Traceback (most recent call last):
  File "D:\python\find.py", line 2, in <module>    
    driver=webdriver.chrome("desktop\chromedriver")
TypeError: 'module' object is not callable





標題:python 撲克牌程式導讀問題(python100day)[已解決]
標籤:python問題 問題 #新手求指導 物件導向 

各位前輩最近在學習python 100day的內容，在學習到物件導向的內容時卡關了。
我的問題主要是在main function裡面的
player.arrange(get_key)我不太理解get_key明明是一個一般函式為什麼可以直接當arrange的參數使用，get_key在程式裡也沒找到其他地方有帶入參數呼叫和所以我很困惑。
還有就是arrage.sort的排序問題
問題主要在arrange的排序和 get_key 我有在註釋打些疑問麻煩各位大大解惑解惑了。
import random


class Card(object):
    """一张牌"""

    def __init__(self, suite, face):
        self._suite = suite
        self._face = face

    @property
    def face(self):
        return self._face

    @property
    def suite(self):
        return self._suite

    def __str__(self):
        if self._face == 1:
            face_str = 'A'
        elif self._face == 11:
            face_str = 'J'
        elif self._face == 12:
            face_str = 'Q'
        elif self._face == 13:
            face_str = 'K'
        else:
            face_str = str(self._face)
        return '%s%s' % (self._suite, face_str)
    
    def __repr__(self):
        return self.__str__()


class Poker(object):
    """一副牌"""

    def __init__(self):
        self._cards = [Card(suite, face) 
                       for suite in '♠♥♣♦'
                       for face in range(1, 14)]
        self._current = 0

    @property
    def cards(self):
        return self._cards

    def shuffle(self):
        """洗牌(随机乱序)"""
        self._current = 0
        random.shuffle(self._cards)

    @property
    def next(self):
        """发牌"""
        card = self._cards[self._current]
        self._current += 1
        return card

    @property
    def has_next(self):
        """还有没有牌"""
        return self._current < len(self._cards)


class Player(object):
    """玩家"""

    def __init__(self, name):
        self._name = name
        self._cards_on_hand = []

    @property
    def name(self):
        return self._name

    @property
    def cards_on_hand(self):
        return self._cards_on_hand

    def get(self, card):
        """摸牌"""
        self._cards_on_hand.append(card)

    def arrange(self, card_key):
        """玩家整理手上的牌"""
        #這裡的排序原理是什麼?key為什麼要是card_key
        #card_key裡面不是由花色和數字組成嗎
        #那這樣cards_on_hand.sort不就可以對字串做排序了
        
        self._cards_on_hand.sort(key=card_key)

#********************這部分除了arrage有呼叫到以外但呼叫了不用帶入參數呼叫嗎?
# 排序规则-先根据花色再根据点数排序
def get_key(card):
    return (card.suite, card.face)


def main():
    p = Poker()
    p.shuffle()
    players = [Player('东邪'), Player('西毒'), Player('南帝'), Player('北丐')]
    for _ in range(13):
        for player in players:
            player.get(p.next)
    for player in players:
        print(player.name + ':', end=' ')
        #***我困惑的地方
        player.arrange(get_key)
        print(player.cards_on_hand)


if __name__ == '__main__':
    main()

https://github.com/jackfrued/Python-100-Days/blob/master/Day01-15/09.%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6.md


標題:Python, Ansible實現執行鎖
標籤:python ansible 

各位大大好!
小弟現在有一情景數個不相干ansible playbook因為某種緣故(有個服務的service_account的token只有一個，同時跑會導致前面token失效最後搶成一團)，所以只能一個一個執行ansible playbook，目前想到辦法是用Python呼叫Ansible之前先檢查某個文件裡是否有ansible_excute_lock=True字串，如果有就先等待沒有就呼叫ansible playbook。
不知道各位大大有沒有Production實務上的做法? 或者這設計本身就有缺陷，感恩!


標題:python 的 typeError : ' module' object is not callable 
標籤:python 

TypeError 誤用變數的資料型態 , 看不出來是哪裡誤用
driver=webdriver.chrome("桌面\chromedriver")





標題:無法用pip
標籤:python 

我要用pip安裝東西，但安裝不了
mac要怎麼安裝pip


標題:請問 python 登入我的拍賣網站聊聊群發信息
標籤:python 

請問我要用 python 登入我的拍賣網站的聊聊 , 群發訊息給我的所有客戶
這樣我要用什麼指令才可達到


標題:Python 的 Socket 如何跟 Nginx 搭配，還是不需要 Nginx ?
標籤:nginx uwsgi gunicorn socket python3 

這裡不是指 Django 與 Flask
是 Python 本身的 Socket 套件。
但我有用過 Nginx + uwsgi or gunicorn + Django or Flask 過。
今天因為要改用 Socket 傳資料，只要最初連線一次後，就能一直雙通傳資料比較快。
但是網路管理員不願意開除了 80 Port 以外的 Port 給我，希望我將 Socket 跟 Nginx 搭起來。
但是我完全不知道怎麼搭??
例如 Django 有 wsgi.py， Flask 有 app = Flask(__name__)，之後用 uwsgi 或 gunicorn 串接起來就好了。
那 Socket 怎麼串?
我 Google 了很多 Python Socket + Nginx 都是 Django 與 Flask 的相關資訊。
求人給個參考文章參考...
簡單來講就是
Nginx -> 80port
我的 Socket Server -> Host: 192.168.x.xxx, Port:9000
client(80 Port) -> Nginx(80port) -> Socket(9000port) -> Nginx(80port) -> client(80 Port)。


標題:Python selenium  driver 多執行續
標籤:python selenium driver 多執行續 程式碼 

想詢問各位高手
Chromedriver怎麼同時執行
目前是想利用資料庫建立使用者名單
然後進行 廣告資料模擬輸入的 壓力測試
目前是卡在我只能單一測試，而無法同時多筆資料一起執行
不知道能否有人能提供 最簡單的同時開啟並輸入資料的程式碼，讓我可以進行參悟
拜託拜託


標題:無法執行 python
標籤:python 





標題:請教如何在 Django 框架， 將 JSON 檔案存入資料庫中
標籤:django json python 

各位大神好，我剛接觸 Django 沒多久，有個小專案要做 API 的處理。如標題的問題困擾我一陣子，也試了很多方法，但都無法解決。我的想法是先建立 model ，再將 JSON 檔案 migrate 到資料庫中，但 JSON 檔案都無法匯入到資料庫。
有錯的地方、或是觀念，請各位不吝指點謝謝!!
下方為 JSON 檔案格式

依照 JSON 的資料型態建立的 model
from django.db import models

WEEKDAYS = [
    (1, ("Monday")),
    (2, ("Tuesday")),
    (3, ("Wednesday")),
    (4, ("Thursday")),
    (5, ("Friday")),
    (6, ("Saturday")),
    (7, ("Sunday")),
]
class BookStore(models.Model):
    cash_balance = models.FloatField(null=False)
    store_name = models.CharField(max_length=100, null=False)

class Book(models.Model):
    books_store = models.ForeignKey(BookStore, on_delete=models.CASCADE)
    book_name = models.CharField(max_length=100, null=False)
    price = models.FloatField(null=False)

class OpeningHour(models.Model):
    books_store = models.ForeignKey(BookStore, on_delete=models.CASCADE)
    week_day = models.CharField(max_length=20, choices=WEEKDAYS)
    start_min = models.TimeField()
    end_min = models.TimeField()

要將 JSON 資料存入資料庫，寫了一個 0002migration.py
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('bookstore_api', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='OpeningHour',
            fields=[
                ('id', models.BigAutoField(auto_created=True,
                 primary_key=True, serialize=False, verbose_name='ID')),
                ('week_day', models.CharField(choices=[(1, 'Monday'), (2, 'Tuesday'), (3, 'Wednesday'), (
                    4, 'Thursday'), (5, 'Friday'), (6, 'Saturday'), (7, 'Sunday')], max_length=20)),
                ('start_min', models.TimeField()),
                ('end_min', models.TimeField()),
            ],
        ),
        migrations.RenameField(
            model_name='book',
            old_name='books',
            new_name='books_store',
        ),
        migrations.RemoveField(
            model_name='bookstore',
            name='opening_hours',
        ),
        migrations.DeleteModel(
            name='OpeningHours',
        ),
        migrations.AddField(
            model_name='openinghour',
            name='books_store',
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE, to='bookstore_api.bookstore'),
        ),
    ]

最後執行了python3 manage.py migrate JSON檔案
出現這個問題，也找了相關問題，都還是卡在這部份。
django.core.serializers.base.DeserializationError: Problem installing fixture



標題:求救 zerojudge f708: 蟲蟲危機 (Insect)
標籤:zerojudge python 

這段代碼哪裡錯了?
def solve(a,g):
    if sum(a)>sum(g):
        return(Yes)
    if sum(a)<=sum(g):
        return(No)
try:
    while True:
        M,N=map(int,input().split())
        a, b = map(int, input().split())
        if M<N:
            print('No')
        if M>N:
            ants=list(map(int(),input().split()))
            grasshoppers=list(map(int(),input().split()))
            print(solve(ants,grasshoppers))
except EOFError:
    pass

謝謝
2021-4-20
感謝AndyChiang提醒，已將網址補上
連結在此: https://zerojudge.tw/ShowProblem?problemid=f708


標題:#已得救QQ #新手python 讀取資料遇到問題
標籤:python3 python python 3 python入門 

檔案資料在C:\Users\sandr\Desktop\FL_insurance_sample.csv
](http://)


標題:Python 列表能直接輸入嗎?
標籤:python python list 輸入 

請問要怎麼在一行內直接輸入列表啊?
我的程式碼要怎麼改?(還是全錯!)
a=list(int,input().split())

謝謝


標題:python 求救 zerojudge c488. kevin 的大桶子
標籤:python zerojudge 

題目內容
https://zerojudge.tw/ShowProblem?problemid=c488
題目中敘述的操作方式我看得不是很懂，
希望各位可以為我詳細解說一下
另外範例輸出中第一行是 1 1
但是1不是裝滿水的意思嗎?
裝滿水後為何要再裝一次?
還是這個意思是指p,q二桶都裝水?
那什麼狀況下輸出要換行呢?
本人的邏輯理解程度低，希望各位大大撥冗詳細解說。


標題:設計python程式 產生西洋棋盤的灰階影像,影像大小為512*512，灰階值僅包含0或255,稱為二值影像，並儲存數位影像檔案    怎麼做???
標籤:python系列文章 opencv 



標題:如何用 python 實現照片 block truncation code ？謝謝！
標籤:python btc block truncation code 方塊編碼 opencv 

# -*- coding: utf-8 -*-
'''
一、統計所有 pixel 值量
二、計數 pixel 大於平均數的數量
'''
import cv2
import sys
import numpy as np
from tkinter import filedialog
import tkinter as tk
from PIL import ImageTk, Image
from matplotlib import pyplot as plt
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
from matplotlib.figure import Figure
root = tk.Tk()
radioValue = tk.IntVar()
mediaFrame = tk.Frame(root).pack()
media = tk.Label(mediaFrame)
media.pack()
fig = plt.figure()
plot =fig.add_subplot(111)
canva = FigureCanvasTkAgg(fig,root)
canva.get_tk_widget().pack(side='right')
def cv_imread(filePath):
    cv_img=cv2.imdecode(np.fromfile(filePath,dtype=np.uint8),-1)
    return cv_img
def oas():
    plt.cla()
    global mode
    try:
        sfname = filedialog.askopenfilename(title='選擇',filetypes=[('All Files','*'),("jpeg files","*.jpg"),("png files","*.png"),("gif files","*.gif")])
        gray = cv2.cvtColor(cv2.resize(cv_imread(sfname),(500,250)),cv2.COLOR_BGR2GRAY)
        y = np.zeros((256))
        sun = 0
        count = 0
        arr = np.array(gray)
        (mean,stddv) = cv2.meanStdDev(gray)
        print(mean)
        print(stddv)
        for i in range(0,gray.shape[0]):
            for j in range(0,gray.shape[1]):
                y[gray[i,j]] += 1
                sun += arr[(i,j)]
                if(arr[i,j]>mean):
                    count += 1
        print(sun,count)
        print((count/(sun-count))**0.5)
        aa = ((count/(sun-count))**0.5)
        print(((sun-count)/count)**0.5)
        bb = (((sun-count)/count)**0.5)
        print(stddv*aa)
        print(stddv*bb)
        print(mean-stddv*aa)
        print(mean+stddv*bb)
        a = mean-stddv*aa
        b = mean+stddv*bb
        ri = gray.shape[0]
        rj = gray.shape[1]
        '''
        s = 0
        c = 0
        for i in range(0,ri,4):
            for j in range(0,rj,4):
                a = arr[i,j]
                s += a 
                if(a>mean):
                    c += 1
        print(s,c)
        print((c/(s-c))**0.5)
        print(((s-c)/c)**0.5)
        '''
        for i in range(0,gray.shape[0]):
            for j in range(0,gray.shape[1]):
                if(arr[(i,j)]>mean):
                    arr[(i,j)]=b
                if(arr[(i,j)]<=mean):
                    arr[(i,j)]=a
        btc=Image.fromarray(arr)
        btc.show()
        plt.bar(np.arange(0,256),y,color="gray",align="center")
        cvphoto = Image.fromarray(gray)
        imgtk = ImageTk.PhotoImage(image=cvphoto)
        media.imgtk = imgtk
        media.configure(image=imgtk)
        canva.draw()
    except:
        print('no open file or no choose mode'+sys.exc_info())
b1 = tk.Button(root, text="打開",command = oas).pack()
root.mainloop()



標題:Django 显示数据库中的表
標籤:django python web 

我在 Django 中，修改创建的一个 Django project：
修改 Settings.py 文件，连接到数据库：
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'testdb',
        'USER': 'it',
        'PASSWORD': 'P@ssw0rd',
        'HOST': '192.168.1.10',
        'PORT': 3306,
    }
}

然后创建一个 App：
修改 models.py:
from django.db import models

# Create your models here.

class HostInfo(models.Model):
   Item = models.IntegerField()
   Model = models.CharField(max_length=40)
   OS = models.CharField(max_length=40)
   Host_Name = models.CharField(max_length=40)
   IP_Address = models.GenericIPAddressField()
   SN = models.CharField(max_length=40)

修改 Settings.py 中的 App 信息，把新建的 App 添加进去：
INSTALLED_APPS = [
    'polls.apps.PollsConfig',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',

然后中 Terminal 中运行命令，在数据库中创建了对应的表：
C:\Django\mysite>python manage.py makemigrations polls
C:\Django\mysite>python manage.py migrate

然后创建了 admin 的账号和密码，进入 admin 页面后，想表中添加了数据，并且可以通过在 mysql 中可以看到：
mysql> select * from polls_hostinfo;
+----+------+--------------+----------+---------------+--------------+-----+
| id | Item | Model        | OS       | Host_Name     | IP_Address   | SN  |
+----+------+--------------+----------+---------------+--------------+-----+
|  1 |    1 | DL 380 Gen 8 | ESXi 7.0 | VSVR01.sh.dto | 192.168.1.51 | 1MG |
+----+------+--------------+----------+---------------+--------------+-----+
1 row in set (0.00 sec)

我现在想通过一个页面去显示这个表的信息：
修改 views.py 文件：
from django.shortcuts import render

# Create your views here.

from .models import HostInfo

def show(request):
    info = HostInfo.objects.all()
    return render(request, "show.html", {"info":"info"})

在 App 目录下创建一个 templates 目录，并在该目录下创建了一个 show.html 文件，并修改内容：
{% for i in info%}
    <tb>{{i.Item}}</tb>
    <tb>{{i.Model}}</tb>
    <tb>{{i.OS}}</tb>
    <tb>{{i.Host_Name}}</tb>
    <tb>{{i.IP_Address}}</tb>
    <tb>{{i.SN}}</tb>
{% endfor %}

修改 urls.py 文件：
from django.urls import path
from . import views

urlpatterns = [
    path("", views.show, name="show"),
]

修改 project 的 urls.py 文件：
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path("pulls/", include("polls.urls")),
    path('admin/', admin.site.urls),
]

但我在浏览器中输入 http://127.0.0.1:8000/pulls/ 返回的是一个空白的页面，这个是怎么回事？


標題:Python網頁爬蟲登入後網址是隨機的SID
標籤:python 網路爬蟲 網頁教學 

Hello 各位大神午安
因為最近公司需要去抓一個電話錄音系統的錄音
但是我一進去網站碰到一個問題是當我每次登入時網址如下
http://192.168.0.10:1000/Status.html?SID=15121651
他後面的SID=XXXXXXXX 即使同一個帳號重新登入後都會產生不同的SID
那我在抓網頁資料的時候 我應該如何解決他每次不同的SID
r=requests.get("http://92.168.0.10:1000/Status.html?SID=15121651")
print(r.text)
那我想我這樣寫如果每次跑他SID一定不同
我是想說將SID變成一個變數然後"http://92.168.0.10:1000/Status.html?"+"變數"
請問這樣如何改? 或者是否有人有更好的設計方法
先感謝大家的協助~


標題:推薦的Python開發環境配置
標籤:#python3 #ide 

各位大大好
個人近幾年主要以NI LabVIEW做開發
但最近跳槽亂入Python界所以問題頗多
手邊僅有一台Win10的Notebook
想請問各位建議用甚麼樣的開發環境呢 ?
（個人怪癖比較不傾向雲端開發 ...）
爬文看大家似乎都比較推 Anaconda+Python 3.X
目前是以「學習第二語言」當出發點
並沒有鎖定像AI還是後端之類的
所以會希望開發的環境盡量以通用為主
若有推薦的學習文章也歡迎施捨給小弟我哦 !


標題:Line Bot 聊天機器人Webhook URL 返回的HTTP狀態碼不是200。
標籤:#python #linebot #webhook 

各位前輩好!!
小弟我修改 Line Bot 程式碼完，透過 Git 將我們的資料夾推向 Heroku，推完一切順利，但是到了準備verify Webhook URL 時，卻跑出了以下問題：

依照這問題上網查了許多資料，但發現相關問題的資料很少(也有可能是我查資料的方式不對)，而有一些也看不太懂該如何去操作其中的意思，所以在這邊小弟請求各位前輩指點一二!!
謝謝各位前輩


標題:linked list Python(以解決)
標籤:python 鏈結資料 新人發問 

class ListNode:
  def __init__(self, data): 
    self.data = data
    # store the reference (next item)
    self.next = None
    return
  

class SingleLinkedList:
  def __init__(self): 
    self.head = None
    self.tail = None
    return

  def add_list_item(self, item):
    if not isinstance(item, ListNode):
      item = ListNode(item)
    
    if self.head is None:
      self.head = item
    else:
    #想問的部分
      self.tail.next = item
    self.tail = item
    return

  def output_list(self):

    current_node = self.head
    results = []
    
    while current_node is not None:
      results.append(current_node.data)

      # jump to the linked node
      current_node = current_node.next 

    print(results)
    return
    
list1 = SingleLinkedList()
list1.add_list_item(18)
list1.add_list_item('12')
list1.add_list_item('18')

list1.output_list()

想請教各位大大
add_list_item這個方法中
self.tail.next = item
有什麼用意
SingleLinkedList 這個類中並沒有next這個方法或變數
tail.next是什麼


標題:Python_最短單詞距離
標籤:python 

題目描述：給定一個 String 形態的 List，找出此 List 中有重複字詞的最近距離。
（其中 "a" 有重複，index 分別是2,5,8，所以最短距離為3。）
input：words = ["I","am","a","student","from","a","university","in","a","city"]
output：3


這是我用 two pointer 概念加入兩個參數 word1,word2 的結果，可正確執行
import sys
def find_nearest_repeated_word(s:list, word1:str, word2:str)->int:
    
    if s == None or word1 == None or word2 == None:
        return -1

    idx1 = -1
    idx2 = -1
    minDiff = sys.maxsize

    for i in range(len(s)):
        if s[i] == word1:
            idx1 = i

        if s[i] == word2:
            idx2 = i

        if idx1 != -1 and idx2 != -1:
            minDiff = min(minDiff, abs(idx1 - idx2))

    return minDiff

但題目的要求是必須在沒有指定單字時（如下，也就是不需輸入word1、word2時），直接找出最近的重複單字，希望厲害的大家可以給新手一點提點 ><。
print(find_nearest_repeated_word(["I","am","a","student","from","a","university","in","a","city"]))
ANS = 3



標題:Python list置換
標籤:python3 

list置換
t = [1, 3, 5, 2, 4, 6]
t[0], t[1] = t[1], t[0]
print('1:',t)
# 1: [3, 1, 5, 2, 4, 6]

t = [1, 3, 5, 2, 4, 6]
temp = t[1]
t[1] = t[0]
t[0] = temp
print('2:',t)
# 2: [3, 1, 5, 2, 4, 6]

想請教為什麼Python可以在第一種方法直接進行置換? 不用像第二種方法這樣置換
還是Python天生支援這樣處理? 其有無關鍵字可查詢?
謝謝


標題:初學LINE bot，heroku設定失敗
標籤:heroku linebot lineapi python 3 

想請教各位，為什麼我在設定完heroku，使用git push master 推送上去之後，我的app頁面會出現Error，該寫的檔案都有寫好，不知道哪邊設定出了問題...
註:
我使用的是python 3.8.5
Procfile, requirements, runtime都有設定好


標題:(已解決)#新手python問題: 在python中呼叫另一支程式的方法，如何進行內部修改
標籤:python mechine learning spyder 

如題:
在A程式中寫了畫熱度圖的a方法後
於B程式中呼叫了A程式裡的a方法，
試問如何更改其方法裡targets值和X,Y值並畫出屬於B的熱度圖


標題:python cnn 交叉驗證
標籤:python cnn kfold 

def read_directory(directory_name):
list_of_ans=[]
list_of_img=[]
for filename in os.listdir(directory_name):
img=cv2.imread(directory_name+"/"+filename)
img_resize = cv2.resize(img,(32,32))
list_of_img.append(img_resize)
list_of_ans.append(int(filename.split('.')[0])-1)
array_of_img = np.array(list_of_img,dtype="float32")
return(array_of_img,list_of_ans)
指定亂數種子
seed = 14
np.random.seed(14)
載入資料集
img_width, img_height, img_num_channels = 32, 32, 3
(input_train,target_train)=read_directory(r"C:\Users\COSH\Desktop\Ch09\train")
(input_test, target_test)=read_directory(r"C:\Users\COSH\Desktop\Ch09\test")
input_shape = (img_width, img_height, img_num_channels)
epochs=10
batch_size=10
verbose=1
num_folds = 10
no_classes = 14
loss_function = sparse_categorical_crossentropy
因為是固定範圍, 所以執行正規化, 從 0-255 至 0-1
input_train = input_train.astype("float32") / 255
input_test = input_test.astype("float32") / 255
acc_per_fold = []
loss_per_fold = []
Merge inputs and targets
inputs = np.concatenate((input_train, input_test), axis=0)
targets = np.concatenate((target_train, target_test), axis=0)
Define the K-fold Cross Validator
kfold = KFold(n_splits=num_folds, shuffle=True)
K-fold Cross Validation model evaluation
fold_no = 1
for train, test in kfold.split(inputs, targets):
# One-hot編碼
target_train = to_categorical(target_train)
target_test= to_categorical(target_test)
定義模型
model = Sequential()
model.add(Conv2D(32, kernel_size=(3, 3), padding="same",
             input_shape=input_shape, activation="relu"))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Dropout(0.25))
model.add(Conv2D(64, kernel_size=(3, 3), padding="same",
             activation="relu"))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Conv2D(64, kernel_size=(3, 3), padding="same",
             activation="relu"))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Dropout(0.25))
model.add(Flatten())
model.add(Dense(256, activation="relu"))
model.add(Dense(no_classes, activation="softmax"))
model.summary()   # 顯示模型摘要資訊

編譯模型
model.compile(loss=loss_function, 
              optimizer="adam",
              metrics=["accuracy"])
print('------------------------------------------------------------------------')
print(f'Training for fold {fold_no} ...')

訓練模型
history = model.fit(inputs[train], targets[train],
                batch_size=batch_size,
                epochs=epochs,
                verbose=verbose)

Generate generalization metrics
scores = model.evaluate(inputs[train], targets[train], verbose=0)
print(f'Score for fold {fold_no}: {model.metrics_names[0]} of {scores[0]}; {model.metrics_names[1]} of {scores[1]*100}%')
acc_per_fold.append(scores[1] * 100)
loss_per_fold.append(scores[0])
 # Increase fold number
fold_no = fold_no + 1

在跑的時候都會跑出Error when checking target: expected dense_4 to have shape (14,) but got array with shape (1,)這個錯誤想請問厲害各位我該怎麼解決這個錯誤
非常感謝


標題:如何讓圖片變成互補色
標籤:#影像處理 #python #色彩 

最近在做一個作業是要處理圖片讓他變成互補色
根據維基百科的說法:
互補色(對比色)是成對的顏色，當組合時，相互抵消。這意味著當組合時，它們會產生灰階色彩，如白色或黑色。當彼此相鄰放置時，它們會為這兩種特定顏色創造最強烈的對比度。由於這種顯著的顏色衝突，對比色或相反色等術語通常被認為比「互補色」更合適。
概念懂，但是實作又發現完全不懂，到底怎麼樣得到互補色?
然後找到了這篇
https://www.coder.work/article/1253704
我不確定這是不是對的，然後也不知道他的運作原理...
總之...求解


標題:加速巢狀for迴圈
標籤:python 效能優化 

我想請問有什麼方法在python語法之下可以加速巢狀for迴圈的
def Compute(testdata,FAQ):
    scoreboard=[]
    for i in tqdm(range(1035)):
        encoded_dict1=tokenizer.encode_plus(
                    testdata[i][1],                    
                    add_special_tokens = True, 
                    max_length = 100,          
                    pad_to_max_length = True,
                    return_attention_mask = True,   
                    return_tensors = 'pt', 
                    truncation=True    
            )
        invector=model(encoded_dict1['input_ids'],encoded_dict1['attention_mask'],'cls')
    
        faq_score=[]
        for j in tqdm(range(5821)):
            encoded_dict2=tokenizer.encode_plus(
                        FAQ[j][2],                    
                        add_special_tokens = True, 
                        max_length = 100,          
                        pad_to_max_length = True,
                        return_attention_mask = True,   
                        return_tensors = 'pt',  
                        truncation=True   
                    )
            faqvector=model(encoded_dict2['input_ids'],encoded_dict2['attention_mask'],'cls')
            score=float(torch.cosine_similarity(faqvector,invector))
            faq_score.append([FAQ[j][1],score]) 
            #print(i,j) 
        scoreboard.append(faq_score)
    return scoreboard



標題:Python 開啟一個檔案txt然後算出TD-IDF
標籤:tf-idf python it大神 學渣 燒腦 

from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction.text import TfidfTransformer
from sklearn.feature_extraction.text import TfidfVectorizer
import pandas as pd
d1="a b c d"
d2="e f g h"
vectorizer = CountVectorizer(stop_words=None, token_pattern="(?u)\b\w+\b")
X = vectorizer.fit_transform([d1,d2])
r = pd.DataFrame(X.toarray(),columns=vectorizer.get_feature_names())
transformer = TfidfTransformer(smooth_idf=True)
Z = transformer.fit_transform(X)
r = pd.DataFrame(Z.toarray(),columns=vectorizer.get_feature_names())
print(r)
想把d1換成打開一個txt檔  有大神可以教教我嗎
有用d1 =open('test.txt','r',encoding='utf-8')
可是還是有錯誤
另外一個問題TF-IDF 是不是算出來的頻率不會等於1  為什麼


標題:請教各位大大 Raspberry Pi 4  使用 OMXPlayer 播放影片的問題
標籤:python3 raspberry pi raspberry pi 4 

我使用 排程自動呼叫 python 播放影片
Raspberry Pi 4 有接螢幕
python 去指定API抓影片目錄並下載影片
使用OMXPlayer播放
每一兩天 就會OMXPlayer直接炸了
python沒有全壞就繼續在那裡背景執行
但影片早停了
定時呼叫順便當看門狗(shell)
#!/bin/sh
proc_name="SmartMiniBox.py"

for i in {1..12}
do
  if [ `ps -ef | grep $proc_name | grep -v grep | wc -l` -eq 0 ]
  then
    #sudo pkill -f omxplayer;sudo pkill -f fbi;pkill -f SmartMiniBox.py; #預防性刪除舊的
    FileName=$(date +%Y%m%d.%H%M%S.txt)
    touch /home/pi/log/${FileName}
    nohup python3 -u /home/pi/SmartMiniBox.py > /home/pi/AED/log/${FileName} 2>&1 &
  fi
  sleep 5s
done

#*  *  *  *  *   root    /bin/bash /home/pi/AED/run.sh > /dev/null 2>&1

code
#!/usr/bin/python3
# -*- coding: UTF-8 -*-
# 需安裝 sudo apt-get install -y libdbus-1-3 libdbus-1-dev omxplayer fbi
# 需安裝 pip3 install requests schedule opencv-python screeninfo
# 需安裝 sudo python3 -m pip install omxplayer-wrapper
# sudo apt-get install automake autoconf libtool libreadline-dev libexif-dev libjpeg-dev libpng-dev libtiff-dev libgif-dev libsdl1.2-dev libaa1-dev libpoppler-dev libdjvulibre-dev libspectre-dev libarchive-dev
from omxplayer.player import OMXPlayer
import requests, json, schedule, time, syslog, os, signal, sys, uuid, subprocess, threading
#import datetime
try:
    import RPi.GPIO as GPIO
except RuntimeError:
    print("導入失敗")
    syslog.syslog("導入失敗")

DOOR2_PIN = 17                                                                            #DOOR2 Pin腳
DOOR_PIN = 27                                                                           #DOOR Pin腳
SelfCheck = '00'                                                                        #自檢時間
StationGuid = "XXXXXXXXXXXXXXXX"            #機碼
DOOR2_STATUS = 0                                                                          #DOOR2 上次狀態暫存
DOOR_STATUS = 0                                                                         #DOOR 上次狀態暫存
ImageRoot = os.path.abspath(os.path.dirname(__file__)) + '/'                            #程式根
ImagePath = ImageRoot + 'video/'                                                        #影片資料夾
os.makedirs(ImagePath, exist_ok=True)                                                   #不存在則創建
BackgroundBlackSubprocess = {}                                                          #黑底背景進程

def setup():
    global DOOR2_STATUS, DOOR_STATUS
    GPIO.setwarnings(False)                                                             #忽略警告
    GPIO.setmode(GPIO.BCM)                                                              #GPIO.BOARD GPIO編號 或 Port Pin編號
    GPIO.setup([DOOR2_PIN,DOOR_PIN],GPIO.IN,pull_up_down=GPIO.PUD_DOWN)                   #GPIO 設定讀入  GPIO.PUD_UP/GPIO.PUD_DOWN
    GPIO.add_event_detect(DOOR2_PIN, GPIO.BOTH, callback=DOOR2_WAIT_FUN, bouncetime=10)     #GPIO 觸發事件  GPIO.RISING/GPIO.FALLING/GPIO.BOTH  bouncetime=1
    GPIO.add_event_detect(DOOR_PIN, GPIO.BOTH, callback=DOOR_WAIT_FUN, bouncetime=10)   #GPIO 觸發事件  GPIO.RISING/GPIO.FALLING/GPIO.BOTH  bouncetime=1

    DOOR2_STATUS = GPIO.input(DOOR2_PIN)
    DOOR_STATUS = GPIO.input(DOOR_PIN)

    KillProcessing()

    #os.system("fbi -a --noverbose -T 2 " + ImagePath + "black.jpg")                                                        #螢幕用黑色檔住
    #BackgroundBlackSubprocess = subprocess.Popen(args=["fbi", "-a", "--noverbose", "-T", "2", ImagePath + "black.jpg"], shell = True)                 #螢幕用黑色檔住
    #if os.environ.get('DISPLAY','') == '':
    #    print('no display found. Using :0.0')
    #    os.environ.__setitem__('DISPLAY', ':0.0')
    #
    #    BackgroundBlackSubprocess = subprocess.Popen(args=["/usr/bin/feh","-q","-p","-Z","-F","-R","60","-Y","-D","15.0", ImagePath + "black.jpg"], shell = True)                 #螢幕用黑色檔住
    #    BackgroundBlackSubprocess = subprocess.Popen(args="DISPLAY=:0.0 XAUTHORITY=/home/pi/.Xauthority /usr/bin/feh -q -p -Z -F -R  60 -Y -D 15.0 "+ ImagePath + "black.jpg", shell = True)                 #螢幕用黑色檔住

    #啟動程序
    print("啟動完成")
    syslog.syslog("啟動完成")
    PostAPI([{
        "EventTypeId": 11, #[Description("啟動完成")] SmartBoxInitFinish = 11,
        "EventTitle": "SmartMiniBox 啟動狀況",
        "EventContecnt": "",
        "EventTime": time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
    }])

def KillProcessing():
    os.system("sudo pkill -f omxplayer;sudo pkill -f fbi;pkill -f SmartMiniBox.py;")
    #os.system("sudo pkill omxplayer;sudo killall -s 9 omxplayer;sudo pkill fbi;sudo killall -s 9 fbi;")
    #os.system("sudo pkill omxplayer; sudo killall -s 9 omxplayer;sudo killall -s 9 fbi;")
    syslog.syslog("Run kill omxplayer and fbi")

def print_json(obj):
    print(json.dumps(obj, sort_keys=True, indent=2, separators=(',', ': ')))

def get_mac_address():
    mac=uuid.UUID(int = uuid.getnode()).hex[-12:].upper()
    return "-".join([mac[e:e+2] for e in range(0,11,2)])

def PostAPI(data_detail):
    API_URI = 'http://XXXXXXX.com/api/v1'
    HEADERS = {'Content-Type':'application/json'}
    data_json = {
                    "Details": data_detail,
                    "Command": "UploadEvent",
                    "StationMAC": get_mac_address(),
                    "StationGuid": StationGuid
                }

    #data_json['Details'].append(data_detail)
    #print(data_detail['EventTitle'])
    #print_json(data_json)

    try:
        response = requests.post(API_URI, headers=HEADERS, json=data_json)
        response.raise_for_status()
        #print(response.json()["Status"])
        #print_json(response.json())

        if response.json()['ErrorCode'] == 0:
            print('Send API Success')
        else:
            print('Send API Error')
            syslog.syslog("Send API Error")

        time.sleep(1)   #小停一下

    except Exception as ex:
        raise ex

def DOOR2_WAIT_FUN(channel):
    global DOOR2_STATUS
    DOOR2_NEW_STATUS = GPIO.input(DOOR2_PIN)   #避免瞬間換狀態
    if DOOR2_STATUS != DOOR2_NEW_STATUS:        #不等於上次的狀態才動作
        DOOR2_STATUS = DOOR2_NEW_STATUS
        print("DOOR2狀況: " + ("DOOR2取走" if DOOR2_NEW_STATUS == 1 else "DOOR2歸位"))
        syslog.syslog("DOOR2狀況: " + ("DOOR2取走" if DOOR2_NEW_STATUS == 1 else "DOOR2歸位"))
        PostAPI([{
            "EventTypeId": 3 if DOOR2_NEW_STATUS == 1 else 4, #[Description("DOOR2取走")] DOOR2Taked = 3, [Description("DOOR2歸位")] DOOR2Back = 4,
            "EventTitle": "DOOR2狀況",
            "EventContecnt": "",
            "EventTime": time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
        }])

def DOOR_WAIT_FUN(channel):
    global DOOR_STATUS
    DOOR_NEW_STATUS = GPIO.input(DOOR_PIN)  #避免瞬間換狀態
    if DOOR_STATUS != DOOR_NEW_STATUS:       #不等於上次的狀態才動作
        DOOR_STATUS = DOOR_NEW_STATUS
        print("門狀況:" + ("開門" if DOOR_NEW_STATUS == 1 else "關門"))
        syslog.syslog("門狀況:" + ("開門" if DOOR_NEW_STATUS == 1 else "關門"))
        PostAPI([{
            "EventTypeId": 1 if DOOR_NEW_STATUS == 1 else 2, #[Description("開門")] DoorOpen = 1, [Description("關門")] DoorClose = 2,
            "EventTitle": "門狀況",
            "EventContecnt": "",
            "EventTime": time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
        }])

class Cron(object):
    def __init__(self):
        schedule.every().hour.at(':'+SelfCheck).do(self.SelfCheckTask)                                #自檢排程
        self.Run()

    def Run(self):
        while True:
            schedule.run_pending()
            time.sleep(1)

    def SelfCheckTask(self):
        threading.Thread(target=self.SelfCheck).start()

    def SelfCheck(self):
        DOOR2_NEW_STATUS = GPIO.input(DOOR2_PIN)   #避免瞬間換狀態
        DOOR_NEW_STATUS = GPIO.input(DOOR_PIN)  #避免瞬間換狀態

        print("自檢狀況: " + ("自檢正常" if DOOR2_NEW_STATUS == 0 and DOOR_NEW_STATUS == 0 else "自檢異常"))
        syslog.syslog("自檢狀況: " + ("自檢正常" if DOOR2_NEW_STATUS == 0 and DOOR_NEW_STATUS == 0 else "自檢異常"))
        PostAPI([{
            "EventTypeId": 9 if DOOR2_NEW_STATUS == 0 and DOOR_NEW_STATUS == 0 else 10,   #[Description("自檢正常")] SelfCheckCorrect = 9, [Description("自檢異常")] SelfCheckError = 10,
            "EventTitle": "自檢狀況",
            "EventContecnt": "自我檢測",
            "EventTime": time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
        },{
            "EventTypeId": 3 if DOOR2_NEW_STATUS == 1 else 4,    #[Description("DOOR2取走")] DOOR2Taked = 3, [Description("DOOR2歸位")] DOOR2Back = 4,
            "EventTitle": "DOOR2狀況",
            "EventContecnt": "自我檢測",
            "EventTime": time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
        },{
            "EventTypeId": 1 if DOOR_NEW_STATUS == 1 else 2,   #[Description("開門")] DoorOpen = 1, [Description("關門")] DoorClose = 2,
            "EventTitle": "門狀況",
            "EventContecnt": "自我檢測",
            "EventTime": time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
        }])

class PlayVideo(object):
    def __init__(self):
        self.PlayList = {}
        self.Run()

    def Run(self):
        while True:
            self.GetPlayList()
            if self.PlayList['ErrorCode'] == 0:
                print('Run Play Video Start: Run')
                #self.BackgroundBlack()
                self.PlayVideo()
                print('Run Play Video End: Run')
            else:
                KillProcessing()
                time.sleep(3)
                print('Run Play Video Error: ' + self.PlayList['ErrorCode'])
                print_json(self.PlayList)
                syslog.syslog('Run Play Video Error: ' + self.PlayList['ErrorCode'])
                syslog.syslog(json.dumps(self.PlayList, sort_keys=True, indent=2, separators=(',', ': ')))

    def BackgroundBlack(self):
        global BackgroundBlackSubprocess
        for line in os.popen("ps ax | grep 'fbi -a' | grep -v grep | wc -l"):                                                                                     #檢查是否已經有黑色檔住
            if(int(line)==0):
                #BackgroundBlackSubprocess = subprocess.Popen(args=["fbi -a --noverbose -T 2 " + ImagePath + "black.jpg"], shell = True)                 #螢幕用黑色檔住
                BackgroundBlackSubprocess = subprocess.Popen(args=["fbi", "-a", "--noverbose", "-T", "2", ImagePath + "black.jpg"])                 #螢幕用黑色檔住
                print('Background Black ID:' + BackgroundBlackSubprocess + ' path:' + ImagePath + "black.jpg")

    def PlayVideo(self):
        print('Play Video Start: PlayVideo')
        plays = {}
        TmpPlays = {}
        #print(json.dumps(self.PlayList["Details"], sort_keys=True, indent=2, separators=(',', ': ')))
        for k, d in enumerate(self.PlayList["Details"]):
            #d["FileName"] = '202009101128550045988_1185.mp4'
            if os.path.isfile(ImagePath+d["FileName"]):
                try:
                    plays[k] = OMXPlayer(ImagePath+d["FileName"], args='--no-osd -b -o both --layer ' + str(10000-k), dbus_name="org.mpris.MediaPlayer2.omxplayer"+ str(10000-k))
                    print(k, plays[k].duration(),ImagePath+d["FileName"])
                    if k > 0:                                                   #關掉上一個播放的
                        plays[0].quit()
                        TmpPlays.quit()
                    TmpPlays = plays[k]                                          #暫存影片索引
                    time.sleep(plays[k].duration()-0.5)
                except Exception as err:
                    print(str(err))
                    plays[k].quit()
                    KillProcessing()
                    print('Playe Video Error, Run SmartMiniBox Stop')
                    syslog.syslog('Playe Video Error, Run SmartMiniBox Stop')
                    GPIO.cleanup()  # cleanup all GPIO
                    #sys.exit("Playe Video Error, Run SmartMiniBox Stop")
                    os._exit(1)
            else:
                print('Playe Video Error: ' + ImagePath+d["FileName"] + ' Not Found')
                syslog.syslog('Playe Video Error: ' + ImagePath+d["FileName"] + ' Not Found')
        print('Play Video End: PlayVideo')

    def GetPlayList(self):
        API_URI = 'http://XXXXXXX.com/api/v1'
        HEADERS = {'Content-Type':'application/json'}
        data_json = {
                        "Command": "GetVideoFileList",
                        "StationMAC": get_mac_address(),
                        "StationGuid": StationGuid
                    }
        #print_json(data_json)

        try:
            response = requests.post(API_URI, headers=HEADERS, json=data_json)
            response.raise_for_status()
            #print(response.json()["Status"])
            #print_json(response.json())

            if response.json()['ErrorCode'] == 0:
                print('Get Play List Success')
                for k, d in enumerate(response.json()["Details"]):
                    print('Download Video Start')
                    self.Download(d)
                    print('Download Video End')
            else:
                print('Get Play List Error: 1')
                print(response.json()['Description'])
                print_json(response.json())
                syslog.syslog('Get Play List Error: 1')
                syslog.syslog(response.json()['Description'])
                syslog.syslog(json.dumps(response.json(), sort_keys=True, indent=2, separators=(',', ': ')))

            self.PlayList = response.json()
            return response.json()

        except Exception as ex:
            print('Get Play List Error: 2')
            print(ex)
            syslog.syslog('Get Play List Error: 2')
            syslog.syslog(ex)
            raise ex

    def Download(self, Data):
        API_URI = 'http://XXXXXXX.com/api/download'
        HEADERS = {'Content-Type':'application/json'}
        data_json = {
                        "Command": "DownLoadVideoFile",
                        "StationMAC": get_mac_address(),
                        "StationGuid": StationGuid,
                        "Type": "Video",
                        "Guid": Data["FileGuid"]
                    }
        #print_json(data_json)

        try:
            if os.path.isfile(ImagePath+Data["FileName"]):
                if os.path.getsize(ImagePath+Data["FileName"]) != Data["FileLength"]:
                    os.remove(ImagePath+Data["FileName"])
                    print('Video Size Error Run Remove File: '+Data["FileName"])

            if not os.path.isfile(ImagePath+Data["FileName"]):
                response = requests.post(API_URI, headers=HEADERS, json=data_json)
                response.raise_for_status()

                with open(ImagePath+Data["FileName"],'wb') as f:
                    f.write(response.content)
                    f.close()

                print('Download Video Success: '+Data["FileName"])

            print('Check Video Success: '+Data["FileName"])

            #time.sleep(1)   #小停一下

        except Exception as ex:
            print('Download Video Error')
            print(ex)
            syslog.syslog('Download Video Error')
            syslog.syslog(ex)
            raise ex

if __name__ == '__main__': # Program start from here
    setup()
    threading.Thread(target=Cron).start()           #setDaemon(True)
    threading.Thread(target=PlayVideo).start()      #setDaemon(True)
try:
    while True:
        time.sleep(1)
except KeyboardInterrupt: # When Ctrl+C is pressed, the child program destroy() will be executed.
        GPIO.cleanup() # cleanup all GPIO
        KillProcessing()
        print('SmartMiniBox Stop')
        syslog.syslog('SmartMiniBox Stop')




log檔案看到的最後報錯
DBus cannot connect to the OMXPlayer process
Exception in thread Thread-2:
Traceback (most recent call last):
  File "/home/pi/SmartMiniBox.py", line 205, in PlayVideo
    plays[k] = OMXPlayer(ImagePath+d["FileName"], args='--no-osd -b -o both --layer ' + str(10000-k), dbus_name="org.mpris.MediaPlayer2.omxplayer"+ str(10000-k))
  File "/usr/local/lib/python3.7/dist-packages/omxplayer/player.py", line 154, in __init__
    self.load(source, pause=pause)
  File "/usr/local/lib/python3.7/dist-packages/omxplayer/player.py", line 251, in load
    self._load_source(source)
  File "/usr/local/lib/python3.7/dist-packages/omxplayer/player.py", line 163, in _load_source
    self._connection = self._setup_dbus_connection(self._Connection, self._bus_address_finder)
  File "/usr/local/lib/python3.7/dist-packages/omxplayer/player.py", line 236, in _setup_dbus_connection
    raise SystemError('DBus cannot connect to the OMXPlayer process')
SystemError: DBus cannot connect to the OMXPlayer process

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/lib/python3.7/threading.py", line 917, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.7/threading.py", line 865, in run
    self._target(*self._args, **self._kwargs)
  File "/home/pi/SmartMiniBox.py", line 170, in __init__
    self.Run()
  File "/home/pi/SmartMiniBox.py", line 178, in Run
    self.PlayVideo()
  File "/home/pi/SmartMiniBox.py", line 214, in PlayVideo
    plays[k].quit()
KeyError: 8



標題:無法在工作排程中執行py檔
標籤:python3 python cmd windows 10 工作排程 

如題，我的程序是照著這篇文章一步一步做的https://dotblogs.com.tw/what_s_note/2017/02/14/113920
我的步驟:
在jubiternotebook的程式碼頁面直接將.ipynb檔下載成.py檔，接下來把.py檔放入D槽的star_data的資料夾中，再來的程序如圖所示(cmd是以系統管理員身分執行的)



最後卻出現這個

想知道到底是哪裡出現了問題?
感謝各位大大!


標題:python 連接 Microsoft Access (已解決)
標籤:python access pyodbc 

各位大大好，小弟目前在使用python 連接 Access資料庫，
查了一些資料使用了 python的pyodbc套件，
使用方法如下:
conString = r'DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=檔案位置.accdb;'
conn = pyodbc.connect(conString)
cur = conn.cursor()
cur.execute('SELECT * FROM  Bank')

出現 error: ('IM002', '[IM002] [Microsoft][ODBC 驅動程式管理員] 找不到資料來源名稱且未指定預設的驅動程式 (0) (SQLDriverConnect)')錯誤
找了一下問題所在如下:
import pyodbc
print(pyodbc.drivers())
// 列印出來的結果只有以下4個
// 1. SQL Server
// 2. SQL Server Native Client 11.0
// 3. ODBC Driver 13 for SQL Server
// 4. ODBC Driver 17 for SQL Server


發現此處沒有access的Driver，試著找出解決方法但無法...

請教各位大大，以上狀況

我缺少安裝了甚麼? 還是我該做什麼處理?
還有其他方式能夠存取.mdb檔案?

---------------------------------以解決--------------------------------------
主要問題如上所述，為driver未安裝啟用，

解決方法:



如 paicheng0111 大大留言所示
32 bit Python + 32 bit Access + 32 bit Access Database engine
64 bit Python + 64 bit Access + 64 bit Access Database engine


如 rogeryao 大大所提供資源下載driver


感謝各位大大!！


標題:想問一下 這個 @  是 python 標準語法嗎 ?  寫 line bot  時的小困惑
標籤:line bot python 

看不太懂 @ 這個語法 的意義
FLASK裡面好像用非常多
@app.route("/callback", methods=['POST'])
def callback():
@webhookhandler.add(MessageEvent, message=TextMessage)
def echo_msg(event):
請問上面這兩行有關係嗎
想問一下 這個 @  是 python 標準語法嗎 ?
@是類似 c# 中的屬性符號嗎 [Athentication]  ??
如果是的話  這種 @  的東西要怎麼自己寫
@webhookhandler.add(MessageEvent, message=TextMessage)
這行白話文是什麼 ???


標題:實作KNN在畫分類圖出來的時候遇到問題
標籤:#knn #python #plot 

目前正在做KNN的作業，在畫圖出來這塊遇到問題，
按照我理解的，
前面
plt.pcolormesh(xx, yy, Z, cmap=cmap_light)
可以依據我的dataset的xy座標跟預測結果畫出分類圖(淺色的密集點)，
下面
plt.scatter(X_test[:, 0], X_test[:, 1], c=y_test, cmap=cmap_bold, edgecolor='k', s=20)
可以依據我的測試資料的xy座標畫出顏色比較深的點
但是我的測試資料居然只有一部分在分類圖上面，有很多都超出去，需要把
plt.xlim(xx.min(), xx.max())
plt.ylim(yy.min(), yy.max())
拿掉才看的到
可是我的test資料是包含在dataset裡的，到底是哪邊出問題才會超出去?


以下為我的code
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.colors import ListedColormap
from pylab import rcParams
dataset = []
label = []

path = 'dataset/'
#讀1~7的txt
for i in range(0, 7):
    f = open(path+str(i+1)+'.txt', 'r')
    print('Read file: ', path+str(i+1)+'.txt')
    lines = f.readlines()
    for line in lines:
        line = line.split()
        dataset.append(line)
        label.append(i)
        #print('line: ',line, 'label: ', i)
    f.close()

dataset = np.array(dataset)    
print('\ndataset len: ', len(dataset))
label = np.array(label)   
print('label len: ', len(label)) 

def accuracy(k, X_train, y_train, X_test, y_test):
    print('K: ', k)
    print('Train: ', len(X_train), 'Label: ', len(y_train))
    print('Test: ', len(X_test), 'Label: ', len(y_test))
    
    #compute accuracy of the classification based on k values 
    
    # instantiate learning model and fit data
    knn = KNeighborsClassifier(n_neighbors=k)    
    knn.fit(X_train, y_train)

    # predict the response
    pred = knn.predict(X_test)

    # evaluate and return  accuracy
    return accuracy_score(y_test, pred)

def classify_and_plot(X, y, k):
    ''' 
    split data, fit, classify, plot and evaluate results 
    '''
    # split data into training and testing set
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.33, random_state = 41)

    # init vars
    n_neighbors = k
    h           = .02  # step size in the mesh

    # Create color maps            red         blue      yellow     green       cyan      orange      pink
    cmap_light = ListedColormap(['#FFAAAA', '#248EFF', '#F1F358', '#A9F89B', '#40DAF2', '#F39153', '#7566FF'])
    cmap_bold  = ListedColormap(['#FF0000', '#0000FF', '#C8C20E', '#006B07', '#0065B8', '#943F0A', '#0B006B'])

    rcParams['figure.figsize'] = 5, 5
    for weights in ['uniform', 'distance']:
        # we create an instance of Neighbours Classifier and fit the data.
        clf = KNeighborsClassifier(n_neighbors, weights=weights)
        clf.fit(X_train, y_train)

        # 確認訓練集的邊界
        # Plot the decision boundary. For that, we will assign a color to each
        # point in the mesh [x_min, x_max]x[y_min, y_max].
        x_min, x_max = int(min(X[:, 0])) - 1, int(max(X[:, 0])) + 1
        y_min, y_max = int(min(X[:, 1])) - 1, int(max(X[:, 1])) + 1
        print('\nx_min', x_min, 'x_max', x_max, '\ny_min', y_min, 'y_max', y_max)
        
        #xx = x座標值 yy=y座標值
        xx, yy = np.meshgrid(np.arange(x_min, x_max, h),
                             np.arange(y_min, y_max, h))
        
        #np.c_ 以column的方式拼接兩個array
        #ravel() 拉平為 1d-array
        Z = clf.predict(np.c_[xx.ravel(), yy.ravel()])
        # Put the result into a color plot 畫出分類圖(淺色)
        #z=預測結果,會繪製成對應的cmap值顏色
        Z = Z.reshape(xx.shape)
        fig = plt.figure()
        plt.pcolormesh(xx, yy, Z, cmap=cmap_light)
        


        # Plot also the training points, x-axis = 'Glucose', y-axis = "BMI"
        plt.scatter(X_test[:, 0], X_test[:, 1], c=y_test, cmap=cmap_bold, edgecolor='k', s=20)   
        
        plt.xlim(xx.min(), xx.max())
        plt.ylim(yy.min(), yy.max())
    
        print('xx_min', xx.min(), 'xx_max', xx.max(), '\nyy_min', yy.min(), 'yy_max', yy.max())
        plt.title("7-class outcome classification (k = %i, weights = '%s')" % (n_neighbors, weights))
        plt.show()
        fig.savefig(weights +'.png')
        print('dataset: ', len(X[:, 0]), len(X[:, 1]))
        print('test: ', len(X_train[:, 0]), len(X_train[:, 1]))

        # evaluate
        y_expected  = y_test
        y_predicted = clf.predict(X_test)
        print('預測:', y_predicted)
        print('答案:', y_expected)


        # print results
        print('----------------------------------------------------------------------')
        print('Classification report')
        print('----------------------------------------------------------------------')
        print('\n', classification_report(y_expected, y_predicted))
        print('----------------------------------------------------------------------')
        print('Accuracy = %5s' % round(accuracy(n_neighbors, X_train, y_train, X_test, y_test), 3))
        print('----------------------------------------------------------------------')

classify_and_plot(dataset, label, 3)



標題:特徵進行標準化後數值全部變成0
標籤:機器學習 python 


如圖，我想進行標準化，但進行完之後卻全部都變成0，想請問這是為什麼？
還是機器學習新手，所以某些問題還不是很了解請見諒。


標題:python 資料處理
標籤:python python入門 pandas.dataframe 

小弟想利用python做取代的功能
我想將這兩張表(A、B)作一些整理
A表(實驗設計組合):



a
b
c
d
e
f
g




0
2
1
0
1
2
2


1
1
2
1
0
1
0


2
0
0
2
2
0
1


0
2
1
2
0
1
2


1
1
2
0
2
0
1


2
0
0
1
1
2
0



B表(水準表):



水準
a
b
c
d
e
f
g




0
24
1
32
Sigmoid
SGD
64
0.01


1
72
3
64
Tanh
RMSprop
128
0.05


2
144
6
128
ReLU
Adam
256
0.1



想呈現如下結果:
C表(結果)



a
b
c
d
e
f
g




24
6
64
Sigmoid
RMSprop
256
0.1


72
3
128
Tanh
SGD
128
0.01


144
1
32
ReLU
Adam
64
0.05


24
6
64
ReLU
SGD
128
0.1


72
3
128
Sigmoid
Adam
64
0.05


144
1
32
Tanh
RMSprop
256
0.01



小弟是這樣做的
# 读取表
df_my_books = pd.DataFrame(pd.read_excel('./實驗設計組合.xlsx', sheet_name='工作表1'))

df_my_author = pd.DataFrame(pd.read_excel('./水準表.xlsx', sheet_name='工作表1'))
df_my_books1=df_my_books

for i in range(0,df_my_books.shape[1]):
    for j in range(0,df_my_books.shape[0]):
        
        df_my_books1.iloc[j,i]=df_my_author.iloc[df_my_books.iloc[j,i],i]
        
df_my_books1

但結果會出現這個錯誤
ValueError: Location based indexing can only have [integer, integer slice (START point is INCLUDED, END point is EXCLUDED), listlike of integers, boolean array] types

根據小弟測試，好像是最後一欄有小數點那部分出問題
想問一下有甚麼辦法解決或是有更好的寫法


標題:Python flask 註冊表單儲存成db檔時錯誤
標籤:python3 flask sql web 

GITHUB:連結
專案代碼如上
執行run.py時
網頁表單註冊後會跳出
sqlalchemy.exc.OperationalError
新手第一次做網頁請各位大大幫忙><
希望能教我是看哪邊出問題需要新增什麼(我可以自己去找答案)


標題:如何將exe檔還原成python source code
標籤:exe python uncompyle6 數據恢復 

跟各位大大分享一個很悲慘的事情...
前天我電腦用到一半的時候突然黑屏...拿去送修被告知硬碟和硬體都壞掉
資料確定救不回來...
但我剛好發現之前有把執行檔傳給別人!!
上網查有發現很多篇文章提到要反編譯要下載uncompyle6套件
但uncompyle6只支援到python3.8
請問有不用uncompyle6的方法也可以將exe檔回退到.py檔嗎?
如果有大大有厲害的軟體可以直接將執行檔還原的話可以站內信私訊我
一個檔案我願意以500元答謝
謝謝各位大大的幫忙



標題:Python Radiobutton呼叫問題
標籤:python3 python入門 tkinter 

想請教各位大大，如果我想要隨著Radiobutton選擇不同而變更listbox的內容
請問該怎麼寫才好?
現在只會一值疊加上去而已... 程式碼如下

import tkinter as tk 
window = tk.Tk()
window.title('Main Window')
window.geometry('600x300') 

l = tk.Label(window, bg='yellow', width=20, text='empty')
l.pack()
count=0
listbox = tk.Listbox(window, selectmode=tk.MULTIPLE)
listbox.pack()

def test():
    #clear(listbox)
    if var.get() =='A':
        for it in ('A', 'B', 'C', 'D','E'):
            listbox.insert(tk.END, it)
    if var.get() =='B':
        for it in ('1', '2', '3', '4'):
            listbox.insert(tk.END, it)

def print_selection2():
    l.config(text='you have selected ' + var.get())
        
var = tk.StringVar() 
r1 = tk.Radiobutton(window, text='A', variable=var, value='A', command = test)
r1.pack()
r2 = tk.Radiobutton(window, text='B', variable=var, value='B', command= test)
r2.pack()
b = tk.Button(window, text='execute', font=('Arial', 12), width=10, height=1, command = print_selection2)
b.pack()

window.mainloop()


Listbox.delete(pos, length)，从pos开始删除多少个项目，(0, tk.END)就是全部删除；
已解決
開頭多一行listbox.delete(0, tk.END)即可
def test():
#clear(listbox)
listbox.delete(0, tk.END)


標題:python  想做一個 30 秒 後 自動執行的程式
標籤:python3 

想做一個 30 秒 後 自動執行的程式
這30 秒可以自己決定按Y/N 離開或繼續
要怎麼寫?
import getpass
while True  :
#DO  SOMETHING
res = getpass.getpass('在本視窗按  y  後 Enter 繼續執行，\n(不想繼續執行  q  Enter 離開)')
if('Y'  in res.upper()):
print("繼續執行")
continue;
else:
print("結束程式")
break;


標題:WSL無法在python import已安裝成功的module
標籤:@wsl #python 



明明已經安裝成功了，但module卻無法import進去
試了很久卻找不到方法解決，所以來這裡請教，謝謝!


標題:keras_yolov3：yolov3.weights轉換為yolo.h5
標籤:yolov3 keras yolov3.weights google colab python 

我想在Google的Colab上操作
但沒成功
在一開始我就執行了以下程式:
python convert.py yolov3.cfg yolov3.weights model_data/yolo.h5
網路上爬文大家都使用這個程式
但他們使用得都是python
我想說Colab不知道能不能使用
便嘗試了下
最後錯誤
以下是顯示的錯誤:
File "", line 1
python convert.py yolov3.cfg yolov3.weights model_data/yolo.h5
^
SyntaxError: invalid syntax
能不能幫忙解答
Colab要怎麼將yolov3.weights轉換為yolo.h5


標題:selenium   要怎麼 操作  Edge   報一堆錯
標籤:selenium python3 

python 3 安裝 edge webdriver 有錯
DevTools listening on ws://127.0.0.1:62958/devtools/browser/115c7d16-d512-4c53-8fee-0afa6d96edb3
[25444:15112:0319/161417.523:ERROR:device_event_log_impl.cc(214)] [16:14:17.522] USB: usb_device_handle_win.cc:1056 Failed to read descriptor from node connection: 連結到系統的某個裝置失去作用。 (0x1F)
[25444:15112:0319/161417.524:ERROR:device_event_log_impl.cc(214)] [16:14:17.523] USB: usb_device_handle_win.cc:1056 Failed to read descriptor from node connection: 連結到系統的某個裝置失去作用。 (0x1F)
[25444:15112:0319/161417.525:ERROR:device_event_log_impl.cc(214)] [16:14:17.525] USB: usb_device_handle_win.cc:1056 Failed to read descriptor from node connection: 連結到系統的某個裝置失去作用。 (0x1F)




標題:python打包成執行檔無法執行
標籤:python python3 pyscreenshot 

想請教各位大大以下問題:

我引用pyscreenshot寫了一個截圖並存在相同路徑的程式
用.py檔在本機執行都可以，但是一打包成.exe檔，就沒成功過
打包語法如下:(顯示成功)

pyinstaller -F screen.py

一打開執行檔 就一直停在此畫面不動 :

全部程式碼如下:
import pyscreenshot as ImageGrab
import time

i = 1
while 1:

    # 擷取全螢幕畫面
    image = ImageGrab.grab()
    image.save("fullscreen"+str(i)+".png")
    i = i + 1
    time.sleep(5)

第一次碰到這種打包成執行檔無法執行的狀況...
頭好痛...


標題:django model動態名稱
標籤:python django model 

各位大大好，小弟是python新手，
關於python django部份，有以下的問題。
情境如下:
db資料表分為每個月的資料，表名稱如下:
ex: History202001、History202002、History202003...
# models.py
class testTable(models.Model):
    mpi_id = models.CharField(primary_key=True, max_length=10)
    recipe_id = models.CharField(max_length=50)
    plc_value = models.CharField(max_length=50, blank=True, null=True)
    update_at = models.DateTimeField(blank=True, null=True)

    class Meta:
        app_label = 'testDB'
        db_table = 'History202001'   # 這裡是我的資料表名稱，我希望它是動態的

# views.py
from .models import testTable
testData = testTable.objects.all()   # 此處該如何在使用時傳參

以上情境發生一個狀況，就是當我需要讀不同月份時，我就需要在models.py的檔案一直新增"類"，請問有沒有方法能夠在使用到models模型時，帶一個參數來讓db_table在使用上更靈活一些?
感謝各位大大!!!


標題:影像處理基本問題，灰階漸層
標籤:python opencv 

請問python 要如何做出512x512的灰階影像
由左上全黑自右下白色(0~255)的影像
初學感謝各位


標題:python  getpass 問題
標籤:python3 python 

想問一下  PYTHON３
想要做到類似 C 語言的  getchar()
網路上是說
用 getpass 雖然可以做 但是 不會顯示 字元
比如 按  Y +  ENTER
Y 就不會 SHOW
想問一下有啥辦法　有啥套件　像getpass有阻擋效果的輸入


標題:python txt讀取特定區段問題
標籤:python python入門 python系列文章 

txt文件內容如下
一一一一一一一一一一一一一一一一
1
2
3
start
11
22
33
44
end
4
5
6
一一一一一一一一一一一一一一一一
我想要讓它print
11
22
33
44
也就是說 需要找到關鍵字start
然後往下的資料都要
找到關鍵字end結束
有人可以教我該怎麼寫嗎 我使用的是python2.7
ps 不要用特定行數 因為中間的資料行數不固定 這只是範本
感謝各位大大


標題:python數據增強問題
標籤:python data augmentation opencv plt rgb 

def plotImages(images_arr):
fig, axes = plt.subplots(1, 10, figsize=(20,20))
axes = axes.flatten()
for img, ax in zip( images_arr, axes):
ax.imshow(img)
ax.axis("off")
plt.tight_layout()
plt.show()
data_augmentation = True
datagen = ImageDataGenerator(
    rotation_range=10, #randomly rotate images in the range(degrees, 0 to 180)
    width_shift_range=0.2, #randomly shift images horizontally (fraction of total width)
    height_shift_range=0.2, #randomly shift images vertically (fraction of total height)
    horizontal_flip=True, #randomly flip images
    
    shear_range=0.15,
     ) 

chosen_image= random.choice(os.listdir(r"C:\Users\COSH.spyder-py3\train"))
image_path=r"C:\Users\COSH.spyder-py3\train/"+chosen_image
assert os.path.isfile(image_path)
image=np.expand_dims(plt.imread(image_path), 0)
print(plt.imshow(image[0]))
aug_iter=datagen.flow(image)
aug_images=[next(aug_iter)[0].astype('float32')for i in range(10)]
for i in range(10):
aug_images[i] = aug_images[i]*255
cv2.imwrite(r"C:\Users\COSH.spyder-py3\train\aug/test"+str(i)+".png",aug_images[i])
想請問各位大大 我存的圖片都會變GRB的顏色
要如何改顏色通道才能變RGB 再麻煩各位大大高手解惑
感謝感謝



標題:我正在嘗試使用CNN來辨識手寫字出現錯誤AttributeError: 'NoneType' object has no attribute 'numpy'
標籤:python cnn tensorflow numpy 

import pygame 
from pygame.locals import *
import math
import numpy as np
import tensorflow as tf
import matplotlib.pyplot as plt

class Brush():
    def __init__(self, screen):
        self.screen = screen
        self.color = (255, 255, 255)
        self.size = 10 
        self.drawing = False
        self.last_pos = None
    
    def start_draw(self,pos):
        self.drawing = True
        self.last_pos = pos
    
    def end_draw(self):
        self.drawing = False
    
    def draw(self, pos):
        if self.drawing:
            for p in self._get_points(pos):
                #draw everypoint between them
                pygame.draw.circle(self.screen,
                                    self.color, p, self.size)
    
    def _get_points(self, pos):
        points = [(self.last_pos[0], self.last_pos[1])]
        len_x = pos[0] - self.last_pos[0]
        len_y = pos[1] - self.last_pos[1]
        length = math.sqrt(len_x ** 2 + len_y ** 2)
        step_x = len_x /length
        step_y = len_y / length
        for i in range(int(length)):
            points.append(
                (points[- 1][0] + step_x, points[ - 1][1] + step_y))
        
        points = map(lambda x: (int(0.5 + x[0]), int(0.5 + x[1])), points)
        self.last_pos = pos
        return list(set(points))




class Painter():
    def __init__(self, path):
        self.screen = pygame.display.set_mode((280, 280))
        pygame.display.set_caption("Painter")
        self.clock = pygame.time.Clock()
        self.brush = Brush(self.screen)
        self.path = path
        self.count = 0
    def run(self):
        self.screen.fill((0, 0, 0))
        while True:
            self.clock.tick(30)
            for event in pygame.event.get():
                if event.type == QUIT:
                    return
                elif event.type == KEYDOWN:
                    if event.key == K_ESCAPE:
                        self.screen.fill((0, 0, 0))
                    if event.key == K_RETURN:
                        pygame.image.save(self.screen, self.path + str(self.count) + '.jpg')
                        self.screen.fill((0, 0, 0))
                        self.count += 1
                        return
                    if event.key == K_SPACE:
                        pygame.image.save(self.screen, self.path + str(self.count) + '.jpg')
                        self.screen.fill((0, 0, 0))
                        self.count += 1
                elif event.type == MOUSEBUTTONDOWN:
                    self.brush.start_draw(event.pos)
                elif event.type ==MOUSEMOTION:
                    self.brush.draw(event.pos)
                elif event.type == MOUSEBUTTONUP:
                    self.brush.end_draw()


            pygame.display.update()


def load_preprosess_image(path):...

if __name__ == '__main__':
    print('利用CNN來識別手寫文字\n')
    print('每次手寫完按下空白鍵,再輸入下一個數字,按下Enter開始識別\n')


    app = Painter('./img/')
    app.run()
    ID = []
    for count in range(app.count):
        img = load_preprosess_image('./img/' + str(count) + '.jpg')
        np.expand_dims(img,axis = -1)

        model = tf.keras.models.load_model('./model.h5')       
        prediction = model.predict(img.numpy().reshape(1, 28, 28, 1))     
        result = np.argmax(prediction)
        ID.append(result)

    print("辨識數字為:" , end = '')
    for item in ID:
        print(item , end='')    
                

可是出現以下錯誤
prediction = model.predict(img.numpy().reshape(1, 28, 28, 1))
AttributeError: 'NoneType' object has no attribute 'numpy'


標題:如何使用python爬蟲獲得按鈕的連結?
標籤:python3 網路爬蟲 

最近公司要求我們幫忙蒐集展覽客戶公開聯絡名單，內容有上百筆，實在不想一筆一筆複製，本來用爬蟲得到了幾乎所有資料，但唯獨email是以按鈕的方式呈現，測試了一下，像是回傳的值才丟到mail裡面。
想請問各位板友能給一點點意見嗎??
圖片:

先行拜託及感謝各位了。
附上網站網址:http://business.com.tw/com/com.asp?id=2i4zh59i8zopr8y


標題:Leetcode 1423 的時間複雜度問題
標籤:時間複雜度 leetcode 遞迴 python 

各位先進好
敝人在此網站找到Leetcode 1423的詳解：
https://blog.csdn.net/fuxuemingzhu/article/details/113729881
該網站所提供的解法我都可理解，但為何第一種使用recursion的解法時間複雜度為O(N * k)呢？ 要如何分析？
麻煩站內熱心的邦友解惑了，謝謝!


標題:Python PermissionError: [WinError 32] 程序無法存取檔案，因為檔案正由另一個程序使用
標籤:pyhton shutil python zip pyhton ftp 

小弟是python新手，為了實現從FTP抓下檔案後，壓縮成zip檔，從網路上去找了以下的code來實現我要的目的‧在壓縮成zip檔備份後，要刪除從ftp抓下的檔案，用在壓縮成zip檔備份後，要刪除從ftp抓下的檔案，用shutil.remtree時最後會有一個error顯示有一個檔案正由另一個程序使用而沒辦法完全清除‧ 請問我該如何可以在最後把下載的檔案全部刪除‧
#判斷及增加從FTP下載到本地資料夾
import os,os.path
if not os.path.exists(localdir):
os.makedirs(localdir)
#從FTP下載到本地資料夾
from ftplib import FTP
ftp = FTP()
timeout = 30
port = 21
ftp.connect('xx.xx.xx.xx', port, timeout)  # 連線FTP伺服器
ftp.login('user', 'pass')  # 登入
print(ftp.getwelcome() ) # 獲得歡迎資訊
ftp.cwd(remotedir)  # 設定FTP路徑
list = ftp.nlst()  # 獲得目錄列表
print(list)
for name in list:
print(name)  # 列印檔名字
path = localdir + name  # 檔案儲存路徑
f = open(path, 'wb')  # 開啟要儲存檔案
filename = 'RETR ' + name  # 儲存FTP檔案
ftp.retrbinary(filename, f.write)  # 儲存FTP上的檔案
#ftp.delete(name)  # 刪除FTP檔案
#ftp.storbinary('STOR ' + filename, open(path, 'rb'))  # 上傳FTP檔案
ftp.quit()  # 退出FTP伺服器
#壓所資料夾成zip
import zipfile
def zip_dir(dirname,zipfilename):
filelist = []
if os.path.isfile(dirname):
filelist.append(dirname)
else :
for root, dirs, files in os.walk(dirname):
for name in files:
filelist.append(os.path.join(root, name))
zf = zipfile.ZipFile(zipfilename, "w", zipfile.zlib.DEFLATED)
for tar in filelist:
arcname = tar[len(dirname):]
#print arcname
zf.write(tar,arcname)
zf.close()
if name == 'main':
zip_dir(localdir, backupdir)
#刪除資料夾
import shutil
if os.path.exists(localdir):
shutil.rmtree(localdir)


標題:pandas to_csv
標籤:python pandas 匯出csv csv 

新手發問
寫了一個程式去很多個csv檔找特徵,需要把這些找到的存成一個csv檔
但type好像跑掉了
原本的

後來的

附上程式碼

求大神幫忙


標題:python sqlite3的編輯測試寫入失敗
標籤:python sqlite3 

import sqlite3

conn = sqlite3.connect("test.db")
cursor = conn.cursor()
print('Connect ok')

#建立表
cursor.execute(
'''CREATE TABLE HUMAN
(ID INT PRIMARY KEY NOT NULL,
NAME TEXT NOT NULL,
AGE INT NOT NULL);''')

print('Table created.')
conn.commit()

#新增資料
cursor.execute("INSERT INTO HUMAN (ID,NAME,AGE) VALUES (?,?,?)",(1, 'Wendy', 16))

不知道為什麼
無法寫入
這是正常現象嗎?
還是我的程式碼問題?


標題:Python 請問怎麼把網頁表格變成CSV之後不會變成亂碼
標籤:python3 網頁爬蟲 

import requests
import pandas as pd
import numpy as np
import csv
res = requests.get("https://isin.twse.com.tw/isin/class_main.jsp?owncode=&stockname=&isincode=&market=1&issuetype=1&industry_code=&Page=1&chklike=Y")

df = pd.read_html(res.text)[0]

df = df.drop([0,1,5,8,9],axis=1)
df.columns = df.iloc[0]
df = df.iloc[1:]
df = df.set_index("有價證券名稱")
df = df.to_csv()
print(df)
with open('D:\A/df.csv','a',encoding ='utf-8')as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(df)

我想把抓下來的網頁資料轉成excel可是轉成之後反而會出現亂碼要怎麼更改
還有一個問題是能不能只把有"價證券名稱"這段資料留下就好?


標題:Python_CNN_影像辨識問題與進行預測
標籤:python 預測 影像辨識 影像分類 影像預測 

model = tf.keras.models.Sequential()
model.add(tf.keras.layers.Conv2D(filters=16, kernel_size=(2, 2),
padding="same",
activation='relu',
input_shape=(w,h,3)))
model.add(tf.keras.layers.Flatten())
model.add(tf.keras.layers.Dense(50, activation='relu'))
model.add(tf.keras.layers.Dense(units=category,
activation=tf.nn.softmax ))
learning_rate = 0.01
opt1 = tf.keras.optimizers.Adam(lr=learning_rate)
model.compile(
optimizer='adam',
loss='categorical_crossentropy',
metrics=['accuracy'])
model.summary()
with open("model_ImageDataGenerator_myImage.json", "w") as json_file:
json_file.write(model.to_json())
try:
with open('model_ImageDataGenerator_myImage.h5', 'r') as load_weights:
model.load_weights("model_ImageDataGenerator_myImage.h5")
except IOError:
print("File not exists")
checkpoint = tf.keras.callbacks.ModelCheckpoint("model_ImageDataGenerator_myImage.h5", monitor='loss', verbose=1,
save_best_only=True, mode='auto', save_freq=1)
trainData=datagen.flow(x_train,y_train2,batch_size=16)
history = model.fit_generator(trainData,
epochs=20,
callbacks=[checkpoint]
)
model.save('model_defetct_6000.h5')
#測試
score = model.evaluate(x_test, y_test2, batch_size=32)
print("score:",score)
predict = model.predict(x_test)
print("Ans:",np.argmax(predict[0]),np.argmax(predict[1]),np.argmax(predict[2]),np.argmax(predict[3]))
predict2 = model.predict_classes(x_test)
print("predict_classes:",predict2)
print("y_test",y_test[:])
for t1 in predict2:
print(dirs[t1])
#圖片顯示
img=x_test[0]
img=img.reshape(w,h,3)
img=img*255
img = img.astype('uint8')
img = cv2.resize(img, (1000, 750), interpolation=cv2.INTER_AREA)
im_bgr = cv2.cvtColor(img, cv2.COLOR_RGB2BGR)
i = np.argmax(predict[0])
str1 = dirs[i] + "   " + str(predict[0][i])
print(str1);
im_bgr = cv2.putText(im_bgr, str1, (10,30), cv2.FONT_HERSHEY_SIMPLEX, 1, (255,0, 0), 1, cv2.LINE_AA)
cv2.imshow('image', im_bgr)
cv2.waitKey(0)
cv2.destroyAllWindows()
因程式碼是看書編寫的
有許多不懂的地方
想詢問一下訓練完的預測
為什麼結果會顯示
predict_classes: [2 0 4 0 7 0 1 4 1 4 0 1]
y_test [2 0 4 0 6 0 1 4 1 4 0 1]
glue
bubble
measling
bubble
ruled
bubble
dent
measling
dent
measling
bubble
dent
glue   0.99999416
只有最後一個glue 有出現準確度0.99999416
而圖片顯示部分則會顯示橫條波浪紋
看似九張照片共同在一視窗內
若我只想要單一張圖像的話
該如何更改呢?
另外若我要以另外圖案讓訓練好模組進行預判
是先呼叫h.5檔案後進行預測嗎?
也是需要先將圖片前置處理後才能放入模組預測
然後再恢復原圖規格顯現出來嗎?
因為不太懂原理
問題很多再麻煩高手幫忙了
謝謝


標題:Python Tkinter Entry 不輸入直接空值送出 讓他判斷你沒有輸入任何東西跳出提示
標籤:python3 enrty none空值 

各位前輩好 小弟正在練習寫一個記錄生活英文單字及中文的小程式遇到一個問題
def but():

    with open ("英文單字.txt",'a' , encoding='utf-8') as engtext:
        
        eng = var.get()
        chi = varchi.get()
        engtext.write("\n"+eng+" "+chi)
        print(eng,chi)
        tk.Label(root,text='已送出!',bg='skyblue',font='80',width=8,height=2).place(x=200,y=250)

        if eng and chi == "":
            messagebox.showinfo("錯誤!","填寫不完全!")
            print("Error")


當我不輸入Enrty直接提交的話 正常來講我這條要發揮作用 但卻沒觸發
if eng and chi == "":
            messagebox.showinfo("錯誤!","填寫不完全!")
            print("Error")

下列方式也有嘗試過
if eng and chi == False:
if eng and chi == None:
請問各位前輩該如何修改呢?


標題:Python的CUDA_VISIBLE_DEVICES環境設定問題
標籤:python,pytorch 

我把NVIDIA，CUDA，CUDANN等環境都設定好了，但執行CUDA_VISIBLE_DEVICES=0卻讀不到是什麼問題啊






標題:使用 python 還原差分有疑問， 問題： .cumsum()
標籤:python arima .cumsum() .diff() 還原差分 

# -*- coding: utf-8 -*-
import pandas as pd
from tkinter import filedialog
import tkinter as tk
from tkinter import StringVar
from tkinter import ttk
from statsmodels.tsa.arima_model import ARIMA
from datetime import datetime,timedelta,date,time
import warnings
warnings.filterwarnings('ignore')
def op():
    try:
        afew = int(gap01_entry.get())
    except:
        print('沒輸入天數')
        result_label.configure(text = '沒輸入天數')
    sfname = filedialog.askopenfilename(title='選擇 yahoo finance excel ', filetypes=[('Excel', '*.xlsx'), ('All Files', '*')])
    filename = sfname
    df = pd.read_excel(filename,header=0,parse_dates=True,index_col=0,squeeze=True)
    d = pd.date_range(df.index.min(),df.index.max())
    res = pd.Series(df['Close'],d)
    res = res.dropna()
    '''
    B 是按工作日：星期一至五來排
    D 是按每天來排
    '''
    mode = 'B'
    res.index = pd.DatetimeIndex(res.index).to_period(mode)
    '''
    panda serie to data frame
    '''
    df1 = pd.DataFrame(res)
    ddf1 = df1.diff().dropna()
    print(ddf1)
    cols = list(df1.columns)
    tree = ttk.Treeview(root)
    tree.pack()
    tree["columns"] = cols
    for i in cols:
        tree.column(i,anchor="center")
        tree.heading(i,text=i,anchor='center')
    for index, row in df.iterrows():
        tree.insert("",'end',text = index,values=list(row))
    tree.place(relx=0,rely=0.1,relheight=0.5,relwidth=1)
    r = ARIMA(ddf1,(1,2,0))
    model_fit = r.fit(disp=0)
    pred = model_fit.predict(start = df.index.max()+timedelta(0), end = df.index.max()+timedelta(afew),typ='levels',dynamic =True)
    '''
    cumsum 還原
    '''
    tsr = pd.Series([res[0]], index=[res.index[0]]).append(pred).cumsum()
    dfp = pd.DataFrame(tsr)
    '''
    dfp = dfp.loc[df.index.max()+timedelta(1):df.index.max()+timedelta(afew)]
    加這行或不加這行的做用
    加：  預測結果可能已算好所有日期的預測值，只是選擇從原始資料的最後斷點日期繼續開始，往後預測值而已。
    不加：預測結果可能會重疊到原始資料後期某段時間，二者開始重合，預測結果開始接觸原始資料某段時間，繼續往後產出預測值，兩兩可以比較。
    '''
    dfp = dfp.loc[df.index.max()+timedelta(1):df.index.max()+timedelta(afew)]
    dfp.columns = [str(afew)+' 天左右的預測價格']
    print(res)
    print(dfp)
    c =list(dfp.columns)
    treep = ttk.Treeview(root)
    treep.pack()
    treep['columns'] = c
    for i in c:
        treep.column(i,anchor="center")
        treep.heading(i,text=i,anchor='center')
    for index, row in dfp.iterrows():
        treep.insert("",'end',text = index,values=list(row))
    treep.place(relx=0,rely=0.6,relheight=0.5,relwidth=1)
#print('-----'+ str(afew) +' day forecast predict data-----\n'+str(pred))
def main():
    global root
    root = tk.Tk()
    root.geometry("800x600")
# 只能輸入數字的數字框
    def test(content):
        if content.isdigit() or (content==""):return True
        else:return False
#請輸入想要幾天的資料
    v01=StringVar()
    testCMD=root.register(test)
    gap01_frame = ttk.Frame(root)
    gap01_frame.pack(side=tk.TOP)
    gap01_label = ttk.Label(gap01_frame, text='請輸入想要幾天的資料（預設六十二天 約略預測二個月）')
    gap01_label.pack(side=tk.LEFT)
    global gap01_entry
    gap01_entry = ttk.Entry(gap01_frame,textvariable=v01,validate='key',validatecommand=(testCMD,'%P'))
    gap01_entry.pack(side=tk.LEFT)
    gap01_entry.insert(0, "62")
    global result_label
    result_label = tk.Label(root)
    result_label.pack()
    B1 = tk.Button(root, text="打開 yahoo finance excel ",command = op).pack()
    root.mainloop()
if __name__=='__main__':
 main()

有沒有 .cumsum（） 還原差分的差別
有：先將原始資料差分，再將差分後的原始資料置入 arima ， arima 預測完的資料用 .cumsum（）還原回來
預測結果漲跌幅度大
沒有：直接將原始資料置入 arima
預測結果波動不大，趨近於某一值
不好意思打擾各位大大了！請問各位大大，有什麼還原差分的辦法呢？謝謝！


標題:如何把圖像中的 【不正常扭曲】處 標示 出來
標籤:python 影像處理 水波紋處理 特徵搜尋 邊緣搜索 

希望最後可以對 【不正常扭曲】 的地方標示出來,
如下圖 :

我做了如下的步驟 :


經過 Gray 後的



接著我處理了 Erosion.



對第一次 Erosion 後的, 做 Threshold 處理:



對 Threshold 後的, 再 Erosion 一次 :



我的目的是, 要找出這張圖像的 【不正常扭曲】處.
做完上述步驟後, 我試了一些不同的動作,
但是, 好像都沒有辦法找出來 【不正常扭曲】處.
接著, 就不知道該如何做了.
有沒有哪位大神可以幫幫忙 提示一下.
謝謝.
以下, 為我用 Python 做的步驟 :
定義一個顯示圖片的 function
def displayIMG(img, windowName):
cv2.namedWindow(windowName, cv2.WINDOW_NORMAL)
cv2.imshow(windowName, img)
cv2.imwrite(windowName + '.jpg', img)
1.讀取圖檔：讀取圖片檔並顯示：
image = cv2.imread(image_filename)
displayIMG(image, "Original")
2.轉換為灰階
gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
name = "Gray"
draw = gray
displayIMG(draw, name)
3.做 Erosion 處理
kernel = np.ones((3, 3), np.uint8)
erosion = cv2.erode(gray, kernel, iterations=2)
name = "Gary_Erosion"
draw = erosion
hist = plotHistogram(draw, name)
max_gray = max(hist)
print('Max Gray = ', max_gray)
displayIMG(draw, name)
4.做 Threshold
(T, thresh) = cv2.threshold(gray, 120, 255, cv2.THRESH_TOZERO)
name = "Threshold_Gray"
draw = thresh
displayIMG(draw, name)
plotHistogram(draw, name, max_gray)
5. 對 Threshold 後的, 再 Erosion 一次.
kernel = np.ones((3, 3), np.uint8)
erosion2 = cv2.erode(draw, kernel, iterations=5)
name = "Gary_Threshold_Erosion"
draw = erosion2
hist = plotHistogram(draw, name, max_gray)
displayIMG(draw, name)


標題:用Python或R語言整理dataTable資料匯整問題
標籤:datatable python r 

請教各位前輩，如何使用Python或R語言來重新整理Table的資料
需求:一張Table裡存有多筆Type群組資料，假設每組資料各有100筆資料，各有其值(Value)，我想要截取出每組資料集裡Index為95和5的資料，重新匯整為一張Table如圖2所示。
語法很不熟，不知道該怎麼匯整。。。＞＜
圖1.原始資料範例

圖2.預期整理結果

Python or R
dataTable = Document.Data.Tables["myTable"]
rowCount = dataTable.RowCount
rowsToInclude = IndexSet(rowCount, True)
cursor1 = DataValueCursor.CreateFormatted(dataTable.Columns["Count"])
idx=0
for row in dataTable.GetRows(rowsToInclude, cursor1):
    found=False
    aTag = cursor1.CurrentValue
    idx=idx+1



標題:關於Mac終端機和下載python3問題
標籤:python3 zsh shell mac 

本人非IT專業出身，最近自己在自學的初始階段面臨了一些問題
一開始在網上下載完python和visual code後
以為可以開始自學python的旅程
可是只順利了一天
visual code就顯示叫我轉換到zsh和更改python版本
因為不知道如何使用，就先上網找尋答案
先在系統偏好裡面更改shell 從bash到zsh
之後以為成功了..visual code卻顯示要在終端機上更改
之後在終端機更改成功後，要開始按照網路上教學下載python3(網站新版本已下載，但也被要求終端機操作）
卻一下說需要下載Homebrew 一下要 om my zash(這兩個已經下載完成）後來以為能下載python3了，終端機卻顯示
➜  ~ $ python3 --version
Python 3.6.3
zsh: command not found: $
/System/Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python: can't open file '3.6.3': [Errno 2] No such file or directory
不知道是不是哪裡沒設定好，才一直出現
zsh: command not found: $
想請問有沒有人也遇過相同的問題，之後是如何解決的，謝謝大家！


標題:呼叫class的方法，加不加括號的差異
標籤:python3 bound object 

不加括號
class Bank_account():
    def password(self):
        return "password:123"

andy = Bank_account()
print(andy.password)

不加括號，輸出結果
<bound method Bank_account.password of <__main__.Bank_account object at 0x0000012C834FF520>>


加括號
class Bank_account():
    def password(self):
        return "password:123"

andy = Bank_account()
print(andy.password())

加括號，輸出結果
password:123

我的理解是
不加括號是去查看該物件綁定的方法
加括號是去查看該物件的方法內容
想請問各位大大們，我的理解是否有誤，煩請指正
延伸題 @property
class Bank_account():
    @property
    def password(self):
        return "password:123"

andy = Bank_account()
print(andy.password)

andy.password = "password:456"
print(andy.password)

預期的錯誤
password:123
Traceback (most recent call last):File "D:/, line 9, in <module> andy.password = "password:456" AttributeError: can't set attribute

若將第7行加上括號
print(andy.password())
則出現如下錯誤
Traceback (most recent call last):File "D:/", line 7, in <module>
print(andy.password()) TypeError: 'str' object is not callable

想請教為何遇到@property後，就不加括號；表示在讀取屬性時僅能查看?!
再請大大們指正了~
謝謝


標題:想在openwrt下安裝指定版本python
標籤:linux openwrt r2s python 

1.目前使用R2S 裡面的python包是3.7版本，似乎無法指定版本安裝
2.目前理想的版本是python3.5.2
3.有看到可以自製ipk檔放到系統安裝，還沒找到在windows下製作ipk檔的詳細方法，不知各位大大有沒有詳細資料給小弟參考參考。感謝!!


標題:Python 爬蟲寫入文字檔案數量不對
標籤:python python寫入 webcrawl 

各位高手大大們好：
小弟是python新手，最近完成了第一個自己爬蟲程式，目的是爬批踢踢股票版的標題再存入txt檔中。詳細程式碼如下。目前遇到一個問題是：「寫入txt檔的標題筆數太少，只有20幾筆資料」檢查過後也不知道是哪裡出了問題，希望有朋友可以指點我一點方向ＱＱ
小弟第一次發文，如有任何錯誤之處還請海涵！
-- coding: utf-8 --
import requests
from bs4 import BeautifulSoup
import time
def webwebweb(URL):
my_headers = {'cookie': 'over18=1;'}
response=requests.get(URL,headers=my_headers)
soup=BeautifulSoup(response.text,"html.parser")
titles=soup.find_all("div", class_="title")
file = open("stockData.txt", mode="w")
for title in titles:
file.write(title.text.strip()+" \n ")
print(title.text.strip())
file.close()
start = 4993
number = 20
end = start-number
for i in range(start,end,-1):
link= "https://www.ptt.cc/bbs/Stock/index"+str(i)+".html"
webwebweb(link)
time.sleep(0.1)




標題:使用 python arima 預測跨月分資料時有疑問， 問題： .to_period('B') 或 .to_period('D')
標籤:python arima 

# -*- coding: utf-8 -*-
import pandas as pd
from statsmodels.tsa.arima_model import ARIMA
from datetime import datetime,timedelta,date,time
import warnings
warnings.filterwarnings('ignore')
filename = '03.xlsx'
df = pd.read_excel(filename,header=0,parse_dates=True,index_col=0,squeeze=True)
d = pd.date_range(df.index.min(),df.index.max())
res = pd.Series(df['Close'],d)
res = res.dropna()
print('-----original data-----')

res.index = pd.DatetimeIndex(res.index).to_period('B')

print(res)
r = ARIMA(res,(1,2,0))
model_fit = r.fit(disp=0)
afew = 122
pred = model_fit.predict(start = df.index.max()+timedelta(0), end = df.index.max()+timedelta(afew),typ='levels',dynamic =True)
print('-----'+ str(afew) +' day forecast predict data-----\n'+str(pred))

有 res.index = pd.DatetimeIndex(res.index).to_period('B') 這行就可行

沒有 res.index = pd.DatetimeIndex(res.index).to_period('B') 這行就報錯

主要錯：
一、 only integers slices (:) ellipsis (...) numpy.newaxis (None) and integer or boolean arrays are valid indices
二、 The end argument could not be matched to a location related to the index of the data
不好意思打擾各位大大了！請問各位大大知道為什麼會這樣嗎？謝謝！


標題:想請教有關於 Python "pyautogui"這個套件之中的"confirm box"的 button 行為設定
標籤:python 3 pyautogui 


如圖所示，我想請教點擊 button 之後的行為是否能夠自行定義，例如點擊"確定"之後去執行指定的動作，而點擊"取消"後將視窗關閉。
我在官方的說明頁面
https://pypi.org/project/PyMsgBox/ https://pyautogui.readthedocs.io/en/latest/msgbox.html
找不到與此設定的相關說明，因此上來向各位先進求教，小弟我先在此感謝各位大德的幫助。
在"Tkinter"這個GUI套件中(如下面這行指令)可以透過"command"去定義按鈕的行為，
Button(window,text="Exit",width=15,command=window.destroy)
所以我想"confirm box"的 button 應該是有辦法自行定義行為才對?


標題:python爬蟲
標籤:python 爬蟲 

小弟是自學程式的新手,在爬蟲上遇到一些問題,想請各位前輩們指點,
這是我嘗試想要爬臺灣期貨交易所行情資訊網的程式碼。
執行後會被免責說明阻擋,無法抓取到網址下的內容,還請各位前輩們能給小弟指點一下。
import requests
from bs4 import BeautifulSoup
url = 'https://mis.taifex.com.tw/futures/RegularSession/EquityIndices/FuturesDomestic/'
webpage = requests.post(url)
soup = BeautifulSoup(webpage.text,'lxml')
print(soup.text)


標題:關於python_regular_expression的問題
標籤:python 

請問下面的這個程式,我ip的第一位提取出來都只有一位數,請問哪位大大可以幫忙解答?
import re
str1 = """TCP source  12.168.189.167:32806 destination  1.78.5.128:65247, idle 0:00:00, bytes 74, flags UIO
TCP source  192.168.189.167:80 destination  137.78.5.128:65233, idle 0:00:03, bytes 334516, flags UIO """
print(str1)
list1 = str1.split('\n')
for x in list1:
result = re.match(
".(\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}):(\d{1,5}).(\d{1,3}.\d{1,3}.\d{1,3}.\d{1,3}):(\d{1,5}).bytes\s+("
"\d+).flags\s+(\w)\s", x).groups()
print(result)
結果會變成這樣
('2.168.189.167', '32806', '1.78.5.128', '65247', '74', 'UIO')
('2.168.189.167', '80', '7.78.5.128', '65233', '334516', 'UIO')


標題:如何自動化分割圖中的小圖
標籤:影像處理 python c/c++ c++ 

如題，小弟目前想寫code將圖片自動分割為小區塊，下面例子:

原圖(比如一個.png檔)


分割概念圖(可以看到我把想分割的區塊用紅色框出來，所以程式跑完後這張圖應該要有8個"子圖")



這是我想做的事情，但是不知道該從何下手。
不知道否有高手能夠指點下該怎麼做?
目前是希望能夠用python(最好有相關套件可以用)或C++完成(當然其他適合的程式語言也無妨)，或是有其他應用程式級的軟體可以達到上述要求也可以。
謝謝各位~~
EDIT
十分感謝下面各位大大的回答，不過可能是我表達不夠清楚導致大家誤解我的意思了QQ
我想達成的效果是將一張"截圖"(已經是.png這類的圖檔，而非還在網頁的形式)分割成若干個小圖(而想要分割的部分如圖2紅色框出來的部分所示)。
簡單來講，input應是一張圖(比如一張.jpg)，而output是若干張小圖(n張.jpg)
不過仍然很感激回答的大大，也讓我學到一些其他的東西~


標題:python svr輸出圖及準確度問題
標籤:python svr 


我想用SVR建立三個X(紅色框)一個Y(藍色框)的迴歸模型
目前寫出下面的程式碼,可以執行但不知道對不對,想麻煩大家幫我看看
程式檔案下載(會跳出廣告,再按一下可以下載):https://www.sendspace.com/file/z3qyw3
import tensorflow as tf
import numpy as np  # 導入numpy
import pandas as pd # 導入pandas
from sklearn.svm import SVR  # 使用SVM中的SVR
from google.colab import drive #連接雲端硬碟
import matplotlib.pyplot as plt #畫圖

drive.mount('/content/drive',force_remount=True)
data_path = '/content/drive/MyDrive/drill_parameter.csv' #導入data
drill = pd.read_csv(data_path) #drill為原始資料檔
df=pd.DataFrame(drill)

x=df.loc[:,['Spindle speed', 'Feed rate', 'Point angle']] 
y=df['Thrust force']

# 資料分割
from sklearn.model_selection import train_test_split #分割資料的函式
x_train, x_test, y_train, y_test = train_test_split(x.values, y.values, random_state=10, train_size=0.8)

#正規化
from sklearn import preprocessing
from sklearn.preprocessing import StandardScaler #標準化
ss_x = StandardScaler()
ss_y = StandardScaler()
x_train = ss_x.fit_transform(x_train)
x_test = ss_x.fit_transform(x_test)
y_train = ss_y.fit_transform(y_train.reshape(-1, 1))
y_test = ss_y.fit_transform(y_test.reshape(-1, 1))

#建立SVR
svr_rbf = SVR(C=1e3, kernel='rbf', gamma='auto')
svr_rbf.fit(x_train,y_train)
svr_predict=svr_rbf.predict(x_test)

#模型評估
from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error
print('\nThe value of default measurement of rbf SVR is', svr_rbf.score(x_test, y_test))
print('R-squared value of rbf SVR is', r2_score(y_test, svr_predict))
print('The mean squared error of rbf SVR is', mean_squared_error(ss_y.inverse_transform(y_test), ss_y.inverse_transform(svr_predict)))
print('The mean absolute error of rbf SVR is', mean_absolute_error(ss_y.inverse_transform(y_test), ss_y.inverse_transform(svr_predict)))
print(svr_rbf.intercept_) #迴歸模型的截距

#輸出圖
plt.scatter(svr_predict, y_test, color= 'black', label= 'Data') #數據點
plt.plot(svr_predict, svr_predict, color= 'red', label= 'RBF model') #迴歸線
plt.xlabel('data')
plt.ylabel('quality')
plt.title('Support Vector Regression')
plt.legend()
plt.show()

覺得有問題的地方是:
1.正規化→跟用EXCEL算不一樣
2.輸出圖→在網路上有看到放x_train 跟 svr_predict的程式,可是我放了x_train就會顯示x and y must be same size
3.重新切資料或調SVR裡的C,r square都上不去了,想問是不是資料筆數太少或應該調整其他地方(我共有75筆資料,這裡只放上40筆)
是程式超新手,也是第一次發文,如果有錯麻煩大家指正,謝謝!!!


標題:Python問題，在刷Leetcode 1239題時遇到
標籤:python leetcode backtracking 

各位好，以下是本人的code (是用很粗糙的backtracking寫法)
不知為何會出現 local variable "bitArr" referenced before assignment 這個錯誤
但若將bitArr = prevArr這行拿掉，就不會報錯了，蠻詭異的
敝人實在不知該從何debug起，煩請高手指點
class Solution(object):
    def maxLength(self, arr):
        """
        :type arr: List[str]
        :rtype: int
        """
        
        bitArr = [0]*26
        self.res = 0
        
        def backtracking(start):
            self.res = max(self.res, sum(bitArr))
            prevArr = bitArr
            for i in range(start, len(arr)):
                duplicate = False
                for char in arr[i]:
                    if bitArr[ord(char)-ord('a')] == 1:
                        duplicate = True
                        bitArr = prevArr
                        break
                    bitArr[ord(char)-ord('a')] = 1
                if duplicate:
                    continue
                else:
                    for char in arr[i]:
                        bitArr[ord(char)-ord('a')] = 1
                    backtracking(i+1)
                    for char in arr[i]:
                        bitArr[ord(char)-ord('a')] = 0
                    
        backtracking(0)
        
        return self.res



標題:擷取肌電感測器訊號到個人電腦
標籤:python virtual com port mcu c 

各位前輩們好
目前小弟正在做一樣專題,需要使用現有感測器設備來做資料的擷取,官方雖然有提供免費的軟體可供使用者做資料的檢視以及儲存,但我的需求是希望能夠及時(Real-Time)的透過他的設備:USB Dongle(插在PC上)來跟感測器(肌電感測器:位於人體身上)做通訊,擷取我所需要的資料後,需要做資料處理演算提供最後結果回傳到另外一塊Arm Based的MCU做機電控制。以上是需求的描述。
設備的官方說明文件連結如下:
https://www.otbioelettronica.it/en/products/hardware/duelite
說明文件通訊設定部分如下截圖:

小弟本人比較擅長使用MATLAB、C語言,倘若Python能夠做到上述需求我也能夠嘗試看看。目前個人的解決想法大概是需要透過程式創建Virtual COM port,並設定如上的規格,發送特定字元如上所說為(0x80),接著可能就是照著某通訊協議與設備做通訊,解析資料跟演算,對於怎麼回傳訊號就目前還沒有想法了。希望前輩們提供一點實作方向給我,謝謝!


標題:python爬蟲問題
標籤:python #爬蟲 表格 

大家好
我想詢問爬蟲問題再麻煩各位高手解答
import requests
from bs4 import BeautifulSoup
mlb_url='https://www.baseball-reference.com/boxes/NYN/NYN202007250.shtml'
headers = {"Agent-User": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36"}
res=requests.get(mlb_url,headers=headers)
res.encoding = 'utf8'
html_doc=res.text
#print(html_doc)
soup=BeautifulSoup(res.text,'lxml')
#print(soup.prettify())
#print(soup.select("tfoot > tr > td"))
print(soup.select("#div_AtlantaBravesbatting.table_container is_setup "))
我用了很多方式可是他print出來都是[]空的
可是我明明是照網站的html位置找的可是就是回傳空值
想請問各位還有甚麼方法能把表格爬下來嗎?
再麻煩各位解惑


標題:使用 python arima 預測跨月分資料時報錯， 問題： only integers ......
標籤:python arima pandas dataframe pandas.dataframe 

一、我想要預測 excel xlxs data frame 的資料，來產出幾天後的預測資料
二、樣本時間起訖：二零一七年五月至八月
三、 original example data 來自 yahoo fininance ， but easy to go ，我只想要取 df['Date'] 與 df['Close']

code
import pandas as pd
from statsmodels.tsa.arima_model import ARIMA
from datetime import datetime,timedelta,date,time
import warnings
warnings.filterwarnings('ignore')

df = pd.read_excel('01.xlsx',header=0,parse_dates=True,index_col=0,squeeze=True)
d = pd.date_range(df.index.min(),df.index.max())
res = pd.Series(df['Close'],d)
res = res.dropna()
print('-----original data-----')
print(res)
#arima
r = ARIMA(res,(2,1,0))
model_fit = r.fit(disp=0)
afew = 130
pred = model_fit.predict(start = df.index.max()+timedelta(1), end = df.index.max()+timedelta(afew),typ='levels',dynamic =True)
print('-----'+ str(afew) +' day forecast predict data-----')
print(pred)

沒報錯：

2017-05-03 to 2017-05-27
預測五月資料
有報錯：

· 2017-05-03 to 2017-06-10
· 2017-05-03 to 2017-07-12
· 2017-05-03 to 2017-08-30
只要我想預測跨月分資料，就報錯
請問該如何解決呢？謝謝！


標題:Python List 迴圈加減以及條件篩選,不重覆元素
標籤:python 3 篩選條件 迴圈加減 

IT高手
小弟又有問題了，我想將
X=[1,2,3,4,5,6,7,9] 分別加上1,2,3,4,5以及減掉1,2,3,4,5，並且過濾小於0以及大於10的元素，組成新的不重複元素的List.
新List = [1,2,3,4,5,6,7,9,2,3,6,8,......]
For i in X:
1st = i+1:
2nd = i+2:
我只會這總笨方法，希望有IT高手教我該如何寫
謝謝


標題:使用 python arima 報錯： only integers ......
標籤:python arima pandas dataframe pandas.dataframe 

一、我想要預測 excel data frame 的資料，來產出幾天後的預測資料
二、使用 arima 來預測，但報錯——
only integers, slices (:), ellipsis (...), numpy.newaxis (None) and integer or boolean arrays are valid indices
import pandas as pd
from statsmodels.tsa.arima_model import ARIMA
import warnings
warnings.filterwarnings('ignore')
df = pd.read_excel('01.xlsx',header=0,parse_dates=[0],index_col=0,squeeze=True)
d = pd.date_range(df.index.min(),df.index.max())
df = df[['Close']]
df1 = pd.Series(df['Close'],d)
df1 = df1.dropna()
r = ARIMA(df1,(1,2,0))
model_fit = r.fit(disp=0)
pred = model_fit.predict(start = '2012-07-31', end = '2012-09-01' , typ='levels')
print(pred)

請問該如何解決呢？謝謝！


標題:python flask伺服器wifi ip問題
標籤:python web api flask 

主要的碼大概是這些
from flask import Flask, render_template, jsonify, request, Response, make_response
from flask_cors import CORS
from flask_cors import cross_origin
apiApp = Blueprint('apiApp', __name__)
CORS(apiApp,supports_credentials=True)
@apiApp.route("/hi")
@cross_origin()
def helloWorld():
    return "Hello, flask_run"

本地端網址可連線到

想用wifi ip連到伺服器 本機ping的到 網址連不到

一開始以為是cors的問題可是加了好像沒效果。
求各路大神 解惑 感恩


標題:python迴圈/函式輸出電子訊號
標籤:python 電機 訊號處理 程式設計 控制 

本人目前想做個由電腦控制的開關
控制電腦旁的檯燈開啟跟關閉
但是迴圈什麼的會寫
卡在把輸出結果轉為電子訊號開啟/關閉檯燈
流程如圖:

function輸出True後
該怎麼以電腦內的訊號控制檯燈開關


標題:財金系背景想轉工程師該先學C還是Python?建議自學嗎？
標籤:財金 自學 補習 python c 

請問像我一樣財金系背景，想學程式語言建議從哪方面學起？我知道可能要看自己未來的發展去著手，但因為爬文發現有分兩派，以目前為止我認知的訊息是財金背景可以做數據分析以及AI人工智慧，所以學Python，會比較好，希望大家可以給我一點意見，謝謝。


標題:圖像風格轉換如何下Python指令
標籤:python3 

實作Neural-Style-Transfer-Decorative-Pattern-Synthesis中
從Github中下載了檔案，檔案連結:https://github.com/jysh1214/Neural-Style-Transfer-Decorative-Pattern-Synthesis
說是使用python3 neural_style_transfer.py img/input.jpeg img/style.jpeg result指令就可以跑
想問指令要哪裡打cmd?python的直譯器，還是另建python檔去寫?


標題:tensorflow 載入自己訓練好的 model 錯誤
標籤:tensorflow python 

我如果直接訓練的話，把 model 輸出後再用 model = load_model('./my_model.h5') 讀取是正常的
但如果把註解的部分拿掉，model.fit 換成使用註解的，訓練完後再把 model 載入就會出問題?
請問怎麼解決? 用了半天用不出來QQ
1_mnist.py
import tensorflow as tf
from tensorflow.keras.preprocessing.image import ImageDataGenerator

mnist = tf.keras.datasets.mnist
(x_train, y_train), (x_test, y_test) = mnist.load_data()
x_train, x_test = x_train/255.0, x_test/255.0
# x_train = x_train.reshape(x_train.shape[0], 28, 28, 1)
# x_test = x_test.reshape(x_test.shape[0], 28, 28, 1)

# image_gen_train = ImageDataGenerator(
#     rescale=1./1.,
#     rotation_range=45,
#     width_shift_range=15,
#     height_shift_range=15,
#     horizontal_flip=True,
#     zoom_range=0.5
# )
# image_gen_train.fit(x_train)

model = tf.keras.models.Sequential([
    tf.keras.layers.Flatten(),
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam',
                loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=False),
                metrics=['sparse_categorical_accuracy'])

# model.fit(image_gen_train.flow(x_train, y_train, batch_size=32), epochs=5)
model.fit(x_train, y_train, batch_size=32, epochs=5)
model.summary()
model.save('my_model.h5')

使用註解掉的程式碼會出現以下錯誤
raise ValueError('The last dimension of the inputs to `Dense` '
ValueError: The last dimension of the inputs to `Dense` should be defined. Found `None`.



標題:leetcode寫題目測資時遇到問題.
標籤:python leedcode 

class Solution:
    def lengthOfLastWord(self, s: str) -> int:
        listt=s.split(" ")
        ans=len(listt[-1]) if len(listt[-1])!=0 else 0
        return ans


測資遇到"a "時不合，請幫我看一下程式碼錯在哪?謝謝


標題:Python 想找出List連續出現次數,以及連續未出現次數
標籤:python 3 連續出現次數 連續未出現次數 

IT高手
小弟我想問，在List中
X = [1,2,3],[1,4,5],[2,3,4],[2,5,6],[2,7,8]...(後面)
我想從後面往前看哪個元素是連續出現，並記錄連續出現次數以及沒有出現的次數。
以上面的Cases來說，希望得到結果為
連續出現次數:[(1,2),(2,3),(3,0),(4,2),(5,0),(6,0),(7,0),(8,0)]
連續未出現次數:[(1,3),(2,0),(3,2),(4,2),(5,1),(6,1),(7,0),(8,0)]


標題:Python 計算List中的元素，並取出現次數多的前3名
標籤:#python3 出現次數 前幾名 

各位IT高手
小弟我想問，我想取出在X List中的出現次數多的前幾名元素，但寫到這邊就有錯誤訊息
希望能請高手幫忙解答，要如何修改?
謝謝高手
X = [1,5,6,7,8,49],[8,9,12,34,55,30],[6,7,8,9,3,2],[1,8,9,30,55]

from collections import Counter
o = x[:20]
for i in o :
  for j in i :
      n = Counter(j)
      
      TypeError: unhashable type: 'list'



標題:這個問題出在哪?  MYSQL連動pythom
標籤:mysql python連動mysql python 

import numpy
import matplotlib.pyplot as plt
from matplotlib.pyplot import MultipleLocator
from pandas import read_csv
import math
from keras.models import Sequential
from keras.layers import Dense
#from keras.layers import LSTM
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error
import tensorflow as tf
import mysql.connector
import pymysql
import datetime
from datetime import datetime
def create_dataset(dataset, look_back=1):
dataX, dataY = [], []
for i in range(len(dataset)-look_back-1):
a = dataset[i:(i+look_back), 0]
dataX.append(a)
dataY.append(dataset[i + look_back, 0])
return numpy.array(dataX), numpy.array(dataY)
numpy.random.seed(7)
config = {
'user': 'root',
'password': '',
'host': 'localhost',
#'database': 'raspberrydb',
#'database': 'power_mysql,
'database':"pm",
#'raise_on_warnings': True,
}
cnx =  pymysql.connect(**config)
cursor = cnx.cursor()
cursor.execute("SELECT * FROM pm_blockchain_data")
results = cursor.fetchall()
我這樣打哪之前都可以,但不知道現在為什麼有問題了
是MYSQL設定跑掉?
現在MYSQL無法連結我的資料庫
Traceback (most recent call last):
File "C:\TSVSELE_William\Python_code\110_1_27\LSTM_PM_2020_01_11_u4_e50.py", line 49, in 
cursor.execute("SELECT * FROM pm_blockchain_data")


標題:用Python或Cmd擷取xml檔內指定資料
標籤:python batch xml 

我有一個資料夾，目錄結構如下:
sample
--object
--people
--animal
xml範例如下:
DataOut_1.xml
<PDataset>
  <PAMRandom B="1"> 
    <Metadata>
      <MDI key="SMA">1502</MDI>
      <MDI key="SME">3.14</MDI>
    </Metadata>
  </PAMRandom>
  <PAMRandom B="2">
    <Metadata>
      <MDI key="SMA">3394</MDI>
      <MDI key="SME">24.2628</MDI>
    </Metadata>
  </PAMRandom>
</PDataset>

三個資料夾內各有一大堆的xml檔案，我想將特定的內容擷取出並另存成如下方範例的CSV或ODS檔。
Name,B1_SMA,B1_SME,B2_SMA,B2_SME
DataOut_1,1502,3.14,3394,24.2628
參考一些教學後，目前只能做到擷取字串，卻一直無法擷取指定元素的內容，請問這個問題該如何解呢? 解法不限Python，Cmd寫成的批次檔也可以。
謝謝各位 :D
最後附上跑不動的Python
from lxml import etree
import pandas as pd
tree = etree.parse("DataOut_1.xml")
df = pd.DataFrame({
   "B1_SMA" : tree.xpath('/PDataset/PAMRandom/Metadata/MDI*[@key='SMA']'),
})

df.to_csv("output.csv", sep=",", index = None)



標題:leetcode寫題目測資時遇到問題
標籤:leetcode python 


我覺得我寫的應該是沒什麼問題，帶了很多筆數字測驗也ok，但是測資時1534236469這個數字不行，可是1534236469的確在-231 <= x <=231-1的範圍內，所以應該不會要return 0
阿，還是我的程式碼有錯的地方?


標題:LINE bot 使用特殊關鍵字開啟問卷問答後，如何不用重新輸入關鍵字將問卷進行完，而不是都只進行第一題
標籤:python linebot line messaging api 

有關Linebot的範例中，針對文字訊息的處理方式如下：
@handler.add(MessageEvent, message=TextMessage)
def message_text(event):
    line_bot_api.reply_message(
        event.reply_token,
        TextSendMessage(text=event.message.text)
    )

假設使用richmenu針對特定關鍵字回答可以使用:
@handler.add(MessageEvent, message=TextMessage)
def message_text(event):
    parse_text = event.message.text
    same_message = TextSendMessage(text=event.message.text)
    if parse_text == 'question':
        sticker_message = StickerSendMessage(
                    package_id='11538',
                    sticker_id='51626499'
                    )
		line_bot_api.reply_message(event.reply_token, sticker_message)
    else:
		line_bot_api.reply_message(event.reply_token, same_message)


但是假設要設計一個問卷的話，使linebot抓到question這個關鍵字之後，使用者回覆的話依然每次會進到message_text這個迴圈當中，請問要如何修改可以使linebot在處理這個messages時能夠繼續handle其他的訊息?
而不是都只能做到問卷的第一題沒辦法繼續做要持續下關鍵字才能達成?


標題:python 監聽輸入
標籤:python 

大家好,目前自己在研究python ,想請問我爬到一個網頁後可以透過監聽去監控一個html的input輸入欄位嗎?? 我做了每5秒印出欄位值可是都只能印出程式預設的值,無法監聽改變後的值。
import threading

from selenium import webdriver
from selenium.webdriver.chrome.options import Options

options = Options()
options.add_argument("--disable-notifications")

chrome = webdriver.Chrome('./chromedriver', chrome_options=options)
chrome.get("https://www.facebook.com/")

email = chrome.find_element_by_id("email")
password = chrome.find_element_by_id("pass")

email.send_keys('xxxxxx@gmail.com.tw')
password.send_keys('xxxxxxx')


def setInterval(val, Time):
    e = threading.Event()
    while not e.wait(Time):
        print('input:' + val)


setInterval(email.get_attribute('value'), 5)



標題:求大神 用Python 裡的pandas讀xml檔
標籤:程式設計 #新手求指導 大神 python xml 

我上網爬了許多文章
也試者用他們的程式碼 還是未能成功
希望各位大神可以教小弟
如果可以的話 希望程式碼有備註讓學習


標題:Python 中的pandas to_excel用法
標籤:python pandas.dataframe excel 資料處理 

目的:將資料夾中所有EXCEL讀取後各自計算最後合併成一個EXCEL，新的EXCEL裡有多個表單
問題:
目前我寫出來的範例如下
#將路徑下副檔名xlsx的取出
import openpyxl
path_domestic = os.path.abspath(os.getcwd()) + '\globle'
non_domestic = glob.glob(os.path.join(path_domestic, '*.xlsx'))
#寫迴圈並計算所需要的資料
for file in non_domestic:
data = pd.read_excel(file)
TQ = data["Qty"].sum()
amount = data['Px'] * data['Qty']
data['Amount'] = amount #新增一欄
#新增一列並寫到data1
new = pd.DataFrame({'Security': '',
'交易所代碼': '',
'Qty': TQ,
'Px': '',
'Fill Time': '',
'Exec Brkr': '',
'Maker/Taker': '',
'Amount': TAmount,
'N': Aver_P}, index=[1])
data1 = data.append(new, ignore_index=True)
#取得股票名稱
name = str(data["Security"][1])
print(data1)
現在問題是我要如何將多個dataframe寫入到一個EXCEL裡?
因為我用data1.to_excel('20210126.xlsx',sheet_name = name)
這樣只會產生一個表單(迴圈會覆蓋過原有檔案)
下圖是資料夾中其中一個檔案



標題:python更改所有表單名稱
標籤:python openpyxl 檔案寫入 pandas excel 

請教python大神
我有一個list[2330,2454,2313,6609]
我想要讀取一個EXCEL('20210126') 並且把所有表單名稱改為list中的名稱 要如何改呢?
import openpyxl
filename = 'C:\Users\011328\Desktop\python\20210126.xlsx'
wb = openpyxl.load_workbook(filename)
name_list = [2330,2454,2313,6609]
for name in name_list:
# print(name)
wb.create_sheet()
*list名單每次都不固定，可能十個以上


標題:python 如何取多個div內容
標籤:python3 beautifulsoup 

請問要怎樣才能取到所有的幣別?
下列只取到一個USD
python:
import bs4
root=bs4.BeautifulSoup(data, "html.parser")
divs=root.find("div",class_="field-item")
print(divs.string)
html:


標題:Python List 元素比對以及篩選條件
標籤:python3 list 比較元素 篩選條件 

IT大大你們好
想詢問當我有兩組List元素，想互相比較並取出符合條件的，要如何寫呢?
EX:
A=[1,2,3,4,5],[3,4,5,7,8],[10,20,45,50,51]
B=[3,5],[2,3],[3,4],[10,50],[4,5],[7,8]
B元素要跟A比較，如果比較結果有超過三組元素，則取出A該中括弧元素
預期得到
A=[1,2,3,4,5],[3,4,5,7,8]
有試過set、compare 等，但是無法寫出要的，
謝謝


標題:linux ubuntu19.3 執行.py會閃退
標籤:linux python3 .py 

如提...執行.py的檔案會閃退
我有在第一行加#!/usr/bin/python3
pip3和python也有安裝，不知道為何會閃退
這支程式主要會自動開啟網頁，連到某個ip去做自動更新的功能
在windows可以正常運行，可是在linux就會閃退QQ


標題:想請教如何增進自己類別和函式的能力
標籤:python python3 class def 

最近在寫一個Side Project
發現自己的函式和類別能力好弱
在寫Side Project時
效率低
擴充能力差
要增加功能時經常要整個改寫
而且寫不太出
容易繼承的父類別
自己寫class去繼承別人的套件時
也挺有障礙的
想請教如何增進自己類別和函式的能力
或者有什麼好文章分享能讓我學習的


標題:為什麼 model 的 loss 在一開始沒幾次後就不會再變化了
標籤:python tensorflow keras machine learning 

各位好，最近剛接觸，還不是很清楚，問題很奇怪的話請見諒 (ง๑ •̀_•́)ง
我使用 keras 裡的數據來練習
可是發現我的 loss 不知道為什麼維持不變，看不出來哪裡怪怪的
從 epoch 1 開始就沒再改變過了
請問要怎麼修改才會比較正常?
謝謝
output

my_model.py
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import datasets

# x: (60000, 28, 28)
# y: (60000,)
(x, y), _ = tf.keras.datasets.mnist.load_data()

# 轉換成 tensor
x = tf.convert_to_tensor(x, dtype=tf.float32)/255   # 讓值範圍在 0 ~ 1
y = tf.convert_to_tensor(y, dtype=tf.int32)
 
train_db = tf.data.Dataset.from_tensor_slices((x, y)).batch(128)

# [b, 784] -> [b, 256] -> [b, 128] -> [b, 10] 
w1 = tf.Variable(tf.random.truncated_normal([784, 256], stddev=0.1))
b1 = tf.Variable(tf.zeros([256]))
w2 = tf.Variable(tf.random.truncated_normal([256, 128], stddev=0.1))
b2 = tf.Variable(tf.zeros([128]))
w3 = tf.Variable(tf.random.truncated_normal([128, 10], stddev=0.1))
b3 = tf.Variable(tf.zeros([10]))

lr = 1e-3

for epoch in range(10):
    print('---', epoch, '---')
    for step, (x, y) in enumerate(train_db):
        # x [128, 28, 28]
        # y [128]
        x = tf.reshape(x, [-1, 28*28])  # [128, 784]
        
        with tf.GradientTape() as tape: # tf.variable
            h1 = x@w1+b1
            h1 = tf.nn.relu(h1)
            h2 = h1@w2+b2
            h2 = tf.nn.relu(h2)
            y_out = h2@w3+b3

            # compute loss
            y_onehot = tf.one_hot(y, depth=10)
            loss = tf.reduce_mean(tf.square(y_onehot-y_out))

        # compute gradient
        grads = tape.gradient(loss, [w1, b1, w2, b2, w3, b3])

        # update 
        w1.assign_sub(w1 - lr*grads[0]) 
        b1.assign_sub(b1 - lr*grads[1]) 
        w2.assign_sub(w2 - lr*grads[2]) 
        b2.assign_sub(b2 - lr*grads[3]) 
        w3.assign_sub(w3 - lr*grads[4]) 
        b3.assign_sub(b3 - lr*grads[5]) 

        if step%100 == 0:
            print(step, '\tloss:\t', float(loss))



標題:python複利計算應用題
標籤:python 

1、小明想要收集齊全12生肖的生肖高粱酒，於每年年初購買屬於該年的生肖酒，每瓶生肖酒的買入價格皆為10,000，且每瓶高粱酒每年以升值2%去計算，請同學寫一個程式，請問直到豬年年末，每瓶生肖酒的價值為多少，將12瓶酒於豬年年末的價值列印出來?
2、承上題，請問直到豬年年末，生肖酒的總價格為多少，並將每年的總價值列印出來
3、小明想要知道他要花多少年(從第一年鼠年就開始計算)這12瓶酒的總價值才會超過1,000,000元?列印出在第幾年時，小明的生肖高粱酒總價值為多少?以及每瓶生肖酒的價值為多少?
不好意思，小弟正在學習python，想知道這幾題有甚麼好解法?
詪請各位前輩指教!感恩!


標題:網路上找得到的code  再請老師/家教解說的價碼?
標籤:#js #c++ #python 3 #css #html 

如題
我覺得網路收費真的挺誇張的  不知道是小弟太菜還是怎樣@@
往往價格都要拉抬至1500~1800的時薪
內容卻只是基本的宣告 變數  函式  迴圈  條件式
聽自學的朋友也都遇到這種狀況過  甚至有人線上教學也是去github抓來用
google或找code都還好  重點是上課你至少要對code解說吧
也講不出東西
project往往都是簡單的爬蟲而已  就要說是"特殊需求"  疑!!?
這到底是在傳道授業  還是在偷拐搶騙?(迷:這...不好說
難道工程師都這麼缺錢嗎0.0
備註:我並不是指責找家教這件事情   但是存在這樣子的"導師"不少
以至於自學/找資源變得更重要了  寧願花十個小時亂找資源  也不希望被這種風氣掃到
往往一堆免費貢獻的大神們乾貨反而更多  更實際....
小弟太弱雞   觀念不清晰  還請各位指點一下  感恩


標題:python數學問題
標籤:python 

「若已知2520可以被2~10的整數整除，請使用程式找出一個最小數字，該數字可以被2~20整除」
請問這有甚麼好的python程式寫法? 謝謝指教!


標題:python 質因數問題
標籤:python3 質因數問題 

題目是:寫出一個function 叫 Primefactor(n)，做質因數分解將參數n傳入之後，回傳一個list儲存n的質因數與該質因數出現次數，例如傳入120時120=22235，回傳[(2,3),(3,1),(5,1)]出來
以下是我寫的，但是我就是不知道怎麼做最後一步回傳出質因數的次數
def prime_factoring(n):
divisor = 2
factors = []
while divisor * divisor <= n:
if n % divisor:
divisor += 1
else:
n //= divisor
factors.append(divisor)
if n > 1:
    factors.append(n)

return factors

aNumber = (int)(input("Enter a number:"));
print(prime_factoring(aNumber))


標題:python編譯後的程式無故自動關閉
標籤:python exe while 

先前使用python寫了程式後用PyInstaller編譯成exe
內容主要是使用while監看另一部機器的狀態
不過啟動後約2天左右會沒有報錯就默默的關閉
請問這可能是哪方面有問題呢?
python版本為3.8.4
PyInstaller版本為3.6


標題:apscheduler小問題
標籤:python3 elastalert elasticsearch apscheduler 

我在跑elastalert
一直遇到
WARNING:apscheduler.scheduler:Execution of job "ElastAlerter.handle_rule_execution (trigger: interval[0:01:00], next run at: 2021-01-07 15:48:51 CST)" skipped: maximum number of running instances reached (1)
請問要如何增大instances
我看了elastalert.py
把self.scheduler = BackgroundScheduler()
改成self.scheduler = BackgroundScheduler('apscheduler.job_defaults.max_instances', 3)
但會報錯
TypeError: init() takes from 1 to 2 positional arguments but 3 were given
還是說可以直接改底層讓python去執行時直接讓實例x3


標題:python關於 wx & subprocess 的語法請益
標籤:python3 subprocess wxpython python系列文章 python 

Hi 大家好
最近在學習實作python
這是一段網路上看到的程式碼並做了些小修改
運用wx & subprocess 模組後 能點一個按鈕同時叫出 兩個cmd 視窗
一個做wget http的，一個https的
但我程式碼這樣改了之後，只會呼叫http的，
想詢問各位大大這段程式碼應該如何改可以同時教出兩個cmd視窗並做不同的呼叫
謝謝各位
b1=wx.Button(panel, label='wget https')
b1.SetFont(font)
self.Bind(wx.EVT_BUTTON,lambda _:subprocess.Popen('cmd /k tools\\wget https://'+tc.GetValue().replace(':',' ')),b1)
self.Bind(wx.EVT_BUTTON,lambda _:subprocess.Popen('cmd /k tools\\wget http://'+tc.GetValue().replace(':',' ')),b1)



標題:(已解決)pandas製圖過程中，如何增設條件
標籤:pandas python jupyter pandas.dataframe 

新手發問若表達不佳請見諒
想請問各大高手
我一開使在設資料條件時，國家是直接隨機選取
但現在想要設下條件是選擇五大洲中(N欄位)，各自自殺數最高(E欄位)的國家(所以會有五個國家)
(讀取的CSV檔內容如下)
請問該如何做修改呢?
(附上完整程式與執行結果)


標題:有辦法讓wechat跟line notify一樣能自動傳訊息嗎?
標籤:python wechat line notify 微信 

最近剛學會用line notify偵測公司監控數據傳即時訊息
主管提到能不能把訊息也推播到wechat上
我只考慮用python寫(因為要用selenium)
查了一下發現有很多個套件可以用(wxpy、itchat等)
但是在登入測試的時候發現一直顯示失敗
KeyError: 'pass_ticket'

查新聞才發現原來在2019年微信已經全面封鎖這種網頁登入的入口了
無關帳號新舊 我跟一堆人借的超老帳號(超過五年)也登入失敗
難道wechat就沒有一個token申請頁面可以讓我像line notify一樣可以即時傳訊息嗎?
沒想到我才剛畢業就面臨如此巨大的難題
我痛恨我的無能
對不起主管


標題:line notify傳送圖片訊息失敗
標籤:python line bot line notify line requests 

我想要寫一個可以讓公司監控系統有error的時候
馬上傳提醒和螢幕截圖的圖片到line裡的程式
目前的狀況:
1.可以成功傳送目前有幾個error的line文字訊息
2.螢幕截圖成功，圖片也成功存到本機路徑
3.但是無法把存下的圖片傳到line上，就是只會傳文字訊息，不會傳圖片訊息
部分程式碼如下:
headers = {
            "Authorization": "Bearer " + "我的token",
            "Content-Type": "application/x-www-form-urlencoded"
        }
     
        params = {"message": a_tags,                
        }
        
        files = {'imageFile': open(r'C:\Users\lala_chen\Desktop\python\warning.png','rb')}
    
        r = requests.post("https://notify-api.line.me/api/notify",
                          headers=headers, params=params, files = files)

我有照stackoverflow的開啟圖片方法打開圖片了
請問為甚麼圖片訊息還是出不來呢?
謝謝大家幫忙!!!


標題:Raspberry Pi4 讀卡機+Pisces310 無法讀取到資料
標籤:usb讀卡機 raspberry pi python 

我的讀卡機Pisces310  沒辦法抓到他的驅動  有正常安裝公司的驅動程式
可是沒辦法使用 32 64都用過 或是ubuntu 系統也換過 也無法抓到
WIN10-ARM也是 之後換一台讀卡機可正常抓資料
唯獨Pisces310 這台無法 想問是驅動問題嗎?


標題:基礎Python-list問題
標籤:python list basic 基礎語法 

一個串列原始元素為［1, 3, 5, 7, 9]
(1) 請利用串列刪除的函數remove(), 將一個元素刪除
(2) 提示使用輸入要刪除的元素
(3) 先判斷元素是否在原始串列中,是再進行刪除
(4) 若不再元素中,請使用者再輸入一次,輸入三次都不在串列中,則結束程式.
目前在學基本Python，這題做到第3小題用if，但是到第4小題就不會了
有哪一位大神可以幫幫我的嗎～


標題:Python網頁爬蟲內容
標籤:html auth requests python webscraping 

最近嘗試使用requests取得一些網頁資料，遇到2個問題


認證
從requests library中得知requests支援多種驗證功能，但不知如何取得網頁使用的驗證方式?
這邊用蝦皮網站做測試，發現用basic auth帳密亂打也能得到200，有點困惑


網頁內容
試著從蝦皮取得一些使用者帳戶資訊 (profile/addrss...)，status code 200，但回傳的內容似乎都一樣但和網頁看到的不符，讀取shopee網頁原始碼似乎上面也沒有網頁看到的資訊，請問該如何取得資訊呢


程式碼

蝦皮個人資訊頁面

網頁原始碼



標題:Windows 系統下的chrome調視窗透明度失敗
標籤:python 視窗透明化 win32 

剛剛看到版上有一篇將記事本調透明度的文章，試了一下試成功的
但是我換成打開chrome後就失敗了，想請問是出什麼問題呢?
(可以打開chrome，但並沒有變淺)
import win32gui
import win32con
import winxpgui
import win32api
import subprocess
import time

subprocess.Popen("start chrome", shell=True)
time.sleep(1)
hwnd = win32gui.FindWindow(None, "分頁1")  ## The caption of my empty notepad (MetaPad)

win32gui.SetWindowLong (hwnd, win32con.GWL_EXSTYLE, win32gui.GetWindowLong (hwnd, win32con.GWL_EXSTYLE ) | win32con.WS_EX_LAYERED )
winxpgui.SetLayeredWindowAttributes(hwnd, win32api.RGB(0,0,0), 180, win32con.LWA_ALPHA)



標題:Docker TensorFlow Serving GPU 使用率
標籤:docker tensorflow serving tensorflow python 

在docker內使用TensorFlow Serving
image：tensorflow/serving:latest-gpu
GPU
docker run -t --runtime=nvidia -p 8501:8501 
--name tf_serving_gpu 
-v "$TESTDATA:/models/fashion_model" 
-e MODEL_NAME=fashion_model 
tensorflow/serving:latest-gpu &
當container啟動後GPU都一直完全滿載，停止後馬上釋放出memory

是否有辦法可以設定使用率
謝謝


標題:如何 用python 讀mxl然後放進pandas裡面 
標籤:python xml pandas 頭痛 elementtree 

我自己打的程式大概長這樣
假設有一個test.xml檔
然後我的功課是放進pandas裡面
在網路上爬文 還是不太懂ElementTree
希望有大神可以幫忙一下 簡單寫一下 感謝
import xml.etree.ElementTree as ET
tree = ET.parse('test.xml')
root = tree.getroot()
for i in range(len(root)):
print(root)


標題:(已解決)讀取csv檔要繪製altair圖,如何改變其中一個column裡資料的排序
標籤:python pandas.dataframe sort() 

新手發文若有不妥或表達不善請見諒
這是我讀取的CSV檔

要用裡面的age做Y軸
但是會遇到這樣自動排序的問題

想請問各位大師要如何自己手動排序
(註:有上網查過相關問題但都是自己建立資料,沒有查到更改讀檔資料裡的排序)

附上完整程式碼:



標題:使用 beautiful soup find_all() 報錯： lsit out of range
標籤:python tkinter beautifulsoup 

一、我想要爬下述網站的資料
https://tw.stock.yahoo.com/q/q?s=
= 後面接的是 tkinter entry get 輸入得到的代碼變數
二、用 while(true) 一直循環爬取網頁資料，每隔一段時間再爬，並將資料一列一列地寫入 excel
三、我在table01 = soup01.find_all(text='成交')[0].parent.parent.parent 報錯： list out of range
****各位大大好！不好意思打擾各位大大了！請問這個問題該如何解決呢？煩請告知 謝謝！
def blink01():
def run01():
while (switch01 == True):
#決定 excel 報表欄位要設定叫什麼名字
df01 = pd.DataFrame(columns=["時間","名字","價格","漲跌"])
#一、先檢查欄位有沒有填，二、再檢查欄位參數填地是否正確
if len(stock01_entry.get()) == 0:
toast01_label.configure(text = '股票四碼欄位沒填')
print('股票四碼欄位沒填')
break
if len(gap01_entry.get()) == 0:
toast01_label.configure(text = '每隔幾秒欄位沒填')
print('每隔幾秒欄位沒填')
break
try:
#二、再檢查欄位參數填地是否正確
fourname01 = str(stock01_entry.get())
gaptime01 = int(gap01_entry.get())
filename01 = str(file01_entry.get())
page01 = requests.get('https://tw.stock.yahoo.com/q/q?s='+fourname01)
soup01 = BeautifulSoup(page01.content, 'lxml')
table01 = soup01.find_all(text='成交')[0].parent.parent.parent
sname01 = table01.select('tr')[1].select('td')[0].text.strip('加到投資組合')
price01 = table01.select('tr')[1].select('td')[2].text
trend01 = table01.select('tr')[1].select('td')[5].text[0:4]

except:
toast01_label.configure(text = '代碼錯誤、沒有這支股票')
print('代碼錯誤、沒有這支股票')
break
#一、有沒有那「 == True 」的差別
#二、 html.parser vs lxml
while(switch01== True):
page01 = requests.get('https://tw.stock.yahoo.com/q/q?s='+fourname01)
soup01 = BeautifulSoup(page01.content, 'lxml')
#到這裡開始報錯 ： lsit out of range
table01 = soup01.find_all(text='成交')[0].parent.parent.parent
if(len(table01)>5):
    continue

price01 = table01.select('tr')[1].select('td')[2].text
trend01 = table01.select('tr')[1].select('td')[5].text[0:4]
#將時間、名字、價格、漲跌整理成一列資料
s01 = pd.Series([time.strftime('%Y%m%d %H:%M:%S'),sname01,price01,trend01], index=['時間',"名字","價格",'漲跌'])
df01 = df01.append(s01, ignore_index=True)  

sf = StyleFrame(df01)   
sf.set_column_width_dict(col_width_dict={("時間"): 18,("名字"): 13})  
sf.to_excel(filename01+' 報表.xlsx',right_to_left=False,columns_and_rows_to_freeze='A1',row_to_add_filters=0).save()

#橫向地列印至 cmd ，如果 print(s) 就會直向地列印至 cmd
print ( time.strftime ('%Y%m%d %H:%M:%S'),len(table01),sname01,price01,trend01 )
#訊息標籤顯示資訊
toast01_label.configure(text = s01.to_string())
#每隔多少秒，定時更新做這些事
time.sleep(gaptime01)

if(switch01 == False):break
thread1 = threading.Thread(target=run01)
thread1.start()


標題:Python spark RDD問題
標籤:python spark pyspark py decisiontree 

我在lablepointRDD的時候，都會出現錯誤，可是我明明是按照書<python+spark2.0+Hadoop機器學習與大數據分析實戰>上的code打，想詢問大大能不能幫我看一下，小的感激不盡！！！！！！
使用環境
OS: linux ubuntu 14.04
language: python 2 + spark 2.0
＃讀取檔案
if sc.master[0:5] == "local":
    Path = "file:/home/hduser/pythonwork/PythonProject/"
else:
    Path = "hdfs://master:9000/user/hduser/"

print(" Load  Data... ")
rawDataWithHeader = sc.textFile(Path+"data/train.csv")
header = rawDataWithHeader.first()
rawData = rawDataWithHeader.filter(lambda x:x != header)
rData = rawData.map(lambda x: x.replace("\"",""))
lines = rData.map(lambda x: x.split(","))
print("共計：" + str(lines.count()) + "筆")

# 擷取數值欄位
import numpy as np
def extract_feature(record,featureEnd):
    numericalFeatures = [covert_float(field) for field in record [0:featureEnd]]
    return numericalFeatures

def convert_float(x):
    return (0 if x=="?" else float(x))
    
# 擷取lable欄位
def extract_label(record):
    label = (record[-1])
    return float(label)-1

# Spark LabelpointRDD
from pyspark.mllib.regression import LabeledPoint
labelpointRDD = lines.map(lambda r: LabeledPoint (
            extract_label(r),
            extract_feature(r,len(r)-1)))

# Error 到這邊出現錯誤
labelpointRDD.first()

錯誤資訊如下
Py4JJavaError: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 27.0 failed 1 times, most recent failure: Lost task 0.0 in stage 27.0 (TID 27, localhost): org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 172, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 167, in process
    serializer.dump_stream(func(split_index, iterator), outfile)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/serializers.py", line 263, in dump_stream
    vs = list(itertools.islice(iterator, batch))
  File "/usr/local/spark/python/pyspark/rdd.py", line 1306, in takeUpToNumLeft
    yield next(iterator)
  File "<ipython-input-58-1c4bc0cb5b26>", line 7, in <lambda>
  File "<ipython-input-42-f603c8aa108c>", line 4, in extract_feature
  
NameError: global name 'covert_float' is not defined
	at org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)
	at org.apache.spark.api.python.PythonRunner$$anon$1.<init>(PythonRDD.scala:234)
	at org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:283)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:70)
	at org.apache.spark.scheduler.Task.run(Task.scala:85)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:274)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1152)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:622)
	at java.lang.Thread.run(Thread.java:748)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1450)
 at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1438)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1437)
	at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1437)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:811)
	at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:811)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:811)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1659)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1618)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1607)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:632)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:1871)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:1884)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:1897)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:441)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at sun.reflect.GeneratedMethodAccessor36.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:237)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:280)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:128)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:211)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 172, in main
    process()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/worker.py", line 167, in process
    serializer.dump_stream(func(split_index, iterator), outfile)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/serializers.py", line 263, in dump_stream
    vs = list(itertools.islice(iterator, batch))
  File "/usr/local/spark/python/pyspark/rdd.py", line 1306, in takeUpToNumLeft
    yield next(iterator)
  File "<ipython-input-58-1c4bc0cb5b26>", line 7, in <lambda>
  File "<ipython-input-42-f603c8aa108c>", line 4, in extract_feature
NameError: global name 'covert_float' is not defined
	at org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)
	at org.apache.spark.api.python.PythonRunner$$anon$1.<init>(PythonRDD.scala:234)
	at org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)
    at org.apache.spark.rdd.RDD.iterator(RDD.scala:283)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:70)
	at org.apache.spark.scheduler.Task.run(Task.scala:85)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:274)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1152)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:622)
	... 1 more

拜託大家！感謝大家！！


標題:函式求解
標籤:如何寫正確函式? python3 

這是主程式

dict1 = {"高麗菜":300,"A菜":40,"苦瓜":78,"小黃瓜":20}

sum1 =0
cnt = 0
list_class =[None]*100#採購順序
list_price =[None]*100#數量乘上單價
list_Num =[None]*100#各項蔬菜採購數量
for j in range(100):
    list_class[j]=0
    list_price[j]=0
    list_Num[j]=0
while True:
    Class = input("請輸入採購蔬菜")
    list_class[cnt]= Class
    if(Class=='買完'):
        print()
        break
    else: 
        Num = int(input("請輸入採購數量"))
        list_price[cnt] =Num * dict1[list_class[cnt]]
        list_Num[cnt]= Num
        sum1 =sum1 + list_price[cnt]
    cnt =cnt+1 


for i in range(cnt):
    print(list_class[i],list_Num[i],list_price[i])
print("總價",end ='')
print(sum1)

這是我要寫的兩個函式(不太完整)(vegname.py)
def veg_price():
    dict1 = {"高麗菜": 300, "A菜": 40, "苦瓜": 78, "小黃瓜": 20} 

    return dict1
def price(dictionary, dict_name, num):
    price = dictionary[dict_name]*num

    return price


最近再研究模組應用，我不知道如何將圖中的主程式改寫成(vegname.py)裡面的那兩個函式，可請大家幫我解惑嗎?謝謝


標題:我想做德州撲克牌型勝率計算器的網站
標籤:德州撲克 前端 python html5 rwd 


以這個網站為例，我想知道它裡面用到哪些技術？https://www.cardschat.com/poker-odds-calculator.php

目前就我了解，網站會牽涉到前後端的整合，前端技術有HTML5+JS+CSS，我想把牌做成拖曳式的功能，HTML5有支援，可是好像手機或平板電腦就不能滑了，關於拖曳跟滑的功能，不知道有沒有能同時兼顧的做法？
另外剛剛說到手機跟平板電腦，如果我想讓這個網站能同時在不同裝置上都能使用，我找到的關鍵字是RWD:響應式網站。這個要在做之前先規劃好？還是可以最後再根據需求調整大小？
還有牌型演算的部分我已完成，用python寫的。這個部分我想在用戶端去計算，但想把程式碼隱藏起來，該怎麼做？
大概流程是，從左邊的選牌區，將牌拖曳到右邊牌桌上任意的框框，框框感應到牌後，將牌的資訊儲存到python裡頭的board_ori或player_HC_ori變數裡頭，接著自動執行計算，將結果呈現在訊息區內。目前草稿：




標題:Python 新手問題 字串輸出問題
標籤:python 

如果輸入 hello 時
output 結果會是 hhehelhellhelloellolloloo
請問python coding該怎樣寫?


標題:Python Flask 出錯
標籤:python python3 python 3 flask 

程式:
from flask import Flask

app = Flask(__name__)

@app.route('/')
def index():
        return "Hello, World! (PYTHON+FLASK)"

if __name__ == '__main__':
        app.run(debug=True)

錯誤:
Traceback (most recent call last):
  File "flask.py", line 2, in <module>
    from flask import Flask
  File "C:\Users\ericc\Downloads\flask.py", line 2, in <module>
    from flask import Flask
ImportError: cannot import name 'Flask' from partially initialized module 'flask' (most likely due to a circular import) (C:\Users\ericc\Downloads\flask.py)

(有pip3 install flask)


標題:Selenium Webdriver- 無法在Jenkins執行AutoIT腳本(.exe)
標籤:jenkins selenium webdriver autoit python2.7 

各位好:
小弟目前使用Python+Selenium 寫 WEB UI測試，目前有一項Test Case是需要上傳檔案，所以使用AutoIT來寫另開視窗上傳檔案的動作，在本機端是正常運行。
問題：
目前嘗試使用Jenkins來運行程式，是建立在Windows10(x86)上，有發現運行過程中，AutoIT的上傳檔案腳本(.exe)不會執行。所以有爬到一些相關資訊，嘗試在Jenkins建立一個slave的節點，也是在Windows10(x86)上，來單獨執行AutoIT的上傳檔案腳本(.exe)，結果在slave上建置是可以看到上傳檔案腳本(.exe)運行的，但Test Case程式是在master上執行，請問要如何將兩個搭配起來運行? 或是我有用錯方法@@ ?
*AutoIT程式

*Python上傳程式

*Jenkins設定與執行過程-slave節點



若描述有不清楚的地方，煩請指教與說明。謝謝!!


標題:我想寫出 quicksort   和bubble sort的題目,但我寫不出來
標籤:python系列文章 

老師出了3個例題
我不懂要怎麼在90右邊多出60
我已經照同學告訴我的自己練習寫了
還是不確定哪一 行有問題
(input values)            (expected output)


  10,20,80,5,90,60,15        5,10,15,20,60,80,90,60



  10,30,100,-15,0,90,20      -15,0,10,20,30,90,100



  -1,abc,345,90,2,50         error(undefind)



data = [10,30,100,-15,,90,20]
def quicksort(data, left, right):
if left >= right :
return
min = left                      
pig = right                     
clock = data[left]                 

while min != pig:                  
    while data[pig] > clock and min < pig:   
        pig -= 1
    while data[min] <= clock and min < pig:  
        min += 1
    if min < pig:                        
        data[min], data[pig] = data[pig], data[min] 


data[left] = data[min] 
data[min] = clock

  quicksort(data, left, min-1)   
  quicksort(data, min+1, right)  

quicksort(data, 0, len(data)-1)
print(data)


標題:使用 selenium _ select 功能，可以定位到select，但是選擇時出現錯誤。
標籤:#selenium select python3 

我是Python自學新手，想自己寫一個自動化程式，但是在選擇選單時發生問題，找尋很多資料但是沒有得到解答，希望有大大可以幫助。

錯誤碼
Traceback (most recent call last):
File "", line 1, in 
File "C:\Users\user\AppData\Local\Programs\Python\Python37-32\lib\site-packages\selenium\webdriver\support\select.py", line 99, in select_by_index
for opt in self.options:
File "C:\Users\user\AppData\Local\Programs\Python\Python37-32\lib\site-packages\selenium\webdriver\support\select.py", line 47, in options
return self._el.find_elements(By.TAG_NAME, 'option')
File "C:\Users\user\AppData\Local\Programs\Python\Python37-32\lib\site-packages\selenium\webdriver\remote\webelement.py", line 685, in find_elements
{"using": by, "value": value})['value']
File "C:\Users\user\AppData\Local\Programs\Python\Python37-32\lib\site-packages\selenium\webdriver\remote\webelement.py", line 633, in _execute
return self._parent.execute(command, params)
File "C:\Users\user\AppData\Local\Programs\Python\Python37-32\lib\site-packages\selenium\webdriver\remote\webdriver.py", line 321, in execute
self.error_handler.check_response(response)
File "C:\Users\user\AppData\Local\Programs\Python\Python37-32\lib\site-packages\selenium\webdriver\remote\errorhandler.py", line 242, in check_response
raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.StaleElementReferenceException: Message: stale element reference: stale element not found
(Session info: chrome=87.0.4280.88)



Python
Selector_Element = Select(driver.find_element_by_tag_name("select"))
Selector_Element.select_by_index(2)



標題:python import fast問題
標籤:python python3 import 

今天在書上看到介紹import fast模組，但試不出來...
看介紹像是A可以呼叫B的值，然後將結果秀在A上?(如果我理解有不對可以說，還在學習階段中)
總共有兩個.py程式(test.py和lunch.py)
test.py程式碼如下:
import fast
place = fast.pick()
print("Let's go to",place)

lunch.py程式碼如下:
print("Let's go to 飯")
print("Let's go to 麵")
print("Let's go to 粥")

pick()會隨機從一個字串選擇一個結果來回傳
但...我不知道要把test.py要怎麼呼叫lunch.py...?(這兩個檔案有在同一個資料夾裡)


標題:python groupby問題
標籤:python pandas 



請問我該怎麼做才不會使subject_id出現最大最小值??


標題:怎麼在PYPI上發布特定平台的軟件包。
標籤:setuptools python 打包 作業系統 pypi 

本來
我用setuptools(model)構建出了xxxx-1.0-py3-none-any.whl然後發布到PIPI一切都正常，但是我的軟件中有針對特定操作系統編譯的二進制檔案，所以我在win和linux各有構建。所以產生出：
Window電腦的資料：
    dist\
        xxxx-1.0-py3-none-any.whl
linux電腦的資料：
    dist\
        xxxx-1.0-py3-none-any.whl

問題點
當我通過twine進行發布到PIPY問題就來了以下三點：

同一個版本怎麼同時發布到PIPY
還想讓 xxxx-1.0-py3-none-any.whl變成
win  : xxxx-1.0-py3-win-x86.whl ... 之類然後
linux: xxxx-1.0-py3-linux-XXX.whl ... 之類
最後我怎麼找不到可靠的文檔?

twine upload /dist/*

感謝協助


標題:[Python][BeautifulSoup][CSV] 將爬取四組網頁資料寫入csv . 只顯示最後一組 
標籤:python beautifulsoup 匯出csv 

使用python爬取資料..讀取的網址共有2個
但把列印的結果 輸出 csv ,只會顯示最後1各結果 為何?
import requests
from bs4 import BeautifulSoup
import csv
for i in range(12,14):
for q in range(1,2):
url ="https://bwfbadminton.com/rankings/2/bwf-world-rankings/6/men-s-singles/20"+str(i)+"/"+str(q)+"/?rows=25&page_no=1"
print(url.format(i,q))
res=requests.get(url.format(i,q))
soup=BeautifulSoup(res.text)
with open('test.csv','w',encoding="utf-8") as f:
writer = csv.writer(f)
writer.writerow(['date','country','player','point'])
for i in range(0,25):
dd=soup.body.find_all("option",selected=True)[1].text
date=dd[8:18]
country=soup.tbody.find_all("div","country")[i].text.strip()
player=soup.tbody.find_all("div","player")[i].text.strip()
point=soup.tbody.find_all("strong")[i].text.strip()
p1,p2=point.split('/')
writer.writerow([date,country,player,p1])
to 一級屠豬士

sorry 這跟我的程式碼 顯示結果一樣 只會顯示25筆 無法把四個網站100筆都顯示出來
感謝! 把 W 改成 a 對初學者 最容易
也感謝 點出 q in range(1,2) 語法上的錯誤


標題:如何將數據分析的結果顯示在網頁
標籤:machine learning python web 

請教各位大大，小弟目前在用python做數據分析，會用到scikit-learn, numpy...等數據分析的套件，想問有沒有方法可以將分析的結果(顯示confusion matrix, decision tree  classifier的圖)嵌入網頁中？
目前有查到一些django、flask等python開發的網路框架，但不知道嵌入的程式能不能允許import數據分析的套件


標題:python 查詢前三周內是否有紀錄
標籤:python time date csv 


要抓取圖片中charttime 去另外一個csv檔看三周前是否有做檢測


標題:Python解讀問題
標籤:python python3 

Hi,各位大神好，小弟初學Python，這段程式碼是照著書打的思考後有一段還是不太懂...所以上來邦幫忙技術版詢問
-------------------------以下程式碼-------------------------
start1 = ["fee" ,"fie" ,"foe"]
rhymes = [
("flop","get a mop"),
("fope","turn the rope"),
("fa","get your ma"),
("fudge","call the judge"),
("fat","pet the cat"),
("fog","walk the dog"),
("fun","say we're done")
]
start2 = "Someone better"
start1_caps = " ".join([word.capitalize() + "!" for word in start1]) #這段不太懂
for first, second in rhymes:
print(f"{start1_caps}{first.capitalize()}!")
print(f"{start2}{second}.")
-------------------------分隔線-------------------------
start1_caps = " ".join([word.capitalize() + "!" for word in start1])
print(start1_caps)
印出結果是:
Fee! Fie! Foe!
這段似乎是用很簡易(一行程式碼就可以完成一個迴圈)的方式打出來的，雖然很COOL看起來也很厲害!但我還在對這種寫法要解讀還有點吃力的階段QQ


標題:【Python】函數與繼承問題
標籤:python3 discord 好心人 

我想要在外部直接用函數來呼叫其中的_join元素
MusicBot-by vbe0201|GitHub
目前的程式碼:
import discord
from discord.ext import commands
from music_bot_example import Music

def reply_handler(bot, ctx):
    obj1 = Music(bot)
    class obj2(obj1, ctx):
        pass
    obj1.bot.loop.create_task(obj1.core_join(obj2))

class Chat(Cog_Extension):
    @commands.Cog.listener()
    async def on_message(self, ctx):
        reply_handler(self.bot, ctx)

def setup(bot):
    bot.add_cog(Chat(bot))

並且將 _join替換成一個裸函數以供呼叫:
async def core_join(self, ctx: commands.Context):
        destination = ctx.author.voice.channel
        if ctx.voice_state.voice:
            await ctx.voice_state.voice.move_to(destination)
            return

        ctx.voice_state.voice = await destination.connect()

    @commands.command(name='join', invoke_without_subcommand=True)
    async def _join(self, ctx: commands.Context):
        """Joins a voice channel."""
        return self.core_join(ctx)

error
in reply_handler
    class Object(Music(bot), ctx):
TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases

請各位高手指點 Orz


標題:python 十六進位轉二進位並8*8顯屏的困境
標籤:python bine python3 

菜鳥初學python中，遇到一項任務掙扎數天有點頭緒、有點方向、知道問題但沒有方法，還請版上大大指點迷津，先感激各位:
目的: 例如一檔案txt內容如下，解成二進位後顯示於黑白屏幕
str='0x8080808000800000,!'
讓它去掉前兩碼 [2:] 之後兩兩一組 並轉成二進位，如下圖範例

，即可在key: !時只讀取1 如圖，讓螢幕顯示 !

目前想法:

卡關於

list(test)之後如何兩兩一組?用append?
2.如何讓不足四碼的item補足零?



標題:Python PyQt5 QLineEdit無法使用英文輸入法輸入文字、第二個功能無法使用
標籤:python pyqt5 selenium 

新手無基礎菜問題
我的OS是win10

目前在QLineEdit使用中文輸入法的數字鍵盤，可以正常輸入，但切換成英文模式卻毫無動作、而且Backspace也毫無作用，不曉得發生什麼問題。
不曉得格式是否寫錯，只要有兩個def存在，上面那個會有作用，但下面的都無法執行，請問要如何調整?感恩各位大大。

P.s抱歉因為網址是工作用的，恕小弟用XXX替代
from PyQt5 import QtWidgets, QtGui, QtCore
from AutoSN.AutoSN_UI import Ui_mainWindow
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import sys


class MainWindow(QtWidgets.QMainWindow):
    def __init__(self):
        super(MainWindow, self).__init__()
        self.ui = Ui_mainWindow()
        self.ui.setupUi(self)

    #新增序號

        self.ui.sn_enter.keyPressEvent = self.keyPressEvent
    def keyPressEvent(self, e):
        if e.key() == QtCore.Qt.Key_Return or e.key() == QtCore.Qt.Key_Enter and self.ui.sn_enter.text() != "":
            self.ui.collect_sn.addItem(self.ui.sn_enter.text())
            self.ui.sn_enter.clear()



     # 送出單據的按紐
        self.ui.to_order.clicked.connect(self.to_order_but)
    def to_order_but(self):
        order = self.ui.order_numb.text()
        account = self.ui.account.text()
        password = self.ui.pwd.text()

        driver = webdriver.Chrome()
        driver.implicitly_wait(10)
        driver.get(
                'http://' + account + ':' + password + '@system.Xxxxxx.net/xxxxxx/ordersystem.php?toformid=' + order)


app = QtWidgets.QApplication([])
window = MainWindow()
window.show()
sys.exit(app.exec_())

UI的code
from PyQt5 import QtCore, QtGui, QtWidgets


class Ui_mainWindow(object):
    def setupUi(self, mainWindow):
        mainWindow.setObjectName("mainWindow")
        mainWindow.resize(510, 832)
        self.centralwidget = QtWidgets.QWidget(mainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.order_numb = QtWidgets.QLineEdit(self.centralwidget)
        self.order_numb.setGeometry(QtCore.QRect(40, 10, 241, 20))
        self.order_numb.setObjectName("order_numb")
        self.to_order = QtWidgets.QPushButton(self.centralwidget)
        self.to_order.setGeometry(QtCore.QRect(70, 40, 191, 41))
        self.to_order.setObjectName("to_order")
        self.radio_sn = QtWidgets.QRadioButton(self.centralwidget)
        self.radio_sn.setGeometry(QtCore.QRect(50, 90, 83, 16))
        self.radio_sn.setObjectName("radio_sn")
        self.radio_fsn = QtWidgets.QRadioButton(self.centralwidget)
        self.radio_fsn.setGeometry(QtCore.QRect(190, 90, 83, 16))
        self.radio_fsn.setObjectName("radio_fsn")
        self.regi_sn = QtWidgets.QPushButton(self.centralwidget)
        self.regi_sn.setGeometry(QtCore.QRect(60, 470, 201, 41))
        self.regi_sn.setObjectName("regi_sn")
        self.groupBox = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox.setGeometry(QtCore.QRect(10, 700, 301, 91))
        self.groupBox.setObjectName("groupBox")
        self.account = QtWidgets.QLineEdit(self.groupBox)
        self.account.setGeometry(QtCore.QRect(80, 20, 113, 20))
        self.account.setObjectName("account")
        self.pwd = QtWidgets.QLineEdit(self.groupBox)
        self.pwd.setGeometry(QtCore.QRect(80, 60, 113, 20))
        self.pwd.setObjectName("pwd")
        self.groupBox_2 = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox_2.setGeometry(QtCore.QRect(0, 540, 311, 151))
        self.groupBox_2.setObjectName("groupBox_2")
        self.add_note = QtWidgets.QPlainTextEdit(self.groupBox_2)
        self.add_note.setGeometry(QtCore.QRect(10, 50, 291, 91))
        self.add_note.setObjectName("add_note")
        self.add_note_sn = QtWidgets.QLineEdit(self.groupBox_2)
        self.add_note_sn.setGeometry(QtCore.QRect(10, 20, 113, 20))
        self.add_note_sn.setObjectName("add_note_sn")
        self.sn_enter = QtWidgets.QLineEdit(self.centralwidget)
        self.sn_enter.setGeometry(QtCore.QRect(100, 120, 161, 31))
        self.sn_enter.setObjectName("sn_enter")
        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(50, 130, 47, 12))
        self.label.setObjectName("label")
        self.collect_sn = QtWidgets.QListWidget(self.centralwidget)
        self.collect_sn.setGeometry(QtCore.QRect(40, 160, 231, 291))
        self.collect_sn.setObjectName("collect_sn")
        self.test_button = QtWidgets.QPushButton(self.centralwidget)
        self.test_button.setGeometry(QtCore.QRect(280, 120, 75, 23))
        self.test_button.setObjectName("test_button")
        mainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(mainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 510, 21))
        self.menubar.setObjectName("menubar")
        mainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(mainWindow)
        self.statusbar.setObjectName("statusbar")
        mainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(mainWindow)
        QtCore.QMetaObject.connectSlotsByName(mainWindow)

    def retranslateUi(self, mainWindow):
        _translate = QtCore.QCoreApplication.translate
        mainWindow.setWindowTitle(_translate("mainWindow", "序號自動輸入"))
        self.to_order.setText(_translate("mainWindow", "前往單據"))
        self.radio_sn.setText(_translate("mainWindow", "自編序號"))
        self.radio_fsn.setText(_translate("mainWindow", "原廠序號"))
        self.regi_sn.setText(_translate("mainWindow", "登錄序號"))
        self.groupBox.setTitle(_translate("mainWindow", "帳號密碼"))
        self.groupBox_2.setTitle(_translate("mainWindow", "追加序號/註記"))
        self.label.setText(_translate("mainWindow", "刷入序號"))
        self.test_button.setText(_translate("mainWindow", "PushButton"))




標題:樹梅派VNC的小問題 {已解決}
標籤:樹梅派 vnc python系列文章 遠端桌面 螢幕截圖 

我目前在利用樹梅派做監控的工具，
我需要在背景使用VNC連至使用者的筆電並且截圖，
現在是使用python 撰寫程式並且搭配 vncdotool 這個套件執行。
我是照這個網站做的
主要是每5秒截一張圖，並存成 當時的時間.JPG 然後放在資料夾裡面。
但我遇到一個大問題
就是我讓他每5秒做螢幕截圖結果每張照片都一模一樣，雖然不同名稱，但是每張打開來看都是一樣的。ಥ_ಥ
不知道有沒有大神能給我點建議或解決方法！


標題:[發問] Python3 如何在input輸入str和int?
標籤:python3 

我嘗試過只使用input(), 但輸入選項1,2,3的時候, 它不認為輸入的是數字, 而是當作字符串。
input = int("Option: 1)Display all records, 2)Add a record, 3)Exit System \n > Type your option: ")
然後我試着在input()改動:
int(input("Option: 1)Display all records, 2)Add a record, 3)Exit System \n > Type your option: "))
這次輸入選項123沒有問題了, 但是如果輸入abc, 就沒法繼續下去, 我不想出現錯誤訊息, 請問可以怎麼解決?


標題:Server端長時間未接收訊息，自己斷開連線。
標籤:python websocket timeout freeze 

大家好，這次想問關於Socket Server的問題。
基本架構如下，使用的是Websocket協議進行連接。

目前遇到的問題是：當長時間沒有傳送訊息時，Server端會斷開連結，並且輸入任何指令都毫無反應。
我測試過：間隔2分鐘傳送一次訊息，持續三天都沒有斷開連結。

還有間隔4分、5分、6分、8分都不會有這個問題。
但如果我拉長到15分、18分、20分，Server端就會失去連線。
目前在測試間隔12分鐘的狀態。
推測是，Server端超過一定時間未接收消息，Server端就會斷開連結。
這是我的Server端程式碼：
#coding=utf-8
import socket
import sys
import os
import datetime

HOST = 'IP'
PORT = Port

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
server.bind((HOST, PORT))
server.listen(10)

print('Server start st %s:%s' % (HOST, PORT))
print('wait for connection...')

while True:    
    conn, addr = server.accept()
    print('connection by ' + str(addr))

    while True:
        clientMessage = str(conn.recv(1024), encoding = 'utf-8')#轉碼成utf-8
        if clientMessage.lower() == 'close':
            conn.close()
            print('client closed connection.')
            break
        print('recv:' + clientMessage)

        outdata = 'echo: ' +  clientMessage + '\n\r'
        conn.send(outdata.encode())

        '''這邊是我要記錄接收訊息的log'''
        theTime = datetime.datetime.now()
        message = str(theTime) + "  message:" +  clientMessage+'\n'
        f = open("data/log.txt","a")
        f.write(message)
        f.close

我原本在猜是不是Python的while迴圈有秒數限制，可是google過沒有這方面的答案。
我也想過，是不是Windows自己本身會把長時間沒有動作的程式給砍掉，但又不知道從何搜尋起。
想請問各位大大，有沒有什麼關鍵字可以讓我去搜尋的，謝謝！


標題:我才剛學python沒多久，拜託各位幫我解決這題因數分解
標籤:python 質因數分解問題 

My code:
a=int(input())

找因數

for i in range(2,a+1):
s=0
b=a 
d=0


把不是質數的去掉

if a%i==0:                
    for x in range(1,i+1):      
        if a%x==0:
            d=d+x

    if (d-1)/i==1:
        d=0
        print(i)            

    else:
        s=0
        b=a
        d=0

        continue

        d=0            

    while(b>0):


看看有幾個這種質數

        if (b/i)%1==0:   
            s=s+1
            b=b/i

        else:
            b=0

            if b==1:
                b=0

    print(s)
    [https://zerojudge.tw/ShowProblem?problemid=a010](http://)



標題:[發問] Python3 要怎麼打印階乘?
標籤:python 3 

我是剛入門Python沒多久的菜鳥，現在遇到一個問題關於打印階乘。
需要用到兩個函數 : getFacNumList(n) , dispFacNumList(n)
要求getFacNumList(n)這邊印出1-8, dispFacNumList(n)這邊印出1-8的階乘結果。
我試過這樣:
def dispFacNumList(n):
for j in range(1, n + 1):
n = n * j
return n
def getFacNumList(n):
for i in range(1, n + 1):
print('n = {}  :  n! = {}\t'.format(i,dispFacNumList(n)))
def main():
n = 8
dispFacNumList(getFacNumList(n))
main()
但是出來的結果是這樣:
n = 1  :  n! = 8	
n = 2  :  n! = 8	
n = 3  :  n! = 8	
n = 4  :  n! = 8	
n = 5  :  n! = 8	
n = 6  :  n! = 8	
n = 7  :  n! = 8	
n = 8  :  n! = 8
說是dispFacNumList(n)出了問題，請問要怎麼解決?


標題:Python syntax error
標籤:python webscraping 

各位好  初學Python+Web scrapping
下面是書上照打的語法
一直出現syntax error (粗體字)
不懂哪邊不對
謝謝各位
from urllib.request import urlopen
from bs4 import BeautifulSoup
import re
html=urlopen('https://en.wikipedia.org/wiki/Kevin_Bacon')
bs=BeautifulSoup(html,'html.parser')
for link in bs.find('div',{'id':'bodycontent'}).find_all('a', href=re.compile('^(/wiki/)((?!:).)*$")'):
if'href' in link.attrs:
print(link.attrs['href'])


標題:Python Socket UDP廣播 Error (Tkinter)
標籤:python3 socket tkinter thread 

打算為基於廣播的UDP聊天室做一個UI介面，並且可以隨時切換埠來做到切換頻道的效果，但在接收封包的部分遇到了問題。
VScode報錯:
in recv
recv_socket.bind(('', port))
OSError: [WinError 10022] 提供了一個不正確的引數。

程式碼:
import tkinter as tk
from socket import socket, AF_INET, SOCK_DGRAM, SOL_SOCKET, SO_REUSEADDR, SO_BROADCAST
from time import sleep
from threading import Thread

#發送封包
def send(event=None):
    entry = send_entry.get()
    send_entry.delete(0, "end")
    port = int(channel_entry.get())
    sendSocket = socket(AF_INET, SOCK_DGRAM)
    sendSocket.setsockopt(SOL_SOCKET, SO_BROADCAST, 1)
    sendSocket.sendto(entry.encode("utf-8"), ('255.255.255.255', port))

#接收器
recv_socket = socket(AF_INET, SOCK_DGRAM)
recv_socket.setsockopt(SOL_SOCKET, SO_REUSEADDR, 1)
recv_socket.setsockopt(SOL_SOCKET, SO_BROADCAST, 1)
def recv():
    text_box.config(state=tk.NORMAL)
    text_box.insert(tk.END, "[*] 載入 UDP 訊息接收器完成\n")
    text_box.config(state=tk.DISABLED)
    while True:
        port = int(channel_entry.get())
        recv_socket.bind(('', port))
        try:
            recv_data = recv_socket.recvfrom(1024)
            text_box.config(state=tk.NORMAL)
            text_box.insert(tk.END, f"{recv_data[1][0]}:{recv_data[0].decode('utf-8')}\n")
            text_box.config(state=tk.DISABLED)
            text_box.see(tk.END)
            sleep(1)
        except OSError:
            text_box.config(state=tk.NORMAL)
            text_box.insert(tk.END, "[*] 超過單次字數限制\n")
            text_box.config(state=tk.DISABLED)
            text_box.see(tk.END)

#接收器線呈
Thread(target=recv, daemon=True).start()

app.mainloop()



標題:安裝 virtualenv問題
標籤:python virtualenv 


我在電腦裡安裝 virtualenv出現錯誤訊息 請問要如何排除


標題:遺漏植回填問題
標籤:python 遺漏直 遺漏值 

假設我的第1489471筆資料是NaN，我找到他的值是99，我只到如何補進去
我的方法是
df.iloc[1489471].fillna("99")
但是我如果回去看df 她那一欄一樣是NaN，是方法不對嗎，該怎麼補回去呢?


標題:可以在Xcode(UIKit)做ios的app時同時匯入python 嗎？
標籤:swift uikit ios python3 xcode 

大家好：
我正在自己嘗試用Xcode做ios的app，現在遇到了一個問題。
我想把我的python程式匯入我的swift的Xcode專案裡面，請問我該怎麼匯入？
如果有方法的話，小弟想請教一下?
如果不行的話會，請問有什麼方法可以把python裡的程式和swift一起結合？
##如果能幫到我的忙的話，我會非常感謝你們！！


標題:python讀取excel檔案時，表頭名稱應如何讀入
標籤:python read_excel column name 

小弟不才，以前只碰過最簡單的一行的欄位名稱
現在遇到excel表頭名稱長這樣，想問版上大大都會如何讀入表頭名稱
我用的是python的pd.read_excel方式讀檔



標題:python 偵測excel關閉後跳出訊息
標籤:python excel 

python三週新手，想請前輩們指導....
用python寫了以下程式，開啟了名為"test.xlsx"的excel檔案
然後想偵測使用者用完、關閉了"test.xlsx"後，跳出 "close ok"的訊息
但不曉得該如何寫?
如果寫
if xl.Workbooks.Count==0:
print("close ok")
好像無法再使用者關閉後，顯示訊息。
原程式碼如下:
import win32com.client as win32
xl = win32.gencache.EnsureDispatch('Excel.Application')
my_workbook = "test.xlsx"
xlPath="D:\1python\1Training\" + my_workbook
xl.Workbooks.Open(Filename=xlPath)
xl.Visible = True
if xl.Workbooks.Count==0:
print("close ok")


標題:kotlin 轉成 python
標籤:kotlin python 

    private fun urlEncode(str: String?): String {
        return URLEncoder.encode(str, "UTF-8")
            .replace("+", "%20")
            .replace("%7E", "~")
            .replace("*", "%2A")
    }
    private fun generateGSNHash(url: HttpUrl): String {
        var s = c + "GET"
        url.queryParameterNames().toSortedSet().forEach {
            if (it != "gsm") {
                s += it
                s += urlEncode(url.queryParameterValues(it)[0])
            }
        }
        s += c
        return hashString("MD5", s)
    }

    private fun hashString(type: String, input: String): String {
        val hexChars = "0123456789abcdef"
        val bytes = MessageDigest
            .getInstance(type)
            .digest(input.toByteArray())
        val result = StringBuilder(bytes.size * 2)

        bytes.forEach {
            val i = it.toInt()
            result.append(hexChars[i shr 4 and 0x0f])
            result.append(hexChars[i and 0x0f])
        }

        return result.toString()
    }

這幾個代碼能幫忙改寫成python嗎
測試完全不懂是怎麼走的


標題:from googlesearch import search  多關鍵字找尋
標籤:#python #google #關鍵字 #googlesearch 

各位大大您好
小妹我自學python
最近遇到一個問題 想請各位幫忙解答
try:
from googlesearch import search
except ImportError:
print("No module named 'google' found")
query = "Geeksforgeeks"
for j in search(query, tld="co.in", num=10, stop=10, pause=2):
print(j)
這是網上找到的程式碼,
但如果我想一次搜尋三個關鍵字,我應該怎麼做呢?


標題:Python使用requests的爬蟲問題
標籤:python requests 爬蟲 

各位大大好，小弟是爬蟲新手，最近在用request抓取網頁的資料，但目前在抓取以下網站的資料(ex樹木編號、健康度、圖片等)時，request的結果沒有(樹木編號、健康度、圖片等)這些資料
https://www.culture.gov.taipei/frontsite/tree/treeProtectListAction.do?method=doReadDetail&treeId=1
我觀察是在這個地方顯示資料(ex樹木編號、健康度、圖片等)

程式碼如下(我以為是cookie和User-Agent的問題，加上去也沒有改善)
url = 'http://www.culture.gov.taipei/frontsite/tree/treeProtectListAction.do?method=doReadDetail&subMenuId=34&siteId=MTA2&treeId=1'
headers = {
'Cookie': '_ga=GA1.2.158213246.1599196959; _gid=GA1.2.2075770048.1604891241; JSESSIONID=B9D11BC92021B9642FA1ECEAA2CA52C1',
'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.183 Safari/537.36'
}
r = requests.get(url,headers=headers)
print(r.text)

request的結果如下，沒有我要找的資料，連樹木編號上方"受保護樹木查詢"這個區塊的資料也沒有，request的結果只有網頁上方、左邊及下方的資料

PS小弟第一次上來發問，如果有問題敘述不清楚的地方再請提出~


標題:#新手 爬蟲模擬登入和加入購物車下單疑問
標籤:python爬蟲 網路爬蟲 網頁爬蟲 爬蟲 

我想要爬的網站是Momo購物網
用了Chrome的F12去看封包
卻完全看不懂QQ
看不出來哪個封包才是我需要的東西

像模擬登入的話我覺得是這個
可是我不知道裡面有哪些是我需要用到的


標題:python篩選問題
標籤:python pandas 篩選 

請問各位大神，關於python篩選的問題
ex
1.今天有一個欄位叫做合約狀態，裡面的值有欠費停約、欠費限制、生效和終止、遺失和強制停約
如果我想要抓不等於欠費停約、強制停約、終止，請問下面的方式是對的嗎
2.然後篩出來的條件想新增一行欄位叫"狀態"裡面的值是復約，最後在合併回DF裡面可以用什麼方法呢?卡一陣子了想不出來有什麼方式可以回貼....因為資料不方便貼上來所以沒po不好意思，希望能替小弟給方向~謝謝~
我的想法:
1.df3[(df3['合約狀態']!='欠費停約')&(df3['合約狀態']!='強制停約')&(df3['合約狀態']!='終止')] ps.我不要上述三個條件應該是用&沒錯吧...我知道也可以用==欠費限制 ==生效 ==遺失 但我想都練習看看
2.df3["狀態"]....然後就無想法了....


標題:#PYTHON 程式語言 
標籤:#程式語言 python 

1.輸入兩不同之整數，輸出 其大小比較，例如：輸入 5 7，輸出 5 < 7
2.輸入兩個不為0之浮點數，輸出第一個數加第二個數、第一個數減第二個數、第一個數乘第二個數、第一個數除第二個數，輸出於同一列。輸出格式每個運算結果之保留小數以下1位，倆倆之間一個空格。提示：print('{:.1f} {:.1f}'.format(數字1, 數字2))
3.輸入一個字串，輸出當中大寫英文字母，若有多個大寫字母，輸出時，字母間沒有空格
4.輸出a, b, c, d 四個不同整數中之最大數字之值，使用以下輸入：a, b, c, d = map(int, input().split())
5.利用語言內建輸入函數，輸入一個字串，例如輸入之字串為 John，輸出 Hello, John
6.輸入一個正整數，輸出至該整數之累加。
7.輸入兩個整數，輸出其和。不必提示使用者，不必考慮資料型態非整數的情形
會幾題就教我幾題QQ 拜託各位了


標題:python Q : 篩出類行是 float or empty 但default也接受?! 請拯救我枯竭的腦袋
標籤:python default type loop 

不瞞各位此問題是小的一項作業但卡關許久，所以前來尋求幫助，題目類似:
1.詢問用戶輸入台幣換美金的匯率值 且用戶必須輸入是float 或empty (but default value is used.) 否則一直詢問用戶輸入匯率值
[我卡關的地方在此，一是不懂如何篩出empty?default? 二是老師不允許沒有輸入值直接按enter 卻可以繼續run ]
2.當輸入匯率值符合要求，則詢問要換多少台幣? 然後計算出可換得美金多少
3.完成計算後再次詢問用戶是否再來一次? 是，則重問
我試過 使用isdigit和isinstance 去篩出float 但卡在 input('give a rate')? 為str 就不知是否該先 float(input)嗎? 但又還是卡empty 和default....
另附上老師的一段提示，但我有看沒有懂
Basically, program will accept only a float value or a null value.
If a float value is provided the program will use the user provided value to do the calculations.
If null value is provided the program will use the default value to perform the calculations.
You will need to set the default value yourself.
Example:
user_value is provided by the user
default_value is set to 1.5
if user_value is null then exchange_rate is set to default_value
otherwise, exchange_rate is set to user_value.


標題:PYthon的散點圖
標籤:python 散點圖 離群值 


如圖要如何找把離群值去掉
只取正常值就好...
謝謝大大!!


標題:PYthon長條圖轉向及設定範圍
標籤:python 直條圖 轉向 設定範圍 


如圖  要怎麼縮小範圍及轉向!!
謝謝大大!!


標題:PYthon分面直方圖
標籤:python 直方圖 

麻煩了...

如圖 要依照passenger_count 分面，這是要求的完成答案...



標題:PYthon盒鬚圖找離群值
標籤:python 離群值 盒鬚圖 

麻煩了...做到一半了但是不知道怎麼設定離群值...
如圖第一張是原檔已經作出答案了..

但要如何插入語法找尋自己需要的範圍(排除離群值設定)?



標題:為甚麼會出錯?不能理解(PYTHON)
標籤:python python3 

各位大大好，我寫了一個程式，但就不知道為甚麼會出錯
class Calc:
    def plus(self, a, b):
        return a + b
    def minus(self, a, b):
        return a - b
a = Calc.plus(1, 2)
b = Calc.minus(2, 1)
print(a)
print(b)

然後有Error
File "c:\Users\ericc\Downloads\python程式\Calc.py", line 6, in <module>
    a = Calc.plus(1, 2)
TypeError: plus() missing 1 required positional argument: 'b'

我改成了這樣
class Calc:
    def plus(self, a, b):
    	self.a = a
        self.b = b
        return self.a + self.b
    def minus(self, a, b):
        self.a = a
    	self.b = b
        return self.a - self.b
a = Calc.plus(1, 2)
b = Calc.minus(2, 1)
print(a)
print(b)

Error變成了
File "c:\Users\ericc\Downloads\python程式\Calc.py", line 14
    self.b = b
             ^
TabError: inconsistent use of tabs and spaces in indentation

真的救命
求幫忙


標題:Leetcode 189題 Rotate Array（用Python）
標籤:python leetcode 

敝人要問的是這題：
https://leetcode.com/problems/rotate-array/
使用以下解法
nums = nums[len(nums)-k:] + nums[:len(nums)-k]
卻顯示nums不變
必須使用shallow copy才能AC
nums[:] = nums[len(nums)-k:] + nums[:len(nums)-k]
小弟實在不懂，為何需使用shallow copy後才能修改到nums
在此先謝謝各位，如果題目描述得不夠清楚，本人會再補充


標題:python opencv 擷取圖片中矩形
標籤:opencv python3 fastrcnn 

有許多這一類的圖片
中間都有個矩形
若是想透過opencv或其他套件
該如何挖出中間那個矩形
原本想用cv2.findContours
但由於中央有些黑色會造成無法完整切割
二值化又會被上下相同灰階度的區塊影響
不知道能不能透過opencv處理
若真的不行是否只能透過 Fast RCNN這類的方法解決了
謝謝~





標題:python用post爬取
標籤:python post 

import requests
from bs4 import BeautifulSoup
import time

data={"is_encrypted":0,"platform":"pc","client":"web","sign":"","gz":0,"d":{"parent_gid":3,"gid":106,"page":2}}
res=requests.post(url,data=data)
print(res.text)

不知道問題出在哪裡
都無法回傳抓包的內容
這post是在切換頁數時抓包到的


標題:Python 爬取開放API 問題
標籤:python web api pm2.5 

實作關於 python 爬取空氣品質 AQI 遇到的問題
在取得開放 API 後，顯示說
TypeError: string indices must be integers
不知道該如何調整 為整數
取得資料來源如下：
https://data.epa.gov.tw/dataset/aqx_p_432/resource/8ff027dc-2da2-42e8-85de-78ac3faf470e



標題:Python JSON URL格式處理
標籤:python3 json python 

Hi
JSON裡有段資料:
"url": "\ /test\ /tr\ /Session\ /122544", ←忽略空格
我要將這段資料load進來再放到新的檔案裡, 程式大概如下:
    json_array = json.load(input_file)
    for item in json_array:
        result.append(item)
    with open(output_file, 'w') as outfile:
        json.dump(result, outfile, indent = 4)

可是會變成:
"url": "/test/tr/Session/122544",
我試過load進來後再呼叫replace:
    str.replace('/', '\/')

可是會變成:
"url": "\ \ /test\ \ /tr\ \ /Session\ \ /122544", ←忽略空格
請問要如何保持最一開始的格式呢
Thanks


標題:關於PyThon的一些問題
標籤:python ask help 


有圖片的五個問題...
至於csv的檔名為"sample.csv"
有大大可以幫幫嗎?
或是給一些推薦意見之類的就好..我是完全沒方向...


標題:求此python題目解答(已解決)
標籤:python 



標題:python爬取youtube影片觀看次數
標籤:python 3 網頁爬蟲 觀看次數 youtube 

from selenium import webdriver
from selenium.webdriver.common.by import By
from webdriver_manager.chrome import ChromeDriverManager
driver = webdriver.Chrome(ChromeDriverManager().install())
driver.get("https://www.youtube.com/?hl=zh-TW&gl=TW") # 更改網址以前往不同網頁
#driver.close() # 關閉瀏覽器視窗
定位搜尋框
element = driver.find_element_by_class_name("style-scope ytd-searchbox")
傳入字串
element.send_keys("阿滴英文")
#點擊搜尋
start_search_btn = driver.find_element_by_id("search-icon-legacy")
start_search_btn.click()
#點擊圖片
image = driver.find_element_by_id("img")
image.click()
#點擊最新影片
movie = driver.find_element_by_link_text("10支最熱門的影片")
movie.click()
最後的程式碼無法觸擊


標題:PYTHON 遞迴遍歷字典值與索引皆直接返回None
標籤:遞迴 python none 字典 

##########10/15更新後正確的####################
    dic={
           "AAAA":"5",
           "GGGGG":{"F":"C4CC","R":"A66666"},
           "BBBB":{"A":"CCCC","B":"666666"},
           "XXXX":[],
           "DDDD":"6"
    }
    def find_dic(dic,target,res=None):

        for key ,values in dic.items():
            if isinstance(values,dict):
                res=find_dic(values,target)#更改的一行
                #原本是return find_dic(dic[key],target)
                if res:
                    return res
            else:
                if key==target:
                    res=values
                    return values
                elif values==target:
                    res=key
                    return key

    print(find_dic(dic,"XXXX"))

寫錯了 正確的測資應該是多層字典
因為在前一個程式碼裡如果遞迴到第二層的字典時會再次呼叫find_dic(values,target)
進去字典後如果沒有找到目標 第二次的find_dic會回傳None
這時return find_dic(values,target)
就變成了 return None
程式就回傳了None
於是多了個變數做判定若第二層以後的結果不是None則回傳
若是None 則繼續
#################################################################
    dic={
           AAAA:"5",
           XXXX:[],
           DDDD:"6"
    }
    def find_dic(self,dic,target):
        for key in dic.keys():
            if isinstance(dic[key],dict):
                return find_dic(dic[key],target)
            else:
                if key==target:
                    return dic[key]
                elif dic[key]==target:
                    return key
    print(find_dic(dic,"6"))
    #這邊希望結果是找出6對應的key或者value是多少
    正常情況應該印出"DDDD"
    
    print(find_dic(dic,"AAA"))
    印出"5" <==沒問題

這是局部的程式碼
用途在於遍歷字典的KEY跟VALUE找出哪一個對應的
測試很多次只要遍歷到dic["XXXX"]裡面是[]遞迴就會直接結束
並且返回None
不會在遍歷到下一個DDDD
這原因是什麼?
另外要如何避開這個問題
有嘗試在迴圈中一開始就加入if dic[key] is None 或者 if dic[key] == [] 判斷
    dic={
           AAAA:"5",
           XXXX:[],
           DDDD:"6"
    }
    def find_dic(self,dic,target):
        for key in dic.keys():
            if dic[key] is None or dic[key] == []:
                print("GGG了")
            if isinstance(dic[key],dict):
                return find_dic(dic[key],target)
            else:
                if key==target:
                    return dic[key]
                elif dic[key]==target:
                    return key
    print(find_dic(dic,"6"))

但在進入判斷時都直接return None回來 也沒辦法印出"GGG了"
求解..


標題:VSCODE 使用PYQT 無法顯示完整錯誤訊息 traceback
標籤:pyqt5 python 

Traceback (most recent call last):
File "e:\util\main.py", line 33, in start_post
self.tableWidget.setItem(i,1,self.game_data_arr[i][1])
TypeError: setItem(self, int, int, QTableWidgetItem): argument 3 has unexpected type 'str'
假設錯誤訊息完整是如上面
但有時候同個錯誤會只顯示一半 甚至更少 就因為視窗已經當掉了沒辦法繼續顯示
例如變成這樣
Traceback (most recent call last):
File "e:\util\main.py", line 33, in start_post
self.ta
請問這有什麼辦法可以解決


標題:[新手]利用excel完成pdf檔案加密及O365信件發送(大量)
標籤:excel python pdf mail 

請問使用Python及Excel是否可以完成大量/批次的PDF檔，
並且O365寄送信件?是否是一件複雜的工程呢?
在網路上有找到文件加密相關的Code，但實際操作操作時一直出現錯誤...


標題:遇到很多層的css標籤
標籤:python beautifulsoup 

遇到一個網頁碼長類似這樣
  <article id="article-main-contents">
   <span style="color: #424242">
    <span style="font-family:webfont">
     <span style="color: #e82a1f">
      <span style="font-family:webfont">
      </span>
     </span>
    </span>
   </span>
   <br/>
   <span style="color: #424242">
    <span style="font-family:webfont">
     <span style="color: #e82a1f">
      <span style="font-family:webfont">
       這是我要的內容
      </span>
     </span>
    </span>
   </span>
  </article>

用soup.select("span")捕捉
想打印內容會出現很多行 這是我要的內容
這要怎麼解決


標題:python 區域變數問題
標籤:python3 

paramA = 1
if paramA == 1:
    paramB = 2
print(paramB)

上面小段程式碼居然可以輸出paramB為2而不報錯? 這在python是允許的?
照理說離開if後變數paramB就不在了
另外
paramA = 1
paramB = 0 #Unused
if paramA == 1:
    paramB = 2
print(paramB)

編譯器對於這段程式碼指出paramB宣告而未使用這又是為什麼?


標題:python 裡面除了socket 還有其他套件可以溝通嗎? 類似okhttp
標籤:python3 python入門 socket 

我想問說python的連線方式TCP/UDP socket 套件  有沒有其他更穩定的連線方法呢?
因為我socket 用了之後client會斷線 已經有放重新連線的try進去了
但還是怕沒抓到那個錯誤 所以有加入重新偵測連線的方法進來
可是怕效能影響到所以說 想問其他類似socket 的套件可使用的


標題:python??
標籤:python 

大家都說python好,我好難體會


標題:pyinstaller 打包出錯求助
標籤:python pyinstaller 

C:\Users\User>pyinstaller -F .D:/Python/OCT1/venv/AutoDone
409 INFO: PyInstaller: 4.0
409 INFO: Python: 3.6.5
411 INFO: Platform: Windows-10-10.0.18362-SP0
412 INFO: wrote C:\Users\User\AutoDone.spec
451 INFO: UPX is not available.
script 'C:\Users\User.D:\Python\OCT1\venv\AutoDone' not found
我的python是裝在 D:\的
想請大大教學~


標題:python爬蟲程式 請指點程式有何可以改進
標籤:#python #爬蟲 #新手求指導 

小弟接觸python約4個月 ,非資工相關科系
首次發問
想請教各路大大
這樣的程式碼有甚麼建議修改的地方嗎?
感謝大大
想加多執行續在程式內 ,還不知道要怎麼放進程式內 ,請再麻煩指點迷津
感謝
'''
import requests
from http import cookiejar
from lxml import etree
import os
import json
import multiprocessing as mp
import re

#轉換網頁Html
def lxml_html(url):
    headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36'
        , 'referer': 'https://c-h-c.com.tw/shop/'}

    cookies=cookiejar.CookieJar()
    #print(cookies)
    res=requests.get(url=url,headers=headers,cookies=cookies)
    #res.encoding=res.apparent_encoding #自動轉換代碼
    #關鍵字charse 找網頁編碼格式

    html=etree.HTML(res.text)
    return html

#建立指定路徑資料夾
def set_folders(key):
    resource_path=r'./CHCCFolders/'+key+'/'
    if not os.path.exists(resource_path):
        os.makedirs(resource_path)
    else:
        print(resource_path)
    return resource_path


# 轉json檔寫入指定路徑資料夾內
def dump_json_file(query_dict, file_name, resource_path):
    with open(resource_path + "/{}.json".format(file_name), 'w', encoding='utf-8') as outfile:
        json.dump(query_dict, outfile, ensure_ascii=False)
        print('dump the data successfully')

#取得網頁所有的主題網址
def GetUrls():
    url='https://c-h-c.com.tw/shop/'
    html=lxml_html(url)
    urls_list = html.xpath('//li[@class="mega-menu-column mega-menu-columns-2-of-12"]/ul/li/a/@href')
    title_list = html.xpath('//li[@class="mega-menu-column mega-menu-columns-2-of-12"]/ul/li/a/text()')
    CHClist = []
    for run in range(len(title_list)):
        CHCdict = {'id': run, 'title': title_list[run], 'url': urls_list[run]}
        CHClist.append(CHCdict)
    content_all = []
    for number in range(len(CHClist)):
        title = CHClist[number]['title']
        in_url = CHClist[number]['url']

        htmls = lxml_html(in_url)
        content_url = htmls.xpath('//div[@class="un-product-thumbnail"]/a/@href')
        content_json = {'title': title, 'url': content_url}
        content_all.append(content_json)

    return content_all


#取得主題網頁後所有商品
def Get_ALL(content_all):
    for urls in range(len(content_all)):
        title = re.sub(r'\W', '', content_all[urls]['title'])
        urllist = content_all[urls]['url']
        path = set_folders(title)
        for url in urllist:
            content_html = lxml_html(url)

            # Name
            Name = re.sub(r'\W', '', content_html.xpath('//h1[@class="product_title entry-title"]/text()')[0])
            # Url
            Url = url
            # Price
            Price = content_html.xpath('//p/ins/span[@class="woocommerce-Price-amount amount"]/text()')
            if Price == []:
                Price = content_html.xpath('//p/span[@class="woocommerce-Price-amount amount"]/text()')
            try:
                # Store
                Store = re.sub('\n', '', content_html.xpath(
                    '//div[@class="summary entry-summary"]/div[@class="woo-short-description"]/p/text()')[0])
            except IndexError:
                pass
            try:
                # Brand
                Brand = re.sub('\n', '', content_html.xpath(
                    '//div[@class="summary entry-summary"]/div[@class="woo-short-description"]/p/text()')[1])
            except IndexError:
                pass
            try:
                # Introduction
                Introduction = [
                    content_html.xpath('//div[@class="vc_tta-panel-body"]//div[@class="wpb_wrapper"]/h2/text()')[0]
                    , content_html.xpath('//div[@class="vc_tta-panel-body"]//div[@class="wpb_wrapper"]/p/text()')[0]]
            except IndexError:
                pass
            try:
                # Specification
                Specification = [content_html.xpath('//div[@class="wpb_wrapper"]/h4/text()')[0]
                    , content_html.xpath('//div[@class="boxEditCont"]/p/text()')[0]]
            except IndexError:
                pass
            # Product
            Product_img = content_html.xpath('//a[@class="photoswipe"]/img/@src')[0]

            # Layout

            Layout_img = content_html.xpath('//div[@class="wpb_wrapper"]//img/@src')

            try:
                content_json = {'title': title, 'Name': Name, 'Price': Price, 'Url': Url, 'Store': Store,
                                'Brand': Brand, 'Introduction': Introduction
                    , 'Specification': Specification, 'Product': Product_img, 'Layout': Layout_img}
            except:
                content_json = {'title': title, 'Name': Name, 'Price': Price, 'Url': Url, 'Store': [], 'Brand': [],
                                'Introduction': []
                    , 'Specification': [], 'Product': Product_img, 'Layout': Layout_img}
            print(content_json)
            dump_json_file(content_json, Name, path)

def main():
     content_all=GetUrls()

     Get_ALL(content_all)


if __name__ =='__main__':
    main()

'''


標題:[我很爛]SoloLearn|Python 題目
標籤:python 新手上路 

完全沒看過的語法，也不知該如何查起QwQ
來這裡許願，希望有人願意指點我迷津⋯⋯
Fill in the blanks to print the first elements of the list, if it contains even number of elements.
翻譯：求list的第一個偶數
list = [1, 2, 3, 4]
if ___ (list) % 2 == 0 ___
print(list[ ___ ] )
依我看來第二個空格(==0後面那個)是”:”，因為只佔一格。
“if”後面填三個字，list 裡只能填一個。


標題:Python pandas 字串比對問題
標籤:python 3 pandas 

HI 大家好，小弟Python新手，請各位先進指導。感謝!!
問題： 目前有兩個由爬蟲抓下來的資料,一個是電影名稱'MovieTitle.csv'
一個是Ptt Movie版討論串'PttComment.csv', 如下圖：
MovieTitle.csv

PttComment.csv

做字串比對使用.str.contains方法 程式碼如下：
  `import pandas as pd
   # 匯入 PttComment
   movies = pd.read_csv("PttComment.csv").dropna(how='all')
   movies["title"] = movies["title"].astype("category")
   # 匯入 MovieTitle
   titles = pd.read_csv("MovieTitle.csv")
   key_word = titles.iloc[:, 7]
   
   newDF = pd.DataFrame() # 新增DataFrame 儲存結果
   
   for key in key_word:
        mask = movies["title"].str.contains(key) # 字串比對
        movies["key_word"] = key  # 新增欄位把找到的keyword標記上去
        newDF = newDF.append(movies[mask], ignore_index=True)
       
   newDF.to_csv('newdata.csv', index=False) # 匯出新資料
   `
   

結果如下圖：

問題：
想請問各位大大，目前這做法跟方向是對的嗎?
還是爬蟲工具就可以做到資料比對了? (我是使用Scrapy)
Pandas有其他更好的方法可以做到嗎? (假如在資料量大的時候)
另外如果想去計算'負雷'跟'好雷'的次數該怎麼做呢?
如果程式碼有誤還請各位大大不吝指教!!


標題:npm run 開發環境安裝問題！生產環境架設？
標籤:npm python vue.js nginx ubuntu 

想問問開發環境安裝的問題
就是像 vue 這種框架，只要 npm run serve 他就可以自動產生 port 直接可訪問（本端開發時）
不需要透過 nginx 再另外設定
這是實際可以自己做的事嗎？還是安裝框架才會有的東西？
包括 laravel 也是直接 run 就可以產生 port 根本不需要透過 nginx
以及 vue 在本端 npm run build 就會產生編譯後的 dist ，這個時候才可以丟在 nginx 上跑
甚至可以寫個腳本，當透過 git push 專案到 master 時，伺服器可以自己部署（跑 pm run build）！？
有大大可以簡易講解嗎？
萬分感激！


標題:python 無法使用OpenGL問題error.NullFunctionError( OpenGL.error.NullFunctionError
標籤:python opengl 

完整問題:
error.NullFunctionError( OpenGL.error.NullFunctionError: Attempt to call an undefined function glutInit, check for bool(glutInit) before calling
我是win10 64位元電腦
python環境則是3.8.5
我做了以下的事情
pip install PyOpenGL
pip install PyOpenGL_accelerate-3.1.5-cp38-cp38-win_amd64.whl
並且將
glut64.dll
glut32.dll
glut.dll
都丟進我的專案裡跟python程式放在同一個目錄
我有參考了
https://stackoverflow.com/questions/39181192/attempt-to-call-an-undefined-function-glutinit
https://aben20807.blogspot.com/2017/07/1060705-python3pyopengl.html


標題:Python 爬蟲不安全網站的問題 
標籤:python 網路爬蟲 ssl 

我要抓環保署中的資料
但是它是不安全的網站
我在我python 3.6 的 shell 執行下面的程式碼
是可以跑出東西的
如圖:

但是我額外儲存在一個.py程式檔再執行卻有錯誤
import requests
import urllib3
urllib3.disable_warnings()
r=requests.get("https://sta.ci.taiwan.gov.tw/STA_AirQuality_EPAIoT/v1.0/Datastreams?$expand=Thing,Observations($orderby=phenomenonTime%20desc;$top=1)&$filter=Thing/properties/city%20eq%20%27%E5%98%89%E7%BE%A9%E5%B8%82%27%20and%20name%20eq%27PM2.5%27&$count=true",verify=False)
               
print(r.content.decode('utf-8'))


錯誤:

已經試過pip3 install urllib3 --upgrade
pip install --upgrade requests
但是都不行
請問要怎麼改進才能讓他可以執行?
或是有別的可以抓不安全網站的方式


標題:[程式新手發問] Pandas 資料合併問題
標籤:#python #pandas #資料處理 #資料結構 

各位前輩好, 小弟是剛接觸 Python 的新手
以下是小弟的 DataFrame 資料, 資料夾內有數份 json 檔
目前先讀取了兩份 json 轉成 DataFrame 格式後如下圖
import json
import pandas as pd

Data1 = pd.read_json("D:/PHM/正常/Data1.json")
Data2 = pd.read_json("D:/PHM/正常/Data2.json")
DataFrame1 = pd.DataFrame(Data1) # 轉成 DataFrame
DataFrame2 = pd.DataFrame(Data2) 
display(DataFrame1,DataFrame2)


假如資料內我只需要其中一列 "DSY"
欲將兩份資料的 DSY 合併成一份資料 (不是串聯而是並列的方式)
應該使用那些程式碼來完成呢?
目前找到的方法最接近的應該是 insert 的方式, 可是試了幾次達不到想要的效果
麻煩各位前輩指點, 謝謝~
DataFrame_DSY1 = DataFrame1[["DSY"]] # 取出 DSY
DataFrame_DSY2 = DataFrame2[["DSY"]]
display(DataFrame_DSY1,DataFrame_DSY2)




標題:(已解決)python串接元大OneAPI問題
標籤:python3 dll c# 

系統windows 7 x86
python 3.8.5 x86
最近用python串接元大oneapi遇到下面的問題
Traceback (most recent call last):
  File "C:\Users\trevor\Desktop\HSUNJEN\YuantaOneOrder.py", line 9, in <module>
    objYuantaOneAPI.Login(System.String('98875005091'), System.String('1234'))
System.NullReferenceException: 並未將物件參考設定為物件的執行個體。
   於 YuantaOneAPI.YuantaOneAPITrader.Login(String Account, String Password)

原始碼：
import clr
import System
path = "c://Yuanta//ONE//YuantaOneAPI.dll"
clr.AddReference(path)

from YuantaOneAPI import YuantaOneAPITrader
objYuantaOneAPI = YuantaOneAPITrader()
objYuantaOneAPI.Open()
objYuantaOneAPI.Login(System.String('98875005091'), System.String('1234'))

HELP資訊：
Help on YuantaOneAPITrader in module YuantaOneAPI object:

class YuantaOneAPITrader(System.Object)
 |  Void .ctor()
 |  
 |  Method resolution order:
 |      YuantaOneAPITrader
 |      System.Object
 |      builtins.object
 |  
 |  Methods defined here:
 |  
 |  __call__(self, /, *args, **kwargs)
 |      Call self as a function.
 |  
 |  __delitem__(self, key, /)
 |      Delete self[key].
 |  
 |  __eq__(self, value, /)
 |      Return self==value.
 |  
 |  __ge__(self, value, /)
 |      Return self>=value.
 |  
 |  __getitem__(self, key, /)
 |      Return self[key].
 |  
 |  __gt__(self, value, /)
 |      Return self>value.
 |  
 |  __hash__(self, /)
 |      Return hash(self).
 |  
 |  __init__(self, /, *args, **kwargs)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |  
 |  __iter__(self, /)
 |      Implement iter(self).
 |  
 |  __le__(self, value, /)
 |      Return self<=value.
 |  
 |  __lt__(self, value, /)
 |      Return self<value.
 |  
 |  __ne__(self, value, /)
 |      Return self!=value.
 |  
 |  __repr__(self, /)
 |      Return repr(self).
 |  
 |  __setitem__(self, key, value, /)
 |      Set self[key] to value.
 |  
 |  __str__(self, /)
 |      Return str(self).
 |  
 |  ----------------------------------------------------------------------
 |  Static methods defined here:
 |  
 |  __new__(*args, **kwargs) from CLR.CLR Metatype
 |      Create and return a new object.  See help(type) for accurate signature.
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |  
 |  Close
 |      Void Close()
 |  
 |  Dispose
 |      Void Dispose()
 |  
 |  Finalize
 |      Void Finalize()
 |  
 |  GetQuoteList
 |      Boolean GetQuoteList()
 |  
 |  GetQuoteListDetail
 |      Boolean GetQuoteListDetail()
 |  
 |  LogOut
 |      Boolean LogOut()
 |  
 |  Login
 |      Boolean Login(System.String, System.String)
 |  
 |  OnResponse
 |  
 |  Open
 |      Void Open(YuantaOneAPI.enumEnvironmentMode)
 |  
 |  Overloads
 |  
 |  RQ
 |      Boolean RQ(System.String, YuantaOneAPI.YuantaDataHelper)
 |  
 |  SendFutureOrder
 |      Boolean SendFutureOrder(System.String, System.Collections.Generic.List`1[YuantaOneAPI.FutureOrder], YuantaOneAPI.enumLangType)
 |  
 |  SendOVFutureOrder
 |      Boolean SendOVFutureOrder(System.String, System.Collections.Generic.List`1[YuantaOneAPI.OVFutureOrder], YuantaOneAPI.enumLangType)
 |  
 |  SendStockOrder
 |      Boolean SendStockOrder(System.String, System.Collections.Generic.List`1[YuantaOneAPI.StockOrder], YuantaOneAPI.enumLangType)
 |  
 |  SetLogType
 |      Void SetLogType(YuantaOneAPI.enumLogType)
 |  
 |  ShowPostA
 |      Void ShowPostA(Boolean)
 |  
 |  SubscribeFiveTickA
 |      Boolean SubscribeFiveTickA(System.Collections.Generic.List`1[YuantaOneAPI.FiveTickA], YuantaOneAPI.enumLangType)
 |  
 |  SubscribeFiveTickB
 |      Boolean SubscribeFiveTickB(System.Collections.Generic.List`1[YuantaOneAPI.FiveTickB], YuantaOneAPI.enumLangType)
 |  
 |  SubscribeQuote
 |      Boolean SubscribeQuote(System.String, YuantaOneAPI.YuantaDataHelper)
 |  
 |  SubscribeStockTick
 |      Boolean SubscribeStockTick(System.Collections.Generic.List`1[YuantaOneAPI.StockTick], YuantaOneAPI.enumLangType)
 |  
 |  SubscribeWatchlist
 |      Boolean SubscribeWatchlist(System.Collections.Generic.List`1[YuantaOneAPI.Watchlist], YuantaOneAPI.enumLangType)
 |  
 |  SubscribeWatchlistAll
 |      Boolean SubscribeWatchlistAll(System.Collections.Generic.List`1[YuantaOneAPI.WatchlistAll], YuantaOneAPI.enumLangType)
 |  
 |  UnsubscribeFivetickA
 |      Boolean UnsubscribeFivetickA(System.Collections.Generic.List`1[YuantaOneAPI.FiveTickA], YuantaOneAPI.enumLangType)
 |  
 |  UnsubscribeFivetickB
 |      Boolean UnsubscribeFivetickB(System.Collections.Generic.List`1[YuantaOneAPI.FiveTickB], YuantaOneAPI.enumLangType)
 |  
 |  UnsubscribeQuote
 |      Boolean UnsubscribeQuote(System.String, YuantaOneAPI.YuantaDataHelper)
 |  
 |  UnsubscribeStocktick
 |      Boolean UnsubscribeStocktick(System.Collections.Generic.List`1[YuantaOneAPI.StockTick], YuantaOneAPI.enumLangType)
 |  
 |  UnsubscribeWatchlist
 |      Boolean UnsubscribeWatchlist(System.Collections.Generic.List`1[YuantaOneAPI.Watchlist], YuantaOneAPI.enumLangType)
 |  
 |  UnsubscribeWatchlistAll
 |      Boolean UnsubscribeWatchlistAll(System.Collections.Generic.List`1[YuantaOneAPI.WatchlistAll], YuantaOneAPI.enumLangType)
 |  
 |  __overloads__
 |  
 |  add_OnResponse
 |      Void add_OnResponse(YuantaOneAPI.OnResponseEventHandler)
 |  
 |  remove_OnResponse
 |      Void remove_OnResponse(YuantaOneAPI.OnResponseEventHandler)
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from System.Object:
 |  
 |  Equals
 |      Boolean Equals(System.Object)
 |      Boolean Equals(System.Object, System.Object)
 |  
 |  GetHashCode
 |      Int32 GetHashCode()
 |  
 |  GetType
 |      System.Type GetType()
 |  
 |  MemberwiseClone
 |      System.Object MemberwiseClone()
 |  
 |  ReferenceEquals
 |      Boolean ReferenceEquals(System.Object, System.Object)
 |  
 |  ToString
 |      System.String ToString()

API元件：
https://drive.google.com/file/d/1OQXZIZAkwgum2f6QeTJMZluj3IacepoY/view?usp=sharing
希望高手幫幫忙ＸＤ


標題:如何用if選擇for loop
標籤:python python3 

我的迴圈一部分是這樣
for ii in page.select('a'),illustration.select("a"):
    for i in ii:

但是有的時候是沒有illustration這個參數的
有沒有用if或其他方法來避開這個迴圈做出新的迴圈
比如
if illustration:
  for ii in page.select('a'),illustration.select("a"):
    for i in ii:
else:
  for i in page.select('a'):

然後後面是迴圈內容這樣
不過我這方法不行
有甚麼方法嗎


標題:linux 在terminal播放多張照片的問題
標籤:linux cv2 fbi fim python 

小弟最近有個項目是做廣告機的,
用raspberry 加屏幕做播放效果,
有個難題是不知道如何令圖片在某指定位置展示出來(效果是一個屏幕,6張圖片/影片)
(影片已經可以定位及指定layer 播放)
不知道有沒有師兄方法可以做到這效果?
(暫時環境是純CLI介面)
純4段影片效果如下:

就是想加播 天氣/股票/店內廣告


標題:Python: The While Statement 疑問
標籤:python while 

由於是學 Python 的程式新手，連問題都不太知道該如何問，請大家高抬貴手 ＱＱ
目前正在學習 Coursera：用 Python 做商管程式設計（一）
裡頭老師有用 While 寫了一個程式，但我寫一樣的在Atom上卻跑不出來...
程式是想要在輸入大Y或小y時結束此程式，如果輸入其他字母就會不斷詢問，直到輸入Y或y
這是我寫的：

但卻跑出錯誤訊息：

先感謝大家了！


標題:esp8266透過mqtt傳給python的訊息 處理 想請教前輩
標籤:#python 3 mqtt #字串分割 

小弟用ESP8266裝了兩個感測器透過MQTT Broker回傳兩個數值給PYTHON
但我想要進行字串分割 A變數=1號感測數值 B變數=2號感測數值 井水不犯河水
有上網找方法於是寫了<程式一>簡易的這個方法是可以的
但是我用相同的方法給帶入MQTT訊息變數<程式二>,附一張結果圖
<程式一>
msgs = '987,654,321'
strlist = msgs.split(',')

sa = strlist[0]
sb = strlist[1]
sc = strlist[2]

print('分割',sa,sb,sc)

<程式二>
def on_message(client, userdata, msg):
    # 轉換編碼utf-8才看得懂中文 
    global msgs , msg01

    msgs = (msg.payload.decode('utf-8'))
    strlist = msgs.split(',')
    sa = strlist[0]#1號數值
    sb = strlist[0]#2號數值
    print('1號感測數值:',sa)#1號數值
    print('2號感測數值:',sb)#2號數值

<結果圖>

我需要的情境是如下 感測數值分明
1號感測數值: 2
2號感測數值: 28415
1號感測數值: 2
2號感測數值: 28415
1號感測數值: 2
2號感測數值: 28415
請問各位前輩是出了什麼問題


標題:各位前輩好 關於python def有些事想請教
標籤:#python3 

小弟最近正在學習如何 使用esp8266接上感測器透過Mqtt把資料傳至Python GUI上
#樹莓派=MQTT伺服器
目前PYTHON 終端機可以印出MQTT傳來的資料
我想調用def內的字串把他拿到外面來套用variable 來讓label文字不斷更新
出現以下情形

出現問題的地方
var = tk.StringVar()
var.set(msgs)

# 當接收到從伺服器發送的訊息時要進行的動作
def on_message(client, userdata, msg):
    # 轉換編碼utf-8才看得懂中文 
    global msgs
  

    msgs = (msg.topic+" "+ msg.payload.decode('utf-8'))
    print(msg.topic+" "+ msg.payload.decode('utf-8'))



標題:pandas串接1000個大小為1*10000的dataframe，是否有技巧加速?
標籤:python pandas 

版本資訊
先附上自己的程式版本資訊:
python版本3.7(用Spyder IDE開發)
pandas版本0.23.4
名詞定義
為避免不同地區的行、列有歧義，
本問題指的行(columns)、列(row)為「直行橫列」
問題描述
假設我們有大約1000個1*n的dataframe，
n的值大約是一萬左右，
dataframe中的每的格子是一個浮點數，
資料量非常大，
每個dataframe的column名稱可能重複也可能不重複，
我想要將這些dataframe串接成一個1000列的dataframe
目前想到的方法是用pandas內建的concat函數來做
測試範例
為了方便測試，這邊我用隨機生成的資料表做測試，
(由於1000個dataframes有點多，測試只生成100個)
如下:
import random
import pandas as pd
import time

def random_str(length=4):
    return ''.join([chr(ord('a')+random.randrange(26)) for _ in range(length)])

def random_df(col_num):
    data = {}
    for _ in range(col_num):
        key = random_str()
        data[key] = [random.uniform(0,1)]
    return pd.DataFrame.from_dict(data)

random.seed(100) #為了確保每次產生的結果相同，設固定的seed
datas = [random_df(10000) for _ in range(100)]

## 以下開始做concat的測試
start = time.time()
res = pd.DataFrame()
for d in datas:
    res = pd.concat([res,d], ignore_index=True)
end = time.time()
print(f"串接dataframes時間: {end-start:4f}")

這支程式首先生成100個「一列(row)*約10000行(column)」的資料表，
欄位名稱為隨機產生的4個英文字母，
然後用for迴圈合併
然而可能是資料量大，
一直做concat很耗時，
我在自己的電腦上執行這段程式碼(concat的部分)要651秒之久，
想問是否有好的加速方法呢?
非常感謝大家協助
由於跑651秒實在非常耗時，
以下給個迷你範例方便大家在自己電腦上測
迷你範例- 只串接5個dataframes
以下程式在我的電腦上執行約8秒，還是有點久。
import random
import pandas as pd
import time

def random_str(length=4):
    return ''.join([chr(ord('a')+random.randrange(26)) for _ in range(length)])


def random_df(col_num):
    data = {}
    for _ in range(col_num):
        key = random_str()
        data[key] = [random.uniform(0,1)]
    return pd.DataFrame.from_dict(data)

random.seed(100) #為了確保每次產生的結果相同，設固定的seed
datas = [random_df(10000) for _ in range(5)]

## 以下開始做concat的測試
start = time.time()
res = pd.DataFrame()
for d in datas:
    res = pd.concat([res,d], ignore_index=True)
end = time.time()
print(f"串接dataframes時間: {end-start:4f}")



標題:使用 python 連接 RabbitMQ 問題
標籤:python rabbitmq pika 

各位好，我想請問一下
我開了一台虛擬機(IP 為 192.168.0.102)，裡面有裝 RabbitMQ
我如果在實體機上輸入 http://192.168.0.102:15672/ 可以顯示畫面
我照著官網給的資訊寫了一小段程式，在實體機上，如下
因為我看官網寫的是 localhost 所以想說改成用虛擬機的 IP 192.168.0.102 嘗試看看，可是失敗了
請問要怎麼做才能從實體機連入虛擬機，有辦法嗎?

在虛擬機裡用 localhost 可以正常執行，沒問題

感謝

producer.py

import pika

# 連接 rabbitmq
connection = pika.BlockingConnection(pika.ConnectionParameters('192.168.0.102'))

# 頻道 控制對象
channel = connection.channel()

# 創建對列
channel.queue_declare(queue='hello')

# 向對指定列插入數據
channel.basic_publish(exchange='', # 簡單模式
                      routing_key='hello', # 指定對列
                      body='Hello World!') # 指定數據

print(" [x] Sent 'Hello World!'")

error message(在實體機上跑的結果)
Traceback (most recent call last):
  File "01_producer.py", line 5, in <module>
    connection = pika.BlockingConnection(pika.ConnectionParameters('192.168.0.102'))
  File "C:\Users\pcymi\AppData\Local\Programs\Python\Python38\lib\site-packages\pika\adapters\blocking_connection.py", line 359, in __init__
    self._impl = self._create_connection(parameters, _impl_class)
  File "C:\Users\pcymi\AppData\Local\Programs\Python\Python38\lib\site-packages\pika\adapters\blocking_connection.py", line 450, in _create_connection
    raise self._reap_last_connection_workflow_error(error)
pika.exceptions.ProbableAuthenticationError: ConnectionClosedByBroker: (403) 'ACCESS_REFUSED - Login was refused using authentication mechanism PLAIN. For details see the broker logfile.'



標題:[已解決] vscode終端無法進入虛擬環境env
標籤:vscode env python 


即使在這裡選擇了env
vscode下面的終端還是在原本的環境
目前想操作虛擬環境只能在windows的cmd下

全世界亂刪亂逛之後終於莫名其妙搞定了
先選擇編譯器，再重新開新的終端就有env了


標題:如何在Visual Studio Code安裝pygame模組
標籤:python visual studio code 

我在延伸模組安裝了pygame snippets
但在import pygame的時候無法使用，請問要怎麼解決還是要取哪裡安裝?


標題:Rasberry Pi 製作 HTTP Server  不成功
標籤:raspberry pi python3 httpserver wifi 

我嘗試過使用以下的程式碼
    from http.server import BaseHTTPRequestHandler, HTTPServer
    from numbers import Number

    times = None

    class RequestHandler_httpd(BaseHTTPRequestHandler):
      def do_GET(self):
        global times
        times = (times if isinstance(times, Number) else 0) + 1
        messagetosend = bytes(times,"utf")
        self.send_response(200)
        self.send_header('Content-Type', 'text/plain')
        self.send_header('Content-Length', len(messagetosend))
        self.end_headers()
        self.wfile.write(messagetosend)
        print(self.requestline)
        return


    server_address_httpd = ('IP',8080)
    httpd = HTTPServer(server_address_httpd, RequestHandler_httpd)
    print('starting server')
    httpd.serve_forever()
    times = 0

但是當我在網址列輸入'IP':8080時
得不到預期中的效果
請問可以幫忙修改程式碼嗎?


標題:請問Django如何抓取讀卡機中卡片資料
標籤:python django 讀卡機 

請問各位大神:
Django要如何才能抓取讀卡機中卡片內碼(UID)
目前是有一個網頁中的input
希望能夠在使用者插入卡片後
發送APDU
讀出卡片資料並填入input後送出
如果是一般python代碼 已經知道能用pyscard
但是不知道怎麼透過Django或是能夠透過瀏覽器
讓用戶端能夠實現


標題:如何將字串加入Tuple當中?
標籤:python 




標題: Python爬蟲 抓取不到span裡面的文字
標籤:python 網頁爬蟲 




目前我需要爬台電負載的資料，但是span裡面那個...就讀不進去了(圖三)，但是我需要的資料在展開列裡面，以下是我的code:
import requests
tai = "https://www.taipower.com.tw/d006/loadGraph/loadGraph/genshx_.html"
response = requests.get(tai)
file_obj = open('douban.html', 'w')
file_obj = open('douban.html', 'w', encoding="utf-8")
file_obj.write(response.content.decode('utf-8'))
file_obj.close()
print(response.content.decode('utf-8'))
from bs4 import BeautifulSoup
file_obj = open('douban.html', 'r', encoding="utf-8")
html = file_obj.read()
file_obj.close()
soup = BeautifulSoup(html, 'lxml')
all_ed = soup.find_all('span', id = "nestSumId")
print(all_ed)


標題:python當中regex的用法
標籤:regex python3 python linebot 

因為最近在學習寫linebot，想要使用關鍵字回覆的功能，但是個先前沒有學過程式語言的新手
message = '我肚子很餓，怎麼辦？'
if re.search('我.*?餓.*?怎麼辦',message)
    print('去吃泡麵')

是可行的
但若
message = '怎麼辦我肚子好餓～'

就不行了，三個關鍵字中間出現順序性，
想要三個關鍵字中間不要出現順序性，且要三個關鍵字同時出現就可以print出我想要的字句
想要請問該怎麼解決呢？


標題:python class實體物件的搜尋與刪除
標籤:python class 

請問


我用一個list存了一個班級的學生資料(實體物件)  我要怎麼找特定英文成績且特定數學成績的學生資料(物件)


如上題，我想把這個學生資料完全消除 該如何撰寫呢?


我想要按照英文成績排列學生，該怎麼sort比較好?



p.s也不一定要用list存，我自學不確定是不是用list比較好
ex.
class student:
name,en,math.....
data=[]
for
{
data.append(student(eric,92,90))
}


標題:python chromedriver send_keys數字異常
標籤:python系列文章 網路爬蟲 

各位大大 程式功能是爬取身分證的網站資料，在圖形介面選擇發證日期2號或22號後使用sendkeys填入網頁的數字會異常，在選擇1月或11月時也會出現一樣的狀況，程式碼有點雜亂請見諒
下面3張是程式需要的檔案

程式碼如下:
import os
from selenium import webdriver
import tkinter as tk
from tkinter import ttk,messagebox
from datetime import date
import time
from selenium.webdriver.support import expected_conditions as EC
from PIL import Image, ImageDraw,ImageFont,ImageTk
from selenium.webdriver.common.action_chains import ActionChains
from datetime import datetime
from io import BytesIO
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.common.by import By
from docx import Document
from docx.shared import Inches
from docx.shared import Cm, Pt  #加入可調整的 word 單位
class main_function():
driver=None
driver2=None
name_1=None
id_1=None
id_2=None
id_3=None
date_start=None
date_end=None
window=None
code=None
listbox=None
select=None
radioValue=None
issue_date=None
local_path = os.path.dirname(file)+'/'
start_time = int(datetime.today().strftime('%Y%m%d'))-19120000
end_time = int(datetime.today().strftime('%Y%m%d'))-19110000
now_year = int(datetime.today().strftime('%Y'))-1911

month_list =['1','2','3','4','5','6','7','8','9','10',"11",'12']
day_list =['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21',"22",'23','24','25','26','27','28','29','30','31']
year_list =['110','109','108','107','106','105','104','103','102','101','100','99','98','97','96','95','94']
type_list =['初發','補發','換發'] 
locate_list =['北市','北縣','新北市','基市','桃市','桃縣','中市','中縣','南市','南縣','高市','高縣','宜縣','竹市','竹縣','苗縣','彰縣','投縣','雲縣','嘉市','嘉縣','屏縣','東縣','花縣','澎縣','連江','金門',] 

def __init__(self):
    self.gui()
    
def browser_on(self):   #開啟瀏覽器
    try:
        chrome_options = webdriver.ChromeOptions()                         #||
        chrome_options.add_argument("headless")                           #||   
        chrome_options.add_argument("--window-size=900,550")               #||
        chrome_options.add_argument("--proxy-server='direct://'");         #||
        chrome_options.add_argument("--proxy-bypass-list=*");              #||隱藏瀏覽器設定
        self.update_status('開啟瀏覽器...')
        capa = DesiredCapabilities.CHROME
        capa["pageLoadStrategy"] = "none" 
        self.driver2 = webdriver.Chrome(executable_path='chromedriver.exe',options=chrome_options,desired_capabilities=capa)
        self.driver = webdriver.Chrome(executable_path='chromedriver.exe',options=chrome_options)
        self.get_verifycode_image()
        self.update_status('開啟完成')
    except:
        messagebox.showerror(title = "未安裝驅動程式",message = '※未安裝驅動程式，請閱說明※')
        self.window.destroy()
        
def search(self,url,site):     #查詢&截圖
    self.driver.get(url)  
    self.update_status(site+'查詢中...')
    time.sleep(0.7)

    verify_name = self.name_1.get()
    verify_id = self.id_1.get()
    verify_startt = self.date_start.get()
    verify_endt = self.date_end.get()
    
    self.driver.find_element_by_name("clnm").send_keys(verify_name)
    self.driver.find_element_by_name("idno").send_keys(verify_id)
    self.driver.find_element_by_name("sddtStart").send_keys(verify_startt)
    self.driver.find_element_by_name("sddtEnd").send_keys(verify_endt)

    if site == '消債事件':
        self.driver.find_elements_by_xpath('//input[@value="1"]')[0].click()
    elif site == '破產事件':
        self.driver.find_elements_by_xpath('//input[@value="2"]')[0].click()

    self.driver.find_element_by_name('Button').click()

    if EC.alert_is_present()(self.driver):           #錯誤處理
        self.driver.switch_to_alert().dismiss()
        self.update_status('※身份證字號錯誤，請重新輸入※') 
       
    self.update_status('查詢成功')
    _date = date.today().strftime("%Y%m%d")
    img_name = '{}{}.png'.format(site,verify_name)     #命名並儲存檔案
    
    self.driver.save_screenshot(img_name)     #截圖
 
    self.update_status('已儲存{}'.format(img_name))
def search_2(self):
    verify_name = self.name_1.get()
    verify_id = self.id_1.get()
    self.driver.get('https://report.taifex.com.tw/FMS/login.html')  
    self.update_status('開戶數查詢中...')
    time.sleep(0.7)
    self.driver.find_element_by_name("username").send_keys('F008000')
    self.driver.find_element_by_name("subId").send_keys('89')
    self.driver.find_element_by_name("j_password").send_keys('Aa1234567')
    self.driver.find_elements_by_xpath('//img[@title="登入系統"]')[0].click()
    time.sleep(0.7)
    self.driver.find_element_by_id("ext-gen42").click()
    time.sleep(0.7)
    self.driver.find_element_by_id("ext-gen48").click()
    time.sleep(0.7)
    self.driver.find_element_by_id("ext-gen49").click()

    frame = self.driver.find_element_by_css_selector('iframe')
    self.driver.switch_to_frame(frame)
    time.sleep(0.7)
    self.driver.find_elements_by_xpath('/html/body/form/table/tbody/tr[3]/td/table/tbody/tr[1]/td/table/tbody/tr/td[2]/input')[0].send_keys(verify_id)
    self.driver.find_elements_by_xpath("/html/body/form/table/tbody/tr[3]/td/table/tbody/tr[3]/td/input")[0].click()
    self.update_status('查詢成功')
    
    _date = date.today().strftime("%Y%m%d")
    img_name = '{}{}.png'.format('開戶數',verify_name)     #命名並儲存檔案
    self.driver.save_screenshot(img_name)     #截圖

    self.update_status('已儲存{}'.format(img_name))
    time.sleep(0.5)
    self.update_status('違約查詢中...')
    self.driver.switch_to_default_content()
    time.sleep(0.7)
    self.driver.find_element_by_id("ext-gen45").click()
    time.sleep(0.7)
    self.driver.find_element_by_id("ext-gen46").click()
    frame = self.driver.find_element_by_css_selector('iframe')
    self.driver.switch_to_frame(frame)
    time.sleep(0.7)
    self.driver.find_elements_by_xpath("/html/body/table/tbody/tr[4]/td/input")[0].click()
    time.sleep(0.7)
    self.driver.find_elements_by_xpath('//input[@name="w_id"]')[0].send_keys(verify_id)
    self.driver.find_elements_by_xpath('//input[@value="單一身分證字號查詢"]')[0].click()
    
    _date = date.today().strftime("%Y%m%d")
    img_name = '{}{}.png'.format('違約',verify_name)     #命名並儲存檔案
    self.driver.save_screenshot(img_name)     #截圖

    self.update_status('已儲存{}'.format(img_name))
def get_verifycode_image(self):
    try:
        self.update_status('獲取驗證碼...')
        self.driver2.find_element_by_id( 'imageBlock_captcha-refresh').click()
        verify = self.driver2.find_element_by_id('captchaImage_captcha-refresh')
        self.driver2.execute_script("arguments[0].scrollIntoView();", verify)
        png = self.driver2.get_screenshot_as_png() 
        left = verify.location['x'] +250
        top = 10  #verify.location['y'] 
        elementWidth = left + verify.size['width'] -30
        elementHeight = top + verify.size['height'] -20
        picture = Image.open(BytesIO(png))
        picture = picture.crop((left, top, elementWidth, elementHeight)) 
        picture.save('勿動/verify_code.png')
        time.sleep(0.2)
        self.update_img()
        self.update_status('獲取成功')
    except:      
    
        try :

            self.driver2.get('https://www.ris.gov.tw/app/portal/3014 ')
            
            wait = WebDriverWait(self.driver2, 2)
            wait.until(EC.presence_of_element_located((By.XPATH,'/html/body/div/div[3]/div/div[1]/div/div/div/div/div/div[12]/a')))
            time.sleep(1)
            frame = self.driver2.find_element_by_css_selector('iframe')
            self.driver2.switch_to_frame(frame)
            time.sleep(1)
            self.update_status('獲取驗證碼...')
            verify = self.driver2.find_element_by_id('captchaImage_captcha-refresh')
            self.driver2.execute_script("arguments[0].scrollIntoView();", verify)
            png = self.driver2.get_screenshot_as_png() 
            left = verify.location['x'] +250
            top = 10  #verify.location['y'] 
            elementWidth = left + verify.size['width'] -30
            elementHeight = top + verify.size['height'] -20
            picture = Image.open(BytesIO(png))
            picture = picture.crop((left, top, elementWidth, elementHeight)) 
            picture.save('勿動/verify_code.png')
            time.sleep(0.2)
            self.update_img()
            self.update_status('獲取成功')
        except:
            self.get_verifycode_image()
def search_3(self):
    verify_name = self.name_1.get()
    self.update_status('身分證查詢中...')
    verify_id = self.id_3.get()

    verify_day = self.combo_day.current()
    verify_month = self.combo_month.current()
    verify_year = self.combo_year.current()
    verify_site = self.combo_locate.current()
    verify_type = self.combo_type.current()
    verify_code = self.verify_code.get()

    self.driver2.find_element_by_id('idnum').send_keys(verify_id)
    self.driver2.find_element_by_id('applyTWY').send_keys(self.year_list[verify_year])
    self.driver2.find_element_by_id('applyMM').send_keys(self.month_list[verify_month])
    self.driver2.find_element_by_id('applyDD').send_keys(self.day_list[verify_day])
    self.driver2.find_element_by_id('siteId').send_keys(self.locate_list[verify_site]) 
    self.driver2.find_element_by_id('applyReason').send_keys(self.type_list[verify_type]) 
    self.driver2.find_element_by_id('captchaInput_captcha-refresh').send_keys(verify_code)
    
    time.sleep(0.5)
    #self.driver2.find_elements_by_xpath('/html/body/div[1]/div[4]/div[1]/div/form/div[4]/button[1]')[0].click()
    time.sleep(1)
    _date = date.today().strftime("%Y%m%d")
    img_name = '{}{}.png'.format('身分證',verify_name)     #命名並儲存檔案

    self.driver2.save_screenshot(img_name)     #截圖

    
    
def search_1(self):
    url='http://domestic.judicial.gov.tw/abbs/wkw/WHD9HN01.jsp'   
    self.search(url,'家事事件')
    url='http://cdcb.judicial.gov.tw/abbs/wkw/WHD9A01.jsp'   
    self.search(url,'消債事件')
    url='http://cdcb.judicial.gov.tw/abbs/wkw/WHD9A01.jsp'   
    self.search(url,'破產事件')

def browser_close(self):    #關閉GUI
    try:
        self.driver2.close()
        self.driver.close()
    except:
        pass
    self.window.destroy()
    
def gui(self):                          #介面設定
    self.window = tk.Tk()
    windowWidth = self.window.winfo_reqwidth()                                  #||
    windowHeight = self.window.winfo_reqheight()                                #||
    positionRight = int(self.window.winfo_screenwidth()/2 - windowWidth/2)+400      #||
    positionDown = int(self.window.winfo_screenheight()/2 - windowHeight/2)-300     #||
    self.window.geometry("+{}+{}".format(positionRight, positionDown))          #||設定介面出現位置
    
    self.window.title('徵信查詢系統')
    self.window.geometry('400x560')
    var = tk.StringVar()
    
    move_x = 0
    move_y = 15
    self.name_1 = ttk.Entry(self.window, font="微軟正黑體 13 ")      
    self.id_1 = ttk.Entry(self.window, font="微軟正黑體 13 ", textvariable=var)
    self.date_start = ttk.Entry(self.window, font="微軟正黑體 11 ")
    self.date_end = ttk.Entry(self.window, font="微軟正黑體 11 ") 
    self.name_1.place(x =130,y=10+move_y,width=120)
    self.id_1.place(x =130,y=43+move_y,width=120)
    
    self.date_start.insert(0, self.start_time)
    self.date_end.insert(0, self.end_time)

    style = ttk.Style()
    style.configure("TButton", foreground="red", background="orange")

    label1 = ttk.Label(self.window, text='姓名 :', font="微軟正黑體 15 bold").place(x =73,y=10+move_y) 
    label_id_1 = ttk.Label(self.window, text='身分證字號 :', font="微軟正黑體 15 bold").place(x =13,y=40+move_y)
    label_id_2 = ttk.Label(self.window, text='身分證字號 :', font="微軟正黑體 15 bold").place(x =13,y=146+move_y)
    label_id_3 = ttk.Label(self.window, text='身分證字號 :', font="微軟正黑體 15 bold").place(x =13,y=215+move_y)
    label3 = ttk.Label(self.window, text='日期範圍 :', font="微軟正黑體 15 bold").place(x =33,y=73+move_y)
    label4 = ttk.Label(self.window, text='~', font="微軟正黑體 15 bold").place(x =210,y=73+move_y)
    label5 = ttk.Label(self.window, text='發證日期 :', font="微軟正黑體 15 bold").place(x =33,y=245+move_y)
    label6 = ttk.Label(self.window, text='發證地點 :', font="微軟正黑體 13 bold").place(x =29,y=275+move_y)
    label7 = ttk.Label(self.window, text='類別 :', font="微軟正黑體 13 bold").place(x =181,y=275+move_y)
    label8 = ttk.Label(self.window, text='圖形 :', font="微軟正黑體 15 bold").place(x =60,y=322+move_y)
    label10 = ttk.Label(self.window, text='※家事、消債查詢 ', font="微軟正黑體 11 bold").place(x =10,y=2)
    label111 = ttk.Label(self.window, text='※違約、開戶數查詢 ', font="微軟正黑體 11 bold").place(x =10,y=118+move_y)
    label112 = ttk.Label(self.window, text='※身分證查詢 ', font="微軟正黑體 11 bold").place(x =10,y=188+move_y)
    label115 = ttk.Label(self.window, text='資料起始日期： 94年12月21日 ', style="TButton", font="微軟正黑體 9 bold").place(x =110,y=188+move_y)
    label113 = ttk.Label(self.window, text='驗證碼 :', font="微軟正黑體 13 bold").place(x =47,y=372+move_y)

    self.combo_year  = ttk.Combobox(self.window, width=3,values=self.year_list)
    self.combo_month  = ttk.Combobox(self.window, width=3,values=self.month_list)
    self.combo_day  = ttk.Combobox(self.window, width=3,values=self.day_list)
    self.combo_locate = ttk.Combobox(self.window, width=6,values=self.locate_list)
    self.combo_type = ttk.Combobox(self.window, width=5,values=self.type_list)
    separator_1 = ttk.Separator(self.window, orient="horizontal")
    separator_1.place(x=10,y=110+move_y, width=400)
    
    separator_2 = ttk.Separator(self.window, orient="horizontal")
    separator_2.place(x=10,y=180+move_y, width=400)
    
    search_btn = tk.Button(self.window, text='查詢',width=5, command= lambda: [self.search_1()], font="微軟正黑體 16 bold")
    search_btn2 = tk.Button(self.window, text='查詢',width=5, command= lambda: [self.search_2()], font="微軟正黑體 16 bold")
    search_btn3 = tk.Button(self.window, text='查詢',width=5, command= lambda: [self.search_3()], font="微軟正黑體 16 bold")
    search_btn4 = tk.Button(self.window, text='組合圖片',width=7, command= lambda:[self.transword()], font="微軟正黑體 11 bold")
    re_img=ImageTk.PhotoImage(Image.open('勿動/refresh.png').resize((30, 30), Image.ANTIALIAS))
    refresh_btn = tk.Button(self.window, text='刷新',image = re_img ,width=30,height = 30, command= lambda: self.get_verifycode_image(), font="微軟正黑體 16 bold")
    self.listbox=tk.Listbox(self.window,height=7,width=48)
    
    self.id_2 = ttk.Entry(self.window, font="微軟正黑體 13 ", textvariable=var).place(x =130,y=146+move_y,width=120+move_y)  
    self.id_3 = ttk.Entry(self.window, font="微軟正黑體 13 ", textvariable=var)
    self.id_3.place(x =130,y=215+move_y,width=120+move_y) 
    self.issue_date = ttk.Entry(self.window, font="微軟正黑體 11 ")
    
    self.verify_code = ttk.Entry(self.window, font="微軟正黑體 13 ")
    self.verify_code.place(x =121,y=372+move_y,width=80) 

    self.date_start.place(x =130,y=76+move_y,width=80) 
    self.date_end.place(x =230,y=76+move_y,width=80) 
    
    img=ImageTk.PhotoImage(Image.open('勿動/白.png').resize((150, 100), Image.ANTIALIAS))
    self.code = ttk.Label(self.window,image=img)
    self.code.place(x =120,y=307+move_y, width=140, height=60) 

    search_btn.place(x =300,y=20+move_y)
    search_btn2.place(x =300,y=125+move_y)
    search_btn3.place(x =300,y=215+move_y)
    search_btn4.place(x =300,y=365+move_y)
    refresh_btn.place(x =270,y=320+move_y)
    self.combo_locate.place(x=113, y=278+move_y)
    self.combo_year.place(x =130,y=247+move_y)
    self.combo_month.place(x =180,y=247+move_y)
    self.combo_day.place(x =230,y=247+move_y)
    self.combo_type.place(x=230, y=278+move_y)
    self.listbox.place(x=30, y=410+move_y)
    self.window.resizable(0,0)
    self.window.protocol("WM_DELETE_WINDOW", self.browser_close)  #GUI按下X動作
    self.browser_on()
    self.window.mainloop()

def update_img(self):
    img = ImageTk.PhotoImage(Image.open('勿動/verify_code.png').resize((125, 50), Image.ANTIALIAS))
    self.code.configure(image=img)
    self.code.image = img
def update_status(self,status):                    #輸出文字到listbox
    self.listbox.insert(0, time.strftime("%H:%M:%S   ")+status) 
    self.window.update()
    
def transword(self):
    verify_name = self.name_1.get()
    img = Image.open("身分證"+verify_name+".png")
    cropped = img.crop((230,0, 850, 550))  # (left, upper, right, lower)
    cropped.save("身分證"+verify_name+".png")
    
    img = Image.open("違約"+verify_name+".png")
    cropped = img.crop((350,20, 750,170))  # (left, upper, right, lower)
    cropped.save("違約"+verify_name+".png")

    img = Image.open("開戶數"+verify_name+".png")
    cropped = img.crop((350,100, 750,300))  # (left, upper, right, lower)
    cropped.save("開戶數"+verify_name+".png")

    img = Image.open("家事事件"+verify_name+".png")
    cropped = img.crop((30,80, 900,330))  # (left, upper, right, lower)
    cropped.save("家事事件"+verify_name+".png")
    
    img = Image.open("消債事件"+verify_name+".png")
    cropped = img.crop((30,80, 900,330))  # (left, upper, right, lower)
    cropped.save("消債事件"+verify_name+".png")
    
    img = Image.open("破產事件"+verify_name+".png")
    cropped = img.crop((30,80, 900,330))  # (left, upper, right, lower)
    cropped.save("破產事件"+verify_name+".png")




    pic_file_list = os.listdir(file_path)
    doc = Document()
    section = doc.sections[0]
    section.left_margin=Cm(2)
    section.right_margin=Cm(2)
    section.top_margin=Cm(2)
    section.bottom_margin=Cm(2)

    for pic_file in pic_file_list:
        if verify_name in pic_file and pic_file.endswith('.png'):
            doc.add_picture(pic_file, width=Inches(7),height=Inches(2))  # 添加圖片, 設置寬度
            doc.save(file_path + '\\' + verify_name +'.doc') # 命名存檔
            os.remove(pic_file) # 刪除原圖
        

if name == 'main':
main_function()


標題:python 連結 google 試算表 timeout
標籤:google試算表 python urllib3 

我有一個程式碼如下
import gspread
from oauth2client.service_account import ServiceAccountCredentials
scope = ['https://spreadsheets.google.com/feeds',
         'https://www.googleapis.com/auth/drive']
credentials = ServiceAccountCredentials.from_json_keyfile_name('andyto202.json', scope)
gc = gspread.authorize(credentials)
wks = gc.open("UploadByPython").sheet1
print(wks.get_all_values())

就是python連進google試算表讀出資料
在家裡測試是好的(有讀到結果)
但是在公司有下列錯誤訊息(公司要用proxy才能連出去)
錯誤訊息如下
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x0606E568>: Failed to establish a new connection: [WinError 10060] 連線嘗試失敗，因為連線對象有一段時間並未正確回應，或是連線建立失敗，因為連線的主機無法回應。')': /token
請問前輩要怎麼加入proxy
謝謝


標題:python astar演算法
標籤:python a-star networkx 

請問有人會用networkx的astar_path方法嗎?
G=networkx.grid_graph(dim=[30,30])
print(networkx.astar_path(G,(0,0),(5,5)))

[(0, 0), (1, 0), (2, 0), (3, 0), (4, 0), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5)]

我想在矩陣中加入障礙物點
但不知道怎麼加
求幫忙


標題:python win32gui 能檢查頂層窗口hwnd嗎
標籤:win32gui python3 視窗程式 

lol配對成功時會彈到頂層,蠻希望有個程式幫我按接受對戰的...
所以我想寫個程式偵測頂窗口hwnd,等於我要的hwnd時執行動作
win32gui有這功能嗎


標題:[程式新手發問] Python 資料格式問題 (JSON)
標籤:#python #json #資料結構 

各位前輩好, 小弟我第一次發文
最近因公司需要開始學習程式
做資料處理時遇到以下問題：

如圖所示, 拿到手上的資料是類似圖1的格式
但是有些地方需要改成圖2那種正常的JSON
開頭與結尾的地方要有[], 每行結束的地方要有,
爬文嘗試用了以下程式碼來執行但卻不如預期
for fn in folder: # 將檔案夾內每個檔案的主檔名與附檔名分開
    file_name = os.path.splitext(fn)
    if file_name[1] == ".json":
        print(file_name[0])
        with open(path+fn) as f: #逐步讀取檔案
            data = f.readlines()
        vl = []
        for i in enumerate(data): #修正 json 格式
            i.replace("}","},")

請問應該如何下程式碼才能從圖1的格式轉換成圖2的格式
還請各位前輩不吝指教, 會給出最佳解答, 感謝 !!


標題:請益 考試筆記pdf檔 如何在固定位置加上頁數
標籤:python3 

小弟有個網路上大神筆記的pdf檔，想要印下來，只是上面沒有頁數
自己手操又有點累，想請問要用什麼方式才能在固定位置上寫上頁數



標題:各位大神，該如何用python爬goodinfo的資料呢？(現股當沖總獲利 ( 當月 ))
標籤:python python爬蟲 goodinfo 股票爬蟲 大數據 




標題:被要求要提供urllib的版本
標籤:urllib 網路爬蟲 python3 linebot requirememt 

請問各位高手
最近開始學習用python做linebot
我用python進行爬蟲後，要上載到linebot使用
這時將urllib加到requirements.txt 後上傳
出現在要求我提供urllib的版本，請問我要怎麼解決呢？
我上傳到heroku上


標題:根據cosine similarity得出的結果, 如何在dataframe中根據indice尋找相應的資料
標籤:tfidf python dataframe indice 

我有一個dataframe,名為sample_df, 資料大小為3910 行 x 9 列
body_text是抽取sample_df其中一個column(body_text)
question是根據使用者輸入的問題

question_cleaned = processed_query(question)

tfidf_article = tfidf_vector.fit_transform(body_text)
tfidf_question = tfidf_vector.transform(question)

print(f'Shape of tfidf_article:{tfidf_article.shape}, Shape of tifdf_question:{tfidf_question.shape}')

cosine_similarities = linear_kernel(tfidf_article,tfidf_question).flatten()
print(f'length of cosine similarities: {len(cosine_similarities)}')

  
docs_indices = cosine_similarities.argsort()[::-1][:5]
print(f'doc_indices:{docs_indices}') 

score = cosine_similarities[related_docs_indices] 
print(f'score: {score}')



結果如下
Shape of tfidf_article:(3910, 414), Shape of tifdf_question:(7, 414)
length of cosine similarities: 27370
doc_indices:[22357 13724  7781 16496 19156]
score: [0.80544066 0.74396796 0.68608747 0.67502091 0.66033177]

我的問題是: 在使用了cosine similarities的方法後, 我怎樣才能獲得當中的indices讓我可以找回在sample_df相應的數據？因為從結果看到，有些doc_indices的值是超過3910(sample_df長度)。


標題:Python DataFrame 操作
標籤:python3 dataframe pandas 

各位好
最近在學Python，遇到了兩個問題撞牆不知道怎麼解，還請各位給些指點，謝謝。

Q1:
有個df
memberid order_date
a 2020-08-05
a 2020-08-12
a 2020-08-17
b 2020-08-16
b 2020-08-19
c 2020-05-01
c 2020-05-03
c 2020-05-04
c 2020-05-07
要怎麼樣才能找到類似group by memberid 但顯示的是倒數第二筆資料呢
(想像的樣子)
a 2020-08-12
b 2020-08-16
c 2020-05-04

Q2:因為是學SQL慢慢有興趣開始學python 轉換過來一直覺得sql的case when條件式很好用 轉換到python之後 都用apply(lambda x:...) 但最近想轉換str都一直失敗 想請問有沒有別的方法 謝謝
舉例來說
memberid campaign
a bthd
a bthd_sell
a urgent_s
b urgent_s
b urgent_s
c bthd_sell
c bthd_sell
c       christmas
c christmas
想依照條件 campaign == 'bthd_sell', campaign == 'urgent_s' 新開一欄命名為1,2
memberid campaign cam_label
a bthd
a bthd_sell 1
a urgent_s 2
b urgent_s 2
b urgent_s 2
c bthd_sell 1
c bthd_sell 1
c christmas
c christmas
*考慮過用map(dict) 但我目前處理的表該變數有太多種類 只想特定幾個處理一下 其他就null 想問有沒有更方便的解法
小弟有努力在搜索相關資源 嘗試不當伸手牌 但因為入門不久 對相關terms的概念也不深 找不太到相關回答 如果是已經存在的問題 還請鞭小力一點 謝謝各位幫忙了 祝大家周末愉快!


標題:python MQTT Mosquitto
標籤:python3 mosquitto mqtt 

你好
目前正在學習MQTT與PYTHON串接，我先在電腦上安裝Mosquitto 啟動後
進行發布與訂閱，並將資料寫入postgresql。
單一發布與訂閱、寫入是可動作的，但是...
我新增了另一個主題test1,同時訂閱test1/test2 是可以在terminal上收到資料，但是要怎麼把test1/test2 的資料分開，寫入不同table??
請各位給方向或解決方法
更新:以程式碼替換圖片
publish code:
import paho.mqtt.client as mqtt
import random
import json
import datetime
import time

ISOTIMEFORMAT = '%m/%d %H:%M:%S'
client = mqtt.Client()
client.username_pw_set("try","xxxx")
client.connect("127.0.0.1", 1883, 60)

while True:
    t0 = random.randint(0,30)
    t = datetime.datetime.now().strftime(ISOTIMEFORMAT)
    payload = {'Temperature' : t0 , 'Time' : t}
    print (json.dumps(payload))
    #要發布的主題和內容
    client.publish("test", json.dumps(payload))
    #新建立的topic,test1
    client.publish("test", json.dumps(payload))
    time.sleep(5)

subscribe code
import paho.mqtt.client as mqtt
import psycopg2
import pandas as pd

def on_connect(client, userdata, flags, rc):
    print("Connected with result code "+str(rc))
    client.subscribe("test")
    #新訂閱test1
    client.subscribe("test1")
    
# 以上都可以在terminal 上接收topic test1/test2的資訊，但要寫入postgresql同一個database不同table的時候，就寫不進去，在terminal上會繼續跑接收到的資訊，但在資料庫是部會有資料寫入，寫請問這部分怎麼解??

# 當接收到從伺服器發送的訊息時要進行的動作
def on_message(client, userdata, msg):
    # 轉換編碼utf-8才看得懂中文
    print(msg.payload.decode('utf-8'))
    original = eval(msg.payload.decode('utf-8'))
    try:
        connection = psycopg2.connect(user="postgres",  # 預設使用者
                                      password="",  # 登入密碼
                                      host="127.0.0.1",
                                      port="5432",
                                      database="database_test")  # 要連結的資料庫

        cursor = connection.cursor()
        postgreSQL_insert_Query = '''INSERT INTO mqtttest(time,temperature) VALUES (%s,%s)'''
        recods_to_insert = (original['Time'], original['Temperature'])
        cursor.execute(postgreSQL_insert_Query, recods_to_insert)
        connection.commit()
        count = cursor.rowcount
        print(count, "record inserted successfully")
    except (Exception, psycopg2.Error) as error:
        print("Error while connecting to PostgreSQL", error)
client = mqtt.Client()
client.on_connect = on_connect
client.on_message = on_message
client.username_pw_set("try","xxxx")
client.connect("127.0.0.1", 1883, 60)
client.loop_forever()



標題:用python寫linebot時，用到import pandas就會無法執行
標籤:python pandas linebot 無法執行 import 

因為要使用pandas做資料分析，再回傳到textsendmessage。
但只要import pandas後
整個程式就無法執行
而且是包含有去呼叫的app.py都無法執行
編輯器是VScode，伺服器是heroku

2020/08/22更新
是在requirements.txt 內忘了加pandas沒錯
謝謝大家的回答


標題:Python 存成JSON
標籤:python json 

需求類似如下，會跑迴圈去把需要的資料存進來
存的值可能是另一個 dictionary，說明有簡化
因為資料量比較多，想要用累加的方式逐步增加 JSON(a.json 的格式)
不過會造成結果是{}{}{}的格式錯誤
目前是採用 b.json 的方式最後才存檔，就怕愈後面暫存的資料量太大
import json

temp_all = {}

for i in range(5):
    main = i
    val = {i+1:"temp"}
    temp = {}
    temp[i] = val
    temp_all.update(temp)
    js = json.dumps(temp)
    file = open('a.json', 'a')
    file.write(js)
    file.close()

js = json.dumps(temp_all)
file = open('b.json', 'w')
file.write(js)
file.close()

a.json (格式錯誤)
{
    "0": {
        "1": "temp"
    }
}{
    "1": {
        "2": "temp"
    }
}{
    "2": {
        "3": "temp"
    }
}{
    "3": {
        "4": "temp"
    }
}{
    "4": {
        "5": "temp"
    }
}

b.json (格式正確)
{
    "0": {
        "1": "temp"
    },
    "1": {
        "2": "temp"
    },
    "2": {
        "3": "temp"
    },
    "3": {
        "4": "temp"
    },
    "4": {
        "5": "temp"
    }
}

另一個小疑問
之前用 VSCODE 開既有的 JSON 會是白字(應該是純字串，格式化文件才會是階層有顏色)
{"0":{"1":"temp"},"1":{"2":"temp"},"2":{"3":"temp"},"3":{"4":"temp"},"4":{"5":"temp"}}
但目前存出來的檔案卻直接有顏色(類似已經知道是什麼格式)
不知道為什麼會這樣？
{"0":{"1":"temp"},"1":{"2":"temp"},"2":{"3":"temp"},"3":{"4":"temp"},"4":{"5":"temp"}}



標題:機器學習問題
標籤:機器學習 python python3 人工智慧 

目前在做python 機器學習的project 有plan 但不確定要怎麼操作
主要是根據使用者歷程做出結果預測
(可簡單區分為 0 或 1) (可能走time series 或 pattern 判斷)
每個使用者有各自的csv file
各使用者csv file 內 row 數量 不一 但column數量 一樣
預期會是有兩個資料夾
資料夾 - 0
資料夾 - 1
資料夾內分別會有將近幾千的個csv file
需要讀取兩邊資料夾內的檔案
(這邊比較不懂 要怎樣去兩個資料夾讀取作為input 等於說資料夾本身也是label)
然後做ML
想請問是否有類似的demo code 可供參考呢?


標題:python tkinter BUG
標籤:python tkinter ttk 

各位前輩們安安
小弟我最近在使用tkinter時遇到了一個BUG
debug了很久但實在是不能理解為什麼會出現這個BUG
如圖

我更改了userinfo的資料
但是userinfolist的資料卻跟了變動了
如下圖

程式碼檔案在這
https://drive.google.com/file/d/1l1v-dn5K1yeDaFeisLidUmZXKpdUiiMJ/view?usp=sharing
請問一下哪邊出了什麼問題...


標題:想把資料丟到FHIR上，格式問題請教
標籤:#python #fhir postapi 

post資料至國際FHIR ''Patient''上
http://hapi.fhir.org/resource?serverId=home_r4&pretty=true&resource=Patient
小弟有嘗試照著格式撰寫出現錯誤訊息
程式錄:
def postFHIR11(): #post data to FHIR server RFID
    postdata02 = {
  "resourceType": "Bundle",
  "id": "4ba17d68-022c-478f-ad5a-1fb6b866dda8",
  "meta": {
    "lastUpdated": "2020-08-10T13:55:05.322+00:00"
  },
  "type": "searchset",
  "total": 0,
  "link": [
      {
    "relation": "self",
    "url": "http://hapi.fhir.org/baseR4/Patient"
       }
    ]
}  
    r = requests.post(url = 'http://hapi.fhir.org/baseR4/Patient', data = json.dumps(postdata02))
    print(r.text)
    response = json.loads(r.text)
    print('狀態碼,r.status_code)    

錯誤訊息
{
"resourceType": "OperationOutcome",
"text": {
"status": "generated",
"div": "<div xmlns="http://www.w3.org/1999/xhtml\">Operation Outcome<table border="0"><td style="font-weight: bold;">ERROR[]No Content-Type header was provided in the request. This is required for "CREATE" operation\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\n\t"
},
"issue": [ {
"severity": "error",
"code": "processing",
"diagnostics": "No Content-Type header was provided in the request. This is required for "CREATE" operation"
} ]
}
狀態 400
請問是什麼原因造成的


標題:用dataframe中A欄運算後與儲存至D欄
標籤:dataframe python3 

各位先進好
我想要對以下datafram資料進一步處理

新增一個欄位X
將X的第一行由NGflow/6計算得到
之後的行，如果tempSV>100且NGflow>10，則累加NGflow/6的數值，否則就重設NGflow/6為X的值，我目前用以下的方式計算各個row的X值，但計算出來後該如何寫入現有的dataframe中心的欄位內呢？
謝謝~
sum=0
for i in range(df.shape[0]):
    if(i==0):
        sum=df.iloc[i,2]/6.  #column2為NG flow
    else:
        if(df.iloc[i,2]>10 and df.iloc[i,0]>100):  #column 0為tempSV
            sum=sum+df.iloc[i,2]/6.
        else:
            sum=df.iloc[i,2]/6.
    print(sum)



標題:des 解密 vb python
標籤:des python3 python vb.net visual basic 

小弟我在參考別的大大使用vb 編寫的解密程式
內容如下 :
`
Imports System
Imports System.Security.Cryptography
Imports System.Text
Module Program
Sub Main(args As String())
Dim FileNum As Integer
Dim strTemp As String
    Dim Key As String = "1158CB77"
    Dim hexString As String = "A755DDB424D77F7FBBDFC6B457587092"

    Dim des As New DESCryptoServiceProvider()
    'DESCryptoServiceProvider des = New DESCryptoServiceProvider()
    des.Mode = CipherMode.ECB
    des.IV = Encoding.ASCII.GetBytes(Key)
    des.Padding = PaddingMode.None
    des.Key = Encoding.ASCII.GetBytes(Key)

    Dim y = 2
    Dim s(hexString.Length / 2) As Byte
    Dim j = 0
    'Console.WriteLine(Len(hexString) / 2)
    For i As Integer = 0 To (Len(hexString) / 2 - 1)
        s(i) = Byte.Parse(Mid(hexString, j + 1, 1).ToString() + Mid(hexString, j + 2, 1).ToString(), System.Globalization.NumberStyles.HexNumber)
        'Console.WriteLine(s(i))
        j += 2
    Next
    Dim desencrypt As ICryptoTransform = des.CreateDecryptor()
    Dim h() As Byte = {s(0), s(1), s(2), s(3), s(4), s(5), s(6), s(7), s(8), s(9), s(10), s(11), s(12), s(13), s(14), s(15)}
    '                 {167 ,85   ,221  ,180  ,36   ,215   ,127  ,127  ,187  ,223  ,198  ,180   ,87    ,88    ,112   ,146}
    Dim re As String = Encoding.ASCII.GetString(desencrypt.TransformFinalBlock(h, 0, h.Length))
    Console.WriteLine(re) '1114420095

End Sub

End Module
`
想請教一下最後面的TransformFinalBlock，是怎麼把{167,85,221,180,36,215,127,127,187,223,198,180,87,88,112,146}
變成1114420095的。
小弟我嘗試使用python去翻譯，但都弄不出一個所以然
程式碼如下 :
#!/usr/bin/python
# -*- coding: utf-8 -*-
import binascii
from pyDes import des, CBC, PAD_PKCS5, ECB


def des_encrypt(secret_key, s):
    iv = secret_key
    k = des(secret_key, ECB, iv, pad=None, padmode=None)
    #print(k)
    en = k.encrypt(s, padmode=PAD_PKCS5)
    #print(en)
    return binascii.b2a_hex(en)


def des_decrypt(secret_key, s):
    iv = secret_key
    k = des(secret_key, ECB, iv, pad=None, padmode=None)
    de = k.decrypt(binascii.a2b_hex(s), padmode=PAD_PKCS5)
    return de


secret_str = des_encrypt('1158CB77', '1114420095')
print ('密文:', secret_str)#b'a755ddb424d77f7f6e52fb9e82cc897f'
clear_str = des_decrypt('1158CB77', secret_str)
print ('明文:', clear_str)#b'1114420095'

test='A755DDB424D77F7FBBDFC6B457587092'
clear_str = des_decrypt('1158CB77', test)
print ('test:', clear_str) #None

請前輩們指教一下...


標題:使用 Python ssh 连接到远程服务器，并运行 sudo
標籤:python remote sudo shell 

当我直接在操作系统中运行 “echo Shanghai2010 | sudo -S reboot”，系统可以正常重启，但当我通过 Python aramiko 登录到服务器上，运行却没有任何反应，也没有任何报错，最后一个的 print 可以正常打印出来。
import paramiko

ip = "192.168.1.20"
username = "itmanager"
password = "P@ssw0rd"

client = paramiko.SSHClient()
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
client.connect(ip, port=22, username=username, password=password, timeout=20)
client.exec_command('echo P@ssw0rd | sudo -S reboot')
print("Command have been completed")

但我如果把登录的用户换成 root 用户，就可以正常运行 root 命令了。但其他用户却不行，其他用户，直接登录到系统，运行该命令，是可以正常重启系统的，这个是怎么回事？


標題:請益爬香港高登討論區，使用selenium無果
標籤:selenium beautifulsoup python 網路爬蟲 

即使使用selenium做爬取，html也只會出現以下結果：

程式碼：
!pip install selenium
!apt-get update # to update ubuntu to correctly run apt install
!apt install chromium-chromedriver
!cp /usr/lib/chromium-browser/chromedriver /usr/bin
import sys
sys.path.insert(0,'/usr/lib/chromium-browser/chromedriver')
from selenium import webdriver
chrome_options = webdriver.ChromeOptions()
chrome_options.add_argument('--headless')
chrome_options.add_argument('--no-sandbox')
chrome_options.add_argument('--disable-dev-shm-usage')
wd = webdriver.Chrome('chromedriver',chrome_options=chrome_options)

from bs4 import BeautifulSoup
import re
url = 'https://forum.hkgolden.com/search/T/%E8%82%BA%E7%82%8E'
wd.get(url)
wd.page_source

請問有什麼辦法可以爬嗎？


標題:py 如何隱藏其他程式icon(圖示) 在taskbar(工作列)
標籤:taskbar python 工作列 

這是taskbar(工作列),裡面有一大堆icon(圖示)

我想執行一個程式它能打開其他程式(我打算用webdriver)
但希望不會顯示icon在taskbar
也就是"程式有畫面,但不出現在工作列"
請問透過python能做到嗎


標題:使用 Python 比较两个文件
標籤:python difflib 对比两个文件 

我有两个 txt 文件，我想通过 Python 去比较这两个文件，我不 care 这两个文件具体不同的地方，我就想要的结果就是，这两个文件相同或者不相同。
我尝试使用 difflib 库，具体代码：
import difflib

text1 = open("1.txt").readlines()
text2 = open("2.txt").readlines()

for line in difflib.unified_diff(text1, text2):
    print(line)

1.txt 和 2.txt 是我要做对比的两个 txt 文件，通过 for 循环，找不的是不同的部分。
请问，如何才能去判断，直接输出文件相同或者不相同？


標題:使用 Python 获取 Linux 系统日志
標籤:python linux log 文件写入 换行 python 文件写入 

我有一台远程服务器，安装的是 CentOS，我现在想通过 Python 获取该服务器上的日志（messages）文件，并将内容写入到一个 txt 文件中
import paramiko

ip = "192.168.4.5"
username = "root"
password = "P@ssw0rd"
log = open("log.txt", "w")

client = paramiko.SSHClient()
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
client.connect(ip, port=22, username=username, password=password, timeout=20)
ssh_stdin, ssh_stdout, ssh_stderr = client.exec_command("cat /var/log/messages | grep -i error")
blog.write(str(ssh_stdout.read()))
log.close()
client.close()

通过该方法我可以将日志内容写入到 log.txt 文件中，但是所有脚本内容却写在了同一行。
b'Aug  5 15:45:18 localhost kernel: RAS: Correctable Errors collector initialized.\nAug  5 15:45:19 localhost kernel: [drm] It appears like vesafb is loaded. Ignore above error if any.\nAug  5 15:45:29 localhost mcelog[929]: mcelog: Cannot write MSR_ERROR_CONTROL to /dev/cpu/0/msr\nAug  5 15:45:29 localhost mcelog[929]: mcelog: Cannot write MSR_ERROR_CONTROL to /dev/cpu/1/msr\nAug  5 15:45:42 localhost journal[1474]: Error looking up permission: GDBus.Error:org.freedesktop.portal.Error.NotFound: No entry for geolocation\nAug  5 15:45:42 localhost org.gnome.Shell.desktop[1474]: Errors from xkbcomp are not fatal to the X server\nAug  5 15:45:43 localhost kernel: [drm:vmw_stdu_crtc_page_flip [vmwgfx]] *ERROR* Page flip error -16.\n'

请问这个日志的开头 b 表示什么，有办法去掉吗？
我看了每行日志后面都有换行符，请问我怎么才能在写入 txt 文件的时候，是逐行写入的，而不是在后面加换行符？


標題:MIS問題 : 大神們目前寫維運腳本使用powershell或nodejs或python?
標籤:mis python 

請問大神們,目前寫維運腳本使用 powershell 或 nodejs 或 python ?
目前偏好 powershell ,但網路上的文章讓我感覺只會 powershell 很沒前途。


標題:Python 使用OCR 辨識 身分證(姓名區塊) 該如何進行影像處理才比較妥當
標籤:python3 opencv ocr aiot,物聯網,深度學習,影像辨識,嵌入式 

各位前輩好目前小弟在做OCR的光學字元辨識加上影像處理的測試
目前正在使用身分證然後將切割出來的姓名、身分證字號、出生日期使用OCR輸出結果
身分證 和 出生日期可以正常輸出 但姓名部分無論我使用二值化、侵蝕(膨脹)、銳化、(中值濾波太糊)不使用、始終無法識別沒有輸出任何文字 光線是使用LED燈條很多條非常刺眼光線基本上很充足
附上切割出來的原圖 請恕我把字碼掉 如需原圖請私

想詢問各位前輩會怎麼使用哪種影像處理方式?


標題:LSTM 如何做多步 預測
標籤:lstm python keras 

想請問各位大神:
如果今天為t ，過去天數為t-1、t-2...t-n以此類推，想預測未來天數t+1、t+2...t+n該怎麼做呢?
是類似第一個網站這樣，監督式的概念呢
https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/
還是就像第二個網站，將LSTM的模型改成多對多的方式就是了呢?
https://medium.com/@daniel820710/%E5%88%A9%E7%94%A8keras%E5%BB%BA%E6%A7%8Blstm%E6%A8%A1%E5%9E%8B-%E4%BB%A5stock-prediction-%E7%82%BA%E4%BE%8B-1-67456e0a0b
以下是我練習的範例:
參考至
https://wenwender.wordpress.com/2019/10/18/%E5%AF%A6%E4%BD%9C%E9%80%8F%E9%81%8Elstm%E9%A0%90%E6%B8%AC%E8%82%A1%E7%A5%A8/
pip install FinMind

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline

#2330:TSMC
from FinMind.Data import Load
TaiwanStockInfo = Load.FinData(dataset = 'TaiwanStockInfo')
data = Load.FinData(dataset = 'TaiwanStockPrice',select = '2330',date = '2020-01-01')

data.head()

fig=plt.figure(figsize=(20,8))
plt.xticks(rotation = 90)  
ax1 = fig.add_subplot(111)
ax1.plot(data.close,color='red',label='close')
ax1.plot(data.open,color='green',label='open')
plt.legend()
# twin 為共享x軸
ax2= ax1.twinx()
plt.bar(data.date,data.Trading_Volume.astype('int')//1000)
ax3 = ax1.twinx()
plt.savefig('2330_year.png')

#切分Test集
test = data[data.date>'2020-06-01']
train = data[:len(data)-len(test)]
#只要open high
train_set = train['open']
test_set = test['open']

from sklearn.preprocessing import MinMaxScaler 
sc = MinMaxScaler(feature_range = (0, 1))
#需將資料做reshape的動作，使其shape為(資料長度,1) 
train_set= train_set.values.reshape(-1,1)
training_set_scaled = sc.fit_transform(train_set)

#創建資料集
X_train = [] 
y_train = []
for i in range(10,len(train_set)):
    X_train.append(training_set_scaled[i-10:i-1, 0]) 
    y_train.append(training_set_scaled[i, 0]) 
X_train, y_train = np.array(X_train), np.array(y_train) 
X_train = np.reshape(X_train, 
                         (X_train.shape[0], X_train.shape[1], 1))
                         
print('第i天之前的股價')
print(X_train[0])
print('第i天的股價')
print(y_train[0])

import keras
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers import Dropout,BatchNormalization

keras.backend.clear_session()
regressor = Sequential()
regressor.add(LSTM(units = 100, input_shape = (X_train.shape[1], 1)))
regressor.add(Dense(units = 1))
regressor.compile(optimizer = 'adam', loss = 'mean_squared_error')

regressor.summary()

#只使用一層LSTM層
history = regressor.fit(X_train, y_train, epochs = 100, batch_size = 16)
plt.title('train_loss')
plt.ylabel('loss')
plt.xlabel('Epoch')
plt.plot( history.history["loss"])

dataset_total = pd.concat((train['open'], test['open']), axis = 0)
inputs = dataset_total[len(dataset_total) - len(test) - 10:].values
inputs = inputs.reshape(-1,1)
inputs = sc.transform(inputs)
X_test = []
for i in range(10, len(inputs)):
    X_test.append(inputs[i-10:i-1, 0])
X_test = np.array(X_test)
X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))
predicted_stock_price = regressor.predict(X_test)
#使用sc的 inverse_transform將股價轉為歸一化前
predicted_stock_price = sc.inverse_transform(predicted_stock_price)

plt.plot(test['open'].values, color = 'black', label = 'Real TSMC Stock Price')
plt.plot(predicted_stock_price, color = 'green', label = 'Predicted TSMC Stock Price')
plt.title('TATA Stock Price Prediction')
plt.xlabel('Time')
plt.ylabel('Stock Price')
plt.legend()
plt.show()
# plt.savefig('lstm_2330.png')



標題:FTP連線使用TLS加密於CMD或python 2020/08/04更新
標籤:ftp tls cmd python 

近期有這項稍微奇怪之需求
系統使用windows
python部分使用過
from ftplib import FTP_TLS
ftps = FTP_TLS('FTP位置')
ftps.login(user='帳號',passwd='密碼')
ftps.prot_p()
ftps.nlst()
ftps.quit()
此範例進行過修改
但於ftps.nlst()處皆會錯誤
錯誤碼為
TimeoutError: [WinError 10060] 連線嘗試失敗，因為連線對象有一段時間並未正確回應，或是連線建立失敗，因為連線的主機無法回 應。
請問cmd有內建方法可以使用tls加密連線嗎?
或者該python問題為何呢?
2020/08/04更新進展
...
ftps.prot_p()
print(ftps.getwelcome())
print(ftps.size('OOXX.xml'))
到這邊都可以正確
但如果要對檔案進行上傳或下載則依然會出現
TimeoutError: [WinError 10060] 連線嘗試失敗，因為連線對象有一段時間並未正確回應，或是連線建立失敗，因為連線的主機無法回應。
之錯誤
另外print(ftps.getwelcome())的回傳值會是220 (vsFTPd 3.0.2)


標題:python selenium 彈窗
標籤:python 彈窗 selenium 


如圖
此彈窗似乎不是alert彈窗
我在chrome的設定找了很久，不知道是否有關
請問前輩
我想要使用selenium 點擊開啟「XXX」
不知道有沒有辦法處理


標題:[已解決]期貨當沖資料資料寫入疑問
標籤:python python3 迴圈 判斷式 期貨 

https://ithelp.ithome.com.tw/questions/10199175
這次的問題是上一篇的延伸
在那之後我有把完整程式碼補完整
import pandas as pd
import numpy as np

df = pd.read_excel('C:\\Users\\user\\20200102.xlsx', header=0, index_col=None)  
df = pd.DataFrame(df)

A = np.array(df[:300]['Date'])
B = np.array(df[:300]['Time'])
C = np.array(df[:300]['Open'])
D = np.array(df[:300]['High'])
E = np.array(df[:300]['Low'])
F = np.array(df[:300]['Close'])
G = np.array(df[:300]['Volume'])

H1,H2= [] ,[]

for i in range(0, 300) :
      for x in range(i , 300) :
            if df.at[x, 'High'] - df.at[i, 'Open'] >=20 :
                    H1.append(B[x])
                    H2.append(20)               
                    break
         
            elif df.at[i, 'Open'] - df.at[x, 'Low'] >=20 :
                    H1.append(B[x])
                    H2.append(-20)
                    break

data_dist = { 
    "Date":A,
    "Time":B,
    "Open":C, 
    "High":D, "Low":E,"Close":F,"Volume":G,
"損益時間20 20":H1,"損益20 20":H2}

data_df = pd.DataFrame.from_dict(data_dist, orient='index')
                 
data_df1 = data_df.T

print(data_df1)

#data_df1.to_csv('20200102+-全.csv', encoding='utf_8_sig') 

這次的問題是我想直接統計一年
但結果怪怪的
我想要的是今天統計完
統計隔天的
今天和隔天彼此不相關
也就是執行把上面程式碼執行好幾次
但我迴圈執行出來的東西跟我想要的不一樣
第一天後半部接近13:45分後
第二天之後結果都是錯的
https://imgur.com/rrkHadf

H1.append(B[x])
H2.append(20)
這部分寫入問題
不知道怎麼寫到正確的地方的地方

我自己再努力想想
EXCEL檔案
https://drive.google.com/file/d/1wWD5_bZuSfb23uqCcJoKSKB54uk39TcC/view?usp=sharing
import pandas as pd
import numpy as np

df = pd.read_excel('E:\\future\\2018.xlsx', header=0, index_col=None)  
df = pd.DataFrame(df)

A = np.array(df[:70500]['Date'])
B = np.array(df[:70500]['Time'])
C = np.array(df[:70500]['Open'])
D = np.array(df[:70500]['High'])
E = np.array(df[:70500]['Low'])
F = np.array(df[:70500]['Close'])
G = np.array(df[:70500]['Volume'])

H1,H2= [] ,[]

for d in range (0,235):
    for i in range(0+d*300, 300+d*300) :
        for x in range(i , 300+d*300 ) :
            if df.at[x, 'High'] - df.at[i, 'Open'] >=20 :
                    H1.append(B[x])
                    H2.append(20)               
                    break
         
            elif df.at[i, 'Open'] - df.at[x, 'Low'] >=20 :
                    H1.append(B[x])
                    H2.append(-20)
                    break


data_dist = { 
    "Date":A,
    "Time":B,
    "Open":C, 
    "High":D, "Low":E,"Close":F,"Volume":G,
"損益時間20 20":H1,"損益20 20":H2}

data_df = pd.DataFrame.from_dict(data_dist, orient='index')
                 
data_df1 = data_df.T

print(data_df1)

#data_df1.to_csv('2018+-全.csv', encoding='utf_8_sig') 

程式碼為下方
自己搞錯重點很抱歉
import pandas as pd
import numpy as np

df = pd.read_excel('E:\\future\\2018.xlsx', header=0, index_col=None)  
df = pd.DataFrame(df)

A = np.array(df[:70500]['Date'])
B = np.array(df[:70500]['Time'])
C = np.array(df[:70500]['Open'])
D = np.array(df[:70500]['High'])
E = np.array(df[:70500]['Low'])
F = np.array(df[:70500]['Close'])
G = np.array(df[:70500]['Volume'])

H1,H2= [] ,[]
data_dist = { 
    "Date":A,
    "Time":B,
    "Open":C, 
    "High":D, "Low":E,"Close":F,"Volume":G,
"損益時間20 20":H1,"損益20 20":H2}

data_df = pd.DataFrame.from_dict(data_dist, orient='index')
                 
data_df1 = data_df.T
print(data_df1)

rowmax = 300
for d in range(0,235):
    for i in range(0+d*300, 300+d*300):
        for x in range(i , 300+d*300 ):
            if data_df1.at[x, 'High'] - data_df1.at[i, 'Open'] >=20 :
                    data_df1.at[i, '損益時間20 20'] = B[x]
                    data_df1.at[i,'損益20 20']  =  20            
                    break
         
            elif data_df1.at[i, 'Open'] - data_df1.at[x, 'Low'] >=20 :
                    data_df1.at[i, '損益時間20 20'] = B[x]
                    data_df1.at[i,'損益20 20']  =  -20    
                    break
print(data_df1)
data_df1.to_csv('2018+-全12.csv', encoding='utf_8_sig')



標題:如何設定uwsgi 在開機時自啟載入執行
標籤:uwsgi ubuntu python flask 

參考https://blog.gtwang.org/linux/auto-execute-linux-scripts-during-boot-login-logout/ Linux 開機自動執行指令
my_script.sh內容：
bash:
sudo service nginx restart
/usr/local/bin/uwsgi --emperor /home/ubuntu/uwsgi-sites/ --daemonize /home/ubuntu/logs/uwsgi-emperor.log
sudo service nginx restart
sudo killall -s INT /usr/local/bin/uwsgi
/usr/local/bin/uwsgi --emperor /home/ubuntu/uwsgi-sites/ --daemonize /home/ubuntu/logs/uwsgi-emperor.log

確認這個指令稿有執行權限：
chmod +x /opt/my_script.sh
在 /etc/rc.local 中加入這二行指令稿：
/opt/my_script.sh

exit 0

但ubuntu 重啟後，無法啟入載入uwsig，請問要如何在機器重啟時載入uwsgi?
註：
我用
pip install -U uwsgi
安裝uwsgi,uwsgi binary in /usr/local/bin/uwsgi


標題:在mblock的python編輯器中，要執行程式時，出現錯誤訊?!syntaxError missing parentheses in call to 'print'
標籤:python mblock 

在mblock的python編輯器中，要執行程式時，出現錯誤訊?!syntaxError missing parentheses in call to 'print'請問如何解決!
要執行的程式是
#!/usr/bin/env python
"""
moonphase.py - Calculate Lunar Phase
Author: Sean B. Palmer, inamidst.com
Cf. http://en.wikipedia.org/wiki/Lunar_phase#Lunar_phase_calculation
"""
import math, decimal, datetime
dec = decimal.Decimal
def position(now=None):
if now is None:
now = datetime.datetime.now()
diff = now - datetime.datetime(2001, 1, 1)
days = dec(diff.days) + (dec(diff.seconds) / dec(86400))
lunations = dec("0.20439731") + (days * dec("0.03386319269"))
return lunations % dec(1)
def phase(pos):
index = (pos * dec(8)) + dec("0.5")
index = math.floor(index)
return {
0: "New Moon",
1: "Waxing Crescent",
2: "First Quarter",
3: "Waxing Gibbous",
4: "Full Moon",
5: "Waning Gibbous",
6: "Last Quarter",
7: "Waning Crescent"
}[int(index) & 7]
def main():
pos = position()
phasename = phase(pos)
roundedpos = round(float(pos), 3)
print "%s (%s)" % (phasename, roundedpos)
if name=="main":
main()



標題:LINE BOT  handler 問題，無法呼叫函式？{己解決}
標籤:line bot python3 flask 

@handler.add(MessageEvent, message=TextMessage)
def handle_message(event):
    input_text = event.message.text
    if input_text == "查匯率":
        resp = requests.get('https://tw.rter.info/capi.php')
        currency_data = resp.json()
        usd_to_twd = currency_data['USDTWD']['Exrate']
        line_bot_api.reply_message(
            event.reply_token,
            TextSendMessage(text=f'美元 USD 對台幣 TWD：1:{usd_to_twd}'))
    elif input_text == '現在時間':
        now = datetime.now()
        current_time = now.strftime("%H:%M:%S")
        line_bot_api.reply_message(
            event.reply_token, TextSendMessage(text=f"台北時間：{current_time}"))
    elif input_text == "現在幾度" or "溫度":
        Rdata = requests.get(
            'https://opendata.cwb.gov.tw/api/v1/rest/datastore/O-A0003-001?Authorization=ABC-#@12345324-KEY-1233-1237485723&locationName=%E8%87%BA%E5%8C%97,&elementName=TEMP&parameterName=CITY').json()
        Temp = Rdata["records"]["location"][0]["weatherElement"]
        Mdict = dict(enumerate(Temp))
        o1 = Mdict[0]['elementValue']
        line_bot_api.reply_message(
            event.reply_token,
            TextSendMessage(text=f'現在「台北」的目前溫度是：{o1}'))
    elif input_text == "股票":

        stock(x)
        line_bot_api.reply_message(
            event.reply_token,
            TextSendMessage(text=f'現在「股票號碼{stock} 」的目前股價是：{getstock}'))

試過修改許多次if elif的功能,一直無法正常運作,在使用者貼上訊息的時候一直會回應溫度>"<,除非使用特定文字才可以實作回報時間和匯率。另外股票的功能也沒辦法啟動
試著用函式也不能呼叫？


標題:Python_open.cv詢問影像辨識問題
標籤:@open cv @python @影像辨識 

詢問一下各位大大
目前缺陷圖檔資料庫不多
想利用旋轉的方式增加資料庫檔案
旋轉360度都可以
但目前找不到可以將圖檔"傾斜角度"的方式
請問這方式可行嗎?
還是會有光線的問題所以無法如此操作?


標題:Python 爬蟲登入網頁拿資料
標籤:python python系列文章 網頁爬蟲 

最近用python寫模擬測試登入學校圖書館網站,但有時候拿的到網站data,有時候拿不到,不知道是甚麼原因,cookie和authorize我都有抓取的方法進行抓去,header也按照Request HEADERS
部分程式碼:
res2 = rs.get('https://uco-mcu.primo.exlibrisgroup.com/primaws/rest/priv/myaccount/loans?bulk=10&lang=zh-tw&offset=1&type=active', headers=headers, verify=False,timeout=10)
data = res2.text
a = json.loads(data)
print(a)
loan = len(a['data']['loans']['loan'])
if(loan == 0):
    print("你沒有借書")
else:
    print(loan)
    for i in range(loan):
        print("書名:"+a['data']['loans']['loan'][i]['title'])
        print("到期日:"+a['data']['loans']['loan'][i]['duedate'])

出錯:
{'beaconO22': '0', 'status': 'failed', 'reply-code': '0002', 'reply-text': 'The patron ID is invalid', 'data': None}
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-17-00176e7ea317> in <module>
     58 a = json.loads(data)
     59 print(a)
---> 60 loan = len(a['data']['loans']['loan'])
     61 if(loan == 0):
     62     print("你沒有借書")

TypeError: 'NoneType' object is not subscriptable



標題:用python程式解井字遊戲的盤面，先能窮舉三步棋就好
標籤:python game 

我在嘗試用程式解井字遊戲的盤面，
首先，我寫了一個基本架構:
# 寫井字遊戲的基本邏輯，棋子共'X','O'兩種
class TicTacToe():
    def __init__(self):
        self.board = [[' ']*3 for i in range(3)]
    
    # 初始化棋盤
    def iniBoard(self):
        for i in range(3):
            for j in range(3):
                self.board[i][j]=' '
        
    # 視覺化的把井字棋棋盤畫出來    
    def drawBoard(self) -> None:
        HLINE =  ' ' * 3 + '+---' * 3  + '+'
        VLINE = (' ' * 3 +'|') *  (3 +1)
        title = '     0'
        for i in range(1,3):
            title += ' ' * 3 +str(i)
        print(title)
        print(HLINE)
        for y in range(3):
            print(VLINE)
            print(y, end='  ')
            for x in range(3):
                print(f'| {self.board[x][y]}', end=' ')
            print('|')
            print(VLINE)
            print(HLINE)
    
    def isOnBoard(self, x, y):
        return 0 <= x < 3 and 0 <= y < 3

    #檢查tile放在某個座標是否為合法棋步
    def isValidMove(self, tile, x, y):
        return self.isOnBoard(x, y) and self.board[x][y]==' '

    # 把棋子下在座標x, y的地方
    def makeMove(self, tile, x, y):
        if self.isValidMove(tile, x, y):
            self.board[x][y]=tile
    
    # 回傳現在盤面輪到tile走的所有合法棋步
    def getValidMoves(self, tile):
        return [[x, y] for x in range(3) for y in range(3) if self.isValidMove(tile, x, y)]

    # 判斷一個盤面是否有人贏了
    def check_TicTacToe(self):
        rows = list(map(''.join,self.board))
        cols = list(map(''.join, zip(*rows)))
        diags = list(map(''.join, zip(*[(r[i], r[2 - i]) for i, r in enumerate(rows)])))
        lines = rows + cols + diags

        if 'XXX' in lines:
            return 'X'  
        if 'OOO' in lines:
            return 'O' 
        return 'D' # draw(和棋)

我陣列裡面的棋子共有'O'和X兩種，
用字串'O', X, ' '代表格子內的棋子是'O', X還是空白，
棋盤的座標是先看x座標再看y座標，
圖示(比如說00是左上角，20是右上角):
     0   1   2
   +---+---+---+
   |   |   |   |
0  |   |   |   |
   |   |   |   |
   +---+---+---+
   |   |   |   |
1  |   |   |   |
   |   |   |   |
   +---+---+---+
   |   |   |   |
2  |   |   |   |
   |   |   |   |
   +---+---+---+

電腦下棋的邏輯
這部分我是想要實作min-max演算法或alpha-beta演算法來解井字遊戲的盤面。
參考維基百科: 極小化極大演算法，Alpha-beta剪枝
這部分我已經debug一整天，實在看不出哪裡有誤，
要把對局樹印出來又有點複雜，
只好來此求助。
我的電腦下棋邏輯如下，
其中class Node是用來記錄一個井字棋的盤面，
TicTacToeAI實作alpha-beta演算法，
我已經儘量跟維基上的程式碼一致了，
不一樣的地方在於維基上的只有算最佳分數，
我的多回傳最佳棋步(畢竟讓電腦下棋總要知道下在哪裡，不能只知道這個盤面會贏還是會輸吧?)

import random
from copy import deepcopy

class Node(TicTacToe):
    def __init__(self, board):
        super().__init__()
        self.board = deepcopy(board)

    def ending(self):
        return self.check_TicTacToe()!='D'
 
    # 'X'贏的話得分
    def valuef(self):
        winTile = self.check_TicTacToe()
        if winTile == 'X':
            return 100
        elif winTile == 'O':
            return -100
        return 0

# 電腦ai下棋的邏輯
class TicTacToeAI(TicTacToe):
    def __init__(self, board):
        super().__init__()
        self.board = board
        
    """
    參數: node代表盤面，depth是窮舉幾步棋，isMaxPlayer為True時換'X'走
    alpha, beta是alpha-beta演算法的參數，如果看不懂，
    理論上你把我函數的
    if beta <= alpha:
        break
    註解掉即是min-max演算法，
    代表說窮舉所有棋步不剪枝
    """
    def alphabeta(self, node, depth, alpha, beta, isMaxPlayer):
        if depth==0 or node.ending():
            return [-1,-1], node.valuef()

        if isMaxPlayer: # 'X'的回合
            bestop, bestScore = [-1,-1], -99999999
            moves = node.getValidMoves('X')
            random.shuffle(moves)
            for move in moves:

                newNode = Node(self.board)
                newNode.makeMove('X', move[0], move[1])

                M, score = self.alphabeta(newNode, depth-1, alpha,beta,False)

                if score> bestScore:
                    bestop = move[:]
                    bestScore = score
                
                alpha = max(alpha, bestScore)
                if beta <= alpha:
                    break
            return bestop, bestScore
        
        else: # 'O'的回合
            bestop, bestScore = [-1,-1], 99999999
            moves = node.getValidMoves('O')
            random.shuffle(moves)
            for move in moves:

                newNode = Node(self.board)
                newNode.makeMove('O', move[0], move[1])

                M, score = self.alphabeta(newNode, depth-1, alpha,beta,True)

                if score< bestScore:
                    bestop = move[:]
                    bestScore = score
                
                beta = min(beta, bestScore)
                if beta <= alpha:
                    break
            return bestop, bestScore

    # 給定盤面board，回傳電腦的選擇
    def getComputerMove(self, computerTile):
        root = Node(self.board)
        isMaxPlayer = (computerTile == 'X')
        move, score = self.alphabeta(root, 3, -999,999, isMaxPlayer)
        return move

三個測試的盤面
這是我用來測試程式正確性的三個盤面(假設都換X下):
第一個盤面
     0   1   2
   +---+---+---+
   |   |   |   |
0  | O |   |   |
   |   |   |   |
   +---+---+---+
   |   |   |   |
1  | O | X |   |
   |   |   |   |
   +---+---+---+
   |   |   |   |
2  | X |   |   |
   |   |   |   |
   +---+---+---+

這邊很明顯，X只要再一步下在座標2,0就贏了，
電腦應回傳[2,0]過關
第二個盤面也很簡單，就是第一個盤面O,X互換
     0   1   2
   +---+---+---+
   |   |   |   |
0  | X |   |   |
   |   |   |   |
   +---+---+---+
   |   |   |   |
1  | X | O |   |
   |   |   |   |
   +---+---+---+
   |   |   |   |
2  | O |   |   |
   |   |   |   |
   +---+---+---+

很明顯，X必須下在座標2,0阻止O連線了，
電腦應回傳[2,0]過關
第三個盤面需要計算三步，
但對人來說也很簡單，
X下在座標1,2或2,2皆可必勝
     0   1   2
   +---+---+---+
   |   |   |   |
0  |   |   | O |
   |   |   |   |
   +---+---+---+
   |   |   |   |
1  | O | X |   |
   |   |   |   |
   +---+---+---+
   |   |   |   |
2  | X |   |   |
   |   |   |   |
   +---+---+---+

測試盤面的程式我用python的unitest模組來做
import unittest

class Test(unittest.TestCase):

    def test_basic(self):
        game = TicTacToe()
        game.makeMove('O',0,0)
        game.makeMove('O',0,1)
        game.makeMove('X',1,1)
        game.makeMove('X',0,2)
        ai = TicTacToeAI(game.board)
        move = ai.getComputerMove('X')
        ai.drawBoard()
        self.assertEqual(move, [2,0])

    def test_basic2(self):
        game = TicTacToe()
        game.makeMove('X',0,0)
        game.makeMove('X',0,1)
        game.makeMove('O',1,1)
        game.makeMove('O',0,2)
        ai = TicTacToeAI(game.board)
        move = ai.getComputerMove('X')
        ai.drawBoard()
        self.assertEqual(move, [2,0]) 

    def test_fixDatas(self):
        game = TicTacToe()
        game.makeMove('O',2,0)
        game.makeMove('O',0,1)
        game.makeMove('X',1,1)
        game.makeMove('X',0,2)
        ai = TicTacToeAI(game.board)
        move = ai.getComputerMove('X')
        ai.drawBoard()
        self.assertIn(move, [[1,2],[2,2]]) 

unittest.main()

完整測試的程式碼
我的測試環境為線上程式編譯器repl.it，
unitest的class當然不能改，
如果執行程式沒有錯誤，就算過關
註: 目前是有時會過關，有時會錯，
因為我有用random打亂電腦算棋的順序，
但理論上不論算棋的順序，
最好的一步應該是一樣的
import random
import unittest
from copy import deepcopy

# 寫井字遊戲的基本邏輯，棋子共'X','O'兩種
class TicTacToe():
    def __init__(self):
        self.board = [[' ']*3 for i in range(3)]
    
    # 初始化棋盤
    def iniBoard(self):
        for i in range(3):
            for j in range(3):
                self.board[i][j]=' '
        
    # 視覺化的把井字棋棋盤畫出來    
    def drawBoard(self) -> None:
        HLINE =  ' ' * 3 + '+---' * 3  + '+'
        VLINE = (' ' * 3 +'|') *  (3 +1)
        title = '     0'
        for i in range(1,3):
            title += ' ' * 3 +str(i)
        print(title)
        print(HLINE)
        for y in range(3):
            print(VLINE)
            print(y, end='  ')
            for x in range(3):
                print(f'| {self.board[x][y]}', end=' ')
            print('|')
            print(VLINE)
            print(HLINE)
    
    def isOnBoard(self, x, y):
        return 0 <= x < 3 and 0 <= y < 3

    #檢查tile放在某個座標是否為合法棋步
    def isValidMove(self, tile, x, y):
        return self.isOnBoard(x, y) and self.board[x][y]==' '

    # 把棋子下在座標x, y的地方
    def makeMove(self, tile, x, y):
        if self.isValidMove(tile, x, y):
            self.board[x][y]=tile
    
    # 回傳現在盤面輪到tile走的所有合法棋步
    def getValidMoves(self, tile):
        return [[x, y] for x in range(3) for y in range(3) if self.isValidMove(tile, x, y)]

    # 判斷一個盤面是否有人贏了
    def check_TicTacToe(self):
        rows = list(map(''.join,self.board))
        cols = list(map(''.join, zip(*rows)))
        diags = list(map(''.join, zip(*[(r[i], r[2 - i]) for i, r in enumerate(rows)])))
        lines = rows + cols + diags

        if 'XXX' in lines:
            return 'X'  
        if 'OOO' in lines:
            return 'O' 
        return 'D' # draw(和棋)
        

class Node(TicTacToe):
    def __init__(self, board):
        super().__init__()
        self.board = deepcopy(board)

    def ending(self):
        return self.check_TicTacToe()!='D'
 
    # 'X'贏的話得分
    def valuef(self):
        winTile = self.check_TicTacToe()
        if winTile == 'X':
            return 100
        elif winTile == 'O':
            return -100
        return 0

# 電腦ai下棋的邏輯
class TicTacToeAI(TicTacToe):
    def __init__(self, board):
        super().__init__()
        self.board = board

    def alphabeta(self, node, depth, alpha, beta, isMaxPlayer):
        if depth==0 or node.ending():
            return [-1,-1], node.valuef()

        if isMaxPlayer: # 'X'的回合
            bestop, bestScore = [-1,-1], -99999999
            moves = node.getValidMoves('X')
            random.shuffle(moves)
            for move in moves:

                newNode = Node(self.board)
                newNode.makeMove('X', move[0], move[1])

                M, score = self.alphabeta(newNode, depth-1, alpha,beta,False)

                if score> bestScore:
                    bestop = move[:]
                    bestScore = score
                
                alpha = max(alpha, bestScore)
                if beta <= alpha:
                    break
            return bestop, bestScore
        
        else: # 'O'的回合
            bestop, bestScore = [-1,-1], 99999999
            moves = node.getValidMoves('O')
            random.shuffle(moves)
            for move in moves:

                newNode = Node(self.board)
                newNode.makeMove('O', move[0], move[1])

                M, score = self.alphabeta(newNode, depth-1, alpha,beta,True)

                if score< bestScore:
                    bestop = move[:]
                    bestScore = score
                
                beta = min(beta, bestScore)
                if beta <= alpha:
                    break
            return bestop, bestScore

    # 給定盤面board，回傳電腦的選擇
    def getComputerMove(self, computerTile):
        root = Node(self.board)
        isMaxPlayer = (computerTile == 'X')
        move, score = self.alphabeta(root, 3, -999,999, isMaxPlayer)
        return move


class Test(unittest.TestCase):

    def test_basic(self):
        game = TicTacToe()
        game.makeMove('O',0,0)
        game.makeMove('O',0,1)
        game.makeMove('X',1,1)
        game.makeMove('X',0,2)
        ai = TicTacToeAI(game.board)
        move = ai.getComputerMove('X')
        ai.drawBoard()
        self.assertEqual(move, [2,0])

    def test_basic2(self):
        game = TicTacToe()
        game.makeMove('X',0,0)
        game.makeMove('X',0,1)
        game.makeMove('O',1,1)
        game.makeMove('O',0,2)
        ai = TicTacToeAI(game.board)
        move = ai.getComputerMove('X')
        ai.drawBoard()
        self.assertEqual(move, [2,0]) 

    def test_fixDatas(self):
        game = TicTacToe()
        game.makeMove('O',2,0)
        game.makeMove('O',0,1)
        game.makeMove('X',1,1)
        game.makeMove('X',0,2)
        ai = TicTacToeAI(game.board)
        move = ai.getComputerMove('X')
        ai.drawBoard()
        self.assertIn(move, [[1,2],[2,2]]) 

unittest.main()



標題:Python 函數取用問題
標籤:python function 

各位大大好，目前我有兩個.py檔如下：
A.py
def A_1():
	x = [1,2,3]
	x_1 = [3,4,5]
	return x

def A_2(num):
	if num == 1:
		y = x * 3
	elif num == 2:
		y = x_1 * 3
	return y

B.py
import A
x = A.A_1()
A.A_2(num=1)

error:
NameError: name 'x' is not defined
我想要在A_2這個函數使用x這個list，但python似乎讀不到這個變數。
試過在A_1中加入global，還是沒辦法。
為什麼不直接在A_2中多加一個變數去讀取list，是因為想利用num控制參數，方便使用者調用函數，另外num大概會有五種狀況，使用不同的list。
所以想請問一下，有甚麼方法能夠解決此問題？
感謝大大們抽空回答！


標題:python 用代理ip傳送請求
標籤:ip python proxy discord rate limite 

discord 的webhook有一分鐘內只能傳30訊息的規定
小弟不知道變換ip是否能繞過限制?
所以想用代理ip list發送請求
上網查卻沒個結果
有大神知道如何代理ip傳送請求嗎


標題:python OSError python3.8 TCP sever
標籤:python3 socket tcp 

import socket
import threading

bind_ip = "0.0.0.0"
bind_port = 9999

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

server.bind((bind_ip, bind_port))

print(f"[*] Listen on {bind_ip}:{bind_port}")

def handle_client(client_socket):
  request = client_socket.recv(1024)

  print(f"[*] Received: {request}")

  client_socket.send("ACK")

  client_socket.close()

while True:
  client, address = server.accept()

  print(f"[*] Accept connection from {address[0]}:{address[1]}")

  client_handler = threading.Thread(target = handle_client, args = (client, ))
  client_handler.start()
  


[*] Listen on 0.0.0.0:9999
Traceback (most recent call last):
File "main.py", line 23, in 
client, address = server.accept()
File "/usr/lib/python3.8/socket.py", line 292, in accept
fd, addr = self._accept()
OSError: [Errno 22] Invalid argument



標題:Jupyter Lab extension UniCodeError
標籤:python3 jupyter node.js 

前輩們下午好，
小弟目前在windows 10 安裝jupyter lab的插件時都會出現UnicodeError
小弟都在CMD使用jupyter labextension install {插件} 來安裝插件
可是都跳出
UnicodeDecodeError: 'cp950' codec can't decode byte 0xe2 in position 268: illegal multibyte sequence
用"jupyter labextension install {插件} --debug"來看出錯誤的地方都是在跑
"node c:\python37\lib\site-packages\jupyterlab\staging\yarn.js run build:prod:minimize"這串指令時出現錯誤

log:

node c:\python37\lib\site-packages\jupyterlab\staging\yarn.js run build:prod:minimize
Traceback (most recent call last):

File "c:\python37\lib\site-packages\jupyterlab\debuglog.py", line 47, in debug_logging
yield
File "c:\python37\lib\site-packages\jupyterlab\labextensions.py", line 105, in start
command=command, app_options=app_options)
File "c:\python37\lib\site-packages\jupyterlab\commands.py", line 460, in build
command=command, clean_staging=clean_staging)
File "c:\python37\lib\site-packages\jupyterlab\commands.py", line 657, in build
ret = self._run(['node', YARN_PATH, 'run', command], cwd=staging)
File "c:\python37\lib\site-packages\jupyterlab\commands.py", line 1752, in _run
return proc.wait()
File "c:\python37\lib\site-packages\jupyterlab\commands.py", line 107, in wait
out, _ = proc.communicate(timeout=.1)
File "c:\python37\lib\subprocess.py", line 964, in communicate
stdout, stderr = self._communicate(input, endtime, timeout)
File "c:\python37\lib\subprocess.py", line 1317, in _communicate
stdout = stdout[0]
IndexError: list index out of range
Exiting application: jupyter

python版本:3.7.8
node版本:12.18.2.
npm版本:6.14.5
jupyter-notebook版本:6.0.3
jupyter-lab版本:2.1.5
請問前輩們有碰過這個問題嗎?
有嘗試過:npm set unicode false 可是沒有效果...


標題:python requests.get() 無法取得flask架設的api
標籤:python3 requests flask api 

目前在練習區塊鏈技術
遇到了一些問題
gitlab https://gitlab.com/jsbo12551a/blockchaintestproject
參考資料 https://www.chainnews.com/zh-hant/articles/610523687679.htm
當我透過瀏覽器開啟API http://127.0.0.1:5000/chain 時沒有問題
但是當我透過python 執行
respons = requests.get(f'http://127.0.0.1:5000/chain')
卻無法取回..
python部分
    def resolve_conflicts(self):
       
        neighbours = self.nodes
        new_chain = None
        
        max_length = len(self.chain)
        
        for node in neighbours:
            respons = requests.get(f'http://{node}/chain')

            if respons.status_code == 200:
                length = respons.json()['length']
                chain = respons.json()['chain']

                if length>max_length and self.valid_chain(chain):
                    max_length = length
                    new_chain = chain

        if new_chain:
            self.chain = new_chain
            return True

        return False

flask部分
@app.route('/nodes/resolve',methods = ['GET'])
def consensus():
    replace = blockchain.resolve_conflicts()

    if replace:
        response = {
            'messaage':'鏈已被替換',
            'new_chain':blockchain.chain
        }
    else:
      response = {
            'messaage':'此鏈為最長且有效鏈(最具權威鏈)',
            'new_chain':blockchain.chain,
        }
    return jsonify(response),200



標題:使用 Python 获取 SQL Server 数据库内表的第一行（列的名称）
標籤:sql server 表 sql server 表 python pyodbc 

使用 pyodbc 库连接到 SQL Server，执行 “select * from SysColumns Where id=Object_Id('Table_Name')” 获取表格，但显示不了表的第一行（列的名称）。
怎么才能显示第一行（列的名称）
import pyodbc

print("Connecting to database using pyodbc...")

db = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server}; SERVER=' + DB_Host + '; DATABASE=' + DB_Name + '; UID=' + DB_User + '; PWD=' + DB_Password)

print("Succesfully Connected to database using pyodbc!")

table = db.cursor()
table.execute("select * from SysColumns Where id=Object_Id('MonitorData.Application') ")

for name in table:
    print(name)

结果：
"C:\Users\Administrator\PycharmProjects\Python Challenge\venv\Scripts\python.exe" "C:/Users/Administrator/PycharmProjects/Python Challenge/7.py"
Connecting to database using pyodbc...
Succesfully Connected to database using pyodbc!
('Id', 1669580986, 36, 1, 36, 16, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, None, 2, 0, 0, 0, 37, 0, None, 0, None, 0, 0, 0, None, b'\x00\x00\x00\x00\x00')
('Name', 1669580986, 231, 3, 231, 510, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 2, None, -1, 299016, 0, 16, 39, 0, None, 255, None, 0, 0, 0, 'Latin1_General_100_CI_AS_KS', b'\t\x04\x90 \x00')
('PublishedName', 1669580986, 231, 3, 231, 510, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 3, None, -2, 299016, 0, 16, 39, 0, None, 255, None, 0, 0, 0, 'Latin1_General_100_CI_AS_KS', b'\t\x04\x90 \x00')
('ApplicationType', 1669580986, 56, 0, 56, 4, 10, 0, 4, 0, 0, 0, 0, 0, 0, 0, 4, None, -3, 0, 0, 8, 38, 7, None, 10, 0, 0, 0, 1, None, b'\x00\x00\x00\x00\x00')
('Enabled', 1669580986, 104, 0, 104, 1, 1, 0, 5, 0, 0, 0, 0, 0, 0, 0, 5, None, 18, 0, 0, 8, 50, 16, None, 1, None, 0, 0, 1, None, b'\x00\x00\x00\x00\x00')
('AdminFolder', 1669580986, 231, 2, 231, 800, 0, 0, 6, 0, 0, 0, 0, 0, 0, 0, 6, None, -4, 299016, 0, 24, 39, 0, None, 400, None, 0, 0, 1, 'Latin1_General_100_CI_AS_KS', b'\t\x04\x90 \x00')
('LifecycleState', 1669580986, 56, 1, 56, 4, 10, 0, 7, 0, 0, 0, 0, 0, 0, 0, 7, None, 19, 0, 0, 0, 56, 7, None, 10, 0, 0, 0, 0, None, b'\x00\x00\x00\x00\x00')
('Path', 1669580986, 231, 2, 231, 800, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 8, None, -5, 299016, 0, 24, 39, 0, None, 400, None, 0, 0, 1, 'Latin1_General_100_CI_AS_KS', b'\t\x04\x90 \x00')
('BrowserName', 1669580986, 231, 2, 231, 100, 0, 0, 9, 0, 0, 0, 0, 0, 0, 0, 9, None, -6, 299016, 0, 24, 39, 0, None, 50, None, 0, 0, 1, 'Latin1_General_100_CI_AS_KS', b'\t\x04\x90 \x00')
('CreatedDate', 1669580986, 61, 1, 61, 8, 23, 3, 10, 0, 0, 0, 0, 0, 0, 0, 10, None, 23, 0, 0, 0, 61, 12, None, 23, 3, 0, 0, 0, None, b'\x00\x00\x00\x00\x00')
('ModifiedDate', 1669580986, 61, 1, 61, 8, 23, 3, 11, 0, 0, 0, 0, 0, 0, 0, 11, None, 31, 0, 0, 0, 61, 12, None, 23, 3, 0, 0, 0, None, b'\x00\x00\x00\x00\x00')

Process finished with exit code 0


直接输出了数据
这是在 SQL Server Management Studio 里面查询的结果：



標題:LINE BOT (django)Azure 求救
標籤:python django 

己經確認透過GITHUB 部署到AZURE,帳號也因此開了"付費"選項,BOT SERVICE 選了F0
還是出現HTTP 不接受的問題?!?!

//這個程式是先引用書上的來測試再來慢慢改,本地測試沒有什麼狀況....
VIEWS.py
from django.conf import settings
from django.http import HttpResponse, HttpResponseBadRequest, HttpResponseForbidden
from django.views.decorators.csrf import csrf_exempt

from linebot import LineBotApi, WebhookParser
from linebot.exceptions import InvalidSignatureError, LineBotApiError
from linebot.models import MessageEvent, TextSendMessage

line_bot_api = LineBotApi(settings.LINE_CHANNEL_ACCESS_TOKEN)
parser = WebhookParser(settings.LINE_CHANNEL_SECRET)


@csrf_exempt
def callback(request):
    if request.method == 'POST':
        signature = request.META['HTTP_X_LINE_SIGNATURE']
        body = request.body.decode('utf-8')

        try:
            events = parser.parse(body, signature)
        except InvalidSignatureError:
            return HttpResponseForbidden()
        except LineBotApiError:
            return HttpResponseBadRequest()

        for event in events:
            if isinstance(event, MessageEvent):
                line_bot_api.reply_message(event.reply_token,TextSendMessage(text=event.message.text))

        return HttpResponse()
    else:
        return HttpResponseBadRequest()


urls.py
"""botpandas URL Configuration

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/3.0/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import path
from django.conf.urls import url
from botapi import views

urlpatterns = [
    url('^callback', views.callback),
    #path('callback/', callback),
    path(r'admin/', admin.site.urls),
]




標題:使用 Python 获取 SQL Server 数据库中的所有表
標籤:show tables sql server python 

我有一台 SQLServer，我想使用 Python 去查询某一个数据库内的所有表格，应该怎么使用什么语句？
在 SQL Server 中好像没有 “SHOW TABLES” 语句
import pyodbc

print("Connecting to database using pyodbc...")

db = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server}; SERVER=' + DB_Host + '; DATABASE=' + DB_Name + '; UID=' + DB_User + '; PWD=' + DB_Password)

print("Succesfully Connected to database using pyodbc!")

table = db.cursor()
table.execute('show tables')

print（table）



標題:期貨當沖資料處裡疑問
標籤:python python3 python入門 財務分析 期貨 

每分鐘開始時進行買進
20點獲利停利 20點虧損停損
以下圖片為資料

以下圖片是希望達成的目標

open為買進價格
希望統計每分鐘獲利還是虧損
以及獲利或虧損的時間點
以下為EXCEL檔案
https://drive.google.com/file/d/1dytr9KQl36-eTKvWKqLhQp9LPfxsyJ9f/view?usp=sharing
下面這是我的程式碼
碰到的疑問是輸出的結果我要得知第一個True是第幾個
才能知道時間點
但我不知道怎麼寫
才能得知第一個True為第幾個
停利的第一個True和和停損的第一個True
預計都得知後兩個進行判定
哪個較早判定為停損還停利
結果會有四個
停損 停利 到收盤為止都沒停損停利 那一分鐘同時發生停損和停利都行的狀況
這是我的想法和邏輯
但這有一個大問題
按照這邏輯我要寫300次
我不知道怎麼迴圈又迴圈的把它統合起來
希望有高手能幫幫忙
當然不一定要照我程式邏輯下去改
只要能輸出類似第2張圖片那樣就行
import pandas as pd

df = pd.read_excel('C:\\Users\\user\\20200102.xlsx', header=0, index_col=None)  
df = pd.DataFrame(df)

A = [0] * 300
for i in range(0,300): 
    A[i] = df.at[i, 'Open']
B = [0] * 300 
for i in range(300): 
    B[i] = df.at[i, 'High']
C = [99999] * 300 
for i in range(300): 
    C[i] = df.at[i, 'Low']    
A0 ='A[0]+20 <= B:{}'.format(A[0]+20 <= B)
A00='A[0]-20 >= C：{}'.format(A[0]-20 >= C)

B = [0] * 300 
for i in range(1,300): 
    B[i] = df.at[i, 'High']
C = [99999] * 300 
for i in range(1,300): 
    C[i] = df.at[i, 'Low']
A1 ='A[1]+20 <= B：{}'.format(A[1]+20 <= B)
A11='A[1]-20 >= C：{}'.format(A[1]-20 >= C)

B = [0] * 300 
for i in range(2,300): 
    B[i] = df.at[i, 'High']
C = [99999] * 300 
for i in range(2,300): 
    C[i] = df.at[i, 'Low']
A2 ='A[2]+20 <= B：{}'.format(A[2]+20 <= B)
A22='A[2]-20 >= C：{}'.format(A[2]-20 >= C)

print(A0)

print(A00)

print(A1)

print(A11)

print(A2)

print(A22)

補充說明
A[0]來說A[0]+20 <= B在第6個時發生True 也就是8:51
A[0]-20 >= C在第38個時發生True
但是9:01已經停利
所以A[0]-20>= C發生較晚所以不算
換一些方式講其實如果你是在第一分鐘時賣出一口
理論上8:51要停損
但如果繼續凹單的話
不堅持策略
在第38分鐘可以獲利
這是題外話
四個發生情形
第一個就是A[0]來說A[0]+20 <= B
A[0]-20 >= C
看哪個較早
第三種情形發生True位子一樣
通常發生在1分鐘上下波動較大
這樣停利還是停損
要看每秒的成交明細
才能知道哪個情形發生
但這種情形不常發生
第四種就是全都是False
通常在接近收盤時會大機率發生
這邊0和99999
是因為要判定之後的
前面的不用判定
所以設0和99999
判定必為False
B = [0] * 300
for i in range(1,300):
B[i] = df.at[i, 'High']
C = [99999] * 300
for i in range(1,300):
C[i] = df.at[i, 'Low']
A[1]+20 <= B
A[1]-20 >= C
下面是輸出結果
A[0]+20 <= B:[False False False False False  True  True False False False False False
 False False False False  True  True  True  True  True False False  True
  True  True  True  True False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False  True  True  True False False False False False False
 False False False False False  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True]  
A[0]-20 >= C：[False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False  True  True False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False]
 A[1]+20 <= B：[False False False False False  True False False False False False False
 False False False False  True  True False False False False False False
  True  True  True  True False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True]
  A[1]-20 >= C：[False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False  True  True  True  True False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False]
 A[2]+20 <= B：[False False False False False False False False False False False False
 False False False False  True  True False False False False False False
 False  True False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True
  True  True  True  True  True  True  True  True  True  True  True  True]
  A[2]-20 >= C：[False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False  True
  True  True  True  True  True  True  True  True  True  True  True False
 False  True  True False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False
 False False False False False False False False False False False False]
 



標題:python manage.py 不能 work
標籤:python manage.py 

我照著這個網址https://ithelp.ithome.com.tw/articles/10213377 做下來，但是到了下python manage.py的指令的時候就不能work，但也沒有錯誤訊息跳出來，確認一下路徑應該也沒錯，想請問各位大大可能是甚麼原因?謝謝~~

ps.因為是新手不能直接在文章下面留言，只好來發問區問各位大大了><，謝謝~~


標題:line機器人python的module無法執行
標籤:line機器人 python module 

參考https://stackoverflow.com/questions/49353905/no-module-named-future
用各種方式pip future了
還是No module named 'future'

這裡是按照官網那邊找的程式碼
求救!!!謝謝大大
#app.py
from flask import Flask, request, abort

from linebot import (
    LineBotApi, WebhookHandler
)
from linebot.exceptions import (
    InvalidSignatureError
)
from linebot.models import (
    MessageEvent, TextMessage, TextSendMessage,
)

app = Flask(__name__)

line_bot_api = LineBotApi('貼上你的line bot channel token')
handler = WebhookHandler('貼上你的line bot channel secret')


@app.route("/callback", methods=['POST'])
def callback():
    # get X-Line-Signature header value
    signature = request.headers['X-Line-Signature']

    # get request body as text
    body = request.get_data(as_text=True)
    app.logger.info("Request body: " + body)

    # handle webhook body
    try:
        handler.handle(body, signature)
    except InvalidSignatureError:
        abort(400)

    return 'OK'


@handler.add(MessageEvent, message=TextMessage)
def handle_message(event):
    line_bot_api.reply_message(
        event.reply_token,
        TextSendMessage(text=event.message.text))


if __name__ == "__main__":
    app.run()



標題:IndexError: list index out of range(已解決)
標籤:python python 3 python3 

我有一個問題，下列程式我在執行的時候她一直告訴我IndexError: list index out of range，我想解決這問題，但他一直存在一樣的結果，請問有人知道我嘎怎麼改善他嗎?
from __future__ import absolute_import
from __future__ import division
from __future__ import print_function

try:
    from urllib.request import urlopen # python 3
except ImportError:
    from urllib2 import urlopen # python 2
import sys
import tarfile
import tempfile
import shutil

dataset = sys.argv[1]
url = "https://people.eecs.berkeley.edu/~tinghuiz/projects/pix2pix/datasets/%s.tar.gz" % dataset
with tempfile.TemporaryFile() as tmp:
    print("downloading", url)
    shutil.copyfileobj(urlopen(url), tmp)
    print("extracting")
    tmp.seek(0)
    tar = tarfile.open(fileobj=tmp)
    tar.extractall()
    tar.close()
    print("done")



標題:Selenium  能夠把瀏覽器的網址列也擷取進圖片嗎?
標籤:python selenium crawler 

如題，用selenium 有save_screenshot的功能，但只能擷取網頁的部分，因為收到要擷取網址列的需求，但爬遍文章都沒有解決辦法，求大神解惑~

==========================更新====================================
我發現使用網頁的列印功能，能將網址印在網頁下方
因此我調用javascript的語法  driver.execute_script("window.print();")
但在py檔的目錄下找不到截圖的檔案，要怎麼找到他呢?


標題:要怎麼把這段加入minst測資(colab)
標籤:pyhton ai python training minst import keras from minst it大神 




標題:使用 pyodbc 从 SQL Server 获取数据，并将数据写入到 Excel 表格中
標籤:pyodbc sql server python excel 

我有一台 SQL Server，在上面有一个表，我想使用 Python 去获取这个表，并进行赛选，然后将赛选后的内容写入到 Excel 中
这是我的代码：
import pyodbc
import xlwt

data=xlwt.Workbook()
table1=data.add_sheet('sheet1')
table2=data.add_sheet('sheet2')

DB_Host = "192.168.1.10"
DB_Name = "testdb"
DB_User = "admin"
DB_Password = "P@ssw0rd"

print("Connecting to database using pyodbc...")

db = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server}; SERVER=' + DB_Host + '; DATABASE=' + DB_Name + '; UID=' + DB_User + '; PWD=' + DB_Password)

print("Succesfully Connected to database using pyodbc!")

cursor = db.cursor()
cursor.execute('SELECT * FROM dbo.Data_Wash_ALM')

for row in cursor:
    try:
        # print(row[9])
        if "lu" in row[9]:            # 这是我要筛选的
            print(row)                # 筛选后的数据，可以顺利 print 出来
            index = 0
            for col,item in enumerate(row):
                table1.write(index, col, item)
                index += 1
    except TypeError:
        print("Type Error")

data.save("data.xls")

# db.close()

我现在想将 print 的数据写入到 Excel 中，但就是写入不了，不知道是哪里出了问题。
print 的内容类似：
(59, 21054, 9789, 5975, 'Windows 10', IP(192.168.1.95), uptime(1900), '2', None, 'lu', 'lu@test.com', 'Passed', 'Passed')



標題:Python 获取 txt 文件中的列表，再写入到 Excel 中
標籤:python excel xlwt for 循环 

我有一个 a.txt 文件，里面存放了一些列表：
[1,2,3,4,5]
[2,5,3,5,3]
[4,3,2,4,2]

我现在想通过 Python 从这个 txt 文件中获取列表的内容，并将它写入到 Excel 中。
我通过 for 循环获取到了 txt 的每一行内容：
file = open("a.txt")
for l in file:
    line = l.strip("\n")
    print(line)

然后，我想使用 xlwt 将每一行的内容写入到 Excel 中，我应该如何写 for 循环，才能遍历每行列表中的内容，将列表中的每一个值都写入到 Excel 中的不同的单元格？


標題:我如何使用（div [contenteditable]）將他保存和與server傳輸
標籤:html5 javascript jquery django python 

我做了一個留言板，我想讓他能添加圖片，所以我用的是有contenteditable屬性的div標籤而不是input的textarea，可是我遇到一些問題，我不知道該如何讓contenteditable裡的文字和圖片傳送到後端儲存再傳送到前端印在我要讓他出現的地方，並且保持他在留言版裡輸入的順序打印出來(例如:文字圖片文字圖片，由上至下這樣的順序)
我把它寫在codepen裡，裡面的js代碼是可以讓我在（div [contenteditable]）裡即時預覽圖片
https://codepen.io/hankhsiao823/pen/YzwxmZv


標題:用flask shell插入資料列報錯(已自行解決)
標籤:python python3 flask 

import os
from flask import (
    Flask, 
    render_template, 
    session, 
    redirect, 
    url_for,
    flash
    )

from flask_bootstrap import Bootstrap
from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField
from wtforms.validators import DataRequired
from flask_sqlalchemy import SQLAlchemy

basedir = os.path.abspath(os.path.dirname(__file__))

filepath = os.path.join(basedir, 'data.sqlite') #增加這一行


class NameForm(FlaskForm):
    name = StringField('what is your name?', validators=[DataRequired()])
    submit = SubmitField('submit')

app = Flask(__name__)
bootstrap = Bootstrap(app)

app.config['SECRET_KEY'] = 'head to guess string'
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///'+filepath #修改這行
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False

db = SQLAlchemy(app)

class Role(db.Model):
    __tablename__ = 'roles'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(64), unique=True)
    users = db.relationship('User',  backref='role')
    #def __repr__(self):
        #return f'<Role {self.name}>'

class User(db.Model):
    __tablename__ = 'users'
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(64), unique=True, index=True)
    role_id = db.Column(db.Integer, db.ForeignKey('roles.id'))
    #def __repr__(self):
        #return f'<User {self.username}>'


    
@app.route('/', methods=['GET', 'POST'])
def index():
    form = NameForm()
    if form.validate_on_submit():
        user = User.query.filter_by(username=form.name.data).first()
        if user is None:
            user = User(username=form.name.data)
            db.session.add(user)
            db.session.commit()
            session['known'] = False
        else:
            session['known'] = True
        session['name'] = form.name.data
        form.name.data = ''
        return redirect(url_for('index'))
    return render_template(
        'index.html',
        form=form,
        name=session.get('name'),
        known=session.get('known', False)
    )

@app.errorhandler(404)
def page_notfound(e):
    return render_template('404.html'), 404

@app.errorhandler(500)
def internal_server_error(e):
    return render_template('500.html'), 500

if __name__ == "__main__":
    app.run(debug=True)


以上是我照著"flask網頁開發"這本數打的程式碼
到第五章要用"flask shell"操作資料庫插入資料列卻一直報錯
以下是錯誤資訊
在flask shell執行的是
from hello import Role, User 此行正常執行
admin_role =Role(name="Admin") 此行報錯
卡很久拜託各位幫幫忙!!!
解決這問題!
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: users.role_id
[SQL: SELECT users.id AS users_id, users.username AS users_username, users.role_id AS users_role_id
FROM users
WHERE users.username = ?
LIMIT ? OFFSET ?]
[parameters: ('llllll', 1, 0)]
(Background on this error at: http://sqlalche.me/e/e3q8)


已解決
大概是路徑問題
上面程式碼也有標註修改點


標題:Pythone annotate text 問題
標籤:python3 matplotlib 

import pandas as pd
import matplotlib.pyplot as plt


plt.rcParams['font.sans-serif'] =['Microsoft JhengHei']
plt.rcParams['axes.unicode_minus'] = False
df = pd.read_csv('taiwan4g_copy.csv',encoding='utf8')
# print(df)
# print(df[['縣市','基地臺']])
#df_sum = df.groupby('city',as_index=False,sort=False).sum()
df_sum =df.groupby('city')['numbers'].sum().sort_values(ascending=False)
df_sum.plot(x='city', y='numbers',label="基地台數量",kind='bar')
plt.title("基地台建置統計")
plt.xlabel("各縣巿統計數量")
plt.ylabel("基地台數量")
plt.legend(prop = {'size':12})
#plt.ylim(0, 100000)
for p in df_sum.patches:
    df_sum.annotate(format(p.get_height(), '.0f'), 
                    (p.get_x() + p.get_width() / 2., p.get_height()), 
                    ha = 'center', va = 'center', 
                    size=15,
                    xytext = (0, -12), 
                    textcoords = 'offset points')
plt.show()


試了範例的方式一直不能顯示正常,請問大神們幫幫忙，有什麼方向可以指教？


標題:【已解決】挑戰經典問題數字轉正楷中文-LinQ有更好的解法嗎？
標籤:linq python java c# #程式語言 

經典題目： 輸入任數字介於 1~999999999 間，並將其轉成中文樣式
ex: 100 => 壹佰
    999999999 => 玖億玖仟玖佰玖拾玖萬玖仟玖佰玖拾玖

我的解法思路可以參考誤入Ｃ＃村的『Java Programmer』經驗分享--LinQ
不過依照我第1~2步的做法所得到的結果
ex: GetAnswer(int 60058905) => 陸仟萬零佰萬零拾萬伍萬捌仟玖佰零拾伍

直覺應該可以直接用LinQ來對字串做操作來得到正確的中文結果
如果有半夜『熱』到睡不著覺，可挑戰看看這題：

如何將 1~999999999 間的任意數字，從
『X億X仟萬Ｘ佰萬Ｘ拾萬Ｘ萬Ｘ仟Ｘ佰Ｘ拾Ｘ』變成正確的中文輸出
ex: 陸仟萬零佰萬零拾萬伍萬捌仟玖佰零拾伍 => 陸仟零伍萬捌仟玖佰零伍

燒完腦後會比較好入睡
雖然標題有提到『LinQ 有更好的解法嗎？』不過歡迎各路好手參與燒腦
只要限定從『X億X仟萬Ｘ佰萬Ｘ拾萬Ｘ萬Ｘ仟Ｘ佰Ｘ拾Ｘ』開始處理中文轉換就行了

感謝參與回答的各位邦友


標題:如何撰寫線上更新功能
標籤:#撰寫線上更新 #python 3 

請問各位先進
我想在自己的程式中寫一個線上更新功能
也就是程式一啟動會先判斷是否有更新版的系統
若有，就完成下載並重新執行
請問各路高手有沒有好方法
謝謝
PS:開發語言為PYTHON 3


標題:如何在scrapy中運用兩個資料庫？
標籤:python3 scrapy mongodb postgresql 

如題，我希望在爬蟲一開始先讀取postgresql中的資料當作關鍵字，然後再存入mongoDB
如果需要實現這樣的狀況，請問該從何下手呢？
目前是使用postgresql讀取和存入。
spider.py
class SearchSpider(scrapy.Spider):
    def start_requests(self):
        session = pipelines.NewsSaveToPostgresPipeline().sessionmaker()
        total_sql = session.execute(text())

pipelines.py
class NewsSaveToPostgresPipeline(object):
    @classmethod
    def from_crawler(cls, crawler):
        cls.DB_CON_STR = crawler.settings.get('DB_CON_STR')
        cls.engine = create_engine(cls.DB_CON_STR, echo=True, poolclass=NullPool)  # 连接数据库
        cls.sessionmaker = sessionmaker(bind=cls.engine)
        Base.metadata.create_all(cls.engine)

        return cls()

    def open_spider(self, spider):
        self.session = self.sessionmaker()

    def close_spider(self, spider):
        self.session.close()

        def process_item(self, item, spider):
        if spider.name == 'proxy_example':
            self.session.add(Proxy(**item))
        else:
            self.session.add(WebData(**item))
        self.session.commit()



標題:python 相關問題
標籤:python3 


請問要如何改才能讓每一排最後一個Z不要印出來~


標題:python 成績計算問題
標籤:python3 

!

score=[[76,73,85],[88,84,76],[92,82,92],[82,91,85],[72,74,73]]
for i in range(5):
    print('student',str(i+1))
    for j in range(3):
        print(' '+str(j+1)+":",score[i][j])
    print(' '+'sum:',score[i][j]+score[i][j]+score[i][j])
    print(' '+'avg:',(score[i][j]+score[i][j]+score[i][j])/3)

我打的迴圈印出來sum,avg的答案會跟圖片答案不一樣，想請問要怎麼解決~


標題:有可能將以下兩段程式碼合併嗎?(求大神解)
標籤:python ai mnist import keras 求幫忙 it大神 

import numpy
import scipy.special
%matplotlib

def __init__(self, inputnodes, hiddennodes, outputnodes, learningrate):
    self.inodes = inputnodes
    self.hnodes = hiddennodes
    self.onodes = outputnodes

    self.wih = numpy.random.normal(0.0, pow(self.hnodes, -0.5),
        (self.hnodes, self.inodes))
    self.who = numpy.random.normal(0.0, pow(self.onodes, -0.5),
        (self.onodes, self.hnodes))
    
    self.lr = learningrate

    self.activation_function = lambda x: scipy.special.expit(x)

    pass

def train(self, inputs_list, targets_list):
    inputs = numpy.array(inputs_list, ndmin=2).T
    targets = numpy.array(targets_list, ndmin=2).T

    hidden_inputs = numpy.dot(self.wih, inputs)

    hidden_outputs = self.activation_function(hidden_inputs)

    final_inputs = numpy.dot(self.who, hidden_outputs)
    
    final_outputs = self.activation_function(final_inputs)

    ouput_errors = (target - actual)

    hidden_errors = numpy.dot(self.who.T, outputs_errors)

    layers
    self.who += self.lr * numpy.dot((outputs_errors *
        final_outputs * (1.0 - final_outputs)),
        numpy.transpose(hidden_outputs))

    layers
    self.wih += self.lr * numpy.dot((hidden_errors *
        hidden_outputs * (1.0 - hidden_outputs)),
        numpy.transpose(inputs))

    pass
def query(self, inouts_list):
    inputs = numpy.array(inputs_list, ndmin=2).T

    hidden_inputs = numpy.dot(self.wih, inputs)

    hidden_outputs = self.ativation_function(hidden_inputs)

    final_inputs = numpy.dot(self.who, hidden_outputs)

    final_outputs = self.activation_function(final_inputs)

    return final_outputs

def neuralNetwork(input_nodes, hidden_nodes, output_nodes, learning_rate):
    return 0    

input_nodes = 784
hidden_nodes = 200
output_nodes = 10

learning_rate = 1.0

n = neuralNetwork(input_nodes, hidden_nodes, output_nodes,
    learning_rate)

training_data_file = open("mnist_dataset/mnist_train.csv", 'r')
training_data_list = training_data_file.readline()
training_data_file.close()

epochs = 5

for e in range(epochs):
    for record in training_data_list:
        all_values = record.split(',')
        inputs = (numpy.asfarray(all_values[1:] / 255.0 * 0.99) + 0.01151)
        targets = numpy.zeros(output_nodes) + 0.01

        targets[int(all_values[0])] = 0.99
        n.train(inputs, targets)
        
        pass

pass

test_data_file = open("mnist_dataset/mnist_test.csv", 'r')
test_data_list = test_data_file.readline()
test_data_file.close()

for record in test_data_list:
    all_values = record.split(',')

    correct_label = int(all_values[0])

    inputs = (numpy.asfarray(all_values[1:] / 255.0 * 0.99) + 1.0)

    outputs = n.query(inputs)
              
    label = numpy.argmax(outputs)

    if (label == correct_label):
        scorecard.append(1)

    else:
        scorecard.append(0)
        pass
pass

scorecard_array = numpy.asarray(scorecard)
print("performmance = ", secordcard_array.sum()/scorecard_array.size)

import keras

from keras.datasets import minst
from keras.models import Sequential
from keras.layer.core import Dense, Dropout, Activation
from keras.optimizers import RMSprop
from keras.callbacks import EailyStopping, CSVLogger
%matplotlib inline
import matplotlib.pyplot as plt

batch_size = 128
num_classes = 10
epochs = 20

(x_train, y_train), (x_test, y_test) = minst.load_data()

for i in range (10):
    plt.subplot(2, 5, i+1)
    plt.title("M_%d" % i)
    plt.axis("off")
    plt.imshow(x_train[i].reshape(28, 28), cmap=None)
plt.show()

x_train = x_train.reshape(60000, 784).astype('float32')
x_test = x_test.reshape(10000, 784).astype('float32')
x_train /= 255
x_test /= 255
y_train = keras.utils.to_categorical(y_train, num_classes)
y_test = keras.utils.to_categorical(y_test, num_classes)

print(x_train.shape)
print(y_train.shape)
print(x_test.shape)
print(y_test.shape)

model = Sequential()
model.add(Dense(512, input_shape=(784, )))
model.add(Activation('relu'))
model.add(Dropout(0.2))
model.add(Dense(512))
model.add(Activation('relu'))
model.add(Dropout(0.2))
model.add(Dense(10))
model.add(Activation('softmax'))

model.summary()

model.compile(loss='categorical_crossentropy',
              optimizer=RMSprop(),
              metrics=['accuracy'])

es = EarlyStopping(monitor='val_loss', patience=2)
csv_logger = CSVLogger('training.log')
hist = model.fit(x_train, y_train, batch_size=batch_size, epochs=epochs,
                verbose=1, validation_split=0.1, callbacks=[es, csv_logger])

score = model.evaluate(x_text, y_text, verbose=0)
print('test loss:', score[0])
print('test acc:', score[1])

loss = hist.history['loss']
val_loss = hist.history['val_loss']
epochs = len(loss)
plt.plot(range(epochs), loss, marker='.', label='loss(training data)')
plt.plot(range(epochs), val_loss, marker='.', label='val_loss(evaluate data)')
plt.legend(loc='best')
plt.grid()
plt.xlabel('epochs')
plt.ylabel('loss')
plt.show()



標題:VSCODE編譯問題
標籤:vscode python 

我是使用VSCODE寫python，每個資料夾內都有一個py檔，編譯上也不會有問題

不過如果我單開啟某個資料夾要來進行編譯就會出現錯誤

好像是讀取numpy出現問題，但是如果從再外面一層資料夾進行編譯就不會有問題
爬文之後也找不到解，所以上來問問看，謝謝


標題:使用Python3.7.3 從讀卡機讀健保卡資料其中姓名出現亂碼 (BIG5轉UTF-8)  (已解決)  
標籤:#ic卡讀取 #編碼轉換 python3 utf-8 pyscard模組 

使用pyscard模組搭配讀卡機,我是先用程式範例做測試
IC卡讀取程式參考範例來源
他沒做什麼特殊的轉碼卻能正常顯示姓名(雖然有打馬但看的出來)
後續 看了網路上的方法,自己嘗試去改 轉成bytes
圖一連結
再次轉換unicode又變成了亂碼,但這次亂碼變得不一樣感覺稍微有前進了一步.....
圖二連結
也嘗試了 又被打回原形
圖三連結
--------2020年6月20日早上11點半更新------------
試了網路上很多關於python3編碼轉換的方法
算有小小的進展? 苦笑

所需模組 Pyscard  環境 Linux
from smartcard.System import readers
SelectAPDU = [ 0x00, 0xA4, 0x04, 0x00, 0x10, 0xD1, 0x58, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x00 ]
ReadProfileAPDU = [ 0x00, 0xca, 0x11, 0x00, 0x02, 0x00, 0x00 ]
r = readers()
reader = r[0]
connection.connect()
data, sw1, sw2 = connection.transmit(SelectAPDU)
data, sw1, sw2 = connection.transmit(ReadProfileAPDU)
print('姓名 : %s' % ''.join(chr(i) for i in data[12:32]))



標題:網頁爬蟲 取出標籤id屬性問題
標籤:python 3 網路爬蟲 python beautifulsoup 

目前這在運用BeautifulSoup學習爬蟲，但在取標籤id時遇上問題
我在練習取得台彩中獎號碼的code，在最下方我想取得span的id屬性，並且放到函數中判斷是否為中獎號碼的標籤，但顯示了下面的錯誤訊息
Traceback (most recent call last):
  File "lotto.py", line 21, in <module>
    if find_id(tag['id']):
  File "C:\Users\brian\AppData\Local\Programs\Python\Python38-32\lib\site-packages\bs4\element.py", line 1401, in __getitem__
    return self.attrs[key]
KeyError: 'id'

Key值好像有錯誤(Documentation有寫可以字典方式取標籤屬性)，想請問這是為什麼，該怎麼解決呢？
以下是我的code
import requests as req
from bs4 import BeautifulSoup

win_id=["Lotto649Control_history_dlQuery_No1_","Lotto649Control_history_dlQuery_No2_","Lotto649Control_history_dlQuery_No3_","Lotto649Control_history_dlQuery_No4_","Lotto649Control_history_dlQuery_No5_","Lotto649Control_history_dlQuery_No6_","Lotto649Control_history_dlQuery_SNo_"]

def find_id(check_id):
    global win_id
    if(check_id !=None):
        for i in range(len(win_id)): #找尋傳入id是否符合中獎id列表
            if win_id[i] in check_id:
                return True
            else:
                return False

url="https://www.taiwanlottery.com.tw/lotto/lotto649/history.aspx" #網頁網址
request=req.get(url).text
root=BeautifulSoup(request,"html.parser") #大樂透網站的html檔案經過BeautifulSoup分析後存入root
tags=root.find_all("span")
with open("lotto_number.txt", mode="w", encoding="utf-8") as lotto_name:
    for tag in tags: #tags代表所有span標籤 tag代表個別每一個
        if find_id(tag['id']):
            lotto_name.write(tag['id']) #把tag["id"]帶入check_id

謝謝！


標題:爬蟲 輸入錯誤網址 能否不要顯示錯誤訊息，改為輸出error
標籤:python3 爬蟲問題 

from requests import get
url="https://www.baisfdu.com/"
response=get(url)
#1.如果響應狀態碼是200，說明請求成功！
if response.status_code==200:
    print("成功請求響應！")
else:
    print("請求失敗！")

請問各位大大，在我預期中我故意填寫錯誤的網址應該要回傳給我 請求失敗，實際上在運行時(jupyter notebook)
都會跳出
gaierror  Traceback (most recent call last)
//
請問這要下什麼關鍵字去找資料比較找得到呢


標題:Python for 循环中使用变量
標籤:python for 循环 

之前写过一个关于 ping IP 段的 Python 脚本，现在想把脚本优化一下，支持自定义输入，代码如下：
import subprocess

StartIPFirst = input("Please type first of the IP: ")
StartIPSecond = input("Please type second of the IP: ")
StartIPThird = input("Please type third of the IP: ")
StartIPFourth = input("Please type fourth of the IP: ")

StartIP = StartIPFirst + "." + StartIPSecond + "." + StartIPThird + "." + StartIPFourth

EndIPFirst = input("Please type first of the IP: ")
EndIPSecond = input("Please type second of the IP: ")
EndIPThird = input("Please type third of the IP: ")
EndIPFourth = input("Please type fourth of the IP: ")

EndIP = EndIPFirst + "." + EndIPSecond + "." + EndIPThird + "." + EndIPFourth

for h in range(int(StartIPFirst), int(EndIPFirst)):
    for i in range(int(StartIPSecond), int(EndIPSecond)):
        for j in range(int(StartIPThird), int(EndIPThird)):
            for k in range(int(StartIPFourth), int(EndIPFourth)):
                IP = "%s.%s.%s.%s" % (h, i, j, k)
                print(IP + "\n")

print(StartIP)
print(EndIP)

当输入完 IP 每个部分后，就直接 print 两个 IP 了，for 循环好像没有运行，什么也没有 print。也没有任何报错，这个是怎么回事？


標題:利用Python 寫資料增強的Code後修改不了xml檔(以貼code圖和附Code)
標籤:#python #python 3 #yolo #資料增強 #xml 

小弟最近寫了一個增強YOLO訓練集的CODE(左右翻轉)
但在翻轉完後的座標要存回XML檔內卻修改不了
請大大們幫忙看一下~~
import numpy as np
import random
import cv2
import glob
import os
import xml.etree.cElementTree as ET

def random_horizontal_flip(img, bboxes, p=0.5):
    if random.random() < p:
        _, w_img, _ = img.shape
        img = img[:, ::-1, :]
        bboxes[:, [0, 2]] = w_img - bboxes[:, [2, 0]]
    return img, bboxes
 
def readAnnotations(xml_path):
    et = ET.parse(xml_path)
    element = et.getroot()
    element_objs = element.findall('object')
 
    results = []
    for element_obj in element_objs:
        result = []
        obj_bbox = element_obj.find('bndbox')
        x1 = int(round(float(obj_bbox.find('xmin').text)))
        y1 = int(round(float(obj_bbox.find('ymin').text)))
        x2 = int(round(float(obj_bbox.find('xmax').text)))
        y2 = int(round(float(obj_bbox.find('ymax').text)))
 
        result.append(int(x1))
        result.append(int(y1))
        result.append(int(x2))
        result.append(int(y2))
       
 
        results.append(result)
    return results 
    
if __name__ == "__main__":
    img_list = glob.glob("E:/Opencv/dataip/test/*.jpg")
    for image_path in img_list:
        imgpath =image_path[:-4] + ".xml"
        img_org = cv2.imread(image_path)
        img = img_org
        bboxes = readAnnotations(image_path[:-4] + ".xml")
        print("img: {},  box: {}".format(image_path, bboxes))

        img, bboxes = random_horizontal_flip(img, np.array(bboxes), 1)
        #img, bboxes = random_vertical_flip(img, np.array(bboxes), 1)
        #img, bboxes = random_rot90_1(img, np.array(bboxes), 1)
        # img, bboxes = random_translate(img, np.array(bboxes), 1)
        # img, bboxes = random_crop(img, np.array(bboxes), 1)
        # img, bboxes = random_bright(img, np.array(bboxes), 1)
        # img, bboxes = random_swap(img, np.array(bboxes), 1)
        # img, bboxes = random_saturation(img, np.array(bboxes), 1)
        # img, bboxes = random_hue(img, np.array(bboxes), 1)
        img = np.array(img)
        print(bboxes)
        for i,box in enumerate(bboxes):
           cv2.rectangle(img, (box[0], box[1]), (box[2], box[3]), (0, 255, 0), 2)
           print(box[0], box[1], box[2], box[3])

           et = ET.parse(imgpath)
           element = et.getroot()
           
           bndbox = element.findall("./object/bndbox")
           print("修改前:"+bndbox[i].find('xmin').text,bndbox[i].find('xmax').text )
           bndbox[i].find('xmin').text = str(box[0]) 
           bndbox[i].find('ymin').text = str(box[1])  
           bndbox[i].find('xmax').text = str(box[2]) 
           bndbox[i].find('ymax').text = str(box[3]) 
           print("修改後:"+bndbox[i].find('xmin').text,bndbox[i].find('xmax').text )
     
        et.write('test/new/'+'leftright'+imgpath[22:-4]+'.xml',encoding='UTF-8')      
        cv2.imwrite('test/new/'+'leftright'+image_path[22:-4]+'.jpg', img)
       # cv2.imshow(image_path[22:-4]+'da', img)
        img_rotate = 0
        cv2.waitKey()
        cv2.destroyAllWindows()


存回xml的部分Code附上:

這是print出修改前xml內bndbox的座標::

修改後的bndbox座標:

修改前、修改後的xmin、xmax值:

有用cv2去試畫過座標點 是沒問題的:

產出的xml檔長這樣:



標題:怎麼把這段改成C++
標籤:python python trans to c++ c++ 

while True:
    try:
        dict1 = {'A': 10, 'J': 18, 'S': 26, 'B': 11, 'K': 19, 'T': 27, 'C': 12, 'L': 20, 'U': 28,
                 'D': 13, 'M': 21, 'V': 29, 'E': 14, 'N': 22, 'W': 32, 'F': 15, 'O': 35, 'X': 30,
                 'Y': 31, 'G': 16, 'H': 17, 'Q': 24, 'Z': 33, 'I': 34, 'R': 25, 'P': 23}
        id_text = input()
        en = str(dict1[id_text[0].upper()])
        total = int(en[0]) + int(en[1]) * 9 + int(id_text[len(id_text) - 1])
        id_text = id_text[1:9]
        n = 8
        for i in id_text:
            total += int(i) * n
            n -= 1

        print("real" if total % 10 == 0 else "fake")

    except:
        break



標題:[python]輸出超過字數換行
標籤:python 換行輸出 


練這個題目的時候，卡在不知道要怎麼寫，使印出那行超出40字後換行輸出
把
8   9   12  16  18  20  24  27  28  32  36  40  44  45  48  52  54
變成
8   9   12  16  18  20  24  27  28  32
36  40  44  45  48  52  54
求解!謝謝大大


標題:當系統剪貼簿內有字串時執行函數，該如何達成??
標籤:python3 python 

#!python3

import pyperclip as pypc
import webbrowser
import re

URL = "https://translate.google.com/#view=home&op=translate&sl=en&tl=zh-TW&text="
pat = re.compile(r"[a-zA-Z]+")

#pypc.copy("")

while True:
    mytext = pypc.paste()
    txt = pat.match(mytext)
    print(txt)
    if txt:
        webbrowser.open(URL+mytext, new=0, autoraise=True)
        pypc.copy("")
        continue

目標:
當用鍵盤或滑鼠複製英文時，立刻跳出google翻譯網頁，並已有翻譯結果。
現在遇到的難題是要如何讓程式等待剪貼簿裡有字串時才執行???
該如何達成??
標準庫就能完成???
或是一定要第三方的套件???


標題:要怎麼把這段Python trans to C++
標籤:python python c++ 

for i in id_text:
    total += int(i) * n
    n -= 1



標題:請問各位大神要怎麼改? 
標籤:python ai deep learning 

import numpy
import scipy.special
import matplotlib.pyplot

def __init__(self, inputnodes, hiddennodes, outputnodes, learningrate):
    self.inodes = inputnodes
    self.hnodes = hiddennodes
    self.onodes = outputnodes

    self.wih = numpy.random.normal(0.0, pow(self.hnodes, -0.5),
        (self.hnodes, self.inodes))
    self.who = numpy.random.normal(0.0, pow(self.onodes, -0.5),
        (self.onodes, self.hnodes))
    
    self.lr = learningrate

    self.activation_function = lambda x: scipy.special.expit(x)

    pass

def train(self, inputs_list, targets_list):
    inputs = numpy.array(inputs_list, ndmin=2).T
    targets = numpy.array(targets_list, ndmin=2).T

    hidden_inputs = numpy.dot(self.wih, inputs)

    hidden_outputs = self.activation_function(hidden_inputs)

    final_inputs = numpy.dot(self.who, hidden_outputs)
    
    final_outputs = self.activation_function(final_inputs)

    ouput_errors = (target - actual)

    hidden_errors = numpy.dot(self.who.T, outputs_errors)

    layers
    self.who += self.lr * numpy.dot((outputs_errors *
        final_outputs * (1.0 - final_outputs)),
        numpy.transpose(hidden_outputs))

    layers
    self.wih += self.lr * numpy.dot((hidden_errors *
        hidden_outputs * (1.0 - hidden_outputs)),
        numpy.transpose(inputs))

    pass
def query(self, inouts_list):
    inputs = numpy.array(inputs_list, ndmin=2).T

    hidden_inputs = numpy.dot(self.wih, inputs)

    hidden_outputs = self.ativation_function(hidden_inputs)

    final_inputs = numpy.dot(self.who, hidden_outputs)

    final_outputs = self.activation_function(final_inputs)

    return final_outputs

input_nodes = 784
hidden_nodes = 200
output_nodes = 10

learning_rate = 1.0

n = neuralNetwork(input_nodes, hidden_nodes, output_nodes,
    learning_rate)

training_data_file = open("mnist_dataset/mnist_train.csv", 'r')
training_data_list = training_data_file.readline()
training_data_file.close()

epochs = 5

for e in range(epochs):
    for record in training_data_list:
        all_values = record.split(',')
        inputs = (numpy.asfarray(all_values[1:] / 255.0 * 0.99) + 0.01151)
        targets = numpy.zeros(output_nodes) + 0.01

        targets[int(all_values[0])] = 0.99
        n.train(inputs, targets)
        
        pass

pass

test_data_file = open("mnist_dataset/mnist_test.csv", 'r')
test_data_list = test_data_file.readline()
test_data_file.close()

for record in test_data_list:
    all_values = record.split(',')

    correct_label = int(all_values[0])

    inputs = (numpy.asfarray(all_values[1:] / 255.0 * 0.99) + 1.0)

    outputs = n.query(inputs)
              
    label = numpy.argmax(outputs)

    if (label == correct_label):
        scorecard.append(1)

    else:
        scorecard.append(0)
        pass
pass

scorecard_array = numpy.asarray(scorecard)
print("performmance = ", secordcard_array.sum()/scorecard_array.size)




標題:想問問能用python 串接 Slack 重複發送指令嗎？
標籤:slack python 3 

本身是python的初學者
今天在新公司上班的時候發現ＳＯＰ內有個重複性的手動工作
是在Slack持續下指令給機器人跑，突然想到是不是有辦法利用pyhon迴圈的重複指令
串接到Slack中，貼上相關數據後就可以讓python自己跑跑跑
跪求各路大神協助發想，目前還是菜鳥對於語法還不是這麼信手捻來QQ


標題:使用 pymysql 连接到 MySQL 报错
標籤:pycharm pymysql mysql python 

错误内容：
pymysql.err.InternalError: Packet sequence number wrong - got 1 expected 0

这个是怎么回事？
这是我的 python 代码:
import pymysql

DB_Host = "10.10.10.47"
DB_Name = "zabbix"
DB_User = "admin"
DB_Password = "P@ssw0rd@"

print("Connecting to database using MySQLdb...")
db = pymysql.Connect(host=DB_Host, db=DB_Name, user=DB_User, passwd=DB_Password,charset='utf8',)


print("Succesfully Connected to database using MySQLdb!")

db.close()




標題:Spyder路徑問題
標籤:python spyder 

我在Spyder上想將資料集匯進來使用，我已經確定路徑是對的，資料也有放在正確的位置，但執行結果移植說找不到資料集，請問有人遇過一樣的狀況嗎?最後是怎麼解決的?
dataset, metadata = tfds.load('CycleGan/horse2zebra',
                              with_info=True, as_supervised=True)

train_horses, train_zebras = dataset['trainA'], dataset['trainB']
test_horses, test_zebras = dataset['testA'], dataset['testB']



標題:[以解決]#linebot heroku push問題
標籤:line bot heroku python3 

小弟有隻很久沒更新的bot，今天幫它加工能時一直沒改變，所以我就想說也許是
Channel access token (long-lived) 這問題 或者是 Channel Secret的問題
所以我就從新產生幾次 程式碼有隨之更新 但是先前是沒改變
這次直接是無反應 我去heroku後台看 收到"POST /callback HTTP/1.1" 400 -
剛上網查好像是invalid hostname 且我剛看line bot 有些寫好的程式碼
@app.route("/callback", methods=['POST'])
def callback():
    # get X-Line-Signature header value
    signature = request.headers['X-Line-Signature']
    # get request body as text
    body = request.get_data(as_text=True)
    app.logger.info("Request body: " + body)
    # handle webhook body
    try:
        handler.handle(body, signature)
    except InvalidSignatureError:
        abort(400)
    return 'OK'

也有一段是有關於400的，上網看了同樣問題 下面的解答是 Channel access token 、 Channel Secret 要確認正確 只是我的是正確的....


標題:為什麼他一直說我寫錯? 
標籤:python系列文章 python ai 

import numpy
import scipy.special
import matplotlib.pyplot

def __init__(self, inputnodes, hiddennodes, outputnodes, learningrate):
    self.inodes = inputnodes
    self.hnodes = hiddennodes
    self.onodes = outputnodes

    self.wih = numpy.random.normal(0.0, pow(self.hnodes, -0.5),
        (self.hnodes, self.inodes))
    self.who = numpy.random.normal(0.0, pow(self.onodes, -0.5),
        (self.onodes, self.hnodes))
    
    self.lr = learningrate

    self.activation_function = lambda x: scipy.special.expit(x)

    pass

def train(self, inputs_list, targets_list):
    inputs = numpy.array(inputs_list, ndmin=2).T
    targets = numpy.array(targets_list, ndmin=2).T

    hidden_inputs = numpy.dot(self.wih, inputs)

    hidden_outputs = self.activation_function(hidden_inputs)

    final_inputs = numpy.dot(self.who, hidden_outputs)
    
    final_outputs = self.activation_function(final_inputs)

    ouput_errors = (target - actual)

    hidden_errors = numpy.dot(self.who.T, outputs_errors)

    layers
    self.who += self.lr * numpy.dot((outputs_errors *
        final_outputs * (1.0 - final_outputs)),
        numpy.transpose(hidden_outputs))

    layers
    self.wih += self.lr * numpy.dot((hidden_errors *
        hidden_outputs * (1.0 - hidden_outputs)),
        numpy.transpose(inputs))

    pass
def query(self, inouts_list):
    inputs = numpy.array(inputs_list, ndmin=2).T

    hidden_inputs = numpy.dot(self.wih, inputs)

    hidden_outputs = self.ativation_function(hidden_inputs)

    final_inputs = numpy.dot(self.who, hidden_outputs)

    final_outputs = self.activation_function(final_inputs)

    return final_outputs

input_nodes = 784
hidden_nodes = 200
output_nodes = 10

learning_rate = 1.0

n = neuralNetwork(input_nodes, hidden_nodes, output_nodes,
    learning_rate)

training_data_file = open("mnist_dataset/mnist_train.csv", 'r')
training_data_list = training_data_file.readline()
training_data_file.close()

epochs = 5

for e in range(epochs):
    for record in training_data_list:
        all_values = record.split(',')
        inputs = (numpy.asfarray(all_values[1:] / 255.0 * 0.99) + 0.01151
        targets = numpy.zeros(output_nodes) + 0.01

        targets[int(all_values[0])] = 0.99
        n.train(inputs, targets)
        
        pass

pass

test_data_file = open("mnist_dataset/mnist_test.csv", 'r')
test_data_list = test_data_file.readline()
test_data_file.close()

for record in test_data_list:
    all_values = record.split(',')

    correct_label = int(all_values[0])

    inputs = (numpy.asfarray(all_values[1:] / 255.0 * 0.99) + 1.0

    outputs = n.query(inputs)
              
    label = numpy.argmax(outputs)

    if (label == correct_label):
        scorecard.append(1)

    else:
        scorecard.append(0)
        pass
pass

scorecard_array = numpy.asarray(scorecard)
print("performmance = ", secordcard_array.sum()/scorecard_array.size)



標題:初學者學python適合嗎？
標籤:自學程式設計 初學者求助 python 

小女大學不是資訊相關科系
也沒碰過軟體、程式語言這一塊
請問如果想看書自學python適合嗎？
或是有比較適合 沒基礎的新人 的程式語言軟體相關的可以學習的嗎？
感謝QQ
（先不考慮是不是要以這個找工作，想先看看能不能培養出興趣再去考慮以這個就業的問題）
補充一下：
有上網找到推薦新手的入門書
只是不知道python適不適合沒基礎的新人去學
所以想說問一下各位看看QQ


標題:最近寫的一個投資策略的python程式碼  希望知道如何改善
標籤:python python3 python 3 python入門 

上一篇發問耍笨把問題解決之後
算是完成了一個成品吧
因為是python新手所以寫得有點醜
希望知道如何改善
感覺自己寫的跟別人長的差好多
長的超不像程式碼的
這個算是一個很簡單的策略
應該也稱不太上策略吧
就是購買前50大權值股
權重是市值等比例放大
但是輸入你想投資的金額用即時資料幫你算出要購買的股票和股數
如果會證券API的python
一個鍵就可以購買一個這個策略的投資組合
而且10月盤中零股就可以交易了
算是有點用吧
獲利不保證啦
因為只是主要拿來練習python
太複雜的寫不出來
挑一個簡單邏輯又跟財務有相關的來寫的
雖然我覺得沒有幾個人會相信我真的拿去買股票，但這策略跟購買台灣50其實也不會差距太多，要買其實也是可以，但請注意我算出來的是購買股數，不是購買張數，1張=1000股，如果你買到張數錢不夠多會違約交割喔!!!
# 這邊輸入想要投資的金額，預設100萬

Money=1000000

import pandas as pd

df = pd.read_html('https://histock.tw/stock/taiexproportion.aspx')  

print(df[0])

zz =pd.DataFrame(df[0])

#刪除資料的%，讓它變數值，找了很久才知道怎麼删，但試很久不會删整欄，只好土法煉鋼一個一個删 
#MarketValue/100是為了把%變成小數點之後做運算

MarketValue1 = float(zz.at[0, '市值佔大盤比重'].strip('%'))
Value1=MarketValue1/100

MarketValue2 = float(zz.at[1, '市值佔大盤比重'].strip('%'))
Value2=MarketValue2/100


MarketValue3 = float(zz.at[2, '市值佔大盤比重'].strip('%'))
Value3=MarketValue3/100


MarketValue4 = float(zz.at[3, '市值佔大盤比重'].strip('%'))
Value4=MarketValue4/100


MarketValue5 = float(zz.at[4, '市值佔大盤比重'].strip('%'))
Value5=MarketValue5/100


MarketValue6 = float(zz.at[5, '市值佔大盤比重'].strip('%'))
Value6=MarketValue6/100



MarketValue7 = float(zz.at[6, '市值佔大盤比重'].strip('%'))
Value7=MarketValue7/100


MarketValue8 = float(zz.at[7, '市值佔大盤比重'].strip('%'))
Value8=MarketValue8/100


MarketValue9 = float(zz.at[8, '市值佔大盤比重'].strip('%'))
Value9=MarketValue9/100


MarketValue10 = float(zz.at[9, '市值佔大盤比重'].strip('%'))
Value10=MarketValue10/100


MarketValue11 = float(zz.at[10, '市值佔大盤比重'].strip('%'))
Value11=MarketValue11/100


MarketValue12 = float(zz.at[11, '市值佔大盤比重'].strip('%'))
Value12=MarketValue12/100


MarketValue13 = float(zz.at[12, '市值佔大盤比重'].strip('%'))
Value13=MarketValue13/100


MarketValue14 = float(zz.at[13, '市值佔大盤比重'].strip('%'))
Value14=MarketValue14/100


MarketValue15 = float(zz.at[14, '市值佔大盤比重'].strip('%'))
Value15=MarketValue15/100


MarketValue16 = float(zz.at[15, '市值佔大盤比重'].strip('%'))
Value16=MarketValue16/100


MarketValue17 = float(zz.at[16, '市值佔大盤比重'].strip('%'))
Value17=MarketValue17/100


MarketValue18 = float(zz.at[17, '市值佔大盤比重'].strip('%'))
Value18=MarketValue18/100


MarketValue19 = float(zz.at[18, '市值佔大盤比重'].strip('%'))
Value19=MarketValue19/100


MarketValue20 = float(zz.at[19, '市值佔大盤比重'].strip('%'))
Value20=MarketValue20/100


MarketValue21 = float(zz.at[20, '市值佔大盤比重'].strip('%'))
Value21=MarketValue21/100


MarketValue22 = float(zz.at[21, '市值佔大盤比重'].strip('%'))
Value22=MarketValue22/100


MarketValue23 = float(zz.at[22, '市值佔大盤比重'].strip('%'))
Value23=MarketValue23/100

MarketValue24 = float(zz.at[23, '市值佔大盤比重'].strip('%'))
Value24=MarketValue24/100

MarketValue25 = float(zz.at[24, '市值佔大盤比重'].strip('%'))
Value25=MarketValue25/100


MarketValue26 = float(zz.at[25, '市值佔大盤比重'].strip('%'))
Value26=MarketValue26/100

MarketValue27 = float(zz.at[26, '市值佔大盤比重'].strip('%'))
Value27=MarketValue27/100


MarketValue28 = float(zz.at[27, '市值佔大盤比重'].strip('%'))
Value28=MarketValue28/100


MarketValue29 = float(zz.at[28, '市值佔大盤比重'].strip('%'))
Value29=MarketValue29/100


MarketValue30 = float(zz.at[29, '市值佔大盤比重'].strip('%'))
Value30=MarketValue30/100

MarketValue31 = float(zz.at[30, '市值佔大盤比重'].strip('%'))
Value31=MarketValue31/100


MarketValue32 = float(zz.at[31, '市值佔大盤比重'].strip('%'))
Value32=MarketValue32/100


MarketValue33 = float(zz.at[32, '市值佔大盤比重'].strip('%'))
Value33=MarketValue33/100

MarketValue34 = float(zz.at[33, '市值佔大盤比重'].strip('%'))
Value34=MarketValue34/100


MarketValue35 = float(zz.at[34, '市值佔大盤比重'].strip('%'))
Value35=MarketValue35/100


MarketValue36 = float(zz.at[35, '市值佔大盤比重'].strip('%'))
Value36=MarketValue36/100


MarketValue37 = float(zz.at[36, '市值佔大盤比重'].strip('%'))
Value37=MarketValue37/100


MarketValue38 = float(zz.at[37, '市值佔大盤比重'].strip('%'))
Value38=MarketValue38/100

MarketValue39 = float(zz.at[38, '市值佔大盤比重'].strip('%'))
Value39=MarketValue39/100

MarketValue40 = float(zz.at[39, '市值佔大盤比重'].strip('%'))
Value40=MarketValue40/100

MarketValue41 = float(zz.at[40, '市值佔大盤比重'].strip('%'))
Value41=MarketValue41/100


MarketValue42 = float(zz.at[41, '市值佔大盤比重'].strip('%'))
Value42=MarketValue42/100

MarketValue43 = float(zz.at[42, '市值佔大盤比重'].strip('%'))
Value43=MarketValue43/100


MarketValue44 = float(zz.at[43, '市值佔大盤比重'].strip('%'))
Value44=MarketValue44/100


MarketValue45 = float(zz.at[44, '市值佔大盤比重'].strip('%'))
Value45=MarketValue45/100


MarketValue46 = float(zz.at[45, '市值佔大盤比重'].strip('%'))
Value46=MarketValue46/100


MarketValue47 = float(zz.at[46, '市值佔大盤比重'].strip('%'))
Value47=MarketValue47/100


MarketValue48 = float(zz.at[47, '市值佔大盤比重'].strip('%'))
Value48=MarketValue48/100


MarketValue49 = float(zz.at[48, '市值佔大盤比重'].strip('%'))
Value49=MarketValue49/100


MarketValue50 = float(zz.at[49, '市值佔大盤比重'].strip('%'))
Value50=MarketValue50/100


#算出前50支股票的市值總合
SumValue=(
Value1
+Value2
+Value3
+Value4
+Value5
+Value6
+Value7
+Value8
+Value9
+Value10
+Value11
+Value12
+Value13
+Value14
+Value15
+Value16
+Value17
+Value18
+Value19
+Value20
+Value21
+Value22
+Value23
+Value24
+Value25
+Value26
+Value27
+Value28
+Value29
+Value30
+Value31
+Value32
+Value33
+Value34
+Value35
+Value36
+Value37
+Value38
+Value39
+Value40
+Value41
+Value42
+Value43
+Value44
+Value45
+Value46
+Value47
+Value48
+Value49
+Value50)

#策略是很單純的等比例放大，所以1/市值總和

AdjustValue=1/SumValue

#等比例放大就會是股票的權重
#市值*等比例放大的比重
A1=Value1*AdjustValue
A2=Value2*AdjustValue
A3=Value3*AdjustValue
A4=Value4*AdjustValue
A5=Value5*AdjustValue
A6=Value6*AdjustValue
A7=Value7*AdjustValue
A8=Value8*AdjustValue
A9=Value9*AdjustValue
A10=Value10*AdjustValue
A11=Value11*AdjustValue
A12=Value12*AdjustValue
A13=Value13*AdjustValue
A14=Value14*AdjustValue
A15=Value15*AdjustValue
A16=Value16*AdjustValue
A17=Value17*AdjustValue
A18=Value18*AdjustValue
A19=Value19*AdjustValue
A20=Value20*AdjustValue
A21=Value21*AdjustValue
A22=Value22*AdjustValue
A23=Value23*AdjustValue
A24=Value24*AdjustValue
A25=Value25*AdjustValue
A26=Value26*AdjustValue
A27=Value27*AdjustValue
A28=Value28*AdjustValue
A29=Value29*AdjustValue
A30=Value30*AdjustValue
A31=Value31*AdjustValue
A32=Value32*AdjustValue
A33=Value33*AdjustValue
A34=Value34*AdjustValue
A35=Value35*AdjustValue
A36=Value36*AdjustValue
A37=Value37*AdjustValue
A38=Value38*AdjustValue
A39=Value39*AdjustValue
A40=Value40*AdjustValue
A41=Value41*AdjustValue
A42=Value42*AdjustValue
A43=Value43*AdjustValue
A44=Value44*AdjustValue
A45=Value45*AdjustValue
A46=Value46*AdjustValue
A47=Value47*AdjustValue
A48=Value48*AdjustValue
A49=Value49*AdjustValue
A50=Value50*AdjustValue

#股票名稱
F1=zz.at[0,'名稱']
F2=zz.at[1,'名稱']
F3=zz.at[2,'名稱']
F4=zz.at[3,'名稱']
F5=zz.at[4,'名稱']
F6=zz.at[5,'名稱']
F7=zz.at[6,'名稱']
F8=zz.at[7,'名稱']
F9=zz.at[8,'名稱']
F10=zz.at[9,'名稱']
F11=zz.at[10,'名稱']
F12=zz.at[11,'名稱']
F13=zz.at[12,'名稱']
F14=zz.at[13,'名稱']
F15=zz.at[14,'名稱']
F16=zz.at[15,'名稱']
F17=zz.at[16,'名稱']
F18=zz.at[17,'名稱']
F19=zz.at[18,'名稱']
F20=zz.at[19,'名稱']
F21=zz.at[20,'名稱']
F22=zz.at[21,'名稱']
F23=zz.at[22,'名稱']
F24=zz.at[23,'名稱']
F25=zz.at[24,'名稱']
F26=zz.at[25,'名稱']
F27=zz.at[26,'名稱']
F28=zz.at[27,'名稱']
F29=zz.at[28,'名稱']
F30=zz.at[29,'名稱']
F31=zz.at[30,'名稱']
F32=zz.at[31,'名稱']
F33=zz.at[32,'名稱']
F34=zz.at[33,'名稱']
F35=zz.at[34,'名稱']
F36=zz.at[35,'名稱']
F37=zz.at[36,'名稱']
F38=zz.at[37,'名稱']
F39=zz.at[38,'名稱']
F40=zz.at[39,'名稱']
F41=zz.at[40,'名稱']
F42=zz.at[41,'名稱']
F43=zz.at[42,'名稱']
F44=zz.at[43,'名稱']
F45=zz.at[44,'名稱']
F46=zz.at[45,'名稱']
F47=zz.at[46,'名稱']
F48=zz.at[47,'名稱']
F49=zz.at[48,'名稱']
F50=zz.at[49,'名稱']


#投資金額*權重，就是這支股票要投資的金額
B1=Money*A1
B2=Money*A2
B3=Money*A3
B4=Money*A4
B5=Money*A5
B6=Money*A6
B7=Money*A7
B8=Money*A8
B9=Money*A9
B10=Money*A10
B11=Money*A11
B12=Money*A12
B13=Money*A13
B14=Money*A14
B15=Money*A15
B16=Money*A16
B17=Money*A17
B18=Money*A18
B19=Money*A19
B20=Money*A20
B21=Money*A21
B22=Money*A22
B23=Money*A23
B24=Money*A24
B25=Money*A25
B26=Money*A26
B27=Money*A27
B28=Money*A28
B29=Money*A29
B30=Money*A30
B31=Money*A31
B32=Money*A32
B33=Money*A33
B34=Money*A34
B35=Money*A35
B36=Money*A36
B37=Money*A37
B38=Money*A38
B39=Money*A39
B40=Money*A40
B41=Money*A41
B42=Money*A42
B43=Money*A43
B44=Money*A44
B45=Money*A45
B46=Money*A46
B47=Money*A47
B48=Money*A48
B49=Money*A49
B50=Money*A50

#股票的代號可以當證券API的參數
C1=zz.at[0, '代號']
C2=zz.at[1, '代號']
C3=zz.at[2, '代號']
C4=zz.at[3, '代號']
C5=zz.at[4, '代號']
C6=zz.at[5, '代號']
C7=zz.at[6, '代號']
C8=zz.at[7, '代號']
C9=zz.at[8, '代號']
C10=zz.at[9, '代號']
C11=zz.at[10, '代號']
C12=zz.at[11, '代號']
C13=zz.at[12, '代號']
C14=zz.at[13, '代號']
C15=zz.at[14, '代號']
C16=zz.at[15, '代號']
C17=zz.at[16, '代號']
C18=zz.at[17, '代號']
C19=zz.at[18, '代號']
C20=zz.at[19, '代號']
C21=zz.at[20, '代號']
C22=zz.at[21, '代號']
C23=zz.at[22, '代號']
C24=zz.at[23, '代號']
C25=zz.at[24, '代號']
C26=zz.at[25, '代號']
C27=zz.at[26, '代號']
C28=zz.at[27, '代號']
C29=zz.at[28, '代號']
C30=zz.at[29, '代號']
C31=zz.at[30, '代號']
C32=zz.at[31, '代號']
C33=zz.at[32, '代號']
C34=zz.at[33, '代號']
C35=zz.at[34, '代號']
C36=zz.at[35, '代號']
C37=zz.at[36, '代號']
C38=zz.at[37, '代號']
C39=zz.at[38, '代號']
C40=zz.at[39, '代號']
C41=zz.at[40, '代號']
C42=zz.at[41, '代號']
C43=zz.at[42, '代號']
C44=zz.at[43, '代號']
C45=zz.at[44, '代號']
C46=zz.at[45, '代號']
C47=zz.at[46, '代號']
C48=zz.at[47, '代號']
C49=zz.at[48, '代號']
C50=zz.at[49, '代號']


#這是根據我策略做的次級版的策略，我想要用這筆資料得出的代號當爬蟲的變數去爬當下的股價，在用投資金額除以當下股價，這樣就是股票的股數

import requests
import bs4
url1='https://histock.tw/stock/' + str(C1)
url2='https://histock.tw/stock/' + str(C2)
url3='https://histock.tw/stock/' + str(C3)
url4='https://histock.tw/stock/' + str(C4)
url5='https://histock.tw/stock/' + str(C5)
url6='https://histock.tw/stock/' + str(C6)
url7='https://histock.tw/stock/' + str(C7)
url8='https://histock.tw/stock/' + str(C8)
url9='https://histock.tw/stock/' + str(C9)
url10='https://histock.tw/stock/' + str(C10)
url11='https://histock.tw/stock/' + str(C11)
url12='https://histock.tw/stock/' + str(C12)
url13='https://histock.tw/stock/' + str(C13)
url14='https://histock.tw/stock/' + str(C14)
url15='https://histock.tw/stock/' + str(C15)
url16='https://histock.tw/stock/' + str(C16)
url17='https://histock.tw/stock/' + str(C17)
url18='https://histock.tw/stock/' + str(C18)
url19='https://histock.tw/stock/' + str(C19)
url20='https://histock.tw/stock/' + str(C20)
url21='https://histock.tw/stock/' + str(C21)
url22='https://histock.tw/stock/' + str(C22)
url23='https://histock.tw/stock/' + str(C23)
url24='https://histock.tw/stock/' + str(C24)
url25='https://histock.tw/stock/' + str(C25)
url26='https://histock.tw/stock/' + str(C26)
url27='https://histock.tw/stock/' + str(C27)
url28='https://histock.tw/stock/' + str(C28)
url29='https://histock.tw/stock/' + str(C29)
url30='https://histock.tw/stock/' + str(C30)
url31='https://histock.tw/stock/' + str(C31)
url32='https://histock.tw/stock/' + str(C32)
url33='https://histock.tw/stock/' + str(C33)
url34='https://histock.tw/stock/' + str(C34)
url35='https://histock.tw/stock/' + str(C35)
url36='https://histock.tw/stock/' + str(C36)
url37='https://histock.tw/stock/' + str(C37)
url38='https://histock.tw/stock/' + str(C38)
url39='https://histock.tw/stock/' + str(C39)
url40='https://histock.tw/stock/' + str(C40)
url41='https://histock.tw/stock/' + str(C41)
url42='https://histock.tw/stock/' + str(C42)
url43='https://histock.tw/stock/' + str(C43)
url44='https://histock.tw/stock/' + str(C44)
url45='https://histock.tw/stock/' + str(C45)
url46='https://histock.tw/stock/' + str(C46)
url47='https://histock.tw/stock/' + str(C47)
url48='https://histock.tw/stock/' + str(C48)
url49='https://histock.tw/stock/' + str(C49)
url50='https://histock.tw/stock/' + str(C50)

response1 =requests.get(url1)
response2=requests.get(url2)
response3=requests.get(url3)
response4=requests.get(url4)
response5=requests.get(url5)
response6=requests.get(url6)
response7=requests.get(url7)
response8=requests.get(url8)
response9=requests.get(url9)
response10=requests.get(url10)
response11=requests.get(url11)
response12=requests.get(url12)
response13=requests.get(url13)
response14=requests.get(url14)
response15=requests.get(url15)
response16=requests.get(url16)
response17=requests.get(url17)
response18=requests.get(url18)
response19=requests.get(url19)
response20=requests.get(url20)
response21=requests.get(url21)
response22=requests.get(url22)
response23=requests.get(url23)
response24=requests.get(url24)
response25=requests.get(url25)
response26=requests.get(url26)
response27=requests.get(url27)
response28=requests.get(url28)
response29=requests.get(url29)
response30=requests.get(url30)
response31=requests.get(url31)
response32=requests.get(url32)
response33=requests.get(url33)
response34=requests.get(url34)
response35=requests.get(url35)
response36=requests.get(url36)
response37=requests.get(url37)
response38=requests.get(url38)
response39=requests.get(url39)
response40=requests.get(url40)
response41=requests.get(url41)
response42=requests.get(url42)
response43=requests.get(url43)
response44=requests.get(url44)
response45=requests.get(url45)
response46=requests.get(url46)
response47=requests.get(url47)
response48=requests.get(url48)
response49=requests.get(url49)
response50=requests.get(url50)

root1=bs4.BeautifulSoup(response1.text, "html.parser")
root2=bs4.BeautifulSoup(response2.text, "html.parser")
root3=bs4.BeautifulSoup(response3.text, "html.parser")
root4=bs4.BeautifulSoup(response4.text, "html.parser")
root5=bs4.BeautifulSoup(response5.text, "html.parser")
root6=bs4.BeautifulSoup(response6.text, "html.parser")
root7=bs4.BeautifulSoup(response7.text, "html.parser")
root8=bs4.BeautifulSoup(response8.text, "html.parser")
root9=bs4.BeautifulSoup(response9.text, "html.parser")
root10=bs4.BeautifulSoup(response10.text, "html.parser")
root11=bs4.BeautifulSoup(response11.text, "html.parser")
root12=bs4.BeautifulSoup(response12.text, "html.parser")
root13=bs4.BeautifulSoup(response13.text, "html.parser")
root14=bs4.BeautifulSoup(response14.text, "html.parser")
root15=bs4.BeautifulSoup(response15.text, "html.parser")
root16=bs4.BeautifulSoup(response16.text, "html.parser")
root17=bs4.BeautifulSoup(response17.text, "html.parser")
root18=bs4.BeautifulSoup(response18.text, "html.parser")
root19=bs4.BeautifulSoup(response19.text, "html.parser")
root20=bs4.BeautifulSoup(response20.text, "html.parser")
root21=bs4.BeautifulSoup(response21.text, "html.parser")
root22=bs4.BeautifulSoup(response22.text, "html.parser")
root23=bs4.BeautifulSoup(response23.text, "html.parser")
root24=bs4.BeautifulSoup(response24.text, "html.parser")
root25=bs4.BeautifulSoup(response25.text, "html.parser")
root26=bs4.BeautifulSoup(response26.text, "html.parser")
root27=bs4.BeautifulSoup(response27.text, "html.parser")
root28=bs4.BeautifulSoup(response28.text, "html.parser")
root29=bs4.BeautifulSoup(response29.text, "html.parser")
root30=bs4.BeautifulSoup(response30.text, "html.parser")
root31=bs4.BeautifulSoup(response31.text, "html.parser")
root32=bs4.BeautifulSoup(response32.text, "html.parser")
root33=bs4.BeautifulSoup(response33.text, "html.parser")
root34=bs4.BeautifulSoup(response34.text, "html.parser")
root35=bs4.BeautifulSoup(response35.text, "html.parser")
root36=bs4.BeautifulSoup(response36.text, "html.parser")
root37=bs4.BeautifulSoup(response37.text, "html.parser")
root38=bs4.BeautifulSoup(response38.text, "html.parser")
root39=bs4.BeautifulSoup(response39.text, "html.parser")
root40=bs4.BeautifulSoup(response40.text, "html.parser")
root41=bs4.BeautifulSoup(response41.text, "html.parser")
root42=bs4.BeautifulSoup(response42.text, "html.parser")
root43=bs4.BeautifulSoup(response43.text, "html.parser")
root44=bs4.BeautifulSoup(response44.text, "html.parser")
root45=bs4.BeautifulSoup(response45.text, "html.parser")
root46=bs4.BeautifulSoup(response46.text, "html.parser")
root47=bs4.BeautifulSoup(response47.text, "html.parser")
root48=bs4.BeautifulSoup(response48.text, "html.parser")
root49=bs4.BeautifulSoup(response49.text, "html.parser")
root50=bs4.BeautifulSoup(response50.text, "html.parser")

E1=root1.find("span", id="Price1_lbTPrice")
E2=root2.find("span", id="Price1_lbTPrice")
E3=root3.find("span", id="Price1_lbTPrice")
E4=root4.find("span", id="Price1_lbTPrice")
E5=root5.find("span", id="Price1_lbTPrice")
E6=root6.find("span", id="Price1_lbTPrice")
E7=root7.find("span", id="Price1_lbTPrice")
E8=root8.find("span", id="Price1_lbTPrice")
E9=root9.find("span", id="Price1_lbTPrice")
E10=root10.find("span", id="Price1_lbTPrice")
E11=root11.find("span", id="Price1_lbTPrice")
E12=root12.find("span", id="Price1_lbTPrice")
E13=root13.find("span", id="Price1_lbTPrice")
E14=root14.find("span", id="Price1_lbTPrice")
E15=root15.find("span", id="Price1_lbTPrice")
E16=root16.find("span", id="Price1_lbTPrice")
E17=root17.find("span", id="Price1_lbTPrice")
E18=root18.find("span", id="Price1_lbTPrice")
E19=root19.find("span", id="Price1_lbTPrice")
E20=root20.find("span", id="Price1_lbTPrice")
E21=root21.find("span", id="Price1_lbTPrice")
E22=root22.find("span", id="Price1_lbTPrice")
E23=root23.find("span", id="Price1_lbTPrice")
E24=root24.find("span", id="Price1_lbTPrice")
E25=root25.find("span", id="Price1_lbTPrice")
E26=root26.find("span", id="Price1_lbTPrice")
E27=root27.find("span", id="Price1_lbTPrice")
E28=root28.find("span", id="Price1_lbTPrice")
E29=root29.find("span", id="Price1_lbTPrice")
E30=root30.find("span", id="Price1_lbTPrice")
E31=root31.find("span", id="Price1_lbTPrice")
E32=root32.find("span", id="Price1_lbTPrice")
E33=root33.find("span", id="Price1_lbTPrice")
E34=root34.find("span", id="Price1_lbTPrice")
E35=root35.find("span", id="Price1_lbTPrice")
E36=root36.find("span", id="Price1_lbTPrice")
E37=root37.find("span", id="Price1_lbTPrice")
E38=root38.find("span", id="Price1_lbTPrice")
E39=root39.find("span", id="Price1_lbTPrice")
E40=root40.find("span", id="Price1_lbTPrice")
E41=root41.find("span", id="Price1_lbTPrice")
E42=root42.find("span", id="Price1_lbTPrice")
E43=root43.find("span", id="Price1_lbTPrice")
E44=root44.find("span", id="Price1_lbTPrice")
E45=root45.find("span", id="Price1_lbTPrice")
E46=root46.find("span", id="Price1_lbTPrice")
E47=root47.find("span", id="Price1_lbTPrice")
E48=root48.find("span", id="Price1_lbTPrice")
E49=root49.find("span", id="Price1_lbTPrice")
E50=root50.find("span", id="Price1_lbTPrice")

#股票的股數可以當證券API的參數，因為股數必須為整數，所以四捨五入

D1=round (B1/float(E1.string),0)
D1=round (B1/float(E1.string),0)
D2=round (B2/float(E2.string),0)
D3=round (B3/float(E3.string),0)
D4=round (B4/float(E4.string),0)
D5=round (B5/float(E5.string),0)
D6=round (B6/float(E6.string),0)
D7=round (B7/float(E7.string),0)
D8=round (B8/float(E8.string),0)
D9=round (B9/float(E9.string),0)
D10=round (B10/float(E10.string),0)
D11=round (B11/float(E11.string),0)
D12=round (B12/float(E12.string),0)
D13=round (B13/float(E13.string),0)
D14=round (B14/float(E14.string),0)
D15=round (B15/float(E15.string),0)
D16=round (B16/float(E16.string),0)
D17=round (B17/float(E17.string),0)
D18=round (B18/float(E18.string),0)
D19=round (B19/float(E19.string),0)
D20=round (B20/float(E20.string),0)
D21=round (B21/float(E21.string),0)
D22=round (B22/float(E22.string),0)
D23=round (B23/float(E23.string),0)
D24=round (B24/float(E24.string),0)
D25=round (B25/float(E25.string),0)
D26=round (B26/float(E26.string),0)
D27=round (B27/float(E27.string),0)
D28=round (B28/float(E28.string),0)
D29=round (B29/float(E29.string),0)
D30=round (B30/float(E30.string),0)
D31=round (B31/float(E31.string),0)
D32=round (B32/float(E32.string),0)
D33=round (B33/float(E33.string),0)
D34=round (B34/float(E34.string),0)
D35=round (B35/float(E35.string),0)
D36=round (B36/float(E36.string),0)
D37=round (B37/float(E37.string),0)
D38=round (B38/float(E38.string),0)
D39=round (B39/float(E39.string),0)
D40=round (B40/float(E40.string),0)
D41=round (B41/float(E41.string),0)
D42=round (B42/float(E42.string),0)
D43=round (B43/float(E43.string),0)
D44=round (B44/float(E44.string),0)
D45=round (B45/float(E45.string),0)
D46=round (B46/float(E46.string),0)
D47=round (B47/float(E47.string),0)
D48=round (B48/float(E48.string),0)
D49=round (B49/float(E49.string),0)
D50=round (B50/float(E50.string),0)

#最後投資四捨五入，是為了呈現比較乾淨，計算時越接近真實值越好就沒四捨五入
print('1','股票代號',C1,F1,'股價',E1.string,'購買股數',D1,'投資金額',round(B1,0))
print('2','股票代號',C2,F2,'股價',E2.string,'購買股數',D2,'投資金額',round(B2,0))
print('3','股票代號',C3,F3,'股價',E3.string,'購買股數',D3,'投資金額',round(B3,0))
print('4','股票代號',C4,F4,'股價',E4.string,'購買股數',D4,'投資金額',round(B4,0))
print('5','股票代號',C5,F5,'股價',E5.string,'購買股數',D5,'投資金額',round(B5,0))
print('6','股票代號',C6,F6,'股價',E6.string,'購買股數',D6,'投資金額',round(B6,0))
print('7','股票代號',C7,F7,'股價',E7.string,'購買股數',D7,'投資金額',round(B7,0))
print('8','股票代號',C8,F8,'股價',E8.string,'購買股數',D8,'投資金額',round(B8,0))
print('9','股票代號',C9,F9,'股價',E9.string,'購買股數',D9,'投資金額',round(B9,0))
print('10','股票代號',C10,F10,'股價',E10.string,'購買股數',D10,'投資金額',round(B10,0))
print('11','股票代號',C11,F11,'股價',E11.string,'購買股數',D11,'投資金額',round(B11,0))
print('12','股票代號',C12,F12,'股價',E12.string,'購買股數',D12,'投資金額',round(B12,0))
print('13','股票代號',C13,F13,'股價',E13.string,'購買股數',D13,'投資金額',round(B13,0))
print('14','股票代號',C14,F14,'股價',E14.string,'購買股數',D14,'投資金額',round(B14,0))
print('15','股票代號',C15,F15,'股價',E15.string,'購買股數',D15,'投資金額',round(B15,0))
print('16','股票代號',C16,F16,'股價',E16.string,'購買股數',D16,'投資金額',round(B16,0))
print('17','股票代號',C17,F17,'股價',E17.string,'購買股數',D17,'投資金額',round(B17,0))
print('18','股票代號',C18,F18,'股價',E18.string,'購買股數',D18,'投資金額',round(B18,0))
print('19','股票代號',C19,F19,'股價',E19.string,'購買股數',D19,'投資金額',round(B19,0))
print('20','股票代號',C20,F20,'股價',E20.string,'購買股數',D20,'投資金額',round(B20,0))
print('21','股票代號',C21,F21,'股價',E21.string,'購買股數',D21,'投資金額',round(B21,0))
print('22','股票代號',C22,F22,'股價',E22.string,'購買股數',D22,'投資金額',round(B22,0))
print('23','股票代號',C23,F23,'股價',E23.string,'購買股數',D23,'投資金額',round(B23,0))
print('24','股票代號',C24,F24,'股價',E24.string,'購買股數',D24,'投資金額',round(B24,0))
print('25','股票代號',C25,F25,'股價',E25.string,'購買股數',D25,'投資金額',round(B25,0))
print('26','股票代號',C26,F26,'股價',E26.string,'購買股數',D26,'投資金額',round(B26,0))
print('27','股票代號',C27,F27,'股價',E27.string,'購買股數',D27,'投資金額',round(B27,0))
print('28','股票代號',C28,F28,'股價',E28.string,'購買股數',D28,'投資金額',round(B28,0))
print('29','股票代號',C29,F29,'股價',E29.string,'購買股數',D29,'投資金額',round(B29,0))
print('30','股票代號',C30,F30,'股價',E30.string,'購買股數',D30,'投資金額',round(B30,0))
print('31','股票代號',C31,F31,'股價',E31.string,'購買股數',D31,'投資金額',round(B31,0))
print('32','股票代號',C32,F32,'股價',E32.string,'購買股數',D32,'投資金額',round(B32,0))
print('33','股票代號',C33,F33,'股價',E33.string,'購買股數',D33,'投資金額',round(B33,0))
print('34','股票代號',C34,F34,'股價',E34.string,'購買股數',D34,'投資金額',round(B34,0))
print('35','股票代號',C35,F35,'股價',E35.string,'購買股數',D35,'投資金額',round(B35,0))
print('36','股票代號',C36,F36,'股價',E36.string,'購買股數',D36,'投資金額',round(B36,0))
print('37','股票代號',C37,F37,'股價',E37.string,'購買股數',D37,'投資金額',round(B37,0))
print('38','股票代號',C38,F38,'股價',E38.string,'購買股數',D38,'投資金額',round(B38,0))
print('39','股票代號',C39,F39,'股價',E39.string,'購買股數',D39,'投資金額',round(B39,0))
print('40','股票代號',C40,F40,'股價',E40.string,'購買股數',D40,'投資金額',round(B40,0))
print('41','股票代號',C41,F41,'股價',E41.string,'購買股數',D41,'投資金額',round(B41,0))
print('42','股票代號',C42,F42,'股價',E42.string,'購買股數',D42,'投資金額',round(B42,0))
print('43','股票代號',C43,F43,'股價',E43.string,'購買股數',D43,'投資金額',round(B43,0))
print('44','股票代號',C44,F44,'股價',E44.string,'購買股數',D44,'投資金額',round(B44,0))
print('45','股票代號',C45,F45,'股價',E45.string,'購買股數',D45,'投資金額',round(B45,0))
print('46','股票代號',C46,F46,'股價',E46.string,'購買股數',D46,'投資金額',round(B46,0))
print('47','股票代號',C47,F47,'股價',E47.string,'購買股數',D47,'投資金額',round(B47,0))
print('48','股票代號',C48,F48,'股價',E48.string,'購買股數',D48,'投資金額',round(B48,0))
print('49','股票代號',C49,F49,'股價',E49.string,'購買股數',D49,'投資金額',round(B49,0))
print('50','股票代號',C50,F50,'股價',E50.string,'購買股數',D50,'投資金額',round(B50,0))



#如果把API程式碼補上就可以一鍵下單一個投資組合，不用一個一個慢慢按慢慢輸入



標題:新手爬股價資料遇到的問題
標籤:python python入門 python3 

最近才剛接觸python不久
東學一點西學一點
學python主要想用在財金相關方面
想問的是這邊"span", class_="clr-rd"
當漲的時候這邊標籤為"span", class_="clr-rd"
當跌得時候這邊標籤為"span", class_="clr-gr"
當平盤的時候這邊標籤為"span", id="Price1_lbTPrice"
可以有辦法說爬"span", class_="clr-rd"
沒有就改爬"span", class_="clr-gr"
再沒有就爬"span", id="Price1_lbTPrice"
抱歉我犯傻了
原本一直找"span", class_="clr-rd"
"span", class_="clr-gr"
漲跌標籤一直變怎麼辦
沒想到我挑一隻平盤股票就解決了
通通改"span", id="Price1_lbTPrice"
就可以了
我太執著找最後一個標籤
剛發現這網站辦帳號
想解決問題
沒想到發文沒多久
自己解決了
import requests
import bs4
C1=2330

url = 'https://histock.tw/stock/' + str(C1)  
response = requests.get(url)
#print(response.text)

root=bs4.BeautifulSoup(response.text, "html.parser")
deal=root.find("span", class_="clr-rd")
print(float(deal.string))



標題:圖檔可以爬下來，但卻開不了
標籤:python入門 

小弟是python新手 使用visual studio code以下是我的程式碥
'''
import os,time,requests,imghdr,random
from bs4 import BeautifulSoup as bs
url='https://www.google.com/search?q=%E7%BE%8E%E5%A5%B3&rlz=1C2CAFB_enTW617TW617'
headers={'user-agent': 'Mozilla/5.0'}
photolimit=5
response=requests.get(url,headers)
sp=bs(response.content,'html.parser')
items=sp.find_all('img')
folder_name='./photo/'
if (os.path.exists(folder_name)==False):
os.mkdir(folder_name)
for index,item in enumerate(items,1):
if( index < photolimit):
html=requests.get(url,item.get('src'))
img_name=folder_name+str(index)+'.jpeg'
print(html,img_name)
with open(img_name,'wb')as file:
file.write(html.content)
file.flush()
file.close()
print('第{}張已下載......'.format(index))
time.sleep(random.uniform(1,3))
print('完成~')
'''
實在不知該如何下tag


標題:DCGAN教程範例
標籤:python gan 

https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html
至次我想實現上列網址的範例，但我遇到一個我看不懂的錯誤，請問有人知道那是甚麼意思嗎??
錯誤內容如下:
  File "C:\Users\tenpyai\Anaconda3\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)

PicklingError: Can't pickle <class 'torchvision.datasets.folder.ImageFolder'>: it's not the same object as torchvision.datasets.folder.ImageFolder

我發現在我執行下列coed時回觸發上述問題
dataset = dset.ImageFolder(root=dataroot,
                           transform=transforms.Compose([
                               transforms.Resize(image_size),
                               transforms.CenterCrop(image_size),
                               transforms.ToTensor(),
                               transforms.Normalize((0.5, 0.5, 0.5), (0.5,  0.5, 0.5)),
                           ]))
dataloader = torch.utils.data.DataLoader(dataset, batch_size=batch_size,
                                         shuffle=True, num_workers=workers)

# Decide which device we want to run on
device = torch.device("cuda:0" if (torch.cuda.is_available() and ngpu > 0) else "cpu")
real_batch = next(iter(dataloader))
plt.figure(figsize=(8,8))
plt.axis("off")
plt.title("Training Images")
plt.imshow(np.transpose(vutils.make_grid(real_batch[0].to(device)[:64], padding=2, normalize=True).cpu(),(1,2,0)))

而錯誤卻指向reduction.py內的coed(如下)
def dump(obj, file, protocol=None):
    '''Replacement for pickle.dump() using ForkingPickler.'''   
    ForkingPickler(file, protocol).dump(obj)  <<錯誤指向這



標題:想要測試POST上傳資料至公開API網站上遇到問題
標籤:requests post python3 

各位好 我目前正在嘗試使用POST上傳隨便字串到公開API伺服器 使用以下

公開API網址
此圖裡面的應該是別人也在測試隨便丟上來的值,我也是想要亂丟個值上來做測試
然後出現標頭錯誤的響應

附上官方提供的請求標頭

目前程式寫法
import requests
import json

headers = {
'Accept-Charset': 'utf-8',
'Accept': 'application/fhir+xml;q=1.0, application/fhir+json;q=1.0, application/xml+fhir;q=0.9, application/json+fhir;q=0.9',
'User-Agent': 'HAPI-FHIR/4.0.3 (FHIR Client; FHIR 4.0.0/R4; apache)',
'Accept-Encoding': 'gzip'
}

password = 'A123456789'
account = '王明'

postdata = {"username":account, "password":password}
r = requests.post(url='https://hapi.fhir.tw/fhir/Person?_include=Person%3Alink&_pretty=true', data=postdata , headers=headers)
print(r.text)
response = json.loads(r.text)
print('請求狀態',r.status_code)

懇請指教


標題:使用pip安裝後,出現 No module named mlxtend錯誤
標籤:mlxtend python3 



標題:使用 Python ping 一段 IP
標籤:python3 ping python ping 

我有一段 IP，我想通过 Python 去 ping 这些 IP，看看那些 IP 可以 ping 通。
我的 IP 段是 10.10.240.0 - 10.10.255.255
我通过 os.system("ping" + ip) 去 ping IP；
首先，我想通过 for 循环去生成 IP
for i in range(240,255)：
    for j in range(1,255):
        ip = "10.10." + i + j        

但我发现生成的第一个 IP 并不是 10.10.240.1
这个是怎么回事？
当我使用一个 txt 文本文件代替自动生成 IP，我准备了两个 txt 文件，一个是存放需要 ping 的 IP 地址，当可以 ping 通后，写入 ping.txt 文件。
import os

ping = open('ping.txt','a')

f = open("ip.txt")
for i in f:
    PingReturn = os.system("ping -c 1 " + i )
    if PingReturn == 0:
        ping.write(str(i))
    else:
        pass

但，该代码运行后，不管ping 的结果怎么样，都会被写入到 ping.txt.
然后，我用下面代码做了一个测试，发现，不管 IP 可以不可以ping 通，返回的值都 0，也就是这个 a 的值，那么我应该怎么写 if 判断？
import os

ip = "15.83.240.49"
a = os.system("ping " + ip)

print(a)



標題:捕捉網頁超時的錯誤
標籤:python python3 

我用python3的import requests中超時處理很好捕捉
resp=requests.get(url,timeout=10)
用except requests.exceptions.ReadTimeout:就能夠成功捕捉
但是另外一個import urllib.request
不知道為什麼都無法捕捉
resp = urllib.request.urlopen(url,timeout=10)
錯誤是說socket.timeout: timed out
但是用except socket.timeout:卻沒效果
變成except socket.timeout:
NameError: name 'socket' is not defined
有辦法捕捉這麻煩的錯誤嗎
雖然except:可以捕捉全部錯誤
但是我還有其他錯誤要分開處理...


標題:網頁抓圖python練習題失敗
標籤:python python 3 

Hello 各位大神
我的系統是Windows 10 x64
我用Python跑以下的程式想練習抓網頁圖片
但是彈出的結果都是
"重複"
"重複"
"重複".......
請問我哪裡有錯或是哪個路徑少了呢?
import os
import urllib.request


def imgs(url):
    try:
        res = urllib.request.urlopen(rep)
        rep = urllib.request.Request(url)
        html = res.read().decode("utf-8", 'ignore')
        # print(html)
        import re

        from bs4 import BeautifulSoup

        web = BeautifulSoup(html, features="html.parser")

        img = web.select("img[src*=/uploads/allimg/]")

        for s in img:
            img_url = "http://pic.netbi.com" + s.get("src")
            file_path = 'D:/DOWNLOAD'
            file_name = "img" + str(int(random.uniform(20, 10) * 10 ** 14))
            if not os.path.exists(file_path):
                # 建立路徑
                os.makedirs(file_path)
                # 獲得圖片字尾
            file_suffix = os.path.splitext(img_url)[1]
            print(file_suffix)
            # 拼接圖片名（包含路徑）
            filename = '{}{}{}{}'.format(file_path, os.sep, file_name, file_suffix)
            print(filename)
            # 下載圖片，並儲存到資料夾中
            urllib.request.urlretrieve(img_url, filename=filename)
    except:
        print("重複")



i = 1
try:
    while i < 1092:
        url = "http://pic.netbi.com/index"
        if i == 1:
            url += ".html"
        else:
            url += "_" + str(i) + ".html"
        imgs(url)
        i += 1
except:
    print("錯誤")

懇請大神指教


標題:請問Python 要如何讓多個浮點數相乘~
標籤:python 


請讓使用者依序輸入數字，直到輸入q停止。(題目要求)
Float=1.00
Int=1
x=input()
while x!= 'q':
    if x==int(x):
        Int=Int*int(x)
    else:
        Float=Float*float(x)
    x=input()
else:
    if round(Float,2)>Int:
        print("Float>Int")
    elif round(Float,2)<Int:
        print("Float<Int")
    else:
        print("Float=Int")

請大家幫偶看要怎麼改，謝謝!


標題:Python 風格遷移
標籤:python ai 風格遷移 

我想重現https://github.com/taipeitechmmslab/MMSLAB-TF2/blob/master/Lab9.ipynb
網址中的範例，但是在*trainsplit, validsplit, testsplit = tfds.Split.TRAIN.subsplit([80, 10, 10])*這段code遇到**AttributeError: 'Split' object has no attribute 'subsplit'**的錯誤，我一直不懂我該怎麼去排除這樣的錯誤，請問有人知道嗎??


標題:在linebot中製作carousel flex message的問題
標籤:linebot python 3 heroku 

各位前輩好，目前遇到一個問題
在linebot中的flex模板能否製作出像carousel template一樣的效果，爬了一些文（https://developers.line.biz/en/reference/messaging-api/）
似乎能夠實現，但我一直無法成功，也套用Line官方提供的工具Flex Message Simulator（https://developers.line.biz/flex-simulator/）
僅能實現一個flex message reply（如case 1）
Case 1可以work，但Case 2卻無法成功
請問是哪裡出現問題了呢？
以下是我的code
Case 1:
if event.message.text == 'test1':
reply_header = {'Content-Type': 'application/json; charset=UTF-8',
'Authorization': 'Bearer ' +  'xxx'}
reply_json = {
"replyToken": event.reply_token,
"messages": [
{
"type": "flex",
"altText": "Flex Message",
"contents": {
"type": "bubble",
"direction": "ltr",
"header": {
"type": "box",
"layout": "vertical",
"contents": [
{
"type": "text",
"text": "Header",
"align": "center"
}
]
},
"hero": {
"type": "image",
"url": "https://developers.line.me/assets/images/services/bot-designer-icon.png",
"size": "full",
"aspectRatio": "1.51:1",
"aspectMode": "fit"
},
"body": {
"type": "box",
"layout": "vertical",
"contents": [
{
"type": "text",
"text": "Body",
"align": "center"
}
]
},
"footer": {
"type": "box",
"layout": "horizontal",
"contents": [
{
"type": "button",
"action": {
"type": "uri",
"label": "Button",
"uri": "https://linecorp.com"
}
}
]
}
}
}
]
}
r = requests.post("https://api.line.me/v2/bot/message/reply", headers=reply_header, json=reply_json)
Case 2:
if event.message.text == 'test2':
reply_header = {'Content-Type': 'application/json; charset=UTF-8',
'Authorization': 'Bearer ' +  'xxx'}
reply_json = {
"replyToken": event.reply_token,
"type": "carousel",
"contents": [
{
"type": "bubble",
"body": {
"type": "box",
"layout": "vertical",
"contents": [
{
"type": "text",
"text": "First bubble"
}
]
}
},
{
"type": "bubble",
"body": {
"type": "box",
"layout": "vertical",
"contents": [
{
"type": "text",
"text": "Second bubble"
}
]
}
}
]
}
r = requests.post("https://api.line.me/v2/bot/message/reply", headers=reply_header, json=reply_json)


標題:請問一下Python 要如何印出(+數字)
標籤:python3 


x=int(input())
print("Original:","%.2f"%(x))
print("Adjusted:","%.2f"%(x0.5*10),end="")
print("+",(round(x0.5*10)-x))
這是我打的，無法印出括號


標題:補問 python OSError: [WinError 8] 記憶體資源不足，無法處理此命令。
標籤:python3 yolov2 

我在自己train yolov2的權重 先前忘了加上寫檔指令 所以可以執行
之後加上了，就出現此錯誤訊息
且有搜尋過 有人跟我一樣的問題 但下方沒解答
https://github.com/thtrieu/darkflow/issues/539
https://stackoverflow.com/questions/53377033/oserror-winerror-8-not-enough-memory-resources-are-available-to-process-this
補充個 我在這個github跟著做 這個指令
flow --model cfg/tiny-yolo.cfg --load bin/tiny-yolo.weights
也出同樣的問題
https://github.com/thtrieu/darkflow
我也去學校電腦以及學校的伺服器實驗 結果都會出現記憶體不足 求解


標題:python OSError: [WinError 8] 記憶體資源不足，無法處理此命令。
標籤:python3 yolov2 

我在自己train yolov2的權重 先前忘了加上寫檔指令 所以可以執行
之後加上了，就出現此錯誤訊息
且有搜尋過 有人跟我一樣的問題 但下方沒解答
https://github.com/thtrieu/darkflow/issues/539
https://stackoverflow.com/questions/53377033/oserror-winerror-8-not-enough-memory-resources-are-available-to-process-this


標題:ModuleNotFoundError: No module named 'tensorflow.contrib' 錯誤
標籤:python3 tensorflow 

如題:網路上說tensorflow 2.0已經沒有這個套件包 所以 我1.12 ,1.14,1.15都裝過了
一樣都有此問題 求解


標題:Python OpenCV 影像顛倒的問題
標籤:python 3 opencv影像水平翻轉 

各位前輩大哥好 小弟遇到一個問題 就是OpenCV的影像顛倒如下圖 這是一張發票

我有去爬文使用 cv2.flip(frame, 1) 水平翻轉卻依然沒有效果
我用Tk Frame 去顯示影像的

想請問是出了什麼問題?


標題:c++ v.s. python: python的內建自定義排序函數竟比c++的還快速?
標籤:c++ python 

一般來說，我們對於c++和python的印象是，
c++的程式執行速度較快，python的程式執行速度較慢，
我在leetcode上刷題百題以上，
也幾乎都是這樣的結論
但有一天，我在leetcode上刷到一題跟「排序」相關的問題
(973. K Closest Points to Origin)
同樣使用內建的排序函數，
做完之後卻發現c++比python還慢了2倍以上
補充: 附上我在leetcode上的解法
c++程式, 1476ms
class Solution {
public:
    vector<vector<int>> kClosest(vector<vector<int>>& points, int K) {
        sort(points.begin(), points.end(), [](auto p1, auto p2){
            return (p1[0]*p1[0]+p1[1]*p1[1])< (p2[0]*p2[0]+p2[1]*p2[1]);});
        return {points.begin(), points.begin()+K};
    }
};

python程式, 648ms
class Solution:
    def kClosest(self, points: List[List[int]], K: int) -> List[List[int]]:
        points.sort(key=lambda p: p[0]*p[0]+p[1]*p[1])
        return points[:K]

這個結果十分新奇，難道c++的排序函數比python慢嗎?
於是我自己寫了程式來重現這個效果，
測試的平台都是用repl.it
c++排序程式:
#include <iostream>
#include <vector>
#include <algorithm> // sort()函數
#include <cstdlib> // 亂數相關函數
#include <ctime>   // 時間相關函數

using namespace std;

int main()
{
    srand( time(NULL) );  /* 設定亂數種子 */
    vector<vector<int>> arr(100000, vector<int>(2));
    for(int i=0; i<arr.size(); i++)
    {
        arr[i][0] = rand();
        arr[i][1] = rand();
    }
    clock_t start, end; // 儲存時間用的變數
    start = clock(); // 計算開始時間
    sort(arr.begin(), arr.end(), [](auto p1, auto p2)
    {
        return (p1[0]*p1[0]+p1[1]*p1[1])< (p2[0]*p2[0]+p2[1]*p2[1]);
    });
    end = clock(); // 計算結束時間
    double cpu_time_used = ((double) (end - start)) / CLOCKS_PER_SEC; // 計算實際花費時間
    cout << "程式執行時間:" << cpu_time_used <<endl;
    return 0;
}

python的排序程式:
import time
import random

L = [[random.randint(0, 1<<31-1), random.randint(0, 1<<31-1)] for i in range(100000)]
tStart = time.time() #計時開始
L.sort(key=lambda p: p[0]*p[0]+p[1]*p[1])
tEnd = time.time() #計時結束
print(f"程式執行時間= {tEnd - tStart:.4f}秒") #四捨五入到小數點後四位

一測試之後非常驚人，
同樣在陣列裡面放十萬個小陣列，
使用自定義排序的方式，
陣列p[0]*p[0]+p[1]*p[1]的值愈小，排序上愈前面，

c++ 完成排序的時間大約1.2秒
python 完成排序的時間大約0.2秒

c++的排序速度比python慢了數倍以上，
為什麼c++在各方面似乎都比python快，
在自定義的排序上感覺慢這麼多呢?


標題:如何用python實作判斷程式是否重新啟動
標籤:python系列文章 

如何用python實作， 本身的程式是否已經啟動， 也就是不允許程式執行第二次。


標題:python 連資料庫
標籤:網頁爬蟲 python php 

我用python 寫爬蟲
有確定連上資料庫
但為甚麼資料存不進去資料庫
而且沒報錯
求解????


標題:Python  使用讀卡機 讀IC健保卡 印出來的名字是亂碼不是中文 # (Pyscard模組) #Raspberry pi 4
標籤:python3.7 pyscard模組 樹莓派 usb讀卡機 中文亂碼 

各位前輩好小弟使用Python讓讀卡機  讀健保卡 印出來的中文名字卻是亂碼

知道是Big5格式,上述已經設定了
各位前輩小弟小弟還是沒解決這問題我試圖用把字串從big5轉utf8 出現錯誤訊息

#USB讀卡機
#樹莓派
#Pyscard模組
#Python3.7


標題:求改成用字典的方法來改成可以把空位欄填對
標籤:python 



import requests
from bs4 import BeautifulSoup
import csv


url = "https://csie.asia.edu.tw/faculty/professors"

r = requests.get(url)
r.encoding = "utf8"
soup = BeautifulSoup(r.text, "lxml")


tag_table = soup.find(attrs={"class":"row contact-category"}) 

ALL_Professors = tag_table.find_all("div",class_="col-sm-12")


csvfile = "AU_CSIE_Professor_jdwang2020_5_20_BIG5_FieldName.csv"


with open(csvfile, 'w+', newline='', encoding="big5") as fp:
    writer = csv.writer(fp)
    
    Fieldnames = ["姓名","學歷","辦公室","分機","E-mail"]
    writer.writerow(Fieldnames)
    for One in ALL_Professors:
        OneRecordList = []
        print (One.find('h2','card-header').string)
        OneRecordList.append(One.find('h2','card-header').string)
        ALL_card_description = One.find_all("p",class_="card-description")
       
        for oneItem in ALL_card_description:
            OneRecordList.append(oneItem.text.split('：')[1].replace("\t","").replace(" ",""))
        print(OneRecordList)
        writer.writerow(OneRecordList)
            
       
       




請問爬蟲這個紅色箭頭指分機的要怎把它改成可以填到信箱那一格，用list會沒辦法移過去，想請問怎用字典移過去，求大神。
p.s不好意思第一次發文，已發出程式碼。


標題:爬蟲時遇到不是編碼原因的亂碼
標籤:python 

在爬取一個網站時
遇到這個亂碼
網頁原始碼的部分
<span style="display:none">亂碼</span>要爬取的部分<br />

不管怎麼改標籤
都沒辦法避開亂碼的部分
有什麼方法嗎?
import requests
from bs4 import BeautifulSoup
def ourl(url):
    res=requests.get(url)
    res.encoding='big5'
    soup=BeautifulSoup(res.text,'html.parser')
    return soup
url='http://ds-hk.net/thread-93278-1-49.html'
soup=ourl(url)
print(soup.select('.t_msgfont')[0])



標題:XGBoost 繪製ROC Curve python
標籤:xgboost roc curve python3 

sklearn的xgboost繪製ROC Curve沒問題
#XGBoost
xgb = xgb.fit(X_train,y_train)
#預測分類的概率
y_pred_xgb = xgb.predict_proba(X_test)[:, 1]
fpr_xgb, tpr_xgb, _ = roc_curve(y_test, y_pred_gbdt)
↑↑↑↑↑↑↑↑以上是用sklearn api↑↑↑↑↑↑↑↑
想請問若是使用
import xgboost as xgb
訓練是用bst = xgb.train(param, dtrain, num_round)
這種的xgboost要怎麼計算出他每個分類的概率
而不是預測出的結果
才可以繪製ROC Curve
感謝了


標題:衛服部網站爬資料 python
標籤:python3 爬蟲 

此網站下一些條件後，可取得在同頁面下的查詢結果table
https://info.fda.gov.tw/MLMS/H0001.aspx
解析過該網站取得資料，是由H0001.js產生table資料，
請問大大該如何爬這網站的資料呢?
類似下圖的查詢結果



標題:爬蟲問題 動態型網頁
標籤:#爬蟲 selenium #python 3 

我想要爬取這網頁的table，它是透過javaScript動態載入的
我使用execute_script去給日期，卻依然抓取不到動態載入的資料
有什麼其他好方式呢?
程式碼
import os
import sys
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.common.exceptions import NoSuchElementException
from selenium.webdriver.chrome.options import Options
import selenium.webdriver.support.ui as ui

def info_fubao():
 
    chrome_options = Options()
    driver = webdriver.Chrome(chrome_options=chrome_options)
    
    driver.get('http://www.f139.com/')
    #登入 個人帳密
    elem = driver.find_element_by_id("userName")
    elem.send_keys(acc)
    elem = driver.find_element_by_id("passWord")
    elem.send_keys(pwd)

    elem = driver.find_element_by_xpath('//*[@id="loginForm"]/input[6]')
    elem.click()
    
    #爬取網頁
      driver.get('http://data.f139.com/trend.do?pid=15647&start=2020-05-17&end=2020-05-27')
    #給日期
    driver.execute_script(
        "$('#begin-btn').val('2020-05-17');$('#end-btn').val('2020-05-27')"
    )
    #確定
    elem = driver.find_element_by_xpath('//*[@id="date-btn"]')
    elem.click()
    #還是沒抓到
    
    # 關閉瀏覽器視窗
    driver.quit()
  
if __name__ == '__main__':
    info_fubao()


網頁網址:http://data.f139.com/trend.do?pid=15647&start=2020-05-17&end=2020-05-27


標題:關於一維二維掃碼器  Python讀取問題 
標籤:python 3 1d2dcode 

小弟遇到一個問題 我最近在研究如何直接Python讀取1D2D掃碼器的字串
用input輸入並印出字串了
但卡到一個問題
我有設很多種按鍵模式 
這些模式分別會處理不同事情 例如拍照 影像切割等等
大家都知道 掃碼器就是非接觸式的鍵盤輸入
他可能會掃到(假如P12345678)
按鍵開關(p) 按鍵模式功能就會衝突到 他就會啟用p的function
請問各大前輩有什麼好的建議


標題:[已解決] 關於一維二維掃碼器 讀出來的字   使用Python即時讀取
標籤:一維二維掃碼器 python3 

各位前輩好又是小弟 小弟這次想做一個
使用Python即時讀取一維二維條碼掃描器的 當練習
目前已經有了一台 一維二碼掃碼器
型號: MK10-GB_USB
掃碼器目前可以讀取到身分證條碼,QRCode到電腦上的記事本.txt
我當初想法就是直接用python讀取txt最後一行
可是如果沒把記事本儲存 這樣就沒有即時性
我的情境是想 掃碼器掃到條碼 >>> Python直接印出字串
請各位前輩有什麼好的建議
##################使用Python內建Input 函式##########


標題:關於在heroku上部署flask失敗問題
標籤:flask python heroku 

相關設定 編輯器vscode python版本 3.6.8
app_run.py

Procfile
web: gunicorn app_run:app
requirements.txt

runtime.txt
python-3.6.8
流程都照heroku教學執行
部署完打開網頁顯示
Application error

查看日誌
heroku logs --tail
顯示如下
2020-05-21T08:14:18.942707+00:00 heroku[router]: at=error code=H14 desc="No web processes running" method=GET path="/" host=pythonis1234.herokuapp.com request_id=d4afe2bb-c61e-48dd-92c6-a713564227df fwd="101.137.120.95" dyno= connect= service= status=503 bytes= protocol=https
2020-05-21T08:14:19.406106+00:00 heroku[router]: at=error code=H14 desc="No web processes running" method=GET path="/favicon.ico" host=pythonis1234.herokuapp.com request_id=f1902ff3-5a77-41da-b68d-c40385383c0a fwd="101.137.120.95" dyno= connect= service= status=503 bytes= protocol=https
2020-05-21T08:14:21.573331+00:00 heroku[router]: at=error code=H14 desc="No web processes running" method=GET path="/" host=pythonis1234.herokuapp.com request_id=83a03e22-67ef-4096-a166-8fdd28b9d96f fwd="101.137.120.95" dyno= connect= service= status=503 bytes= protocol=https
2020-05-21T08:14:22.017136+00:00 heroku[router]: at=error code=H14 desc="No web processes running" method=GET path="/favicon.ico" host=pythonis1234.herokuapp.com request_id=f3446580-a729-4331-84ea-d26a3f48acd2 fwd="101.137.120.95" dyno= connect= service= status=503 bytes= protocol=https
查看No web processes running原因
heroku ps:scale web=1
顯示
Scaling dynos... !
!    Couldn't find that process type (web).
overview

中間猜想有沒有可能是python版本問題 但換各版本都是一樣
目前到這一步後 就不知道如何解決
麻煩各位先進提供解決方向思考 感謝您
謝謝以下的回覆 都有照做了 還是沒辦法 感謝您


標題:如何爬取動態加載的網頁
標籤:python 

https://www.myacg.com.tw/goods_list.php
我我想爬取這網站的商品列表
第一頁我能夠爬取
但是沒有換頁
而是一直往下滑
直到最後
查了一下
是指動態加載
教學中用POST取得json
用POST嘗試後卻無法取得
這是代碼
不知道問題在哪...
import requests
from bs4 import BeautifulSoup

def str2obj(s,s1=';',s2='='):
    li=s.split(s1)
    res={}
    for kv in li:
        li2=kv.split(s2)
        if len(li2)>1:
            res[li2[0]]=li2[1]
    return res

url='https://www.myacg.com.tw/goods_list_load_html_api.php'
headers ='''
POST /goods_list_load_html_api.php HTTP/1.1
Host: www.myacg.com.tw
Connection: keep-alive
Content-Length: 148
Accept: text/html, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: https://www.myacg.com.tw
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://www.myacg.com.tw/goods_list.php
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: _ga=GA1.3.717561162.1589798051; _gid=GA1.3.1621339013.1589798051; _fbp=fb.2.1589798050985.1976526027; PHPSESSID=tuov00pqmsl239531rc4tscp46; goods_hit[1644929]=1; r18=1; BIGipServerpoor_10.10.12.62_80=1040976394.20480.0000; TS011c35a1=01b0479bf3acdc1dfda4f6843ce29d06bde1903ce55ba6e0c8565f36bd5665dfd4945def72ff56b8aeb49edd0f4be872e1e0a31993; goods_hit[1849699]=1; TS01f565ed=01b0479bf346e280bd4430a385c00ccb5d3ab1e9f29694ec422e6ea8f6523a792b8fe1eae2009643044c11c22aeec4e46cc4ed843e; goods_hit[1884426]=1; _gat_UA-51168861-1=1; arp_scroll_position=2679
'''
headers=str2obj(headers,'\n',': ')
#print(headers)

payload = {'start_date':'',
           'end_date':'',
           'keyword':'',
           'search_ctid':'',
           'low_price':'',
           'high_price':'',
           'show':'image',
           'type':'0',
           'sort':'1',
           'seller':'',
           'gnum':'',
           'ctid':'',
           'ct18':'',
           'has_amount':'',
           'demo':'',
           'now_count':'40',
           }
res = requests.post(url,headers=headers,params = payload)
soup = BeautifulSoup(res.text,'html.parser')
print(soup)




標題:關於Python Post請求 疑問 
標籤:restapi post python 3 

小弟最近在研究如何用Python Post資料出去
但有一個地方不懂
# 具有重複鍵值的資料
my_data = (('key1', 'value1'), ('key1', 'value2'))

# 將資料加入 POST 請求中
r = requests.post('http://httpbin.org/post', data = my_data)

疑問就是'http://httpbin.org/post'
這條網頁是什麼意思,我該從哪裡取得
PS這是網路參考網路上的code


標題:Python Cv2   ,  Ocr 如何把辨識到的文字做分類
標籤:python 文字條件分類 

小弟有一個課題是要用影像辨識 印出 學生證 文字
目前可以辨識到文字並印出 二年甲班 王小明 A123456789
但需要進行分類 班級:二年甲班 姓名:王小明 學號:A123456789
目前想到分類條件 姓名=全中文 學號 = 英文+數字 班級 中文+數字
王小明       A123456789    二年甲班
印出條件調整 但不知如何下手
懇請各位前輩提點 小弟非常感謝


標題:請教如何在Tkinter GUI 中 實時顯示txt中變化的內容
標籤:tkinter tkinter gui python 3 python 

小弟搜尋也試過許多文章
發現在GUI中是不能使用sleep這個指令的
要用after 但是小弟想破頭還是想不出來要怎麼顯示在我的介面之中
於是我先將我使用python亂數生成的程式碼打包成亂數產生的執行檔exe
繼續再GUI程式碼之中打開exe之後 再去做讀取由亂數exe生成的記事本資料
但實在是沒有辦法運行 前幾天測試的時候只能顯示第一筆資料就卡住不動了
想在這邊請教有沒有高手神人可以幫幫小弟
而之前按鈕有反應 現在改到按下去都沒反應了
小弟初學者已經google到沒有辦法了 請求版上各大高手解惑...
#def ChillerPL():
def Data():
    RRT = open(r'D:\Chiller_Program\4TEST(OFF2).txt') #讀取記事本數據 冷凍頓
    SDSM = []
    for line in RRT:
        SDSM.append(line)
        print(SDSM[0])
    RRT.close()
    SDSM1 = SDSM[0]
    b = SDSM1 
    SDSM1.delete(0,"end") 
    SDSM1.insert(0, b) 
    root.after(1,Data)  
def dis(event): 
    SDSM1 = tk.Entry(SDSM1[0],font = ft3,bg="yellow") 
    SDSM1.place(x=1220,y=120)
    root.after(0,Data)        

def btnPL(event): 
    root.after(0, Data)

btnSchedule = tk.Button(root, 
                    text='執行調度',font = ft1,      # 顯示文字
                    width=10, height=3)
    #command=hit_me)     # 執行之指令
btnSchedule.bind("<Button-1>",btnPL)
btnSchedule.place(x=10,y=320)    # 位置布局



標題:如何使用 Opencv + OCR 影像辨識的文字  個別輸出TXT或XML (內容辨識到的文字,檔名辨識到的文字)
標籤:opencv python3 ocr 產生txt或其它文本 檔名是辨識到的文字 

各位前輩好
小弟剛開始入門影像辨識這塊
目前可以透過Webcam辨識英文字並且印出該英文字
然後產生txt檔,目前全部辨識的文字都集中在裡面

我想要每辨識到一組文字就產一個txt或xml並且文字印到txt或xml裡面
然後檔名是影像辨識到的文字
個別輸出TXT或XML (內容辨識到的文字,檔名辨識到的文字)
例如辨識到123 檔名123 TXT內容123

附上code
import cv2
import sys
import pyocr
from PIL import Image
import pytesseract
import pyocr.builders

tools = pyocr.get_available_tools()
tool = tools[0]

cap = cv2.VideoCapture(0)


imgs = Image.open('test01.png')
imga = imgs.convert('L')
ans = pytesseract.image_to_string(imga)
print('OCR光學辨識：',ans)

while True:  
    ret, frame = cap.read()

    Height , Width = frame.shape[:2]

    img = cv2.resize(frame,(int(Width),int(Height)))

    #OCR 讀取範圍 紅框
    cv2.rectangle(img, (100, 100), (Width-200,Height-200),(0, 0, 255), 10)

    dst = img[100:Height-200,100:Width-200]#OCR讀出識別後印出

    PIL_Image = Image.fromarray(dst)
    text = tool.image_to_string(
        PIL_Image,
        lang = 'chi_tra+eng',
        builder=pyocr.builders.TextBuilder())
    k = cv2.waitKey(1) & 0xFF
    if k == 27:

        break
    if k == 32:
        if(text !=''):
            print(text)
            with open('識別的文字.txt','a',encoding='utf-8') as fObject:
                fObject.write(text+'\n')
                 
    cv2.imshow('001',img)
    cv2.waitKey(1)

cap.release()
cv2.destroyAllWindows()


請各位前輩指教


標題:[網頁爬蟲] 標籤抓不到內容
標籤:爬蟲 python 

大家好，我是爬蟲初學者。在練習爬104人力銀行網頁內容時，遇到”定位標籤找不到內容”的問題，麻煩幫忙求解。

想要抓取的網頁url: (https://www.104.com.tw/job/6vrlf?jobsource=jolist_c_relevance)
想要抓取的網頁內容: “條件要求”裡的”工作技能”的內容

使用的程式語言: Python 3
使用套件: requests, BeautifulSoup
附上程式碼: (https://repl.it/@ellieytc/ProperFrigidZettabyte)
下圖為anaconda jupyter notebook的環境截圖:

我遇到的問題是:
print(soup)後，發現回傳的html文件內容裡，沒有”條件要求”這一大區塊的文字內容，但是回到”開發人員工具”看，有找到”條件要求”區塊裡的標籤和文字內容。
”開發人員工具”畫面如下:

於是我試著定位標籤，寫出語法:
'''jobs = soup.select('div.job-requirement > p > span > a > u')'''
但回傳的卻是空集合。

試著google和解決問題的思考過程:

難道select()裡面的標籤語法寫錯了嗎? 如果是，應該會印出attribute error。(os:不是這個問題!)
回傳空集合，意思是定位錯誤、沒抓到資料嗎? 於是我試著改成 '''jobs = soup.select(‘div’)'''，卻回傳一堆div標籤，但就是沒有”文字(text)”內容。(os:嗯，有可能是定位錯誤! 但百思不解哪裡錯了?)
“print(soup)後，發現回傳的html文件內容裡，沒有”條件要求”這一大區塊的文字內容; 但是有上一個區塊 “工作內容”的所有文字”，這點非常奇怪!於是我 Google 搜尋: 爬蟲 抓不到標籤，找到以下案例:
-動態網頁的問題。(os: 但我這個是靜態網頁，不是這個問題!)
-欲抓取的內容是用javascript寫的，所以沒有呈現在html文件。(os:什麼意思不太懂? 那為什麼我在css裡也可以找到標籤? )
-反爬蟲。(os: 可是我爬進去了呀，為什麼只有”條件要求”這個區塊找不到? 難道被隱藏了嗎?如果被隱藏，但是有找到標籤，為什麼會抓不到??)


目前呈現一個鬼打牆的狀態，只能求求版上大神幫忙了。
第一次發問，如果發問的鋪陳有需要改進的地方，也請多多指教。
謝謝


標題:TypeError: __init__() got an unexpected keyword argument 'channels'
標籤:python 人臉辨識 ai 

code來源: https://github.com/eriklindernoren/PyTorch-GAN
images來源: http://mmlab.ie.cuhk.edu.hk/projects/CelebA.html
我正在執行GitHub上的code，但在implementations/context_encoder中的context_encoder.py這個檔案我一直出現TypeError: init() got an unexpected keyword argument 'channels'的錯誤，我有事著將channels排除，但依然會出現同樣的錯誤，請問有人知道該怎麼排除這樣的錯誤讓code可以順利執行嗎?


標題:Python 爬蟲問題 語音google搜索溫度
標籤:python python3 #爬蟲 

不好意思，耍了白痴，網址的部分打錯了，更改後能順利執行了。
import requests
from bs4 import BeautifulSoup

kv={'user-agent':'Mozilla/5.0'}
r=requests.get("https://www.google.com/search?q=tucheng+weather",headers=kv)
demo=r.text
r.raise_for_status()
r.encoding=r.apparent_encoding
soup = BeautifulSoup(r.content)
temp=soup.find("div", attrs={"class": "BNeawe iBp4i AP7Wnd"}).text
print(temp)
print(demo)

#語音搜尋google
import speech_recognition #載入語音辨識套件
import tempfile#能用於生成臨時文件和目錄。https://docs.python.org/zh-tw/3/library/tempfile.html
from pygame import mixer#基於pygame模組，能用以播放MP3。https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/363871/
from gtts import gTTS#文字轉語音
import webbrowser#打開網頁
import requests #使用requests模組建立HTTP請求，從網頁取得想要的資料
from bs4 import BeautifulSoup#爬蟲用
def speak(sentence):
    mixer.init()#將mixer初始化
    with tempfile.NamedTemporaryFile(delete=True) as fp: #使用完檔案會自動將暫存檔刪除
        tts=gTTS(text=sentence, lang='zh-TW')
        tts.save("{}.mp3".format(fp.name))#存檔案
        mixer.music.load('{}.mp3'.format(fp.name))#載入mp3檔案
        mixer.music.play()#播放
def weather():
    print ("請問想搜尋什麼？")
    speak("請問想搜尋什麼")
    try:
        r = speech_recognition.Recognizer()
        with speech_recognition.Microphone() as source: #把麥克風的輸出放在source內，作為聲源
            r.adjust_for_ambient_noise(source, duration=0.5) #時間分析範圍改為0.5
            audio = r.listen(source) #使Recognizer去聽（listen）聲源，並放入audio
            query=r.recognize_google(audio, language='zh-TW')#語言設置為中文
            print("您想搜尋的是："+query)
            speak("您想搜尋的是"+query)
            wweb="http://www.google.com/search?q="+query#wweb=weather_web
            kv={'user-agent':'Mozilla/5.0'}
            res = requests.get(wweb,headers=kv)
            demo=res.text
            res.raise_for_status()
            res.encoding=res.apparent_encoding
            webbrowser.open(wweb, new=2)
            print(demo)
    except:
        print("請再說一次")
        speak("請再說一次")
        weather()



標題:python upgrade 出現的問題
標籤:python 

Preparing to unpack .../python-cryptography_1.7.1-3+deb9u2_armhf.deb ...
File "/usr/bin/pyclean", line 63
except (IOError, OSError), e:
^
SyntaxError: invalid syntax
dpkg: 警告: 子程序 原先的 pre-removal script 傳回了錯誤退出狀態 1
dpkg: 試著改用新套件的 script ...
File "/usr/bin/pyclean", line 63
except (IOError, OSError), e:
^
SyntaxError: invalid syntax
dpkg: error processing archive /var/cache/apt/archives/python-cryptography_1.7.1-3+deb9u2_armhf.deb (--unpack):
子程序 新的 pre-removal script 傳回了錯誤退出狀態 1
Traceback (most recent call last):
File "/usr/bin/pycompile", line 35, in 
from debpython.version import SUPPORTED, debsorted, vrepr, 
File "/usr/share/python/debpython/version.py", line 24, in 
from ConfigParser import SafeConfigParser
ImportError: No module named 'ConfigParser'
dpkg: error while cleaning up:
子程序 已安裝的 post-installation script 傳回了錯誤退出狀態 1
Preparing to unpack .../python-pil_4.0.0-4+deb9u1_armhf.deb ...
File "/usr/bin/pyclean", line 63
except (IOError, OSError), e:
^
SyntaxError: invalid syntax
dpkg: 警告: 子程序 原先的 pre-removal script 傳回了錯誤退出狀態 1
dpkg: 試著改用新套件的 script ...
File "/usr/bin/pyclean", line 63
except (IOError, OSError), e:
^
SyntaxError: invalid syntax
dpkg: error processing archive /var/cache/apt/archives/python-pil_4.0.0-4+deb9u1_armhf.deb (--unpack):
子程序 新的 pre-removal script 傳回了錯誤退出狀態 1
Traceback (most recent call last):
File "/usr/bin/pycompile", line 35, in 
from debpython.version import SUPPORTED, debsorted, vrepr, 
File "/usr/share/python/debpython/version.py", line 24, in 
from ConfigParser import SafeConfigParser
ImportError: No module named 'ConfigParser'
dpkg: error while cleaning up:
子程序 已安裝的 post-installation script 傳回了錯誤退出狀態 1
Preparing to unpack .../python-werkzeug_0.11.15+dfsg1-1+deb9u1_all.deb ...
File "/usr/bin/pyclean", line 63
except (IOError, OSError), e:
^
SyntaxError: invalid syntax
dpkg: 警告: 子程序 原先的 pre-removal script 傳回了錯誤退出狀態 1
dpkg: 試著改用新套件的 script ...
File "/usr/bin/pyclean", line 63
except (IOError, OSError), e:
^
SyntaxError: invalid syntax
dpkg: error processing archive /var/cache/apt/archives/python-werkzeug_0.11.15+dfsg1-1+deb9u1_all.deb (--unpack):
子程序 新的 pre-removal script 傳回了錯誤退出狀態 1
Traceback (most recent call last):
File "/usr/bin/pycompile", line 35, in 
from debpython.version import SUPPORTED, debsorted, vrepr, 
File "/usr/share/python/debpython/version.py", line 24, in 
from ConfigParser import SafeConfigParser
ImportError: No module named 'ConfigParser'
dpkg: error while cleaning up:
子程序 已安裝的 post-installation script 傳回了錯誤退出狀態 1
處理時發生錯誤：
/var/cache/apt/archives/python-cryptography_1.7.1-3+deb9u2_armhf.deb
/var/cache/apt/archives/python-pil_4.0.0-4+deb9u1_armhf.deb
/var/cache/apt/archives/python-werkzeug_0.11.15+dfsg1-1+deb9u1_all.deb
E: Sub-process /usr/bin/dpkg returned an error code (1)


標題:python 有基礎後的應用
標籤:#python 3 #初學 

知道分開的方法怎麼用 但要合在一起或自己想程式碼時常常轉不過來


標題:(已解決) Mysql如何取最後一筆資料
標籤:mysql取最後一筆資料 python3 

目前小弟在寫Python程式想要取資料庫最後一筆資料
數值會不斷一直近來 我要一直不斷抓最後一筆資料
目前只取到第一筆  請問該怎麼解決


解決方法 自行替換參數(更正)
SELECT record FROM user_record ORDER BY created_at DESC LIMIT 1
我是抓取created_at 日期數字越大向下排序取第一個record



標題:(已自行解決)目前小弟用Python Tk_Button 讀取資料庫的數字但不知道該如何即時按下按鈕就刷新數字
標籤:python tkinter mysql 即時刷新 

大家好目前小弟使用Python Tkinter設置一個按鈕
按下去他可以讀取資料庫的一個數字
但當數字更新在按一次他不會刷新依舊是舊的數字除非重啟動程式
我要如何不用重開程式直接在按一次就刷新 最新數字

UPDATE那塊是我讀別的資料庫有別的用途不影響
(variable那邊是讀取要即時更新資料庫的值)
請問def功能 裡面該添加什麼指令才能達到按下按鈕即時更新數字需求?




標題:python將路徑加入列表時會多出斜線
標籤:python 

from os import listdir
from os.path import isfile, isdir, join
import os
b=[]
mypath = "D:\long\Desktop"
for f in listdir(mypath):
  fullpath = join(mypath, f)
  if isdir(fullpath):
    b.append(fullpath)
    print(fullpath)

打印出來的路徑是正常的一個斜線
但是如果打印b
路徑就會的一個斜線會變成兩個斜線
這要如何變回一個斜線啊?


標題:(已解決)如何使用 Python Tk_Button傳值給Mysql   按一次變1  , 在按一次變0  
標籤:python3 tkinter gui python傳值給mysql mysql資料修改 button function 

各位資深前輩大哥好 目前小弟想要用Python透過按下按鈕傳值給Mysql
按下一次修改成1再按一次修改為0
Python Tkinter Button

這是目前的按鈕程式

請各位前輩大哥傳授方法!
      ------------9點41分最新情況------------




標題:(已解決)(13:57更新) Python讀取Mysql的number 要如何過濾括號和逗號 只單純留下數字
標籤:python mysql 取值 內容過濾 單純數字 

我透過Python去抓資料庫的值 印出的時候多了括號和逗號

可以下什麼語法來去除只括號.逗號留下數字

'資料庫回傳值:',sqls

例 資料庫回傳值:10
請各位前輩大哥幫幫剛入行的我


標題:(已解決)如何讓python tkinter依照讀到資料庫的數字 進行圖片切換(動畫) 第1張圖跑到10張
標籤:tkinter 資料庫 前端動畫 python 3 

各位資深前輩好 小弟目前有一個問題
我之前是讀取(get)同事架設的網頁文字字串來讓我的圖片切換(動畫)
假設網頁字串60 我只要按Button就會啟動funtion 第0張圖跑到60張
有一個動畫的效果 但是現在要使用數據庫新增修改數字字串
目前需求是我自己架設了數據庫我從裡面新增一個數值假設為10

那他就要有我上述說的效果 從0跑到10張照片 動畫效果
可以想像 油門慢慢從0吹到100 儀錶板(電子)的一格一格的上升
請問各位資深前輩我下列的程式該怎麼改?
附上程式....
 共61張圖
def changeimage():
    
    global count , label2 , textavariable , button 

    # print(count)
    # print(nodata)

    if int(nodata) > count:
        label2['image'] = animationss[count]  
        count+=1
        #count + 1
        if count >= 60:
           count + 1
           label2['image'] = animationss[count]
        window.after(100, changeimage)
    else:
        window.after(500, changeimage)
    
def uplabels():

    global nodata , count , textavariable , button ,datas
    
    datas = requests.get("http://192.168.174.1/RasperryDB3.PHP")
    variable.set((str(datas.text)))
    int(datas.text)
    nodata = datas.text
    count = 0



標題:(已解決)(0504 18:50更新問題)python抓取mysql資料庫的值
標籤:phpmysql python tk php mysql 資料管理 sql語法 

我嘗試用Python 套用sql語法去抓取Mysql裡面的'60'數值
但卻是文字印出


'資料庫當前版本:',sqls , '數值:',sql)


請問各位資深前輩是哪邊出了問題


標題:在keras model中加入自定義function
標籤:python keras tensorflow custom layer 

我想在keras model中加入自定義function，功能是將tensor中每一個element和一個數比大小，若大於此數則輸出1，若小於此數則輸出0，因此我define了一個function：
def Compare(input_tensor):
    input_shape = input_tensor.get_shape().as_list()
    y = tf.placeholder(dtype=tf.float32, shape=[None,55,55,96], name='y')

    for j in range(input_shape[1]):
        for k in range(input_shape[2]):
            for z in range(input_shape[3]):
                y = tf.map_fn(lambda x: tf.cond(tf.greater(x[j][k][z], -4.4), lambda: 1.0, lambda: 0.0),input_tensor,dtype=tf.float32)
    print(y)
    return y

其中，[55,55,96]是我的input tensor shape也是output tensor shape，-4.4是我用來比大小的門檻值，如上面所說，大於-4.4則輸出1，小於-4.4則輸出0。
接這我再將此function用keras.layers.lambda轉換成layer並放到model裡面
conv1     = Conv2D(96,(11,11),strides=4,activation=None)(input_img)
conv1     = Lambda(Compare)(conv1)

我是用jupyter notebook，沒有出現error但一直跑不完，我不知道是不是我的code寫得不好或有其他問題，希望各位邦友能給我一些建議，謝謝大家！


標題:利用Python OpenCV 輸出圖片的 orientation、albedo、depth 三項數值
標籤:opencv python albedo depth orientation 

小弟 我遇到了關於OPENCV上面的問題 小弟對OPENCV處理這方面的能力不是很了解
題目:將測試圖片輸出下列三項數值
Output orientation as a color map
Output albedo as a color map
Output depth file as a text file
懇請有能力的大大們 幫幫小弟我這個忙!!!!
圖片提供光的位置:(238,235,2360)
測試圖片:
https://ithelp.ithome.com.tw/upload/images/20200502/20126795ZxEbHOK5ne.jpg


標題:使用jupyter 寫python下SQL to SQL SEVER2019 遠端無法新增table及欄位問題
標籤:sql sever 2019 python3 pyodbc jupyter 

大家好
有個問題請教
我使用jupyter 寫python下SQL 對 SQL SEVER2019 的資料庫操作
可以遠端連線修改table裡欄位內容!!
可是遠端無法新增減table及欄位，也無產生code寫入錯誤資訊、連線或權限問題回饋。
(檢查SQL SEVER2019資料庫都沒有增減改變)
但同一使用帳號，直接在SQL SEVER Management Studio內可以新增table及增減欄位!!
如何在SQL SEVER Management Studio修改使用者權限?
(我不知道是不是權限問題，因為通常我權限不夠，系統會回傳我權限不足<我修改使用者權限後，就可以編輯欄位下的資訊，但是增減table及欄位就是沒辦法>，但是這次都沒有，code也沒問題，連線也正常)
讓遠端可以連線使用軟體寫SQL新增table及增減欄位??
感謝


標題:Python Selenium 移除list中【不可見】的連結
標籤:python selenium python selenium 

各位前輩好，我使用find_elements_by_xpath取得長度35的list，我要將不顯示的部分剃除，目前我的程式如下
from selenium import webdriver
browser = webdriver.Chrome('./chromedriver.exe')
url_random=random.randint(0,url_length-1)
browser.get('https://www.kip.com.tw/modules/news/')
k = browser.find_elements_by_xpath("//a[contains(@href,'https://www')]")
e = len(k)#一共35個
t = 0
for i in range(e):
    if not k[i].is_displayed():
        del k[i]
        t+=1
    if len(k) <= (t+1):
        break

因為我的邏輯錯誤，在第25次時，出現list index out of range錯誤
原因我知道是list被del後長度不足。
請問各位前輩，我應該如何改寫，才能將【不顯示的部分剃除】。


標題:Python Selenium 隨機點選【可見】的連結
標籤:python selenium python selenium 

目的
隨機點選【可見】的連結

我的Python程式
from selenium import webdriver
import random
browser = webdriver.Chrome('./chromedriver.exe')
e = len(browser.find_elements_by_xpath("//a[contains(@href,'https://www.')]"))
n = random.randint(0,e)
browser.find_elements_by_xpath("//a[contains(@href,'https://www.')]")[n].click()

我的n是隨機產生的，因為有些連結需要滑鼠，滑入才會顯示，有時候剛好n會取到沒顯示的超連結，就會出現下面錯誤訊息
Message: element not interactable

請問各位前輩，要如何只點擊【可見】的連結，以免報錯


標題:如何單獨分類出一份資料其中的字符串並且轉成整數
標籤:python入門 grade 成績排列 string.split 

score = open("score.txt", "r+")
lines = score.readlines()
score.close()

def rank(score):
    if score > 100:
        print("超過100分")
    elif score >= 100:
        print("A+")
    elif score >= 95:
        print("A")
    elif score >= 90:
        print("A-")
    elif score >= 85:
        print("B+")
    elif score >= 80:
        print("B")
    elif score >= 75:
        print("B-")
    elif score >= 70:
        print("C+")
    elif score >= 65:
        print("C")
    elif score >= 60:
        print("C-")
    elif score >= 1:
        print("F")
    else:
        print("X")

for line in lines:
    print(line)
    data = line.split(",")
    print(data)

    for ranking in data[2:]:
        
        
    result = (data[0], data[2], rank(score))
    print(result)
    results.append(result)

print(results)

output = open('D0586499.txt', 'w')
output.writelines(results)
output.close()


請問我要將Score.txt裡面的score單獨分離出來，並且將它用程式碼作成績及等的排列，最後再output到新的文件裡，請問有甚麼辦法可以單獨讀出成績，並且將他轉成整數，作成績排列?
目前遇到的問題是不知如何分離出需要的資料，且沒辦法排列，請求各位大神幫幫忙~~~


標題:Python Selenium 定位到的元素為多個時，如何取得數量
標籤:python selenium selenium webdriver 

目標網頁
<a href="https://www.google.com" target="_blank">GOOGLE</a>
<a href="https://www.google.com" target="_blank">GOOGLE-2</a>
<a href="https://www.google.com" target="_blank">GOOGLE-3</a>
<a href="https://www.google.com" target="_blank">GOOGLE-4</a>

我的Python程式
from selenium import webdriver
import time
browser = webdriver.Chrome('./chromedriver.exe')
browser.find_elements_by_partial_link_text('GOOGLE')[n].click()
browser.close()

因為html程式中有多個符合GOOGLE前置詞
我想要點擊第n個，由於我的n是隨機產生，以目標網頁來說n需要小於4，
請問前輩
定位到的元素為多個時，如何取得元素數量


標題:[已解決]Python Tkinter   清單按照1.2.3.4.5..... .順序讀取圖片
標籤:python tkinter 清單排序 

小弟用GIF讀取他一張一張的圖片 所以必須要從第1張開始讀取

目前只會用隨機選擇的函數有成功但他是隨機選擇
我想要他按到清單編號順序從0.1.2.3.4.5 我有嘗試過下列函式 sorted 和 sort 但沒有效果



標題:[已解決]Python Tkinter (Label image做一個會向前移動的箭頭動畫)
標籤:python tkinter label動畫 

請問各位資深前輩
我想用Python Tkinter做一個標籤影像動畫
(會移動的箭頭)(圖片是自己畫的)
想詢問可以使用哪些函式或方法!


標題:VSCODE  切換工作目錄
標籤:vscode python 

目前使用一個工作區
裡面可能有幾個資料夾
各自資料夾有要讀取的檔案
使用 python
如果 F5 啟動偵錯第 1 個資料夾檔案後
再切換到第 2 個資料夾檔案 偵錯
會出現無法讀取第 2 個資料夾檔案的錯誤問題
發生例外狀況: FileNotFoundError
[Errno 2] No such file or directory:

查工作目錄會發現還在第 1 個資料夾
import os

print(os.getcwd())

雖然 VSCODE 整個重開直接執行第 2 個資料夾的檔案是可以
想請問是否有不重開可以切換的方法
謝謝


標題:欄位依固定長度讀取
標籤:python3 python 

以長度來切欄位
Last Name欄位長度15
First Name欄位長度15
One 7
Two 7
Three 7
若是用pandas中的sep='\s+'來切的話，若姓名中有空格就可能會失敗
想請問python中是否有按字串長度來切分欄位的方法
資料如下
Last Name	   First Name     One    Two    Three  
Abdallah       Johnetta       70.3   68.3   69.2   
Ahle           Delmy          70.3   68.3   69.2   
Albares        Cammy          91.0   85.0   87.7   
Amigon         Minna          89.0   95.0   92.3   
Barfield       Stephaine      60.3   58.3   59.2   
Battle         James          90.7   86.7   88.5   
Benimadho      Elvera         60.3   58.3   59.2   
Blackwood      Kallie         70.3   68.3   69.2   
Bolognia       Brock          71.0   65.0   67.7   
Bowley         Emerson        80.0   80.0   80.0   



標題:python3 sys.arg 輸入字串截取
標籤:python3 

我想要在command line中，執行指令時輸入的參數，只截取部份，例如：
$ python3 input.py 10.0.0.1:123
我希望顯示出來的結果是：
10.0.0.1
想請問我的input.py要怎麼寫?


標題:Python Selenium click()如何不要開新視窗
標籤:python3 selenium click 

目標網頁
<a href="https://www.google.com" target="_blank">GOOGLE</a>

我的Python程式
from selenium import webdriver
import time
browser = webdriver.Chrome('C:\chromedriver.exe')
browser.find_element_by_partial_link_text('GOOGLE').click()
browser.close()

因為html程式中指定開新視窗
所以browser.close()無法將其關閉
請問前輩
Selenium是否有語法將target="_blank"改成target="_top"
或是browser.close()可以控制到新開的視窗讓其關閉


標題:在MacOS 上matplotlib問題 網路上無解
標籤:python matplotlib matplotlib.pyplot 

不囉嗦直接上圖
用plt.show出來的圖片終端機都會跳出:
2020-04-25 01:12:39.975 python[3447:72456] imkxpc_getApplicationProperty:reply: called with incorrect property value 4, bailing.
2020-04-25 01:12:39.975 python[3447:72456] Text input context does not respond to _valueForTIProperty:
只要一切換圖片視窗就會在跳出一次，希望有大老能幫忙解
環境設置:
matplotlib 3.1.1
python 3.6.8
ipython 7.6.1
在windows設置一樣環境無此問題
朋友MACOS也無此問題


標題:python List疑問（已解決）
標籤:python 

剛貼上來就看出bug了QQ


標題:python 圖片add文字
標籤:python 

from PIL import Image
from PIL import ImageFilter
from PIL import ImageEnhance
from PIL import ImageDraw , ImageFont

im = Image.open('紫卡.jpg')
draw = ImageDraw.Draw(im)
fnt = ImageFont.truetype(r'C:\Windows\Fonts\STXINGKA.TTF',20)
draw.text((217,233), u'南理',font=fnt ,fill='red' )
im.show()
im.save(初版图片.jpg)

想用py圖片新增文字,上網查了一下,並稍改他的範例,執行結果失敗
Traceback (most recent call last):
  File "main", line 11, in <module>
    fnt= ImageFont.truetype(r'C:\Windows\Fonts\STXINGKA.TTF',20)
  File "C:\ProgramData\Anaconda3\lib\site-packages\PIL\ImageFont.py", line 275, in truetype
    return FreeTypeFont(font, size, index, encoding, layout_engine)
  File "C:\ProgramData\Anaconda3\lib\site-packages\PIL\ImageFont.py", line 144, in __init__
    self.font = core.getfont(font, size, index, encoding, layout_engine=layout_engine)
OSError: cannot open resource

實在不理解,有方法解決嗎
參考網站:https://blog.csdn.net/dyyay521/article/details/102546637


標題:pyppeteer要如何用APScheduler定時執行
標籤:python pyppeteer apscheduler 

我試圖混合成我常用的這樣
import asyncio
from pyppeteer import launch
from apscheduler.schedulers.blocking import BlockingScheduler

sched = BlockingScheduler()

async def main():
    browser = await launch(headless=False, userDataDir='./userdata', args=["--start-maximized"])
    page = await browser.newPage()
    await page.goto('https://www.gamer.com.tw/')
    await page.waitFor(1000)
    soup=BeautifulSoup(await page.content(),'html.parser')
    print(soup)
    await browser.close()

asyncio.get_event_loop().run_until_complete(main())

sched.add_job(main, 'cron',hour='0-23')
sched.start()

但是不知道什麼原因
都直接失敗
也試過sched.add_job(asyncio.get_event_loop().run_until_complete(main()), 'cron',hour='0-23')
也無法定時
這要怎麼改?
換了一個思路
from apscheduler.schedulers.blocking import BlockingScheduler
import os

sched = BlockingScheduler()

def my_job():
    os.system("實驗.py")
    
sched.add_job(my_job, 'cron',hour='0-23')
sched.start()

呼叫外部程式
雖然是能用了
但是很難調整參數之類的...
希望有人能提供pyppeteer定時定時執行的方法


標題:python布林排列組合
標籤:布林 python 

想請教一下 python是否有function可以直接做布林排列組合
以達到如下圖

謝謝


標題:在python中進行基本的顏色轉換出現 in function 'cvtColor'
標籤:python 

我正在嘗試在python中進行基本的顏色轉換，但是我似乎無法擺脫以下錯誤。
import cv2

img = cv2.imread("people1.jpg")

gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
gray = cv2.medianBlur(gray, 3)
edges = cv2.adaptiveThreshold(gray, 255, cv2.ADAPIVE_THRESH_MEAN_C, cv2.THRESH_BINARY, 7, 7)

cv2.imwrite("./uotput_image.jpg", edges)

它出現下面錯誤。
error    Traceback (most recent call last)
<ipython-input-2-d3dd0507c5b7> in <module>()
      8 
      9 img = cv2.imread("people1.jpg")
---> 10 gray = cv2.cvtColor(img, cv2.COLORBGR2GRAY)
     11 gray = cv2.medianBlur(gray, 3)
     12 edges = cv2.adaptiveThreshold(gray, 255, cv2.ADAPIVETHRESHMEANC, cv2.THRESHBINARY, 7, 7)

error: OpenCV(4.1.2) /io/opencv/modules/imgproc/src/color.cpp:182: error: (-215:Assertion failed) !src.empty() in function 'cvtColor'

請問我該怎麼辦?


標題:想研究怎麼做出類似repl.it的功能（在網頁上實現terminal 的 interactive IO）
標籤:node.js python 


先謝謝各路大神點進來Orz
就某天看到時覺得很酷炫 就想說來做一個看看呢...

正文開始
如果要透過node Child_Process來執行一個.py，假如沒有'I'的部分那倒是很輕鬆就能解決了。就只是把輸出導回到網頁上而已。
但遇到有child process要請求使用者輸入的時候就gg了，研究了好一陣子，貌似主process並沒有辦法透過event區分出child是不是在等待輸入？而且預設上好像沒有預先塞input到childprocess的stdin的話，一但child process需要輸入就直接判斷終止了。
想說是不是自己的思考方向有錯誤？


標題:高手請進   反爬蟲網頁如何破解?
標籤:網路爬蟲 python post 

原本寫法是先取得SESSION_ID 之後透過POST則可登入
正常情況這時右上角會出現安全退出 有找到則為登入狀態
可能是站方反爬蟲的原因 雖然一樣有取得SESSION_ID 但卻requset 405
想問問有沒有高手可以破解的?
#登入頁面取得，動態產生的PAGE_SESSION_ID
headers = {'User-Agent':'User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36'}

s = requests.session()
URL = 'http://www.51bxg.com/web/login_register/login.aspx'
r = s.get(URL, headers=headers)
r.encoding = "utf-8"
sp = BeautifulSoup(r.text, 'lxml')

rt_msg = str(sp.find('script', type="text/javascript"))
#print(rt_msg)

m = re.search('var _PAGE_SESSION_ID=[\d]+', rt_msg, flags = 0)
pg_ssid = str(m.group()).replace("var _PAGE_SESSION_ID=","")
#print(pg_ssid)

#網站登入
	URL  = 'http://www.51bxg.com/api_web/WebCommon/PostUserLogin?'
	URL += 'z_access_mode=web_service&'
	URL += 'session_page_id=' + str(pg_ssid) + '&'
	URL += 'has_req_data=true&retry_num=0'

	arg_pload = '{"loginName":"' + acc_id + '","loginPwd":"' + acc_pwd + '","autoLogin":false}'
	
	payload = {
			"z_data": arg_pload
			}
	
	r = s.post(URL, data=payload, headers=headers)
	
	#測試是否登入成功
	URL = 'http://www.51bxg.com/'
	r = s.get(URL, headers=headers)
	r.encoding = "utf-8"
	sp = BeautifulSoup(r.text, 'html.parser')
	print(sp)
	sp.findAll('div', attrs={'class': 'dc_data_list'})

	flag = r.text.find('安全退出')



標題:Python 陣列內尋找特定範圍的最小值
標籤:python array 

請問如下面的陣列
想要挑出第 0 列中的各種值，並且在第 1 列的值最小
陣列 a
import numpy as np

a = np.array([[1,1],[1,2],[1,3],[1,4],[2,2],[2,3],[2,4],[3,1],[3,2],[3,3],[4,3],[4,4]])

[[1 1] # 1 範圍1~4 最小值1
 [1 2]
 [1 3]
 [1 4]
 [2 2]  # 2 範圍2~4 最小值2
 [2 3]
 [2 4]
 [3 1]  # 3 範圍1~3 最小值1
 [3 2]
 [3 3]
 [4 3]  # 4 範圍3~4 最小值3
 [4 4]]

預期答案是
[1,1]
[2,2]
[3,1]
[4,3]
試著用 for 和 np.min() 找，頂多找到一組
因為範圍可能不定，所以沒有辦法用 a[0:5,1] 之類的找
有無其他建議跟方向，謝謝


標題:[已解決]使用Python Tkinter 製作動畫問題 請教各位資深前輩 
標籤:#tkinter python3 前端動畫 人機介面 後端傳值到前端動畫呈現 

小弟是Python初學者 正在嘗試用Tkinter製作動畫
呈現方式是我有一個後端伺服器,他會不斷傳數值過來我的程式,假設傳來的值是60(目前上限60)
我按下按鈕取到數值,能量條就會跟著從0讀取每一張圖片(0.1.2.3.4.5.6.7.8.9.10....60)呈現一個從0到滿格的動畫效果(能量條滿)(可以把它想成吹油門儀錶板從0飆到你現在的速度)
參考圖(一)

參考圖(二) 目前寫的程式

我把圖片61張放在清單上,我目前想到用for迴圈和if判斷....寫到一半邏輯轉不過來
想請問各位前輩有哪些方法可以完成上面的問題。 小弟非常感謝!


標題:python升級版本後的第三方包要如何轉移
標籤:python 

如題
我原本的python是3.6
現在我在官網下載了3.7並且安裝好了
我要將3.6移除
但是發現3.7沒有第三方包
有辦法把3.6的第三方包轉移到3.7嗎?


標題:如何在keras的model中加入自定義function(layer)
標籤:keras python custom layer keras.backend.lambda 

各位邦友好：
我想在Convolution layer之前對tensor的每一個elements做取二進位16bits的運算，function我已經寫好了，但我把function放到model裡面會有叫我feed a value for placeholder tensor的error。

我的猜想是：在keras中是先宣告model再給model訓練資料，因為我的function沒有轉成layer，所以在宣告model的時候他就會跟我要input，我有試過用backend.lambda想將function轉成layer但會有相同的error。
希望有遇過相同問題的邦友們可以給我一些指點，謝謝！


標題:Python3  Email smtplib.SMTPAuthenticationError
標籤:python3 email 

各位大大好
最近購買了Office365基本商務版, 想要利用python 來寄信, 但是一直出現,smtplib.SMTPAuthenticationError: (535, b'5.7.3 Authentication unsuccessful error.
測試過是可以從outlook登入郵寄, 但是找了網路文章 , 改過密碼 ,目前Python
還無法郵寄,不知道大家是否有遇過類似的問題, 在此先謝過各位大大.
import smtplib

mailserver = smtplib.SMTP('smtp.office365.com', 587)
mailserver.ehlo()
mailserver.starttls()
mailserver.login('email_add', 'email_password')
mailserver.sendmail('service@y******.com','********@gmail.com', 'python email')
mailserver.quit()

Imgur


標題:python 將 list重新排序
標籤:python3 

path = "/content/drive/My Drive/mm"
os.chdir(path)
a = os.listdir(path)
['2142.jpg', '2143.jpg', '2144.jpg', '2145.jpg', '2146.jpg', '2147.jpg', '2148.jpg', '2149.jpg', '2150.jpg', '2151.jpg', '2152.jpg', '2153.jpg', '2154.jpg', '2155.jpg', '2156.jpg', '2157.jpg', '2158.jpg', '2159.jpg', '2160.jpg'...
我的list裡面有很多jpg但是我想要將他們前面的排序由小到大
sorted對這個不起作用
想請問大家有沒有甚麼辦法還可以達成這個目的


標題:python print回到上一行
標籤:python 

有點難說明
比如說
a=1
while 1:
   print(a,end='\r')
   a+=2

這樣我可以讓數字一直在第一行
但是當我要打印兩行時
就沒辦法讓數字一直待在原地
比如
a=1
b=2
while 1:
   print(a,end='\r')
   print(b,end='\r')
   a+=2
   b+=2

我想要a和b在不同行固定
然後數字一直增加
有可能做到嗎?


標題:如何讓一字串判斷是否包含python dict字典中的KEY值？
標籤:python dictionary 

dict={
'abc.123':01,
'def.456':02
}

那麼假設我有一個字串key='ccc.abc.123'，但也想要01這個value的值，
要如何設判斷式呢？
原本是使用完全符合的
if key in list(dict.keys())



標題:Pandas內容篩選取代
標籤:pandas python3 

import pandas as pd
df = pd.DataFrame({
                    'A': ['one', 'two', 'three','four'],
                    'B': ['TCP/56617', 'TCP/56575', 'http', 'https']
                })

想請問各位大大
我想要將'TCP/56617'、'TCP/56575'全部用'TCP'這個字串取代
該怎麼做呢。
查了半天只會字串一對一的取代，麻煩各位了


標題:tensorflow CNN  雙輸入卷積神經網路，全連接層共享
標籤:tensorflow cnn python flatten 

各位先進目前在研究上遇到問題個問題想請各位先進幫我打解答 感謝!
目前想做一個雙輸入的卷積神經網路，各別輸入不同的影像卷積然後共用全連接層。
                              .
                              .
                              .
    with tf.variable_scope('s_pooling3_lrn') as scope:
        pool3 = max_pool_2x2(s_conv3, 's_pooling3')  # 得到32*32*32
        s_norm3 = tf.nn.lrn(pool3, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='s_norm3')
        
                              .
                              .
                              .
    with tf.variable_scope('T_pooling3_lrn') as scope:
        pool3 = max_pool_2x2(T_conv3, 'T_pooling3')  # 得到32*32*32
        T_norm3 = tf.nn.lrn(pool3, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='T_norm3')
        
     local4 = s_norm3 + T_norm3   
     
      with tf.variable_scope('local4') as scope: 
        reshape = tf.reshape(local4, shape=[batch_size, -1]) 
        dim = reshape.get_shape()[1].value
        w_fc1 = tf.Variable(weight_variable([dim, 128], 0.005),  name='weights', dtype=tf.float32)
        b_fc1 = tf.Variable(bias_variable([128]), name='biases', dtype=tf.float32)
        h_fc1 = tf.nn.relu(tf.matmul(reshape, w_fc1) + b_fc1, name=scope.name)   

程式裡 **local4 = s_norm3 + T_norm3 **
這段是目前將兩邊卷積後的結果做結合讓兩邊filter合併再到全連接層展開
但我現在想要做是否可以讓兩邊輸入做到pooling後，一邊先進去做全連接再讓另一邊的結果作全連接。不要兩邊合併再去全連接! 達到可以共用全連接層的效果。
請問我該加上判斷還是該怎樣改才能達到我想要的結果 還請各位先進幫忙解答


標題:(初學者) 請問 Tkinter 如何製作簡單GUI介面  GET API JSON資料  
標籤:python tkinter gui 初學者求助 get api json資料 串gui 

小弟想用Python Tkinter 做一個簡易的 獲取API JSON格式資料
但因為是初學者 目前只用好

如果能附上code 讓我參考一下非常感謝..
畫面需求簡易
一個文字輸入方塊 = 輸入API網址
按鈕 = 請求獲取
呈現資料方塊 <<想請問這個要用哪個物件瀏覽API資料


標題:python 檔案路徑處理
標籤:python 檔案寫入 python新手 

我有個資料夾,裡面放的是影片拆成的圖片,名字是00001.jpg,00002.jpg...想將之一一上傳到網站處理
我寫了個迴圈,變數每次增加1,且自動補成類零成五位數(和圖片命名規則相同)但不知道要如何將之寫入檔案路徑,這是程式碼:
r = requests.post(
		"https://aaaaaaaaaaaaaaa",
		files={
			'imag``e': open('C:\\Users\\user\\Desktop\\in\\%d.jpg','rb'),
			
		},
		headers={'key': '1f5eb62e-44fd-8c91-e352b2d3d8cb'}
	)

這個'image': open('C:\Users\user\Desktop\in\%d.jpg','rb'),的%djpg(我寫法有誤)我想帶入變數,不知該如何是好?


標題:(新手) 如何使用C++或python建立GUI並且Get API網頁資料
標籤:c++ python gui get api qt creator 

大家好小弟最近在研究如何用C++/C 或python建立圖形介面並且可以功能可以Get到網路上的API資料,想請問有人知道該如何下手嗎?
目前打算用QT Creator 或 Python Tkinter 建立GUI


標題:在載入Tensorflow的dataset時出現NonMatchingChecksumError
標籤:tensorflow python dataset 

今天試著做書本範例時
試著要載入tf的dataset的時候一直出現了
tensorflow_datasets.core.download.download_manager.NonMatchingChecksumError: Artifact https://drive.google.com/uc?export=download&id=0B7EVK8r0v71pZjFTYXZWM3FlRnM, downloaded to C:\Users\KAN\tensorflow_datasets\downloads\ucexport_download_id_0B7EVK8r0v71pZjFTYXZWM3FlDDaXUAQO8EGH_a7VqGNLRtW52mva1LzDrb-V723OQN8.tmp.ba57fa510d5d4b0f807c6890efa6d3f8\uc, has wrong checksum.


後來上網查了一下 就加入了
import requests.packages.urllib3
requests.packages.urllib3.disable_warnings()


也是無法解決，請問是我哪裡出了問題嗎?
以下是載入資料集的code，這是我修改過後的樣子
# Load datasets and setting
AUTOTUNE = tf.data.experimental.AUTOTUNE  # 自動調整模式
combine_split = tfds.Split.TRAIN + tfds.Split.VALIDATION + tfds.Split.TEST
train_data, info = tfds.load("celeb_a",split=tfds.Split.TRAIN,with_info=True)
valid_data = tfds.load("celeb_a",split=tfds.Split.TRAIN.VALIDATION)
test_data=tfds.load("celeb_a",split=tfds.Split.TEST)

train_data = train_data.shuffle(1000)
train_data = train_data.map(parse_fn, num_parallel_calls=AUTOTUNE)
train_data = train_data.batch(batch_size, drop_remainder=True)      # 如果最後一批資料小於batch_size，則捨棄該批資料
train_data = train_data.prefetch(buffer_size=AUTOTUNE)


因為在修改前code
# Load datasets and setting
AUTOTUNE = tf.data.experimental.AUTOTUNE  # 自動調整模式
combine_split = tfds.Split.TRAIN + tfds.Split.VALIDATION + tfds.Split.TEST
train_data, info = tfds.load(dataset, split=combine_split, data_dir='/home/share/dataset/tensorflow-datasets', with_info=True)
train_data = train_data.shuffle(1000)
train_data = train_data.map(parse_fn, num_parallel_calls=AUTOTUNE)
train_data = train_data.batch(batch_size, drop_remainder=True)      # 如果最後一批資料小於batch_size，則捨棄該批資料
train_data = train_data.prefetch(buffer_size=AUTOTUNE)


一直出現錯誤
ensorflow.python.framework.errors_impl.NotFoundError: Failed to create a directory: /home/share/dataset/tensorflow-datasets\downloads; No such file or directory
Downloading and preparing dataset celeb_a/2.0.0 (download: 1.38 GiB, generated: Unknown size, total: 1.38 GiB) to /home/share/dataset/tensorflow-datasets\celeb_a\2.0.0...

想請問大大們我該怎麼解決此問題呢


標題:python 提取str中特定字之後文字 
標籤:python list python萌新 str 短問題,複雜解 

我有程式碼,會產生一字串:{'id'='XX','ad'='xxxx'}分明就很像list嘛...
今天我想提取ad的值xxxx,在程式碼盡量最少的情況(跑比較快)該如何是好...
或許換個話說,我想'提取字串特定字元後字元'


標題:pymysql  寫入新聞數據進 MySQL DB ，HeidiSQL 顯示有資料行數，但卻query不到數據
標籤:mysql python3 pymysql 資料庫 

各位大大好
如標題，小弟用python 爬取了一些新聞數據，想把他們存進資料庫，但遇到很奇怪的bug，一時不知如何解決，我用 pymysql 下了
REPLACE INTO my_table
VALUES (data);

執行後看似數據有寫入成功，用pymysql立刻再下
SELECT *
FROM _table;

也可以順利撈到數據
但是我用 DB圖形介面 HeidiSQL 去看，他的資料表總攬可以看到如下圖有顯示資料行數：

但是當我點進資料表時，卻Query不出任何資料，在介面中寫 SELECT * 語法也是，當我做完這件事情，在回去用python下剛剛的語法時，這時資料回吐就變成 None。
我完全不知道原因出在哪 @@
請問這可能會時甚麼原因造成的呢？
這邊也附上我的 table data type 的設定，不知道與這個有沒有關係。
謝謝各位大大



標題:Mask_RCNN 使用tensorflow2.0-GPU出現AttributeError
標籤:tensorflow anaconda python cnn rcnn 

在安裝Anaconda中使用以下基礎環境
python                    3.6.9
cython                    0.29.16
pip                       20.0.2
opencv-python             4.2.0.32
python                    3.6.9
tensorboard               2.0.2
tensorflow                2.0.0
tensorflow-estimator      2.0.1
tensorflow-gpu            2.0.0
tensorflow-gpu-estimator  2.0.0
shapely                   1.6.4.post1
keras                     2.3.1
keras-applications        1.0.8
keras-preprocessing       1.1.0
在最後輸出圖像時產生
AttributeError: module 'tensorflow' has no attribute 'log'的錯誤
完整Error如下，大多數網上出現此錯誤的解決文章有一半都直接建議回1.4版本，但須重裝許多東西，想上來問問各位有沒有出現一樣或類似的經驗是如何解決的呢?



標題:python迴圈中的url如何重試
標籤:python 

for i in listurl:
try:
url=i
html = requests.get(url,timeout=10)
print(html.text)
except:
print('超時')
這樣雖然能夠跳過錯誤繼續執行
但是被跳過的url就沒取得資料了
我要如何取得被跳過的url的資料呢


標題:LSTM分類問題
標籤:lstm deep learning python 

資料筆數約500筆
時間序列的資料，分成0，1兩類
想透過LSTM分類如下，
想請問為什麼最終訓練出的模型都把資料分為1類
但0完全沒預測出任何一筆，想請問怎麼優化
麻煩了
n_steps = 3
n_features = 10
model = Sequential()

model.add(Embedding(input_dim=20, output_dim=128))
model.add(LSTM(256, activation='relu', input_shape=(n_steps, n_features)))
model.add(Dense(128,activation="relu",name="FC2"))
model.add(Dense(64,activation="relu",name="FC3"))
model.add(Dense(32,activation="relu",name="FC4"))
model.add(Dense(1, activation='sigmoid'))
model.summary()

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding_1 (Embedding)      (None, None, 128)         2560      
_________________________________________________________________
lstm_1 (LSTM)                (None, 256)               394240    
_________________________________________________________________
FC2 (Dense)                  (None, 128)               32896     
_________________________________________________________________
FC3 (Dense)                  (None, 64)                8256      
_________________________________________________________________
FC4 (Dense)                  (None, 32)                2080      
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 33        
=================================================================
Total params: 440,065
Trainable params: 440,065
Non-trainable params: 0

model.compile(loss='binary_crossentropy',
              optimizer='adam',
              metrics=['accuracy',f1_m,precision_m, recall_m])
hist = model.fit(X_train, y_train, batch_size=16, epochs=20, verbose=0)

![]
              precision    recall  f1-score   support

           0       0.00      0.00      0.00        17
           1       0.69      1.00      0.82        38

    accuracy                           0.69        55
   macro avg       0.35      0.50      0.41        55
weighted avg       0.48      0.69      0.56        55



標題:python有辦法編輯新版協作平台嗎
標籤:python 協作平台 

最近想讓一群使用者編輯新版Google協作平台的特定頁面
但又不想開共用
去到Google sites API的網站看到


A rebuilt version of Sites was launched on November 22, 2016. The Sites API cannot access or modify Sites made with this version, but can still access classic Sites.


想詢問python是否能夠編輯新版協作平台嗎


標題:python入門題
標籤:python入門 初學者 拜託 

如果有人願意幫忙的話，我很感謝。我是初學者，
搞不太懂整個程式的結構和語法，最近在自學python，
如果有空的話，可以幫我個忙嗎下面這題
以if else if的結構，寫一個程式依照收入多寡繳納不同稅額的稅額。
54萬元以下免稅，大於54萬至121萬稅率12%,大於121萬至242萬稅率20%,
大於242萬至453萬稅率30%,大於453萬至1031萬稅率40%,
大於1031萬以上稅率45%。


標題:請問使用python該如何將Column的資料加總帶給index
標籤:python python3 

情況是這個樣子的因為我需要把城市名稱當成X軸,確診病例數當成Y軸利用Pandas輸出成直列圖,然後我有一個list內的數據是index是各個縣市的名稱,Column內的數據是本次這個縣市有幾個個案格式如下:

所以想請問大家如果想讓index內的資料彙總成只會出現一次,然後Column的數據加總帶總數帶給該縣市的話應該要怎麼做呢?
謝謝大家


標題:python 如何輸出每個observation的標準差
標籤:python python3 資料分析 linearregression 

想請教各位python高手，做多元線性回歸的時候，應該如何取得每個observation的標準差？
拜託大家救救可能需要壓一千次SPSS的我ˊˋ
各大網站的標準差都是針對「某一控制(自)變數」做標準差，換言之，我無法取得每個observation的標準差，以至於無法刪除最大的outlier，相當困擾，拜託救救我QAQQQ
我看了許多類似的網站https://stackoverflow.com/questions/31523921/print-std-err-value-from-statsmodels-ols-results，但都沒有就各別的標準差@@
這是目前寫的語法
import pandas as pd
import numpy as np
import statsmodels.api as sm
import matplotlib.pyplot as plt
from sklearn import preprocessing, linear_model

df = pd.read_excel(r"data.xlsx",header = [0,1])
print(df.head()) #check data

# 自變量
X = df[['w1','w2','w3','w4']]
# 因變量
y = df['z'].values

X2 = sm.add_constant(X) 
res = sm.OLS(y, X2) 
res = res.fit() 
print(res.summary())

#另一種函式庫的線性回歸(不知道哪個比較方便取得標準差)
regr=linear_model.LinearRegression()
regr.fit(X, y)

如果data大概長這樣，「因變數」為z，「自變數」為w1、w2、w3、w4。



company name
w1
w2
w3
w4




data0
99
13
1
26


data1
82
3
2
13


data2
80
42
8
91


data3
10
50
15
34


data4
20
12
71
17



我希望可以各別print出data1、data2、data3、data4的標準差！
還請各位幫幫忙，非常感謝，萬分感謝QAQQQQ
我願意寫一些關於統計軟體與python的相關應用回饋給這個版~
懇請大家救救可能需要壓SPSS一千次的我阿阿，拜託大家


標題:Python  服裝
標籤:python 

假設上衣300元、褲子350元與背心400元，使用者可以自行輸入三種服裝的數量，請設計一個程式計算訂購服裝的總金額。


標題:Python 存取串列中元素
標籤:python 

請寫一個程式允許使用者輸入一句英文句子，去除前後的空白或句點，使用split
分割英文句子成為串列，將串列反轉顯示出來。


標題:python 多元線性回歸 刪除outlier 怎麼做
標籤:python 資料分析 spss python3 回歸分析 

最近在做多元線性回歸分析，原先使用的是SPSS來做，但因為上頭指示刪除outlier的方式是「每跑完一次迴歸分析，刪除一個標準差最大的data，再做一次回歸分析，然後在刪除下一個標準差最大的data」，但這樣永遠都做不完阿...，拜託大家，我真的需要各位高手的幫助阿。
SPSS的作法是這樣做

點選回歸分析


加入因變數、自變數


設定三個標準差的output出來


結果長這樣，然後我就會去選最大標準殘差的data，回到表格去刪除他，然後再從第一步again again and again...



因為我比較熟悉python，所以上網找python的相關辦法，但他都有另外設定訓練的方式，來計算回歸，這樣數值貌似會不一樣吧@@但最重要的是我需要一個一個的標準差，才可以慢慢刪除outlier，但我找到的好像都是直接輸出MSE...，希望各位高手可以幫幫我。我有查到類似的網站 https://www.itread01.com/content/1550422451.html
如果data大概長這樣，「因變數」為成績，「自變數」為家庭人數、兄弟姊妹人數、歲數。



人名
生日年分
家庭人數
兄弟姊妹人數
歲數
成績




大華
1999
3
1
21
56


小白
2000
8
3
20
13


小明
2002
8
4
18
91


阿鼻
2017
10
5
2
34


琪琪
1949
18
12
71
3



我打的程式碼只讀了excel..，因為後續開始設x跟y就不太知道自變數跟因變數要設在哪裡，去讀了別人的說明，也不太知道形變量跟標籤值有等於這些嗎，萬分懇求各位幫幫我ˊˋ
import pandas as pd
import numpy as np
import statsmodels.api as sm
import matplotlib.pyplot as plt
data = pd.read_excel("data.header = [0,1])

拜託大家了!!真的非常感謝!感動得痛哭流涕阿QAQQ
拜託拜託大家了


標題:如何寫一個BAT檔每天自動複製同一個資料夾內100個檔案一次只複製2個直到完成
標籤:bat批次檔 robocopy xcopy 自動化 python 

請教各位前輩
如果我有一個資料裡面有100個jpg圖檔，我想要寫一個BAT可以每天可以自動從A資料夾複製到B資料夾，每天按檔名排序只複製其中2個檔案直到完全複製完成
請問這xcopy或robocopy BAT可以完成嗎？
還是有其它程式更容易達到這樣的目的？
謝謝大家


標題:Python 字串處理
標籤:python系列文章 

將輸入的英文句子依序進行以下幾個步驟的處理，並將每個步驟處理的結果輸出
到螢幕上。
(1)將輸入的字串使用空白字元進行字串切割，請找出句子中所有單字，顯示所
有單字出來。
(2)將(1)
的結果以空白字元還原回原來的字串。
(3)將輸入的字串的所有單字的字首大寫。


標題:透過LOG統計在線人數
標籤:python pandas 

想統計各小時的在線人數，
LOG如以下的表，以第一筆為例
登入時間2020-03-03 23:01:00，登出時間2020-03-03 23:40:02
所以統計時，03-03 23時 他會被歸類為在線人數，
03-04 0時，則不會被計算到，
想請問版上各位大大，是否有比較好的算法可以計算出每天每個小時
的在線人數，謝謝各位了。
start_time,end_time,login_hour,logout_hour
2020-03-03 23:01:00,2020-03-03 23:40:02,23,0
2020-03-04 00:01:02,2020-03-04 01:01:02,0,2
2020-03-04 00:02:41,2020-03-04 01:02:41,0,2
2020-03-04 00:03:09,2020-03-04 01:03:09,0,2
2020-03-04 00:03:39,2020-03-04 00:05:15,0,1
2020-03-04 00:04:47,2020-03-04 01:04:47,1,2
2020-03-04 01:05:13,2020-03-04 01:10:13,1,2
2020-03-04 02:00:15,2020-03-04 02:05:15,2,3
2020-03-04 02:05:47,2020-03-04 03:33:25,2,4


標題:如何讓voice kit與自己寫的網頁互相傳值
標籤:#node.js raspberry pi voice kit 傳值 python 

小弟最近由於專題需要，需要利用aiy voice kit(使用樹莓派3B+)聽取人聲並轉成字串然後去搜索檔案。
將人聲轉字串這部分是寫在樹莓派裡的python檔，搜索檔案則是在別處另外寫的網頁功能。
流程是: 網頁按下按鈕呼叫樹莓派裡的python檔開始執行->python開始聽->python將聽到的字串回傳給網頁->網頁進行搜尋
但我對於網頁與樹莓派之間的溝通有點沒頭緒。原本是想說資料庫設一個布林值false，網頁按下按鈕改true，python檔持續監聽是否為true，一旦為true便執行後改false。
聽朋友說這不是個很好的做法，想請教大大們有沒有更好的方法。


標題:OPENCV影像疊加越來越淡
標籤:opencv python 影像處理 

今天在實作影像疊加的時候
先是提取了每個BIT-PLANE

然後想把它疊加起來回原圖的時候不知道為甚麼越來淡

本人是新手有點摸不著頭緒
也試著用過addWeighted也沒用
麻煩大大們解惑
補充:
我是想將bit plane8為基礎逐一疊加回去~
我怕我敘述不太完整
謝謝!!
下面是程式碼
更新:
如果用bitwise_and會呈現

i=7
while(i-1>=0):
    r[:,:,7] = cv2.bitwise_and(r[:,:,7],r[:,:,i-1])
    cv2.imshow(str(i), r[:,:,7])
    showImage(str(i), r[:,:,7])
    i=i-1



cv2.waitKey()
cv2.destroyAllWindows()

import cv2
import numpy as np


def showImage(title, img):
    ishow = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) # for plt.imshow()
    plt.imshow(ishow)
    plt.axis('off')
    plt.title(title)
    plt.show()
    
#讀取灰階影像
lena = cv2.imread("lena.png", 0)
cv2.imshow("lena", lena)
showImage("lena", lena)

#取出影像 rows and cols
r, c = lena.shape

#產生 8 個 bit-plane 對應的 mask
x = np.zeros((r,c,8), dtype = np.uint8)
for i in range(8):
    x[:,:,i] = 2**i

#建立 8 個空白的 bit-planes
r = np.zeros((r,c,8), dtype = np.uint8)

#建立相對應的 bit-planes
for i in range(8):
    r[:,:,i] = cv2.bitwise_and(lena, x[:,:,i])
    mask = r[:,:,i] > 0
    r[mask] = 255
    cv2.imshow(str(i), r[:,:,i])
    showImage(str(i), r[:,:,i])

i=7
while(i-1>=0):
    r[:,:,7] = cv2.add(r[:,:,7],r[:,:,i-1])
    cv2.imshow(str(i), r[:,:,7])
    showImage(str(i), r[:,:,7])
    i=i-1

cv2.waitKey()
cv2.destroyAllWindows()




標題:寫入文字至網路上檔案
標籤:雲端備份 python3 

想不需要透過資料庫將文字寫入至網路上的雲端硬碟檔案中
如dropbox、google drive...等
有沒有我只要把key之類的東西寫在程式內就不需要透過驗證
可以把文字寫入呢


標題:windows AD TLS 設定。
標籤:windows ad windows server python 

今天在寫一支程式，想要連進AD改密碼，但是一開始怎樣都連接不上，後來查到windows AD要改密碼必須透過ldaps連線，於是照著門神大的這篇一步一步安裝 Windows 2012 AD LDAPs 安裝設定憑證 CA SSL TLS 必成功設定AD，用ldp.exe去測試是連線成功的。
但是遇到用程式連的時候，怎麼連都不成功。
一開始的設定如下：
l.set_option(ldap.OPT_REFERRALS, 0)
l.set_option(ldap.OPT_PROTOCOL_VERSION, 3)
l.set_option(ldap.OPT_X_TLS_CACERTFILE, os.getcwd()+"/ad.cer")
l.set_option(ldap.OPT_X_TLS,ldap.OPT_X_TLS_DEMAND)
l.set_option(ldap.OPT_X_TLS_DEMAND, True)
l.set_option(ldap.OPT_DEBUG_LEVEL, 255)

在bind的時候都直接跳憑證錯誤。
後來改用：
ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER)

反而成功了...甚至不用cert。
想請問2件事：
1.這樣DC到底有沒有用TLS？還是要另外設定？有什麼參考資料？
2.在程式中所使用的cert是從DC匯出的憑證嗎？

自問自答一下：
原因是因為我用自簽證書。
根據下面這篇參考資料：
https://stackoverflow.com/questions/3495739/ldap-connection-problem-with-self-signed-cert
ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_ALLOW)

加入這段才可以用證書登入並修改
這段是告訴openssl不要去外部驗證證書。
ldap.set_option(ldap.OPT_X_TLS_REQUIRE_CERT, ldap.OPT_X_TLS_NEVER)

這段是忽略證書檢查，基本上就沒有安全性了。


標題:Python
標籤:python 

電腦為二進位系統，最小儲存單位為位元(bit)，8個位元變成1個位元組(byte)， byte組成1KB， byte組成1MB， byte組成1GB， byte組成1TB， byte組成1PB， byte組成1EB， byte組成1ZB， byte組成1YB，請寫出一個程式計算  的十進位數值。


標題:[解决]在Cloud9  Python  上的sqlalchemy
標籤:python cloud9 sqlalchemy 

我正在跟隨 https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world
我在Pychram 上可以直接打開 app.db ,但在Cloud9  怎可以查詢app.db?


標題:非本科超級新手自學程式詢問 !
標籤:#自學 #新手疑問 #轉職 #非本科 #python 

大家好，小女子剛加入這個網站，這是我第一次發問(緊張)，請多包涵！
先來自我介紹，大學會計系畢業，會研所輟學(發現課堂學不到東西，去資管系選修發現更有興趣，不想浪費$就離開了)，大學應徵上四大會計師事務所，但沒有去(你可能覺得我瘋了，但我伴侶就在四大裡，大學四年聽聞學長姐故事加上每天看著另一半，讓我認知到自己不適合那裡)，目前北漂做著一份28K助理，過著勉強繳得起房租和學貸的生活(對，比事務所底薪還低...)
想學程式並不是突然的事情，只是終於"下定決心"以工程師為目標是最近的事情，開始工作後，身邊的工程師過著高薪準時下班的生活讓我很羨慕（我也想當那個每天最早走笑著說掰掰的人！），但最讓我羨慕的是能夠"擁有一份專長"、"永不停止學習"和"創作"的這份工作。
有爬文看了很多自學的心得文，但大部分都有搭配補習，由於目前條件不允許我辭職去補習(好想去資策會啊Q.Q)只能利用下班和假日自學，所以想來版上詢問各位大大的建議。
［個人能力］
程式背景: 無，也沒接觸過計概、演算法和資料結構，只碰過scratch和codecombat的幼幼班新手
英文程度: 多益830分
邏輯思考: 微積分和統計學尚可(?)
目標語言: Python
目標工作: 想以AI人工智慧、大數據分析為主
想請問：
1.【推薦的學習順序】
是建議直接開始學語法，再去了解計概、演算法和資料結構，還是會建議倒過來?還是一起學?
2.【推薦的教材】
書籍有看到網上推《Python最強入門邁向頂尖高手之路》和《深入淺出Python》，請問有看過的心得嗎? 或是有其他推薦的書籍/免費線上教材嗎? (想先以中文為主英文為輔)
3.【工作需求】
聽說如果要順利應徵到工作，至少要有過完成專案的經驗，那能夠接案的能力具體的標準是什麼? 我需到達到什麼程度? 有建議的渠道可以找到相關兼職嗎?
4.【心態建立】
我知道工程師行業也很競爭，有的還過著爆肝生活，我雖然對程式有興趣，但說白了也是為了薪水，和它的發展性及工作環境，不排斥加班，加班有拿到對應的報酬我可以接受(現在加班都沒$拿Q.Q) 不想給自己後路，四大資格都放棄了，想要早日找到工作，給自己一年時間拚拚看，知道自己也是程式新手中的超級新手，問的問題也比較淺，如果心態上有哪邊需要調整的，再拜託各位大大給我指教了！感謝您的閱讀！


標題:tensorflow test model 語法問題
標籤:tensorflow python cnn 

近期在學習雙流卷積神經網，在利用訓練完的model測試圖片的準確率與類別時遇到語法上的錯誤，麻煩各位給予幫助
import os
import numpy as np
from PIL import Image
import tensorflow as tf
import matplotlib.pyplot as plt
#from Model import inference
import Model

n_classes = 2

img_dir = './Input_data/test/'
log_dir = './Input_data/model/'   #./Input_data/model/
lists = ['Face', 'NotFace', 'face1', 'face2', 'notface1', 'notface2']


def get_one_image(img_dir):
    imgs = os.listdir(img_dir)
    img_num = len(imgs)
    # print(imgs, img_num)
    idn = np.random.randint(0, img_num)
    image = imgs[idn]
    image_dir = img_dir + image
    print(image_dir)
    image = Image.open(image_dir)
    plt.imshow(image)
    plt.show()
    image = image.resize([128, 128])
    image_arr = np.array(image)
    return image_arr


def test(image_arr):
    
    with tf.Graph().as_default():
        
        image = tf.cast(image_arr, tf.float32)
        # print('1', np.array(image).shape)
        image = tf.image.per_image_standardization(image)
        # print('2', np.array(image).shape)
        image = tf.reshape(image, [1, 128, 128, 3])
        # print(image.shape)
       ** logit = Model.inference(image, 1, n_classes) **
        logits = tf.nn.softmax(logit)                
        x = tf.placeholder(tf.float32, shape=[128, 128, 3])
        saver = tf.train.Saver()
        sess = tf.Session()
        sess.run(tf.global_variables_initializer())  #加
        ckpt = tf.train.get_checkpoint_state(log_dir)
        if ckpt and ckpt.model_checkpoint_path:
            # print(ckpt.model_checkpoint_path)
            saver.restore(sess, ckpt.model_checkpoint_path)
            # 调用saver.restore()函数，加载训练好的网络模型
            print('Loading success')
        # prediction = sess.run(logits, feed_dict={x: image_arr})
        prediction = sess.run(logits, feed_dict={x: image_arr})
        max_index = np.argmax(prediction)
        print('預測的標籤：', max_index, lists[max_index])
        print('預測的結果：', prediction)


if __name__ == '__main__':
    img = get_one_image(img_dir)  
    test(img)


Model 程式如下
def weight_variable(shape, n):
    initial = tf.truncated_normal(shape, stddev=n, dtype=tf.float32)
    return initial

def bias_variable(shape):
    initial = tf.constant(0.1, shape=shape, dtype=tf.float32)
    return initial

def conv2d(x, W):
    return tf.nn.conv2d(x, W, strides=[1, 1, 1, 1], padding='SAME')

def max_pool_2x2(x, name):
    return tf.nn.max_pool(x, ksize=[1, 2, 2, 1], strides=[1, 2, 2, 1], padding='SAME', name=name) #1331 ks  st 1221


def inference(S_images,T_images, batch_size, n_classes):

    with tf.variable_scope('s_conv1') as scope:
      
        w_conv1 = tf.Variable(weight_variable([4, 4, 3, 32], 1.0), name='weights', dtype=tf.float32) 
        b_conv1 = tf.Variable(bias_variable([32]), name='biases', dtype=tf.float32)   
        s_conv1 = tf.nn.relu(conv2d(S_images, w_conv1)+b_conv1, name=scope.name) 


    with tf.variable_scope('s_pooling1_lrn') as scope:
        pool1 = max_pool_2x2(s_conv1, 's_pooling1')  
        norm1 = tf.nn.lrn(pool1, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='s_norm1')


    with tf.variable_scope('s_conv2') as scope:
        w_conv2 = tf.Variable(weight_variable([4, 4, 32, 64], 0.1), name='weights', dtype=tf.float32) # 33 64 32 
        b_conv2 = tf.Variable(bias_variable([64]), name='biases', dtype=tf.float32)   
        s_conv2 = tf.nn.relu(conv2d(norm1, w_conv2)+b_conv2, name='s_conv2')  # 得到64*64*32


    with tf.variable_scope('s_pooling2_lrn') as scope:
        pool2 = max_pool_2x2(s_conv2, 's_pooling2') 
        norm2 = tf.nn.lrn(pool2, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='s_norm2')


    with tf.variable_scope('s_conv3') as scope:
        w_conv3 = tf.Variable(weight_variable([4, 4, 64, 64], 0.1), name='weights', dtype=tf.float32)  # 3 3 32 16
        b_conv3 = tf.Variable(bias_variable([64]), name='biases', dtype=tf.float32)  
        s_conv3 = tf.nn.relu(conv2d(norm2, w_conv3)+b_conv3, name='s_conv3')  # 得到32*32*16

    with tf.variable_scope('s_pooling3_lrn') as scope:
        pool3 = max_pool_2x2(s_conv3, 's_pooling3')  
        norm3 = tf.nn.lrn(pool3, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='s_norm3')

    with tf.variable_scope('s_local4') as scope: #3
        reshape = tf.reshape(norm3, shape=[batch_size, -1]) #-1
        dim = reshape.get_shape()[1].value
        w_fc1 = tf.Variable(weight_variable([dim, 64], 0.005),  name='weights', dtype=tf.float32)
        b_fc1 = tf.Variable(bias_variable([64]), name='biases', dtype=tf.float32)
        s_local4 = tf.nn.relu(tf.matmul(reshape, w_fc1) + b_fc1, name=scope.name)	


    with tf.variable_scope('T_conv1') as scope:
 
        w_conv1 = tf.Variable(weight_variable([4, 4, 3, 32], 1.0), name='weights', dtype=tf.float32) # 333 64
        b_conv1 = tf.Variable(bias_variable([32]), name='biases', dtype=tf.float32)   
        T_conv1 = tf.nn.relu(conv2d(T_images, w_conv1)+b_conv1, name=scope.name)  

    with tf.variable_scope('T_pooling1_lrn') as scope:
        pool1 = max_pool_2x2(T_conv1, 'T_pooling1')   
        norm1 = tf.nn.lrn(pool1, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='T_norm1')


    with tf.variable_scope('T_conv2') as scope:
        w_conv2 = tf.Variable(weight_variable([4, 4, 32, 64], 0.1), name='weights', dtype=tf.float32) # 33 64 32 
        b_conv2 = tf.Variable(bias_variable([64]), name='biases', dtype=tf.float32)  
        T_conv2 = tf.nn.relu(conv2d(norm1, w_conv2)+b_conv2, name='T_conv2')  

    with tf.variable_scope('T_pooling2_lrn') as scope:
        pool2 = max_pool_2x2(T_conv2, 'T_pooling2')  
        norm2 = tf.nn.lrn(pool2, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='T_norm2')


    with tf.variable_scope('T_conv3') as scope:
        w_conv3 = tf.Variable(weight_variable([4, 4, 64, 64], 0.1), name='weights', dtype=tf.float32)  # 3 3 32 16
        b_conv3 = tf.Variable(bias_variable([64]), name='biases', dtype=tf.float32)   
        T_conv3 = tf.nn.relu(conv2d(norm2, w_conv3)+b_conv3, name='T_conv3')  
        
    with tf.variable_scope('T_pooling3_lrn') as scope:
        pool3 = max_pool_2x2(T_conv3, 'T_pooling3') 
        norm3 = tf.nn.lrn(pool3, depth_radius=4, bias=1.0, alpha=0.001 / 9.0, beta=0.75, name='T_norm3')
    
   
    with tf.variable_scope('T_local4') as scope: 
        reshape = tf.reshape(norm3, shape=[batch_size, -1]) #-1
        dim = reshape.get_shape()[1].value
        w_fc1 = tf.Variable(weight_variable([dim, 64], 0.005),  name='weights', dtype=tf.float32)
        b_fc1 = tf.Variable(bias_variable([64]), name='biases', dtype=tf.float32)
        T_local4 = tf.nn.relu(tf.matmul(reshape, w_fc1) + b_fc1, name=scope.name)
      
    local4 = s_local4 + T_local4
 
    
    with tf.variable_scope('local5') as scope:
        w_fc2 = tf.Variable(weight_variable([64 ,64], 0.005),name='weights', dtype=tf.float32)  #128
        b_fc2 = tf.Variable(bias_variable([64]), name='biases', dtype=tf.float32)   #128
        h_fc2 = tf.nn.relu(tf.matmul(local4, w_fc2) + b_fc2, name=scope.name)


    h_fc2_dropout = tf.nn.dropout(h_fc2, 0.5)


    with tf.variable_scope('softmax_linear') as scope:
        weights = tf.Variable(weight_variable([64, n_classes], 0.005), name='softmax_linear', dtype=tf.float32) #128
        biases = tf.Variable(bias_variable([n_classes]), name='biases', dtype=tf.float32)
        softmax_linear = tf.add(tf.matmul(h_fc2_dropout, weights), biases, name='softmax_linear')

    return softmax_linear
	
def losses(logits, labels):
    with tf.variable_scope('loss') as scope:
        cross_entropy = tf.nn.sparse_softmax_cross_entropy_with_logits(logits=logits, labels=labels, name='xentropy_per_example')
        loss = tf.reduce_mean(cross_entropy, name='loss')
        tf.summary.scalar(scope.name + '/loss', loss)
    return loss


def trainning(loss, learning_rate):
    with tf.name_scope('optimizer'):
        optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate)
        global_step = tf.Variable(0, name='global_step', trainable=False)
        train_op = optimizer.minimize(loss, global_step=global_step)
    return train_op


def evaluation(logits, labels):
    with tf.variable_scope('accuracy') as scope:
        correct = tf.nn.in_top_k(logits, labels, 1)
        accuracy = tf.reduce_mean(tf.cast(correct, tf.float16))
        tf.summary.scalar(scope.name + '/accuracy', accuracy)
    return accuracy




標題:CountVectorizer詞袋問題
標籤:countvectorizer python3 

我想要用CountVectorizer來計算每個數字1~10出現的次數，
但只能抓出10的次數，其他數字都無法統計出來，
換成純文字可以正常計算
不知道是不是CountVectorizer把一位數字當作數字不統計
想請問板上大大是否有解法或是更好的計算方式
謝謝
import pandas as pd
import numpy as np
from sklearn.feature_extraction.text import CountVectorizer

data_list= [
    '6 1 8 7 2 3 4 ', 
    '8 6 4 7 9 3 1 ', 
    '10 4 6 7 5 2 9', 
    '7 2 10 9 8 6 4', 
 ]
vectorizer = CountVectorizer()
X = vectorizer.fit_transform(data_list)
print(vectorizer.get_feature_names())
print(X.toarray())

----------------------------------------
['10']
[[0]
 [0]
 [1]
 [1]]
 



標題:在Python如何取得SMTP伺服器回應
標籤:smtp gsuite python 

請問使用Python內建的SMPT物件，如何取得SMTP伺服器回應的訊息，我的寫法如下：
try:
...     import smtplib
...     smtpObj = smtplib.SMTP(mail_host, 587)
...     a = smtpObj.starttls()
...     smtpObj.set_debuglevel(1)
...     b = smtpObj.login(mail_user, mail_pass)
...     c = smtpObj.sendmail(sender, receivers, message.as_string())
...     d = smtpObj.quit()
...     print("Success")
... except smtplib.SMTPException as e:
...     print("Error: QQ......")
...     print(e)

但如圖所示，即使信件因為SMTP的限制無法寄出，仍是沒有觸發例外；另外變數c與d也沒有收到任何東西。
我要如何知道我的郵件是否真的被成功寄出貨是失敗？
我使用的服務：https://support.google.com/a/answer/2956491#sendinglimitsforrelay



標題:makefile呼叫python執行檔時print無輸出
標籤:python python3 makefile 

嗨 各位好
code如下:
def MyErrorHandle(message):
	print('Error : %s' % message)

try:
	# blablablabla code
	MyErrorHandle('An error String-1')
	
except BaseException as e:
	MyErrorHandle('An error String-2')
	os._exit(0)

直接執行或使用pyinstaller包成執行檔執行都沒問題, 都有輸出
但使用makefile call 執行檔卻無輸出, 請問可能是什麼問題?
而如果不call MyErrorHandle() 直接print()是OK的


標題:在學習機器學習python語法問題
標籤:python machine learning tensorflow 

data_num = data.shape[0]
# 取得一筆與data數量相同的亂數索引，主要目的是用於打散資料
indexes = np.random.permutation(data_num)
# 並將亂數索引值分為Train、validation和test分為，這裡的劃分比例為6:2:2
train_indexes = indexes[:int(data_num*0.6)]
val_indexes = indexes[int(data_num *0.6):int(data_num *0.8)]
test_indexes = indexes[int(data_num *0.8):]

問題在於它的亂數索引值不是劃分為6:2:2嗎
為何val_indexes是indexes[int(data_num *0.6):int(data_num *0.8)]
和test_indexes 是 indexes[int(data_num *0.8):]
在這個地方卡住了還麻煩大大們賜教


標題:librosa找歌曲大調疑問
標籤:python mir 

大家好:
在python上做音樂分析時，遇到了兩個問題想請教
from __future__ import print_function
import numpy as np
import matplotlib.pyplot as plt # matplotlib for displaying the output
%matplotlib inline
import IPython.display # IPython.display for audio output
import librosa # Librosa for audio
import librosa.display # display module for visualization
y, sr = librosa.load('\abc.wav')
y_harmonic, y_percussive = librosa.effects.hpss(y)
C = librosa.feature.chroma_cqt(y=y_harmonic, sr=sr, bins_per_octave=36)


想請問"bins_per_octave=36"的意思:看了原文跟中文翻譯都不是很懂，每八度36個bins?
網路上僅找到輸出視覺化的code，想請問只要顯示出這首歌的大調的話，code要怎麼寫 print('chord:   ',C....)



標題:Keras: Multiple Inputs and Mixed Data
標籤:keras convolutional neural network siamese network tensorflow python 

各位前輩好 目前剛學習keras有看過Keras Functional API for Deep Learning介紹 跑單一網路架構cnn是可以正常訓練的 但希望將CNN可以做成如圖所示
研究幾天後用了很多方法去讓2個輸入卷積後Flatten在做合併
但目前遇到問題無法解決
#前端資料夾抓取輸入影像
model1 = Sequential()
model1.add(Conv2D(96, (11, 11),strides=4, input_shape=input_shape)) #same
model1.add(Activation('relu'))
model1.add(MaxPooling2D(pool_size=(3, 3),strides=2))
model1.add(Conv2D(256, (3, 3),strides=1))  #strides=2 SAME
model1.add(Activation('relu'))
model1.add(MaxPooling2D(pool_size=(2, 2),strides=2))
model1.add(Conv2D(384, (5, 5),strides=1)) #SAME
model1.add(Activation('relu'))
#model1.add(MaxPooling2D(pool_size=(2, 2)))
model1.add(Flatten())

model2 = Sequential()
model2.add(Conv2D(96, (11, 11),strides=4, input_shape=input_shape)) #same
model2.add(Activation('relu'))
model2.add(MaxPooling2D(pool_size=(3, 3),strides=2))
model2.add(Conv2D(256, (3, 3),strides=1))  #strides=2 SAME
model2.add(Activation('relu'))
model2.add(MaxPooling2D(pool_size=(2, 2),strides=2))
model2.add(Conv2D(384, (5, 5),strides=1)) #SAME
model2.add(Activation('relu'))
model2.add(Flatten())

**merged = merge([model1, model2], mode='concat')**

final_model = Sequential()
final_model.add(merged)
#final_model.add(Dropout(0.25))        
#final_model.add(Flatten())
final_model.add(Dense(1024,activation="relu"))  #1024 
final_model.add(Dropout(0.5))
#final_model.add(Dense(256,activation="relu"))
final_model.add(Dense(1))             
final_model.add(Activation('sigmoid'))
final_model.compile(loss='binary_crossentropy',optimizer='rmsprop',metrics=['accuracy'])

執行後遇到
請教各位這是哪邊出了問題，還是不能這樣做使用有人可以給我解答嗎?
查過滿多資料與方法但得不到解答    再麻煩各位了 謝謝


標題:Pandas 指定條件修改內容
標籤:python pandas 

在Pandas中我想要修改
將斜體的部分改為2019
條件想要用 month = 'Nov' or month = 'Dec'
取代原本的資料集
不知道各位大大是否有較好的寫法呢
先謝謝各位了
year month day time cl SessionID user user_id
2020 Nov 30 19:16:22 cl ftp[4504]: USER sc
2020 Nov 30 19:16:22 cl ftp[4509]: USER sc
2020 Nov 30 19:16:26 cl ftp[4551]: USER sc
2020 Nov 30 19:16:36 cl ftp[4597]: USER ace
2020 Nov 30 19:16:39 cl ftp[4611]: USER yA
2020 Dec 31 23:59:01 cl ftp[11667]: USER sc
2020 Dec 31 23:59:01 cl ftp[11670]: USER nx
2020 Dec 31 23:59:02 cl ftp[11674]: USER sc
2020 Dec 31 23:59:03 cl ftp[11675]: USER sc
2020 Dec 31 23:59:03 cl ftp[11678]: USER sc
2020 Dec 31 23:59:07 cl ftp[11683]: USER sc
2020 Jan  1 00:00:01 cl ftp[12183]: USER sc
2020 Jan  1 00:00:01 cl ftp[12185]: USER ap
2020 Jan  1 00:00:02 cl ftp[12196]: USER ni


標題:Telegram Bot問題 webhook 和直接寫的分别?
標籤:python 

Telegram Bot問題 webhook 和直接寫的分别?
哪個好 ?
現在我是
def on_chat_message(msg):
    content_type, chat_type, chat_id = telepot.glance(msg)
    if msg['text'] == '/start':
        mark_up = ReplyKeyboardMarkup(keyboard=[['Hello'], ['test1'], ['test2']], one_time_keyboard=True)
        bot.sendMessage(chat_id, text='Pleasae Select the demo?', reply_markup=mark_up)

    elif msg['text'] == 'Hello':
        bot.sendMessage(chat_id, 'Hello!')
        ...

解決 JS VS PYTHON


標題:Python 如何計算元素個素By區間?
標籤:python 3 計算區間元素總數 

Dear Python 高手
小弟我是新手，目前卡關了，
想要將ks 這5個元素分成,利用list分組, 分成 大:小 = 2:3
Code 碼如下
from collections import Counter



定義大跟小的元素
小 =[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]
大 = [16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]






要分組的元素
ks = [2,3,4,27,31]
dict = {}



for item in ks:
dict.update({item:ks.count(item)})
print(dict)
但只能一個一個算，無法算區間數....


標題:爬蟲被登入小視窗擋 求解決方法
標籤:網頁爬蟲 python python request 

目前在用python學爬蟲, 其中一個題目是要爬這個網址
https://www.zhihu.com/explore
但用 requests.get() 都會跑出 400 Bad Request 的資料
像這樣
<html>
<head><title>400 Bad Request</title></head>
<body bgcolor="white">
<center><h1>400 Bad Request</h1></center>
<hr><center>openresty</center>
</body>
</html>

搜了網址發現一進去就會跳出要我們登入的彈出視窗, 因此猜測是因為這樣而出現錯誤

求解~


標題:一門python爬蟲課程要4萬2，值這個價嗎？
標籤:python scrapy crawler html url 

各位前輩們好，小弟透過線上學習python約莫一年，目前想系統性的學習爬蟲的部分，學習正確的爬蟲觀念與方法，目標是學會爬動態(時時更新)並且會反爬蟲的網站，例如體育賠率網站之類的。
近日了解到達內教育有一個爬蟲的課程，內容如下圖：

這門課要4萬2(線上課程並且有時效性)，價格比Udemy或Coursera上的課程貴很多，或許這門課是貴在有專人回答問題，但其實很多程式問題從google都可以找到答案，如果排除掉導師從旁輔助的服務而言，這門課的內容有值這個價嗎？ 另外也想請問各位前輩們有覺得不錯的學習資源可以推薦嗎？ 謝謝！


標題:python有辦法從尾端迴圈嗎?
標籤:python 

比如正常的迴圈
list=[1,2,3,4,5]
for i in list:
print(i)
會跑出
1
2
3
4
5
有辦法在不改變列表的前提下變成這樣嗎
5
4
3
2
1


標題:Django | 如何使用富文本編輯器將圖片上傳資料庫
標籤:django python 編輯器 

如題，想請問有人有研究Django富文本編輯器嗎？ 用ckeditor，文章的圖片好像只能放到指定路徑下。
請問有人有推薦的富文本編輯器嗎，而且希望可以將圖片上傳到mysql資料庫中


標題:使用Python設計漸層的灰階影像
標籤:python opencv 

影像大小:512x100，灰階自左到右分別為0~255，並儲存影像檔案。
我的程式:
import numpy as np
import cv2
img = np.zeros([100,512],dtype="uint8")
for i in range(0,256):
img[:,:] += i
cv2.imshow("Example",img)
cv2.imwrite("color.bmp",img)
cv2.waitKey(0)
cv2.destroyAllWindows()
結果:

請問需要怎麼修改才會正確?


標題:python 代理IP驗證問題 scrapy.request vs requests
標籤:python requests proxy 

在驗證一個IP是否可用時，http協定的IP雖然可以執行，卻無法代理
https協定的IP則是完全無法執行
想請教各位該使用何種方法來驗證IP是不是能作為proxy IP使用？
httpbin = 'https://httpbin.org/ip'
        headers = {"User-Agent": UserAgent().random}
        if meta:
            proxies = {meta['scheme']: meta['proxy']}
            print(proxies)
            session = requests.session()
            try:
                resource = requests.get(httpbin, headers=headers, proxies=proxies, timeout=3)
                sleep(1)
            except TimeoutError:
                print('except')
                pass
            except requests.ConnectionError as e:
                print("  Failed to open url")
                print(e)
                pass
            print(resource.text)

http(可連線，但結果沒有被代理成功):
{'http': 'http://222.95.240.191:3000'}
{
  "origin": "117.19.193.171"
}

https(無法連線):
{'https': 'https://183.143.49.23:8118'}
  Failed to open url
HTTPSConnectionPool(host='httpbin.org', port=443): Max retries exceeded with url: /ip (Caused by ConnectTimeoutError(<urllib3.connection.VerifiedHTTPSConnection object at 0x000001F6ED7F1AC8>, 'Connection to 183.143.49.23 timed out. (connect timeout=3)'))
{'https': 'https://139.196.13.63:3128'}
  Failed to open url
HTTPSConnectionPool(host='httpbin.org', port=443): Max retries exceeded with url: /ip (Caused by ProxyError('Cannot connect to proxy.', NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x000001F6ED809860>: Failed to establish a new connection: [WinError 10061] 無法連線，因為目標電腦拒絕連線。')))

然而另一方面若使用scrapy.request則大多數http的IP皆可驗證成功並能順利爬取網站，想請教原因！
（猜測https的IP大多無法用來代理，但http的IP卻無法用requests驗證成功）


標題:詢問pymongo 亂數取值的方法
標籤:python pymongo mongodb 

網路上查到的方法是使用
.aggregate([{ $sample: { size: 1 } }])
但是我實際上使用時它卻說是無效的語法
想請教各位原因出在哪裡，感謝><
import pymongo
class GetProxy():
    def __init__(self):
        self.DB_URI = pymongo.MongoClient(host='localhost', port=27017)
        self.DB_NAME = self.DB_URI.ip_pool  # 資料庫
        self.DB_COLLECTION = self.DB_NAME.proxy  # 資料表
        
    def get_random_proxy(self):
        result = self.DB_COLLECTION.aggregate([{ $sample: { size: 1 } }])

error code:
Traceback (most recent call last):
  File "D:/【程式設計】/HSIAO_plan/get_proxy/get_proxy/get_proxy.py", line 1, in <module>
    from runProxy import GetProxy
  File "D:\【程式設計】\HSIAO_plan\get_proxy\get_proxy\runProxy.py", line 43
    result = self.DB_COLLECTION.aggregate([{ $sample: { size: 1 } }])
                                             ^
SyntaxError: invalid syntax



標題:Python 迴圈練習
標籤:python 迴圈 

問題如下:
Statement
As a future athlete you just started your practice for an upcoming event. Given that on the first day you run x miles, and by the event you must be able to run y miles.
Calculate the number of days required for you to finally reach the required distance for the event, if you increases your distance each day by 10% from the previous day.
Print one integer representing the number of days to reach the required distance.
大意是 第一天我可以一次跑 x miles
訓練的最後一天 我的目標是一次跑 y miles
每訓練一天 我可以比前一天 多跑10%
要達到目標 我需要訓練幾天?
以下是我練習的語法
a = int(input()) --第一天可以跑得miles
b = int(input()) --最後一天目標miles
ans = 0 --紀錄每一天可以跑得miles
i = 1 --從第一天開始
while ans <= b:
    ans = a * 1.1
    i += 1
print(i) --印出總共訓練了幾天

測試資料 a = 10  b = 20
snakify練習網址
按下 執行後
整個網頁會當機 沒有回應
不知道是不是我寫了無窮迴圈導致的
還是這個練習網站本身的問題??
(PS 需要註冊後才可以練習題目)
更新正解:
a = int(input()) 
b = int(input()) 
ans = 0 
i =  1
if(a < b):
    while ans < b:
        ans = a * 1.1
        i += 1
        a = ans
print(i)

更新簡化:
a = int(input()) 
b = int(input()) 
i =  1
if(a < b):
    while a < b:
        a *= 1.1
        i += 1
print(i) 



標題:matplotlib繪圖問題
標籤:python matplotlib.pyplot matplotlib 

data如下:
from_x,from_y,to_x,to_y
2,3,3.5,5
1,4,3,7
4,6,6,3
3,3,3.2,5
4,5,7,5


我想要繪出這樣的圖

目前我只會用笨方法處理
import numpy as np
import matplotlib.pyplot as plt
t11 = [2, 3.5]
t12 = [3, 5]

t21 = [1, 3]
t22 = [4, 7]

t31 = [4, 6 ]
t32 = [6, 3]

t41 = [3, 3.2]
t42 = [3, 5]

t51 = [4, 7]
t52 = [5 ,5]
plt.plot(t11, t12, 'y', t21, t22, 'b', 
         t31, t32, 'g', t41, t42, 'r',
         t51, t52)

plt.show()

不知道大大是否有比較好的處理方式，麻煩各位了


標題:如何用power bi desktop建立3D地圖
標籤:power bi desktop power bi python r data visualization 

大家好,
最近工作需要在使用 power bi desktop 進行資料分析,之前在excel的部分有看過power map建立3D地圖,但power bi desktop中好像找不到相關的功能
目前嘗試了ArcGIS Maps和Global Maps,ArcGIS建立的地圖雖然圖很漂亮但無法做出3D地圖,Global Maps 建立的地圖看起來有3D但是解析度很差也無法旋轉角度,無法達到理想中的效果,請求各位高手幫忙><
PS.power bi desktop中可以使R或Python不知道能否用這個方法做到3D地圖的效果(這兩種語法不太熟悉QQ)
謝謝大家~


標題:Arima 預測空氣品質
標籤:python 3 arima 深度學習 

目前利用Arima方法預測李宏毅的作業一
我已經把資料分割了

行的名稱0~8代表時間0點~8點
列是pm2.5所在的位置
格式是dataframe
然後我現在卡在我是要把資料轉成一行好幾列
還是可以就以這樣格式去計算後續的差分?
我使用直接用這格式計算會出現錯誤


temx是上面顯示的格式
想問有沒有比較好的方法?
因為網路上介紹的方式都是選一行其中的資料然後有好幾列代表不同天的格式
剛學習Arima所以不太懂
我是參考时间序列预测任务 4 4 股票预测案例的方法來去做預測


標題:PY連結SQL 字串問題
標籤:python sql 

cursor.execute('SELECT * FROM CUSTOMERS WHERE NAME LIKE  '%ik%' '  )
請問碰到這樣有%的符號時 怎麼樣輸入才是正確的
跳錯
cursor.execute('SELECT * FROM CUSTOMERS WHERE NAME LIKE  '%ik%' '  )
NameError: name 'ik' is not defined
我的''應該是怎麼加才會正確 請教各位大大


標題:html 圖片新手Grid排版問題
標籤:html image python bootstrap flask 

Python Flask
Bootstap 3.3.7
程式碼:
            <div class="form-horizontal">
              <div class="form-group ">
                <input type="image" class="col-xs-offset-2" style="float:left" src="static/front.png"  id="btn_front" onclick="send();" />
                <input type="image" class="col-xs-offset-3" style="float:left" src="static/front.png"  id="btn_up" onclick="send();" />
              </div>
              <div class="form-group">
                <input type="image" class="col-xs-offset-1" style="float:left" src="static/left.png"  id="btn_left" onclick="send();" />
                <input type="image" class="col-xs-offset-1" style="float:left" src="static/right.png"  id="btn_right" onclick="send();" />
                <input type="image" class=" col-xs-offset-2 " style=" float:left" src="static/right.png"  id="btn_down" onclick="send();" />
              </div>
              <div class="form-group">
                <input type="image" class="col-xs-offset-2" style="float:left" src="static/back.png"  id="btn_back" onclick="send();" />
                <input type="image" class="col-xs-offset-3" style="float:left" src="static/back.png"  id="btn_catch" onclick="send();" />
              </div>
            </div>

出來的結果為:

不知道為什麼第二排會有個偏差在
我理想中的結果是:



標題:Python 爬蟲 重複
標籤:爬蟲 python 

有一個爬新聞的程式，每天執行一次，但是會爬到同一篇新聞的情況，因為我是抓一整頁，所以該頁面會有昨天的新聞，這樣我該如何處理呢？
我有兩種想法：
1.爬蟲完去跟資料庫比對有沒有重複的資料，沒有在存入資料庫。
2.爬蟲完先存入資料庫，在下sql指令把重複資料刪除。
不知道哪一種比較好？
請大神們幫忙解惑
ps爬蟲使用python＋mysql


標題:Python資料處理.txt
標籤:python preprocessing 

最常都是使用Pandas來處理csv的檔案格式，
但若是要處理log類型的資料，如下
month=>[0:3]
day=>[4:6]
time=>[7:15]
clftp1=>[16:22]
.........略.........
想請問各位前輩遇到這類的data是否有較好的前處理方式
不論是直接操作該格式
或是
replace後轉成csv使用pandas操作都可
希望可以分享大家寶貴的意見
謝謝
Rawdata


標題:PY連結到MSSQL問題
標籤:python sql 

代碼如下
import pyodbc
server = 'tcp:DESKTOP-LJED17C\MSSQLSERVER01.database.windows.net'
database = 'TNU'
username = '54321'
password = 'canon760d'
cnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password)
cursor = cnxn.cursor()
conn.close()
跳錯
cnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password)
pyodbc.OperationalError: ('08001', '[08001] [Microsoft][ODBC Driver 17 for SQL Server]SQL Server 網路介面: 尋找指定的伺服器/執行個體時發生錯誤 [xFFFFFFFF].  (-1) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 17 for SQL Server]登入逾時終止 (0); [08001] [Microsoft][ODBC Driver
17 for SQL Server]建立 SQL Server 的連接時發生網路相關或執行個體特定錯誤。找不到伺服器或是無法存取。檢查執行個體名稱是否正確以及 SQL Server 執行個體是否設定為允許遠端連接。如需詳細資訊，請參閱《SQL Server 線上叢書》。 (-1)')
想問各位大神如何解決這個問題QQ
是代碼錯了還是哪邊沒有設定到呢


標題:學習PYthon
標籤:python 

完全沒有程式概念的話，從哪裡入門比較快呢？


標題:Raspberry Pi 將WIFI網卡重啟後無法SSH和VNC連線
標籤:raspberry pi wifi python ssh vnc 

目前在開發個用Python選擇SSID來切換連線的WIFI功能
選擇後會將SSID和密碼寫入wpa_supplicant.conf
然後再下sudo wpa_cli -i wlan0 reconfigure這段指令來重啟WIFI
目前切換上都正常
但若是想加入復原備份檔功能時會出錯
復原備份檔的流程是每次在連線成功後會備份一個wpa_supplicant.conf.bak
然後當前面那段sudo wpa_cli -i wlan0 reconfigure重啟後跳錯誤時
會下這段將上一次成功連線的備份檔覆蓋現在的wpa_supplicant.conf
shutil.copy2("/etc/wpa_supplicant/wpa_supplicant.conf.bak", "/etc/wpa_supplicant/wpa_supplicant.conf")
但現在還原完成後, Raspberry Pi本身網路功能看起來都正常, 也可透過瀏覽器上網
但SSH或是VNC連線都沒有反應, 也有嘗試用別種方式重啟:
sudo ifconfig eth0 down
sudo ifconfig eth0 up
但結果都一樣, 最後reboot重啟後又都正常了, 所以備份還原的部份應該也沒有問題?
不知道是哪個環節出了問題?
或是說有更好的方式可以以Python完成這個功能嗎?
謝謝


標題:Python3 Tkinter 無法顯示繁體中文的"錯"字
標籤:python python3 tkinter utf-8 ui 

開發環境:
Raspberry Pi Debian 9
Python 3.5
Notepad++ v7.8.1

如圖, 開發到現在只有遇到"錯"這個字會變空白
反而簡體的"错"可以顯示
也有在程式第一行加上# -*- coding: utf-8 -*-
是在Windows 10用Notepad++編輯程式碼, 再用FTP方式丟到Raspberry Pi裡面執行, 有確認Notepad++這邊也是選UTF-8了
Label部份程式碼:
second_title_font_cht = tkFont.Font(family='Piboto Condensed', size=25, weight=tkFont.NORMAL)

volume_error_title_label = Label(system_set_frame, text='錯誤音量:', font=second_title_font_cht, background=background_color, fg=parameter_label_color)
volume_error_title_label.place(x=150, y=465, anchor='center', width = 230, height = 80)


目前測試下來好像不是Python的關係
在整個Raspberry Pi系統都顯示不出"錯"這個字
還在找方法中

將Raspberry Pi重開居然就可以正常顯示了!??


標題:Python Pandas 使用 pd.corsstab 的欄位排列錯位問題
標籤:python 3 pandas crosstab data science big data 

各位前輩大大好，小弟遇到一個不知名的問題，希望有前輩大大可以幫忙解惑。
我的df，有3個欄位，分別是
trial_Level (type=str)
signupDays_Level (type=str)
yesNo (type=float64)


原本我的代碼在做corsstab的時候，都有很正常的按照順序排列
然後有一天他突然就失靈了，原本分組10的都會在最後面，但突然就往前跑了，由於我有十幾個crosstab要跑，希望能找到一個解決根本的問題。

這個corsstab是為了進行heatMap，錯位對整體顏色的影響滿大的

在獨立執行
pd.crosstab([df_name[columnA],(df_name['yesNo'] == 0)], df_name[columnB])的時候，就產生錯位了，所以初步判斷這個錯誤與後面的代碼"應該"是沒有關聯性。
附上代碼
cross_test
def cross_test(df_name, columnA, columnB, showtype=2):
    tdf1 = pd.crosstab([df_name[columnA],(df_name['yesNo'] == 0)], 
                                                      df_name[columnB])
    tdf2 = pd.crosstab([df_name[columnA],(df_name['yesNo'] == 1)], 
                                                      df_name[columnB])
    tdf3 = tdf1 / (tdf1 + tdf2)
    iloclist = []
    #showtype參數2：僅顯示True的部分
    if showtype == 2 :
        [iloclist.append(x) for x in range(1,len(tdf3),2)]
        return tdf3.iloc[iloclist,:]
    #showtype參數3：僅顯示False的部分
    if showtype == 3 :
        [iloclist.append(x) for x in range(0,len(tdf3),2)]
        return tdf3.iloc[iloclist,:]
    return tdf3

cross_test(tdf, 'trial_Level', 'signupDays_Level')

heatMap_test
def heatMap_test(df_name, columnA, columnB, showtype=2):
    plt.figure(figsize=(8, 6))
    sns.set(font_scale=1)    
    sns.heatmap(cross_test(df_name, columnA, columnB, showtype).fillna(0),annot=True)
    
heatMap_test(tdf, 'trial_Level', 'signupDays_Level')

dataLevel
def dataLevel(series_in, new_name):
    quantileEdges = [0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]
    binsEdges = []
    binsNames = []
    #根據series_in進行quantile(劃分10組界線)
    for i in quantileEdges:
        sq = series_in.quantile(i)
        binsEdges.append(sq)
        binsNames.append('{}_分組{}({})'.format(series_in.name, int(i*10), int(sq)))
    #處理bins前幾項重複的問題(ex: '時間diff' 前30%數據都是0)
    binsEdges = sorted(set(binsEdges))
    binsNames = binsNames[-len(binsEdges)+1:]
    #分組並建立新欄位    
    df[new_name] = pd.cut(df[series_in.name].fillna(0), bins=binsEdges, labels=binsNames, right=False)
    print('new column [{}] created!'.format(new_name))
    return True



標題:linebot api - broadcast
標籤:linebot broadcast python 3 heroku 

如題
請問有先進知道
linebot api - broadcast
這個功能怎麼使用嗎？
看了這個文件
我的code：
if event.message.text == 'broadcast':
    line_bot_api.broadcast(TextSendMessage(text='broadcast_test'))

部署在heroku
收到下面的log
'LineBotApi' object has no attribute 'broadcast'
請問我需怎麼修正呢？


標題:Python 兩個 list 合併
標籤:python3 csv forloop 

如題，有兩個List
其中
A List 各列 想對應 B List 每一列
逐步形成水平合併的list形式

temp = []
tempU = []
userANDitem = []

for userLen in range(len(user_list)-1):
    tempU.clear()
    #每一個 user 5 欄位
    for x in range(5):
        tempU = temp.append(user_list[userLen+1][x])
    # 共 40 個  物品
    for questionLen in range(len(question_list)-1):
        #物品中共 6 個欄位
        for y in range(6):
            print(y)
            temp.append(question_list[questionLen+1][y])
            print(temp)
            if(y==5):
                userANDitem.append(temp)
                temp.clear()
                temp.append(tempU)
                print("------userANDitem--------")
                print(userANDitem)
                print("--------------")

但不知為何出來的list都只會重複，
已寫了兩天但還是無法想出，懇請各位大大幫忙，
謝謝
不考慮

numpy 是因為只能對數字操作，但資料格式含有String
pandas 是因為pandas只能針對各列一對一水平合併，且有index問題



標題:小數放進np.array都剩下整數小數不見了
標籤:python 

如題
像是2.9 3.1等等數字要放進array之後剩下2和3後面的小數都不見了
請問該怎麼解決 感謝各位大大幫忙!!!


標題:請問python爬取google的圖片程式
標籤:python 


import requests

import urllib.request

from bs4 import BeautifulSoup

import os

import time




word = input('Input key word: ')
url = 'https://www.google.com.tw/search?q='+word+' &rlz=1C1CAFB_enTW617TW621&source=lnms&tbm=isch&sa=X&ved=0ahUKEwienc6V1oLcAhVN-WEKHdD_B3EQ_AUICigB&biw=1128&bih=863'

photolimit = 10



headers = {'User-Agent': 'Mozilla/5.0'}

response = requests.get(url,headers = headers) #使用header避免訪問受到限制

soup = BeautifulSoup(response.content, 'html.parser')

items = soup.find_all('img')

folder_path ='./photo/'

if (os.path.exists(folder_path) == False): #判斷資料夾是否存在

    os.makedirs(folder_path) 



for index , item in enumerate (items):

    if (item and index < photolimit ):

        html = requests.get(item.get('src')) 

        img_name = folder_path + str(index + 1) + '.png'



        with open(img_name,'wb') as file: #以byte的形式將圖片數據寫入

            file.write(html.content)

            file.flush()

        file.close() 

        print('第 %d 張' % (index + 1))

        time.sleep(1)



print('Done')
 

請問我這個程式哪裡出問題?我記得幾個月前還能用啊?
錯誤訊息:



標題:Django的安全配置
標籤:django python security 

有查到關於 Django 的安全配置 如下：
實施SSL / HTTPS
可以在Web服務器上啟用SSL / HTTPS，以便加密站點和瀏覽器之間的所有流量，包括否則將以純文本形式發送的身份驗證憑據（強烈建議啟用HTTPS）。如果啟用了HTTPS，則Django提供了許多其他保護措施，您可以使用：
SECURE_PROXY_SSL_HEADER 可以用於檢查內容是否安全，即使內容是從非HTTP代理傳入的也是如此。
SECURE_SSL_REDIRECT 用於將所有HTTP請求重定向到HTTPS。
使用HTTP嚴格傳輸安全性（HSTS）。這是一個HTTP標頭，它通知瀏覽器將來與特定站點的所有連接都應始終使用HTTPS。結合將HTTP請求重定向到HTTPS，此設置可確保在成功建立連接後始終使用HTTPS。HSTS可以通過SECURE_HSTS_SECONDS和SECURE_HSTS_INCLUDE_SUBDOMAINS或在Web服務器上進行配置。
通過將SESSION_COOKIE_SECURE和設置CSRF_COOKIE_SECURE為使用“安全” cookie True。這將確保cookie僅通過HTTPS發送。
↑以上內容 看的不是很懂，請教有相關經驗的朋友們，是否有在settings.py上，一定要建議要設置的安全選項呢？
謝謝您
ex: SESSION_COOKIE_SECURE 一定要設True 才好嗎？之類的，感謝。


標題:Python Tkinter Scale Slider 顏色設定問題
標籤:python tkinter gui scale python3 


如上圖, 想要設定箭頭處Slider的顏色
但用了background參數設定顏色會和底色一起變色
像是:

若直接設定和背景顏色一樣Slider會不太容易辨識
像用activebackground就可以單獨設定Slider的顏色
是否有方法可以Slider和底色分開設定顏色嗎?
s2 = Scale(control_frame, from_=0, to=100, tickinterval=100, sliderrelief='flat', orient="horizontal", highlightthickness=0, background='black', fg='grey', troughcolor='#73B5FA', activebackground='#1065BF')

s2.place(x=70, y=600, anchor='nw', width = 280, height = 50)



標題:Spyder 3.x > 4.0 升級後ipython console無法顯示
標籤:spyder anaconda python 

三周前把anaconda的spyder升級到4.0後
原本可以在spyder內一個一個cell執行
在右邊的ipython console中可以印出ipython的資訊
升級完後再也顯示不了
太傷心了，請問有解嗎


標題:opencv矩形辨識的問題?提取矩形和濾除雜訊?
標籤:opencv python 影像處理 影像辨識 

如提
下圖是我目前辨識出來的效果
https://i.imgur.com/9EOw2Lx.png

最右邊的result是我辨識出來的結果
主要是希望把矩形辨識出來
我的步驟大概是
1.先把圖做濾波
其實我不知道到底要用哪種濾波會比較好(每種方式後面都是一種數學式，但我數學真的很糟糕...)
不做濾波的話會result會辨識出一堆亂七八糟的東西
就像是我在result中用黃線圈出來的東西
2.把濾出來的圖做灰度化
3.把灰度化的圖做二值化
4.對二值化的圖做findContours
5.對findContours的結果做邊緣逼近approxPolyDP
6.取得approxPolyDP的結果approx
approx陣列長度如果等於4代表是矩形
如果是矩形就把矩形畫出來
但是最大的問題是
我雖然有濾波過
但程式會把一些不是矩形的東西也辨別出來
result中我用黃色圈起來的東西
是我不想要的東西
然後線太細的話好像也不是那麼容易可以被辨認出來??
所有code:
import cv2

#選擇外接的webcam
cap = cv2.VideoCapture(0)

c = 1
timeF = 10  # frame time

while(1):
    # 從攝影機擷取一張影像
    ret, frame = cap.read()
    if (c % timeF == 0 or c % timeF == 5):# frame 限制
    
      dst = cv2.pyrMeanShiftFiltering(frame, 10, 50)#濾波
      gray = cv2.cvtColor(dst, cv2.COLOR_BGR2GRAY)#灰度
      ret, thresh = cv2.threshold(gray, 127, 255, cv2.THRESH_BINARY)#二值化
      
      cv2.imshow("ShiftFiltering", dst)
      cv2.imshow("threshold", thresh)

      image, cnts, hierarchy = cv2.findContours(thresh.copy(), cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)

      for i in cnts:
        
        #輪廓近似
        peri = cv2.arcLength(i, True)
        approx = cv2.approxPolyDP(i, 0.01*peri, True)
        
        if len(approx) == 4:

          start_point = (approx[0][0][0], approx[0][0][1])
          end_point = (approx[2][0][0], approx[2][0][1])
          color = (255, 0, 0)
          image = cv2.rectangle(frame, start_point, end_point, color, 2)
          cv2.imshow("result", image)

    c = c + 1
    
    if cv2.waitKey(1) & 0xFF == ord('q'):
        final = image
        break

# 釋放攝影機
cap.release()
# 關閉所有 OpenCV 視窗
cv2.destroyAllWindows()
cv2.imshow("final", final)
cv2.waitKey(0)



標題:python   開啟headless抓不到值
標籤:python 

在抓取網頁資料遇到一個問題
如果是視窗模式的話可以抓到值
但只要開啟headless就會抓不到值
['1#镍', '107950—113550', '110750', '-2,600']
感覺是資料擷取長度不足問題
想請問有什麼方式解決嗎?
正常:
['1#镍', '107950—113550', '110750', '-2,600', '元/吨', '01-06']
網站 https://www.ccmn.cn/

程式碼
chrome_options = Options()
chrome_options.add_argument('--headless')
chrome_options.add_argument('--disable-gpu')
driver = webdriver.Chrome(chrome_options=chrome_options)

def scrp_ccmn01(driver):
    driver.get("https://www.ccmn.cn/")

    #讀取內文報價資料
    tr_elem = driver.find_element_by_xpath('//*[@id="quoPrice_box"]/table')
    for tr in tr_elem.find_elements_by_xpath('//tr'):
        ls = [td.text for td in tr.find_elements_by_xpath('td') 
        if len(td.text.strip()) > 0]
        #print(ls)
        if (len(ls) > 0) and ('1#镍' in ls[0]):
            break



標題:為什麼我在Django中設定的網址，只要一用正規表示式就無法顯示？
標籤:django python 網站開發 

Django問題請益：
為什麼我在urls.py中設定的網址，只要一用正規表示式就會壞掉？但不用正規表示式就可以正常顯示。這是什麼原因？如果需要用正規表示式的話，我該如何修改？
開發環境：
Mac OS 10.13
Python3.7
Django version 3.0.2
Code跟顯示資訊如下：



我找到答案了
Django2.0以上的版本
要使用re_path才能使用正規表示式
正確寫法：

參考網址：
https://www.osgeo.cn/django/topics/http/urls.html


標題:Python 讀取記事本 list 問題
標籤:python3 txt list讀取 

請大大幫忙解答，我讀取一個記事本com.txt，該怎麼寫依index讀取
com.txt文本資料
['https://i.imgur.com/yCRKRrW.jpg', 'https://i.imgur.com/Wi2ZpI0.jpg', 'https://i.imgur.com/0o3RywQ.jpg', 'https://i.imgur.com/J32O3Y6.jpg', 'https://i.imgur.com/3uYICfO.jpg', 'https://i.imgur.com/NtzTFsY.jpg', 'https://i.imgur.com/1gZmY1u.jpg', 'https://i.imgur.com/tJM6E1b.jpg', 'https://i.imgur.com/OJjyDbs.jpg', 'https://i.imgur.com/xV1SDLT.jpg', 'https://i.imgur.com/gxsGgpg.jpg', 'https://i.imgur.com/YrZbHmU.jpg']
file = 'com.txt'
with open(file, 'r') as f:
    a = f.read()

使用print(a[0]) 輸出只有 [ 符號 ，無法輸出圖片網址
該怎麼轉換可以正常使用list，麻煩大大們幫忙


標題:中斷ADSL的連線
標籤:adsl python 

連線很簡單
我知道這兩個方法
import win32ras
dialname = 'ADSL'
account = '123@wifi.hinet.net'
passwd = '123456'
dial_params = (dialname, '', '', account, passwd, '')
win32ras.Dial(None, None, dial_params, None)

import os,sys
os.system('@Rasdial ADSL 123@wifi.hinet.net 123456')

但是我已經連線了
想要斷線
Rasdial的很簡單
os.system('@Rasdial ADSL /DISCONNECT')

但是win32ras要怎要怎麼做啊
據說win32ras.HangUp可以
但是完全沒反應
有人有辦法嗎
找到解決方法了
在已經ADSL連線的前提下
win32ras.HangUp(1)


標題:突然不能刪除檔案
標籤:python3 python pil 

這個代碼原本用得好好地都沒問題
在我重裝軟體後就出問題
無法刪除他檢測到的圖片
import os
import shutil
from PIL import Image

def is_valid_jpg(jpg_file):
    with open(jpg_file, 'rb') as f:
        f.seek(-2, 2)
        buf = f.read()
        return buf == b'\xff\xd9'

def is_valid_png(png_file):
    with open(png_file, 'rb') as f:
        f.seek(-3, 2)
        buf = f.read()
        if buf == b'\x60\x82\x00':
            return True
        elif buf[1:] == b'\x60\x82':
            return True
        else:
            return False

def is_valid_pic(pic_file):
    if pic_file.endswith('jpeg'):
        return is_valid_jpg(pic_file)

    elif pic_file.endswith('png'):
        return is_valid_png(pic_file)
    else:
        return False
    
DirList=["D:\\long\\Desktop\\123"]
for path in DirList:
    for dirPath, dirNames, fileNames in os.walk(path):
        for file in fileNames:
            pic_file = os.path.join(dirPath,file)
            ext=pic_file.split('.')[-1]
            if not is_valid_pic(pic_file):
                if ext == 'jpg' or ext == 'png':
                    try:
                        img = Image.open(pic_file)
                        img.load()
                    except Exception as e:
                        #print(e)
                        print(pic_file)
                        #os.remove(pic_file)#刪除檔案

https://www.sendspace.com/file/5xd5ut
這裡有3個檔案
分別是代碼、正常圖、毀損圖
有誰可以幫忙測試一下嗎
版本是Python 3.6.8


標題:python3問題?
標籤:python python3 ubuntu 

我已經搜尋了一些資料 有關 ubuntu 18安裝 python3
如下

$ sudo apt-get update
$ sudo apt-get upgrade
$ sudo apt-get install libssl-dev openssl libreadline-dev
$ cd ~
$ wget https://www.python.org/ftp/python/3.6.1/Python-3.6.1.tgz
$ tar zxf Python-3.6.1.tgz
$ cd Python-3.6.1
$ ./configure
$ make
$ sudo make install

但是到import  telepot 出現問題
peter@dvr:~$ python3 --version
Python 3.6.1
peter@dvr:~$ pip3 --version
pip 9.0.1 from /usr/lib/python3/dist-packages (python 3.6)
peter@dvr:~$ python3
Python 3.6.1 (default, Dec 27 2019, 10:01:53)
[GCC 7.4.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import telepot
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/peter/.local/lib/python3.6/site-packages/telepot/__init__.py", line 346, in <module>
    from . import api
  File "/home/peter/.local/lib/python3.6/site-packages/telepot/api.py", line 1, in <module>
    import urllib3
  File "/home/peter/.local/lib/python3.6/site-packages/urllib3/__init__.py", line 7, in <module>
    from .connectionpool import HTTPConnectionPool, HTTPSConnectionPool, connection_from_url
  File "/home/peter/.local/lib/python3.6/site-packages/urllib3/connectionpool.py", line 39, in <module>
    from .response import HTTPResponse
  File "/home/peter/.local/lib/python3.6/site-packages/urllib3/response.py", line 3, in <module>
    import zlib
ModuleNotFoundError: No module named 'zlib'
>>>

謝謝


標題:如何防呆XML File
標籤:python xml xml schema xsd 

各位好
我有個xml file部分內容如下, 內容由user填入, 現在必須做防呆, 像是item1只能1~3, item4只能0x10~0x20之類的, 請問XML Schema可以做到嗎?
有稍微摸索一下, 但感覺不太好用...
另外我是使用python吃這個xml file的, 不知有沒有檢查的套件?
	<Config>
		<item1>1</item1>
		<item2>0</item2>
		<item3>1</item3>	
		<item4>0x12</item4>
		<item5>0x23</item5>
		<item6>0x34</item6>
	</Config>



標題: 如何爬取圖文網頁
標籤:python python3 

import requests
from bs4 import BeautifulSoup
import os
url = 'https://ericjhang.github.io/archives/ad5450f3.html'
html = requests.get(url).content
with open('123.html','wb')as f:
f.write(html)
f.close()
這樣爬出來圖是叉叉
要怎樣爬取才能文字連同圖片一起爬
格式只有html嗎


標題:敏感資料加密處理
標籤:python3 gmail python 

想藉gmail寄送郵件
程式內需要輸入帳密
但由於程式需要放在共用的電腦

想請問該如何把圖中
gmail_user、gmail_password的部分加密
讓別人無法從source code中看到帳密資訊
謝謝~


標題:梯度下降 用在曲線擬合y=axe^bx
標籤:python vba #數值 

請問梯度下降可以用在非線性y=axe^bx 這一個嗎
現在有資料點，想辦法找出a和b
不知道各位大大有沒有範例 不能使用模組來算，網路上找不到範例
不知道有沒有大大可以指點迷津


標題:Python爬取證交所資料製圖出現return self._engine.get_loc(key)問題
標籤:return self._engine.get_loc(key) python3 

小弟有個問題，找了一陣子還是找不出問題，也上網找了還是沒有明確答案...
我希望從證交所將每日大盤資訊爬下來
import time
crawl_date = datetime(2019,11,1) # start_date

for i in range(31): 
    crawl_date -= timedelta(1)
    crawl_date_str = datetime.strftime(crawl_date, '%Y%m%d')
    res = requests.get('https://www.twse.com.tw/exchangeReport/BFIAMU?response=json&date=' + crawl_date_str+'&_=1576056207631')
    
    jres = json.loads(res.text)
    
    if(jres['stat']=='OK'):
        print(crawl_date_str, ': crawling data...')
       
        df_temp = pd.DataFrame(jres['data'],columns=jres['fields'])
        
        row_data = list(df_temp['漲跌指數'])
        row_data.append(crawl_date_str)
        df.loc[len(df)] = row_data #用loc指令，把資料(row_data)傳進df指定的位置，df的指定位置就是用len(df)，也就是df中row的長度
    else:
        print(crawl_date_str, ': no data')
        
    time.sleep(5) 
df = df.reset_index(drop=True)

在此之前我已先抓一日資料，並以該日資料的名稱建置DataFrame的表頭
import requests
import json
import pandas as pd
res = requests.get('https://www.twse.com.tw/exchangeReport/BFIAMU?response=json&date=20191209&_=1576056207631')
jres = json.loads(res.text)
df_temp = pd.DataFrame(jres['data'],columns=jres['fields'])
column_list = list(df_temp['分類指數名稱'])
column_list.append('date')
df = pd.DataFrame(columns=column_list)

我已把資料型態改了
df = df.astype(float)
df.dtypes

我想畫個圖
import matplotlib.pyplot as plt
from matplotlib.font_manager import FontProperties
plt.rcParams['font.sans-serif'] = ['simhei']
plt.rcParams['axes.unicode_minus'] = False
plt.style.use('ggplot')

%matplotlib inline

plt.figure(figsize=(10,8))
plt.plot(df["食品類指數"])

出現以下訊息
KeyError                                  Traceback (most recent call last)
/anaconda3/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2656             try:
-> 2657                 return self._engine.get_loc(key)
   2658             except KeyError:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: '食品類指數'

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
<ipython-input-29-16cef854be62> in <module>
      1 #df['水泥類指數'].plot(figsize=(10,8))
      2 plt.figure(figsize=(10,8))
----> 3 plt.plot(df["食品類指數"])
      4 #df['食品類指數'].plot(figsize=(10,8))
      5 #df.plot(kind='line',title='折線圖',figsize=(10,8))

/anaconda3/lib/python3.7/site-packages/pandas/core/frame.py in __getitem__(self, key)
   2925             if self.columns.nlevels > 1:
   2926                 return self._getitem_multilevel(key)
-> 2927             indexer = self.columns.get_loc(key)
   2928             if is_integer(indexer):
   2929                 indexer = [indexer]

/anaconda3/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   2657                 return self._engine.get_loc(key)
   2658             except KeyError:
-> 2659                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   2660         indexer = self.get_indexer([key], method=method, tolerance=tolerance)
   2661         if indexer.ndim > 1 or indexer.size > 1:

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: '食品類指數'

找了好久實在找不出哪裡出錯，請教各位高手，能否協助解答


標題:python 如何用for循環重複公式呢
標籤:python linebot for 

小弟初學者
最近想用python寫個Line Bot
目前遇到的狀況是
想看數據庫有幾筆資料 就創造出幾個CarouselColumn
原本是想用 col = str("CarouselColumn....")
再用columns=[eval(col)] 把文字轉回公式
但是頻頻報錯
又找不到原因
想請各位大神協助
    carousel_template_message = TemplateSendMessage(
        alt_text='目錄',
        template=CarouselTemplate(
            columns=[
                CarouselColumn(
                    thumbnail_image_url='link',
                    title='選擇服務',
                    text='請選擇',
                    actions=[
                        URIAction(
                            label='test',
                            uri='test'
                        ),
                        URIAction(
                            label='test2',
                            uri='test2'
                        ),
                        URIAction(
                            label='test3',
                            uri='test3'
                        )
                    ]
                )
            ]
        )
    )

    line_bot_api.reply_message(event.reply_token, carousel_template_message)



標題:如何利用scrapy request 中的callback函數回傳布林值？
標籤:scrapy python requset 

run = scrapy.Request('https://httpbin.org/ip',callback=self.proxy_check_available, meta=meta, dont_filter=True,errback = lambda x: self.download_errback(x,i['proxy']))

def proxy_check_available(self, response):
        json_data = json.loads(response.text)['origin']
        print(json_data)
        proxy_ip = response.meta['_proxy_ip']+', '+response.meta['_proxy_ip']
        print('proxy_ip:'+proxy_ip)
        if proxy_ip == json.loads(response.text)['origin']:
            return True
        else:
            return False

我希望能夠把True或False的值回傳到第一個function
想請問應該如何呼叫？
網路上查好像只查得到由第一個function傳值給callback function
卻沒有倒過來的例子。


標題:Pandas如何合併去重之外同時判斷被去除的欄位大小？
標籤:python python 3 python3 pandas pandas.dataframe 

想問一下Pandas在處理去重合併的同時, 有沒有辦法依據某個欄位的值來決定留哪筆資料？
例如：
   name video_name second
0  john      1.mp4     55
1  john      1.mp4     88
2  jonh      2.mp4     13
3  kate      1.mp4     33


我想要合併john在同一個影片底下並只留下最大second的那筆資料
等於name跟video_name做合併, 並依據second大小來決定去重的單一資料.
結果如下：
   name video_name second
0  john      1.mp4     88
1  jonh      2.mp4     13
2  kate      1.mp4     33

有辦法做到嗎？還是說有什麼關鍵字方向可以去研究
謝謝各位


標題:python string[]使用問題請教
標籤:python 

使用python 3.6 64BIT ，pychram 2019.3版
1.參考以下範例
https://ithelp.ithome.com.tw/articles/10193566
text = "aaabbccdddd"
但 text[2:3] 不是//輸出ab
卻只輸出a
我另外參考其他範例


另外，數字型態
pepple=100L，
卻出現 L 是 SyntaxError: invalid syntax
那 Long該如何表示
THX


標題:tensorflow的CNN 錯誤問題
標籤:tensorflow keras cnn nn python3 

import tensorflow as tf
from keras.datasets import mnist
import numpy as np

class MNISTLoader():
    def __init__(self):
        mnist = tf.keras.datasets.mnist
        (self.train_data,self.train_label),(self.test_data,self.test_label) = mnist.load_data()
        # MNIST中的圖像默認為uint8（0-255的數字）。以下代碼將其歸一化到0-1之間的浮點數，並在最後增加一維作為顏色通道
        self.train_data = np.expand_dims(self.train_data.astype(np.float32)/255.0,axis=-1) # [60000, 28, 28, 1]
        self.test_data = np.expand_dims(self.test_data.astype(np.float32)/255.0,axis=-1) # [10000, 28, 28, 1]
        self.train_label = self.train_label.astype(np.int32) # [60000]
        self.test_label = self.test_label.astype(np.int32) # [10000]
        self.num_train_data,self.num_test_data = self.train_data.shape[0],self.test_data.shape[0]

    def get_batch(self, batch_size):
    # 從資料集中隨機取出batch_size個元素並返回
        index = np.random.randint(0, np.shape(self.train_data)[0], batch_size)
        return self.train_data[index,:],self.train_label[index]

class CNN(tf.keras.Model):
    def __init__(self):
        super().__init__()
        self.conv1 = tf.keras.layers.Convolution2D(
            filters = 32,         # 卷積層神經元（卷積核）數目
            kernel_size = [5,5],   # 感受野大小
            padding='same',       # padding策略（vaild 或 same）
            activation=tf.nn.relu # 激活函數
        )
        self.pool1 = tf.keras.layers.MaxPool2D(pool_size = [2, 2],strides = 2)
        self.conv2 = tf.keras.layers.Convolution2D(
            filters = 64,         # 卷積層神經元（卷積核）數目
            kernel_size = [5,5],   # 感受野大小
            padding='same',       # padding策略（vaild 或 same）
            activation=tf.nn.relu # 激活函數
        )
        self.pool2 = tf.keras.layers.MaxPool2D(pool_size = [2, 2],strides = 2)
        self.flatten = tf.keras.layers.Reshape(target_shape=(7 * 7 *64,))
        self.dense1=tf.keras.layers.Dense(units=1024, activation=tf.nn.relu)
        self.dense2=tf.keras.layers.Dense(units=10)
    
    def call(self, inputs):
        x = self.conv1(inputs)     # [batch_size, 28, 28, 32]
        x = self.pool1(x)          # [batch_size, 14, 14, 32]
        x = self.conv2(x)          # [batch_size, 14, 14, 64]
        x = self.pool2(x)          # [batch_size, 7, 7, 64]
        x = self.flatten(x)        # [batch_size, 7 * 7 * 64]
        x = self.dense1(x)         # [batch_size, 1024]
        x = self.dense2(x)         # [batch_size, 10]
        output = tf.nn.softmax(x)
        return output
    
num_epochs = 5
batch_size = 50
learning_rate = 0.001
model = CNN()  #It will be trained!!
data_loader = MNISTLoader()
optimizer = tf.keras.optimizers.Adam(learning_rate = learning_rate) #10000/(50*100)=20
num_batches = int(data_loader.num_train_data // batch_size * num_epochs) #//整數除

for batch_index in range(num_batches):
    X, y = data_loader.get_batch(batch_size) #X data Y label 0 ~ 9
    with tf.GradientTape() as tape:
        y_pred = model(X)
        loss = tf.keras.losses.sparse_categorical_crossentropy(y_true = y , y_pred = y_pred)
        loss = tf.reduce_mean(loss)
        print("batch %d: loss %f" %(batch_index , loss.numpy()))
    # TensorFlow自動計算損失函數關於自變數（模型參數）的梯度
    grads = tape.gradient(loss, model.variables)
    # TensorFlow自動根據梯度更新參數
    optimizer.apply_gradients(grads_and_vars=zip(grads, model.variables))
    
sparse_categorical_accuracy = tf.keras.metrics.SparseCategoricalAccuracy()
num_batches = int(data_loader.num_test_data // batch_size)
for batch_index in range(num_batches):
    start_index, end_index = batch_index * batch_size, (batch_index + 1) * batch_size
    y_pred = model.predict(data_loader.test_data[start_index:end_index])
    sparse_categorical_accuracy.update_state(y_true = data_loader.test_label[strat_index: end_index], y_pred = y_pred)
print("test accuracy: %f" % sparse_categorical_accuracy.result())

**UnknownError:**Failed to get convolution algorithm. This is probably because cuDNN failed to initialize, so try looking to see if a warning log message was printed above. [Op:Conv2D]
請問會是cuda+cuDNN+TensorFlow的版本匹配不一致嗎
目前我tensorflow非GPU版:2.0.0
keras:2.2.4
cudnn:7.6.4
CUDA:10.0


標題:scrapy設定middleware後主程式無法執行
標籤:scrapy python middlewares 

如題
settings.py
DOWNLOADER_MIDDLEWARES = {
    'get_proxy.middlewares.ProxyMiddleware' :740
}

ITEM_PIPELINES = {
    'get_proxy.pipelines.GetProxyPipeline': 300,
    'get_proxy.pipelines.MongoPipeline': 400
}

middleware.py
from scrapy import signals
from scrapy.downloadermiddlewares.httpproxy import HttpProxyMiddleware
from collections import defaultdict
from scrapy.exceptions import NotConfigured
import json
import random
from fake_useragent import UserAgent

class ProxyMiddleware(object):

    def process_request(self,request,spider):
        #request對象加上proxy
        #每次爬蟲訪問網頁之前執行
        proxy=self.get_random_proxy()
        print('Request ip:'+proxy)
        request.meta['http_proxy']=proxy

    def get_random_proxy(self):
        #隨機讀取proxy
        import pymongo
        client = pymongo.MongoClient(host='localhost', port=27017)
        db = client.ip_proxy_pool  # 資料庫
        collection = db.pool  # 資料表
        get_num=0
        count=collection.find({'scheme':{'$in':['https']}}).count()
        print('目前還有:',count)
        # -----此部分需增加當沒取得到ip時需要啟動爬取ip程式-----
        while get_num==0:
            result = collection.aggregate([{'$sample': {'size': 1}}])
            for i in result:
                proxy=i['proxy']
                run=self.check_proxy(proxy)
                if run==True:
                    get_num+=1
                    return proxy
                else:
                    self.del_proxy(proxy)

    def check_proxy(self,proxy):
        from bs4 import BeautifulSoup
        import requests
        import random
        proxy = proxy.split('://')[1]
        proxies = {
            'http': 'http://' + proxy,
            'https': 'https://' + proxy,
        }
        headers = {'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36'}
        showmyip = 'https://www.showmyip.gr/'
        try:
            htmlfile = requests.get(showmyip, headers=headers, proxies=proxies, timeout=random.randint(4,6))
            objSoup = BeautifulSoup(htmlfile.text, 'lxml')
            objTag = objSoup.find('div', 'starter-template container')
            myip = objTag.find('div', 'col-md-6 col-sm-12').find('h2').find('span').text.strip()
            print('ShowMyIP：', myip)
            if myip in proxy:
                print('代理成功')
                return True
            else:
                print('代理失敗')
                return False
        except requests.exceptions.ConnectionError as e:
            print('Error', e.args)
            return False

    def del_proxy(self,proxy):
        import pymongo
        client = pymongo.MongoClient(host='localhost', port=27017)
        db = client.ip_proxy_pool  # 資料庫
        collection = db.pool  # 資料表
        collection.remove({'proxy': proxy})
        print('已刪除：', proxy)


主程式是proxy_example.py
class ProxyExampleSpider(scrapy.Spider):
    name = 'proxy_example'
    allowed_domains = ['www.us-proxy.org']
    start_urls = ['http://www.us-proxy.org/']

    # def start_requests(self):
    #     yield scrapy.Request('http://www.us-proxy.org/', dont_filter=True)

    def parse(self, response):
    ...

執行scrapy crawl proxy_example後卻只會執行middlewares的內容
請問這個狀況是QQ？


標題:javascript 如何取得python執行結果後的值
標籤:javascript python html 

請教各位大大，需求是javascript執行本地client端電腦的python檔，把執行後的值顯示在網頁的textbox裡面，我卡在怎麼把執行後的值顯示在網頁的 textbox裡面或者是 段落裡，附上我的程式碼與執行結果。
html:
script type="text/javascript"
var cc="C:/Python25/test.py";
    function start(strPath){

        var   objShell   =   new   ActiveXObject("wscript.shell");
       objShell.Run(strPath) ;
       
        //objShell   =   null;
    	
  }

       var y=document.getElementById("demo");
    	y.innerHTML=start(cc);
script

body:
body
請輸入要執行的程式路徑：
p id="demo"> /p
input type="button" value="SHOW" onclick=""
body
python:
-- coding: utf-8 --
print('HI')
#import serial
#import sys
#ser = serial.Serial('COM1', 9600, timeout=0.5)
#ser.read(1)  # 小括號內可以填入一次要讀取的byte數
#data=ser.readline()  # 讀取一列資料直到換行符號
#print data
#ser.close()
python執行結果:

網頁執行結果:

以上


標題:爬蟲小問題
標籤:python爬蟲 


如圖中 印出後會是沒整理過的原始碼 請問若我想弄成好檢視的話需怎麼做
而下方則會有報錯 似乎是名叫html的變數和find_all有衝突 請問該如何改善
麻煩各位大大了 python爬蟲


標題:關於python proxy設置問題
標籤:python3 scrapy proxy ip 

目前正在自製一個IP池，但在驗證IP時使用了兩種方法，卻發現兩種方法得出的結果會不一樣！（方法1驗證成功，方法2卻失敗）
想請各位大大看一下是哪邊有問題<(_ _)>
方法1:
def parse(self, response):
...
  meta = {
    'port': port,
    'proxy': proxy,
    'dont_retry': True,
    'download_timeout': 5,
    '_proxy_scheme': scheme,
    '_proxy_ip': ip,
    'update': update
    }
  yield scrapy.Request('https://httpbin.org/ip',callback=self.proxy_check_available, meta=meta, dont_filter=True,errback = lambda x: self.download_errback(x,meta['proxy']))

def proxy_check_available(self, response):
  json_data = json.loads(response.text)['origin']
  proxy_ip = response.meta['_proxy_ip']+', '+response.meta['_proxy_ip']
  item = GetProxyItem()
  if proxy_ip == json.loads(response.text)['origin']:
    item['scheme'] = response.meta['_proxy_scheme']
    item['proxy'] = response.meta['proxy']
    item['port'] = response.meta['port']
    item['update'] = response.meta['update']
    yield item

方法2:
url = 'https://httpbin.org/ip'
headers = {
          "User_Agent" : "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/22.0.1207.1 Safari/537.1"
          # "Referer" : "http://www.xicidaili.com/nn/1"
        }
res = requests.get(url,proxies=proxies,headers=headers)
json_data = json.loads(res.text)['origin']
if proxy_ip == json_data:
  print('pass : '+ x['proxy'])
else:
  print('delete : ' + x['proxy'])



標題:Python Singleton的class 內置換屬性會造成記憶體無法回收
標籤:django uwsgi python 3 python python3 

現在我有一個singleton的架構的class如下
我到時候會透過reset的function去刷新其屬性
不過我發現我每更新一次他記憶體佔用就會上升並且不會釋放
def singleton(clz):
    instances = {}
    
    def getinstance(*args, **kwargs):
        if clz not in instances:
            instances[clz] = clz(*args, **kwargs)
        return instances[clz]
    return getinstance

def get_data(a=1, b=2, c=3, d=4):
    return a, b, c, d

@singleton
class MyClass:
    a, b, c, d = get_data()  
    
    def reset_data(self):
        self.a, self.b, self.c, self.d = get_data(4, 3, 2, 1)

當我
import MyClass

c = MyClass()

c.reset_data()

一直重複執行reset_data, 我記憶體就會一直leak...
不知道是哪邊理解錯誤？


標題:[已解決]Flask Websocket無法從其他伺服器送過來
標籤:python flask websocket web ubuntu 

flask新人問題, 想從不同的伺服器用Websocket收發資料,
主要的Flask Server程式部分:
from flask_socketio import SocketIO
app = Flask(__name__)
app.config.from_object(Config)

@socketio.on('for_test')
def for_test(test):
    print("test")
    
if __name__ == '__main__':
    socketio.run(app, host='0.0.0.0', port=5002, use_reloader=True, debug=True)

test.html:
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
    var socket = io.connect('http://' + '192.168.1.183' + ':' + '5002');
    $('#aa').click(function(event) {
      socket.emit('for_test');
    });       

<!-- Socket on -->
    
    socket.on('state_message', function(data) {
      console.log(data);
      var $textarea = $('#state_message');
      $textarea.val(data);
    })    
  });    

<button id="aa" class="btn btn-primary btn-lg col-xs-3 col-xs-offset-3">aa</button>

按下'aa按鈕'後會'socket.emit'到'for_test', 然後Server會print出"test".
在這邊將var socket中的IP設為0.0.0.0或192.168.1.183皆可正常執行.
但想從其他伺服器送過來的時候卻都沒反應, 例如把上面這些整個複製、準備另外一份如下:
from flask_socketio import SocketIO
app = Flask(__name__)
app.config.from_object(Config)

@socketio.on('for_test')
def for_test(test):
    print("test")
    
if __name__ == '__main__':
    socketio.run(app, host='0.0.0.0', port=5003, use_reloader=True, debug=True)

在這邊只改了Port到5003, 然後網頁端完全一樣, 理想中的結果是在Port 5003網頁中的'aa按鈕'後, 5002會收到.
但測試結果卻沒有反應, 不清楚是哪裡寫錯, 還是對Websocket的用法理解錯誤了?
(這些都在架在同一台ubuntu伺服器上, 應該沒有被防火牆擋住之類的問題?)


現在狀況像這張圖, 全部都在同一台server進行. 在5002和5003各建一個flask server, 各自的server和web的websocket功能都正常, 但要是把位置改成另外一台, 例如5002送到5003(這樣在頁面需要同時建立5002:5002和5002:5003嗎?我的理解是只需要5002:5003), websocket會沒反應

後來找到問題了

Cross-Origin Controls
For security reasons, this server enforces a same-origin policy by default. In practical terms, this means the following:
If an incoming HTTP or WebSocket request includes the Origin header, this header must match the scheme and host of the connection URL. In case of a mismatch, a 400 status code response is returned and the connection is rejected.
No restrictions are imposed on incoming requests that do not include the Origin header.
If necessary, the cors_allowed_origins option can be used to allow other origins. This argument can be set to a string to set a single allowed origin, or to a list to allow multiple origins. A special value of '*' can be used to instruct the server to allow all origins, but this should be done with care, as this could make the server vulnerable to Cross-Site Request Forgery (CSRF) attacks.

flask預設不能跨域

設為cors_allowed_origins='*'

就可以了


標題:python 打包完exe 會閃退
標籤:python pyinstaller 

問題如題
我是用pyinstaller打包的
有上網查到也要下載pywin32
我也都有下載了
下面是我在cmd顯示的結果

我程式碼有這些import
import datetime
import time
import calendar
import json
import pymysql
import requests

我是有把requests、pymysql 的包文件丟到我存的python中
其他沒有看到是包文件，所有就沒丟上去了
我有打input
enter也是跳掉
想請問還有甚麼方法可以解決閃退的問題?
或是有其他方法可以打包成exe檔
我主要要利用工作排程器讓python定時執行結果
還是不需要讓exe成功開啟也可以成功運行?


標題:請教python list問題
標籤:python python系列文章 

初學拍森，請教各位大師問題><
輸入一個數字 n，隨後輸入 n 個正整數組成一個 list，進行排序。分別統計排序完的
list 中從小到大每一個數字出現的次數，將這些次數組成一個新的 list 並輸出
輸入範例：
5
3
1
2
1
2
輸出範例：
[2, 2, 1]
只寫出輸入的部分:
list=[]
n=eval(input())
for i in range(n):
....num=eval(input())
....list.append(num)


標題:python 爬蟲
標籤:python3 網頁爬蟲 

我目前要擷取一些空氣的資料，然後我使用
https://pm25.lass-net.org/data/history.php?device_id=74DA38EBF902
裡面的資料，我查詢他的html架構只有 pre

起初使用BeautifulSoup，可以把全部的東西抓下來，可是不知道要怎麼抓特定的值
url = requests.get("https://pm25.lass-net.org/data/history.php?device_id=74DA38EBF902")
soup = BeautifulSoup(url.text,'html.parser')
ele = soup.find('pre')
print(ele)

會顯示None，把'pre'改成'a'、'head'，都是None，雖然本來他html的架構就沒有其他的
想請問有甚麼方法可以用爬蟲把一些特定的訊息抓下來
像是s_h0、s_t0


標題:[python] ping ip 取得延遲時間
標籤:python ping 

有辦法藉由python取得延遲時間如下斜體部分
目前只會做到ping host取得狀態
import os
hostname = "google.com" #example
response = os.system("ping -c 1 " + hostname)

if response == 0:
  print(hostname, 'is up!')
else:
  print(hostname, 'is down!')

想要把延遲時間紀錄於純文字中
謝謝了
Ping 8.8.8.8 (使用 32 位元組的資料):
回覆自 8.8.8.8: 位元組=32 時間=12ms TTL=52
回覆自 8.8.8.8: 位元組=32 時間=3ms TTL=52
回覆自 8.8.8.8: 位元組=32 時間=2ms TTL=52
回覆自 8.8.8.8: 位元組=32 時間=2ms TTL=52


標題:python 股價累積報酬
標籤:python python畫股票 

a = np.random.randn(100)*0.02
-a 為 報酬率
Ex A = a[0],(1+a[0])*(1+a[1])-1,.....
要求累積報酬率的話，是需要用迴圈嗎
不知道該如何表示


標題:pandas concat在讀取資料時出現KeyError
標籤:pandas python concat 

在解析pdf檔的內文時，使用了tabula + pandas模組的concat
但在解析concat出來的值時出現KeyError
#pdf 轉文字
try:
        df=tabula.read_pdf(input_path=pdffile, output_format='dataframe', lattice=True, multiple_tables=True, pages="all", guess=False,
                                   encoding='utf-8')
        df = pd.concat(df)
    except Exception as e:
        print(e)
    df.to_csv("outing.csv", index = None, header=True)
    get_sh_content(df)

#讀取
def get_sh_content(df):
        ans = []
        print(len(df.index))
        df.fillna(0)
        print(df[df.columns[0]][len(df.index)])

會出現error：
File "test.py", line 44, in get_sh_content
    print(df[df.columns[0]][len(df.index)])
  File "C:\Users\user\Anaconda3\lib\site-packages\pandas\core\series.py", line 1068, in __getitem__
    result = self.index.get_value(self, key)
  File "C:\Users\user\Anaconda3\lib\site-packages\pandas\core\indexes\base.py", line 4730, in get_value
    return self._engine.get_value(s, k, tz=getattr(series.dtype, "tz", None))
  File "pandas\_libs\index.pyx", line 80, in pandas._libs.index.IndexEngine.get_value
  File "pandas\_libs\index.pyx", line 88, in pandas._libs.index.IndexEngine.get_value
  File "pandas\_libs\index.pyx", line 126, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 152, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "pandas\_libs\index_class_helper.pxi", line 122, in pandas._libs.index.Int64Engine._maybe_get_bool_indexer
KeyError: 5237

請問是因為當中有NA值還是其他問題會造成呢？
嘗試將資料輸出成csv檔查看，發現空值很多，試過用fillna替換，也沒辦法解決。
懇求會的大大提點！


標題:Python 如何帶著套件在別的電腦執行
標籤:python3 

Hi 如題
我在程式中使用了一些套件, 如何移植到別台電腦環境執行, 只能也先安裝嗎?


標題:scrapy中如何設定條件使爬蟲1呼叫爬蟲2執行
標籤:scrapy python 

如題，目前有兩隻獨立的spider，希望將他們做合併。
但是卻沒有頭緒要怎麼設定才讓爬蟲1號在未成功爬取時，執行爬蟲2號並獲得其回傳值。
還請各位大能幫幫忙，給點提示（合手）


標題:圖片識別 (分析2張圖片是否相似)
標籤:圖像識別 sift python3 

請教各位使用過opencv與影像識別的先進。
想要分析一張書籍封面是否在其他照片中有出現.
目前僅使用過js的aHash,dHash,pHash代碼判斷識別
(還沒安裝過opencv、python)
因照片拍攝的角度與被景物關係，誤判比例很高。
不知使用sift演算法是否判別率比較高。
還是有其他的演算法判斷?


標題:python 如何使用crcmod算出CRC
標籤:python3 crc crcmod 

目前試著使用指定的多項式算出CRC
多項式:x8 + x7 + x6 + x5
參考網路上用法, 程式碼部分:
    words = b'\x01\x02\x03'
    crc_func = crcmod.mkCrcFun(0x170, rev=True, initCrc=0xFFFF, xorOut=0x0000)
    print(crc_func(words))

輸出10, 要如何知道是正確的? 是否有網頁板可驗證


標題:Python 小數位數
標籤:python 

請問python要如何獲取固定小數位數,
比如0.1234567
我想取0.123而已,但是不需要四捨五入。
謝謝


標題:python中使用sql select如何抓取資料同時抓取欄位名稱
標籤:python sql mysql 

再寫python時使用sql
SELECT * FROM TABLE_NAME
print出來的只有所有欄位的data
要如何同時取得欄位名稱及data，並關聯起來做應用呢?
(如想要print出某個欄位的值)


標題:關於Python相關問題 
標籤:python系列文章 python3 python 

大家好，我是最近在自學python的新手
都會在網路抓一些範例下來練習
目前遭遇到一個問題，就是突然只要import某些文件
就會跑出錯誤訊息
想請問大家是不是也有遇過相同問題
有上網爬過文，但是一直找不到解決方案
因此上來尋求大家的幫助
謝謝大家~
下方錯誤的圖片給大家參考

目前我使用的是anaconda3(64位元)，不知道這會不會有影響?


標題:php執行python時無法載入import
標籤:php python import pandas keras 

我在使用php執行python時發現無法載入一些套件
不過又有一部份套件是可以載入的
這是python import的程式碼
#無法載入的部分
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import MinMaxScaler
from keras.models import Sequential
from keras.layers import LSTM, Dense,Dropout
from plotly.graph_objs import Scatter, Layout
from plotly.offline import plot

#可以載入的部分
import argparse

這是php執行python部分的程式碼
exec("C:/Users/user/Anaconda3/python.exe py/a9.py 2>&1", $A, $ret);
print_r($A);
print_r($ret)

這是顯示的錯誤訊息
Array (
[0] => Traceback (most recent call last):
[1] => File "py/a9.py", line 6, in
[2] => import pandas as pd
[3] => File "C:\Users\user\Anaconda3\lib\site-packages\pandas_init_.py", line 17, in
[4] => "Unable to import required dependencies:\n" + "\n".join(missing_dependencies)
[5] => ImportError: Unable to import required dependencies:
[6] => numpy: DLL load failed: �䤣����w���ҲաC ) 1
不清楚為甚麼有些套件能夠載入 有些卻不行
想問問為甚麼會這樣?
目前查的結果是偏向路徑問題
還在查怎麼解決
想問問大大們有沒有碰過這類似的問題..
順便想問問我在使用php執行python時
為甚麼我在cmd能夠直接使用 python XX.py 來執行
但是在php中卻無法直接使用這樣的寫法執行python而是必須使用路徑的方式呢?


標題:Python 閏年計算問題
標籤:python 

想請問各位，以下計算閏年的寫法是否有錯誤??
year = eval(input())
if year % 4 ==0 and (year % 100 !=0 or year % 400==0):
print('It is a leap year')
else:
print('It is not a leap year')
謝謝~~~


標題:python 連 mysql
標籤:python3 mysql 

目前寫python 要連接mysql

不過都會顯示錯誤，不能連接上
我有把mysql的程式開起來
command line client 也有建立一個database test
錯誤如下:



標題:後端語言選擇與未來實習工作
標籤:c# php python intern backend 

大家好，小弟我目前是大二資管系的學生，由於希望大四下學期能夠去校外實習，現在有些問題想要詢問。
由於現在學校有開始丟一些實習的資訊，能夠實習的公司目前都是以C#與JAVA為主，但是由於目前想要另外學習新的語言以便做專題需要，希望各位大大可以給我一點意見。
請問一下就目前的後端趨勢Python或Php建議先學哪一個呢，當然我會先去補足最基本的前端知識，我有在網路上爬了一些文章大家是說PHP相對來說後端工程師的工作會比Python還多，也有一些人說PYTHON後端的工作會漸漸地比PHP多。
爬文的結果是PHP只能比較歸類在網頁這一環，但Python可以做網頁爬蟲資料探勘等一些實際的使用，如下是我自認為的技能樹點法，希望各位能給我一些建議，對於未來工作與實習上的機會多寡，如有錯誤還麻煩各位大大指導。
後端：Php+MySQL+Laravel
後端：Python+Django+資料庫(比較不清楚最常搭配的是哪一個)
後端：Python+FLASK+資料庫(比較不清楚最常搭配的是哪一個)
最後想要詢問大家如果學習一個新的語言，大家會去購買線上課程來學習還是以書本以及網路上的文章教導為主呢?
謝謝各位願意看完整篇文章!!!


標題:[Python] Facebook粉絲團 自動排程發文 自己看得到貼文 粉絲看不到
標籤:python facebook 檔案上傳 影片 爬蟲 

問題
本人最近寫了一個FB自動排程發文
也如期把功能完成
FB粉絲專業上功能正常
也如期發布影片
自己看或是切換粉絲觀看角度 也有貼文
但是我真的切換另一個帳號時
完全沒有程式排程發布的文章
我接著試試看使用普通手動發文
卻可以看到
是不是程式發布會被限制發文
才會只有我自己看得到 別人或是粉絲看不到貼文
已排程貼文

顯示有幾則即將發布

使用程式發布 並且 是全球都可以瀏覽

程式
程式碼部分我把user_id跟token先刪掉一部分
可替換你的粉絲團id跟token
這裡是多文章傳入uploadVideo
會自動分隔時間去排程
FB SDK上傳的資料如下
uploadTimeStamp 是時間戳
#### 上傳資訊
	m = {'description': title,
	      'title': title,
	      'published':"false",
	      'scheduled_publish_time' : uploadTimeStamp }

完整程式碼
import requests
import time
import json
def uploadVideo(title,id):
	# 基本設置
	_user_id = '52484313'    # user id (ex. 1603333222111000)
	_token = 'EAAOJXyUZAtxkBAOo3UIHL4b9zLO17sBhN6RlbQa9ZAaAXbzLO6b8ZAb81NxjSSVwcSOKUuAHLSsux331ohqL1fMyJdzIK4D55ZBwUxSyma5zgjg4XunQJ1dn0Oin7qBJ28oczZBcnONXbWBXCZARYUJQRUuAuLeWg7OFM9JsOSkQZDZD'    # Graph User API Token
	url = 'https://graph-video.facebook.com/52484313/videos?access_token='+_token
	files = {
	    'file': open(id + '.mp4', 'rb')
	}

	# 時間戳
	timeStamp = int(time.time())  #這是時間戳轉換為其他日期格式, 如:"%Y-%m-%d %H:%M:%S"
	uploadTimeStamp = timeStamp

	# 讀取本地時間資料
	data = {}
	data['data'] = []
	with open('timeStamp.txt') as json_file:
		data = json.load(json_file)

	# 判斷最後時間使否太舊
	if len(data['data']) == 0:
		uploadTimeStamp = timeStamp
	else:
		print(data['data'][0]['lastTime'])
		print("VS")
		print(timeStamp)
		if data['data'][0]['lastTime'] > timeStamp:
			uploadTimeStamp = data['data'][0]['lastTime']
		else:
			uploadTimeStamp = timeStamp

	uploadTimeStamp = uploadTimeStamp + 500
	print(uploadTimeStamp)
	# 儲存最後時間
	data = {}
	data['data'] = []
	data['data'].append({
		'lastTime' : uploadTimeStamp,
	})
	with open('timeStamp.txt', 'w') as outfile:
		json.dump(data, outfile)

	# 上傳資訊
	m = {'description': title,
	      'title': title,
	      'published':"false",
	      'scheduled_publish_time' : uploadTimeStamp }
	response = requests.post(url, data=m, files=files).text
	print(response)

還是程式發文是要審核的
要審核過才可以發文


標題:python 的 requests  --- 已搞定 ...
標籤:python xml json requests 

看原廠範例是 shell
#!/bin/bash
username="example_username"
apiKey="example_apiKey"
date=`env LANG="en_US.UTF-8" date -u "+%a, %d %b %Y %H:%M:%S GMT"`
password=`echo -en "$date" | openssl dgst -sha1 -hmac $apiKey -binary | openssl enc -base64`
curl -i --url "https://open.chinanetcenter.com/api/report/domainflow?datefrom=2017-11-07T00:00:00%2B08:00&dateto=2017-11-07T00:15:00%2B08:00&type=fiveminutes" \
-X "POST" \
-u "$username:$password" \
-H "Date: $date" \
-H "Accept: application/json" \
-d '<?xml version="1.0" encoding="utf-8"?>
<domain-list>
  <domain-name>www.example1.com</domain-name>
</domain-list>
'

試著換成 python ... 沒成功 出現 400 錯誤幫忙看是哪邊問題
import requests
import datetime
import hmac
import hashlib
import base64
username = "example_username"
apiKey= 'example_apiKey'
now = datetime.datetime.now()
nowTime = now.strftime('%a, %d %b %Y %H:%M:%S GMT')
nowTime_bytes = bytes(nowTime, encoding='utf-8')
value = hmac.new(apiKey, nowTime_bytes, hashlib.sha1).digest()
token = base64.b64encode(value).rstrip()
headers = {"Accept": "application/json",
           "Date": nowTime}
url = 'https://open.chinanetcenter.com/api/report/domainflow'
payload= {'datefrom':'2017-11-07T00:00:00%2B08:00',
          'dateto':'2017-11-07T00:15:00%2B08:00',
          'type': 'fiveminutes'}
xml = '<?xml version="1.0" encoding="utf-8"?>
 <domain-list>
   <domain-name>www.example1.com</domain-name>
 </domain-list>
 '

r = requests.post(url, headers=headers, auth=(username, token), data=xml,params=payload)
print (r.text)


輸出 {"code":"InvalidDatePeriod","message":"The date specified is invalid."}
不會改 ...
改好了 ... 原來是 %2B 改成 +
import requests
import datetime
import hmac
import hashlib
import base64
username = "example_username"
apiKey= 'example_apiKey'
now = datetime.datetime.now()
nowTime = now.strftime('%a, %d %b %Y %H:%M:%S GMT')
nowTime_bytes = bytes(nowTime, encoding='utf-8')
value = hmac.new(apiKey, nowTime_bytes, hashlib.sha1).digest()
token = base64.b64encode(value).rstrip()
headers = {"Accept": "application/json",
           "Date": nowTime}
url = 'https://open.chinanetcenter.com/api/report/domainflow'
payload= {'datefrom':'2017-11-07T00:00:00+08:00',
          'dateto':'2017-11-07T00:15:00+08:00',
          'type': 'fiveminutes'}
xml = '<?xml version="1.0" encoding="utf-8"?>
 <domain-list>
   <domain-name>www.example1.com</domain-name>
 </domain-list>
 '

r = requests.post(url, headers=headers, auth=(username, token), data=xml,params=payload)
print (r.text)

是參考
Convert curl syntax to Python, Ansible URI, Node.js, R, PHP, Strest, Go, Dart, JSON, Rust
https://curl.trillworks.com/


標題:使用python寫出knn算法
標籤:python tensorflow 


請問各位大大，要怎麼算出各英文單字他們之間的距離，
目前只有查到三維的並使用tf.form()函數，
並沒有2維x,y的範例，
懇請解答，感謝

之後有寫出程式碼(菜)，如有更好的寫法，可以在下面留言，謝謝
import math
from collections import OrderedDict

print('各item的top 3 neighbor:')
toDataFrame={}
for y in range(len(vectors)):
    distances = []
    distances_dict = {}
    three_item = []
    ##############使用 Euclidean distance
    for x in range(len(vectors)):
        if x==y:
            continue
        else:
            distance = vectors[y]-vectors[x]
            distances.append(math.sqrt( distance[0]*distance[0] + distance[1]*distance[1] ))

    ##################   

    # key為 index
    distances_dict = dict(zip(range(len(distances)), distances))
    
    #取出前 3 近的
    d_sorted_by_value = OrderedDict(sorted(distances_dict.items(), key=lambda x: x[1]))   
    d_sorted_by_value_three = [i for i in d_sorted_by_value.keys()][:3]
 
    #印出 前三 接近的
    for three in range(3):
        if d_sorted_by_value_three[three] >= y:
            three_item.append(w2v_df.word[d_sorted_by_value_three[three]+1])
        else:
            three_item.append(w2v_df.word[d_sorted_by_value_three[three]])
    toDataFrame[w2v_df.word[y]] = three_item
    
for x, y in toDataFrame.items():
  print(x, y)



標題:請教python 迴圈問題
標籤:python python系列文章 python 3 

撰寫一程式，已依迴圈輸入六個整數，計算其總和平均值，最終將這六個整數的總和以及平均數加以印出。
我寫的:
sum=0
for i in range(1,7):
....eval(input())
....sum=sum+i
ave=sum/i
print('sum=',end='')
print(sum,end=',')
print('ave=%d'%(ave))


標題:初學者json格式請教
標籤:json python3 

我從政府公開資訊網站抓資料
import json
import requests
res=requests.get('http://data.ntpc.gov.tw/api/v1/rest/datastore/382000000A-000221-001')

再load下來成為dictionary
result = json.loads(res.text)

結果如下
{'success': True,
'result': {'resource_id': '382000000A-000221-001',
'limit': 2000,
'total': 2000,
'fields': [{'type': 'text', 'id': 'district'},
{'type': 'text', 'id': 'rps01'},
{'type': 'text', 'id': 'rps02'},
{'type': 'text', 'id': 'rps03'},
{'type': 'text', 'id': 'rps04'},
{'type': 'text', 'id': 'rps05'},
{'type': 'text', 'id': 'rps06'},
{'type': 'text', 'id': 'rps07'},
{'type': 'text', 'id': 'rps08'},
{'type': 'text', 'id': 'rps09'},
{'type': 'text', 'id': 'rps10'},
{'type': 'text', 'id': 'rps11'},
{'type': 'text', 'id': 'rps12'},
{'type': 'text', 'id': 'rps13'},
{'type': 'text', 'id': 'rps14'},
{'type': 'text', 'id': 'rps15'},
{'type': 'text', 'id': 'rps16'},
{'type': 'text', 'id': 'rps17'},
{'type': 'text', 'id': 'rps18'},
{'type': 'text', 'id': 'rps19'},
{'type': 'text', 'id': 'rps20'},
{'type': 'text', 'id': 'rps21'},
{'type': 'text', 'id': 'rps22'},
{'type': 'text', 'id': 'rps23'},
{'type': 'text', 'id': 'rps24'},
{'type': 'text', 'id': 'rps25'},
{'type': 'text', 'id': 'rps26'},
{'type': 'text', 'id': 'rps27'}],
'records': [{'district': '土城區',
'rps01': '房地(土地+建物)',
'rps02': '新北市土城區大暖路61~90號',
'rps03': '57.58',
'rps04': '住',
'rps05': '',
'rps06': '',
'rps07': '1080603',
'rps08': '土地3建物1車位0',
'rps09': '全',
'rps10': '二層',
'rps11': '透天厝',
'rps12': '住家用',
'rps13': '加強磚造',
'rps14': '0641231',
'rps15': '94.5',
'rps16': '3',
'rps17': '1',
'rps18': '2',
'rps19': '有',
'rps20': '無',
'rps21': '8000000',
'rps22': '84656',
'rps23': '',
'rps24': '0',
'rps25': '0',
'rps26': '防火巷及頂樓增建。',
'rps27': 'RPRQMLMKQHOFFAF68CA'},
{'district': '板橋區',
'rps01': '房地(土地+建物)',
'rps02': '新北市板橋區重慶路93巷1~30號',
'rps03': '22.6',
'rps04': '商',
'rps05': '',
'rps06': '',
'rps07': '1080715',
'rps08': '土地1建物1車位0',
'rps09': '二層，陽台',
'rps10': '五層',
'rps11': '公寓(5樓含以下無電梯)',
'rps12': '住家用',
'rps13': '鋼筋混凝土造',
'rps14': '0690828',
'rps15': '99.05',
'rps16': '4',
'rps17': '3',
'rps18': '3',
'rps19': '有',
'rps20': '無',
'rps21': '12580000',
'rps22': '127007',
'rps23': '',
'rps24': '0',
'rps25': '0',
'rps26': '含增建或未登記建物。',
'rps27': 'RPVQMLMKQHOFFAF09CA'},
但我只想要 'records'內的資料，我下的指令如下
df2=pd.DataFrame()
for rd in df['records']:
    df2=df2.append(pd.Dataframe(rd))
df2

為何出現錯誤？
KeyError: 'records'


標題:python 爬蟲加入headers仍不work 
標籤:python 爬蟲 requests 動態網頁 

各位前輩大家好><
想要爬取goodinfo裡“股價日線圖”內的資訊
#-------------傳送門-------------#
https://goodinfo.tw/StockInfo/ShowK_Chart.asp?STOCK_ID=1101&CHT_CAT2=DATE
#-------------------------------#

得知檔案是使用canvas繪出

得知檔案是從中呼叫的
https://goodinfo.tw/StockInfo/ShowK_ChartData.asp?STOCK_ID=1101&STOCK_NM=%E5%8F%B0%E6%B3%A5&MARKET_CAT=%E4%B8%8A%E5%B8%82&CHT_NM=%E5%80%8B%E8%82%A1K%E7%B7%9A%E5%9C%96&CHT_CAT=DATE&SESSION_VAL=077%2E5778965

資料在javascript的函數裡

使用requests的get方法
並加入header
程式碼
header= {
        "user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.70 Safari/537.36"
,"cache-control": "private"
,"content-encoding": "gzip"
,"content-type": "text/html"
,"date": "Mon, 04 Nov 2019 07:33:39 GMT"
,"server": "Microsoft-IIS/10.0"
,"status": "200"
,"vary": "Accept-Encoding"
,"authority": "goodinfo.tw"
,"method": "GET"
,"path": "/StockInfo/ShowK_ChartData.asp?STOCK_ID=1101&STOCK_NM=%E5%8F%B0%E6%B3%A5&MARKET_CAT=%E4%B8%8A%E5%B8%82&CHT_NM=%E5%80%8B%E8%82%A1K%E7%B7%9A%E5%9C%96&CHT_CAT=DATE&SESSION_VAL=050%2E5607373"
,"scheme": "https"
,"accept": "*/*"
,"accept-encoding": "gzip, deflate, br"
,"accept-language": "zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7"
,"cookie": "CLIENT%5FID=20191013001631468%5F36%2E231%2E68%2E131; SCREEN_SIZE=WIDTH=1440&HEIGHT=900; _ga=GA1.2.93133782.1570897053; __gads=ID=3bf659387a560e46:T=1570897053:S=ALNI_Maxxp2EzIK3i9_a-5kLoTGzp6HiJw; _gid=GA1.2.284279775.1572778526; GOOD%5FINFO%5FSTOCK%5FBROWSE%5FLIST=20%7C2886%7C2227%7C2207%7C2308%7C6220%7C2732%7C8424%7C3557%7C2514%7C6119%7C2233%7C1418%7C3579%7C8464%7C9915%7C2463%7C6579%7C1704%7C2315%7C1101; SL_GWPT_Show_Hide_tmp=1; SL_wptGlobTipTmp=1"
,"referer": "https://goodinfo.tw/StockInfo/ShowK_Chart.asp?STOCK_ID=1101&CHT_CAT2=DATE"
,"sec-fetch-mode": "no-cors"
,"sec-fetch-site": "same-origin"
        }

res = re.get("https://goodinfo.tw/StockInfo/ShowK_ChartData.asp?STOCK_ID=1101&STOCK_NM=%E5%8F%B0%E6%B3%A5&MARKET_CAT=%E4%B8%8A%E5%B8%82&CHT_NM=%E5%80%8B%E8%82%A1K%E7%B7%9A%E5%9C%96&CHT_CAT=DATE&SESSION_VAL=050%2E5607373",headers = header)

res.encoding = "UTF-8"
print(res.text)

out:""

輸出是完全空白的！
請問我還需要加入哪些元素
才能得到此動態圖表的資訊呢？

另外我使用selenium的chromedriver後，用id查詢後得到的結果為這兩句話

如果解方式使用selenium，那麼我該如何做呢？！
感謝各位前輩大大指點迷津！


標題:獲取瀏覽器>開發者工具的任何資料
標籤:爬蟲 python chrome 

該如何讓程式讀取瀏覽器的開發者工具的任何資料?
我修正了問題的陳述方式，並且把歷史紀錄保留在了討論中


標題:Python用requsets爬蝦皮問題！
標籤:#python 3 #蝦皮 #requests #爬蟲 #python 

各位前輩好，小弟目前正在學習爬蟲，想使用requests去get網頁內的Preview,想要爬到商品名稱、圖片、價格等...像第一張圖一樣。
想爬的網址是https://shopee.tw/3C%E8%88%87%E7%AD%86%E9%9B%BB-cat.69

小弟目前已經找到資料來源了！

也透過Headers查看Request看可能需要那些參數

但是寫到程式碼卻沒有任何資訊..(以下是程式碼)
import requests

url = "https://shopee.tw/api/v2/search_items/?by=pop&fe_categoryids=69&limit=50&newest=0&order=desc&page_type=search&version=2"

path = "C:\Program Files (x86)\Google\Chrome\selenium_driver_chrome\chromedriver.exe"
driver = webdriver.Chrome(path)
driver.get(url)
Cookie = ';'.join(['{}={}'.format(item.get('name'), item.get('value')) for item in driver.get_cookies()])



header = {
    'cookie': Cookie,
    'if-none-match-': '55b03-634508b9798ba9f4e118b697a946c895',
    'referer': 'https://shopee.tw/3C%E8%88%87%E7%AD%86%E9%9B%BB-cat.69',
    'sec-fetch-mode': 'cors',
    'sec-fetch-site': 'same-origin',
    'User-Agent': "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.87 Safari/537.36",
    'x-api-source': 'pc',
    'x-requested-with': 'XMLHttpRequest',
    'Postman-Token': '68c324d7-4894-448a-a4db-9072b6bbcf0c',
    'Connection': 'keep-alive'
}


req = requests.get(url, header)
data = json.loads(req.text)
print(req.status_code)
print(req.request.headers)
print(data)

這是執行結果..
200 #status_code

#下面是request.headers的結果
{'User-Agent': 'python-requests/2.22.0', 'Accept-Encoding': 'gzip, deflate', 'Accept': '*/*', 'Connection': 'keep-alive'}
#下面是印的data的結果
{'show_disclaimer': None, 'query_rewrite': None, 'adjust': None, 'version': 'b1c94828d525e526ff969f451cc3ac33', 'algorithm': None, 'total_count': None, 'error': None, 'total_ads_count': None, 'nomore': None, 'price_adjust': None, 'json_data': None, 'suggestion_algorithm': None, 'items': None, 'reserved_keyword': None, 'hint_keywords': None}




標題:CentOS系統內個人帳號無法開啟Python  matplotlib的圖形視窗
標籤:centos 7 python3 python 圖形視窗 matplotlib 

如標題所述，Server工作環境為CentOS7，Python版本為3.6.5
其他使用者的Python再叫出其圖形視窗皆無問題，但唯有我的帳號無法叫出圖形視窗，但事實上我在使用非Python時，我的Xwindow是正常使用的，唯獨在Python上用各module的指令皆無法叫出其圖形
以下為其中一個例子，Code本身是沒什麼問題的，但偏偏無法顯現圖
from scipy import signal
import matplotlib.pyplot as plt
import numpy as np

fs = 10e3
N = 1e5
amp = 2 * np.sqrt(2)
noise_power = 0.01 * fs / 2
time = np.arange(N) / float(fs)
.
.
.
plt.pcolormesch(t, f, Sxx)
plt.ylabel('Frequency [Hz]')
plt.xlabel('Time [sec]')
plt.show()

正常來說應該會顯示出下面的圖

但實際上執行後卻沒有任何圖形出現

同樣一份Code在同一個Server不同帳號下卻能執行成功
請問各位前輩有誰能告訴我可能的問題出在哪嗎? (我有server root權限)
(我有爬文過，包括國外網站，但不知道是爬的方式不對或是太基本找不到類似情況)


標題:讀入data 到 array的方法 (初學者發問)
標籤:python 

請問大家有沒有簡單的方法可以將data檔讀入numpy的2D array中:
data檔是這樣:
1  :  100 200 300
2  :  101 201 301
...
檔案中有不要的 ":" .需要拿掉,我試了以下方法是可以的,不知道還有沒有其他簡潔的方法:
import numpy as np
import pandas as pd
df = pd.read_csv(filename, header=None, sep="\s+")
data=df.to_numpy(copy=True)
data2=np.delete(data,1,1)
這樣好像就可以得到純數字的2D array.
data2=[[1 100 200 300]
[2 101 200 300]
...
[             ]]
請問有其他簡單一點的寫法嗎?


標題:爬蟲問題 python
標籤:網路爬蟲 python3 問題 

最近需要空氣品質的資料
所以找了
https://pm25.lass-net.org/#apis
裡面有提供一些API
只是他的API需要先解壓縮才能有json檔
但是我目前卡在無法讀取壓縮檔的資料
import urllib
import gzip
import json
url = 'https://pm25.lass-net.org/data/last-all-airbox.json.gz'
f = gzip.open('last-all-airbox.json.gz','r')
jdata = f.read()
f.close()
data = json.loads(jdata)
data

會出現 No such file or directory: 'last-all-airbox.json.gz' 錯誤
請問有哪邊有問題?
last-all-airbox.json.gz 是壓縮檔的名子
還是有其他方法是可以把api 的json是壓縮檔用python讀取?


標題:Python Pandas 資料切割與複製!!
標籤:python pandas 資料切割 資料複製 資料處理 

小弟Python新手，請各位先進指導。
感謝!!

問題：
得獎專題共10組，每組可能1-5人。原始資料的示意如下：

預期的解決方式：
將小組成員切割成個別的得獎人，並在備註中註明與其他人合作。
如小組成員只有1人，則備註為空白。預期程式處理結果如下：

問題檔案下載
抱歉，新手剛來，不了解守則。
自己寫了一段代碼，想法是先計算「，」的次數算出合作人數。
如果合作人數不是0，就複製那一列的合作人數的次數，
複製完了後，再切割小組成員，搬到得獎人員處。
目前就已經卡在如何依照合作人數複製列了。
import pandas as pd
import numpy as np

Location='sample.xlsx'

df = pd.read_excel(Location)
df['合作人數'] = df['小組成員'].str.count('，')

df



lens = df.小組成員.str.split('，').str.len()
df.set_index('組別').reindex(df.組別.repeat(lens)).reset_index()


感謝ccutmis前輩無私的解答!!
我把問題放在國外的網站，得到我無法想像的code。
真是令人汗顏。


標題:python題目~
標籤:python 新手上路 

賣場買飲料，一罐賣20元，一打賣200元，用python設計買幾罐需要花多少錢，若不足一打就個別買
EX: 如購買「30」，計算結果顯示在螢幕如下。
請輸入購買飲料的罐數?30
需花費520
我卡在一打那邊的設計，求提示
以下是我先想到的
x=int(input("請輸入購買飲料的罐數?"))
price=20
sum=x*price
print("需花費:",sum)


標題:python 換行寫入 txt檔 
標籤:python txt文字檔 

各位先進 晚上好! 目前在python上遇到輸出txt檔的問題
list_float是列表形式，在遍歷後將列表逗號改為空白，但希望在寫入txt檔時可以透過換行來寫入，目前程式如下
file=open('101.txt','w')#
file.close() 
for i in list_float: #
    ...
    print(i,end=' ',file=open('101.txt','a')) 

在網路上找了很多資料有關寫入的方式或是在寫入前就做換行的處理，都沒找到有效的解決方法，結果如下圖

希望將內容每做一次寫入就換行在寫入下一次的結果，而不是接在後面寫入結果

感恩各位先進指教 謝謝!


標題:文本分類加入非文本內容特徵
標籤:text classification python 文本分類 nlp data science 

文本分類
做E-mail文本分類時
郵件內容可使用自然語言處理(NLP)
直接使用tf-idf、word2vec等方法
但若想加入寄件人、收件人等
非郵件內容文字的特徵
想請問該如何操作
懇請各位指點


標題:python 迴圈輸出txt檔
標籤:python txt文字檔 for-loop 

各位前輩好
在python中遇到for迴圈中print後需要將結果儲存至txt檔，但輸出至txt檔只會儲存最後一次的迴圈結果請問是我程式的哪方面有問題才能將所有內容儲存至txt檔 謝謝
程式的部分
list_float的內容是個列表 因為需要遍歷將列表內容逗號改空白及補上0
for i in list_float:
    
    print(i,end='00000\t' ,file=open('1013.txt', 'w'))



標題:byte轉換string (python)
標籤:python3 converter python 

各位好
現在有一串byte data:
b'\xc4\xb8\xf6\xd1\x17\xff\x86\x85\x1f\x13\xe\x85\x85\x85\xcb\xb0'
想轉換成如下字串:
c4b8f6d117ff8685....
是否有辦法?
20191015 Edit:
剛試著把該byte data轉為字串, 就可以把\x取代掉:
str(bytedata)

但有個問題, byte data如果介於十進制32~126, 它就會顯示為字元, 例如:
b'\xc4\xb8\xf6\xd1\x17\xff\x86\x85\x1f\x13\xe\x85\x85\x41\x42\x43'
會變成
b'\xc4\xb8\xf6\xd1\x17\xff\x86\x85\x1f\x13\xe\x85\x85ABC'
不曉得有無較好的方法?
20191015 Edit2:
已解決!
先轉為hex再取字串即可:0x12 -> 12
hex(data[i])[2:3]
hex(data[i])[3:4]



標題:python調用腳本失敗
標籤:python調用腳本失敗 

看文檔學習python遇到問題，調用腳本一直失敗，顯示SyntaxError: invalid syntax，試了好久我不知道哪裡做錯。
使用Visual Studio Code軟體
文檔說明部分
https://docs.python.org/zh-cn/3.7/tutorial/modules.html#executing-modules-as-scripts
我建立一個fibo.py
# Fibonacci numbers module

def fib(n):    # write Fibonacci series up to n
    a, b = 0, 1
    while a < n:
        print(a, end=' ')
        a, b = b, a+b
    print()

def fib2(n):   # return Fibonacci series up to n
    result = []
    a, b = 0, 1
    while a < n:
        result.append(a)
        a, b = b, a+b
    return result

if __name__ == "__main__":
    import sys
    fib(int(sys.argv[1]))

建立一個test.py
$ python fibo.py 50
錯誤
SyntaxError: invalid syntax
圖片




標題:Python (spyder)  tkinter測試沒有看到輸出
標籤:python3 

我使用 spyder (Python 3.7, Spyder 3.3.6) 學習 tkinter GUI,測試程式如下:
import tkinter as tk
win=tk.Tk()
#win.title("Python GUI")
label=tk.Label(win, text = "Hello world").pack()
win.mainloop
以上程式碼RUN之後,沒有在Console或是任何地方,看到有window輸出,只有在IPython console看到類似以下的畫面:
runfile('C:/Users/xxx/.spyder-py3/tkinter_test.py', wdir='C:/Users/xxx/.spyder-py3')
請問有人知道是什麼原因嗎?


標題:透過拖曳方式，用python讀取特定excel
標籤:python3 python excel xlsx xls 

我現在做了一個讀去excel檔案的python並包成read.exe去執行。
目前已完成的部分是我可以讀取跟read.exe相同路徑內的excel檔案並去做選擇看要使用哪一個excel檔。
現在想要讓他變成，我直接拖曳我要選擇的excel檔案到read.exe上面，read.exe會直接知道我需要的是哪一個excel並用他去執行。
以下是我目前讀取同路徑excel檔以及選擇的方法
#get excel name
filelist=[]
for root, dirs, files in os.walk(".", topdown=False):
    for name in files:
        str=os.path.join(root, name)
        if str.split('.')[-1]=='xlsx':
            filelist.append(str)
print("Excel in your Folder:")
print(filelist)
check = input("Choose Excel(1、2、3...) : ")
filename = filelist[int(check)-1][2:]
print("Excel Name : ",filename)

#xlsx
workbook = xlrd.open_workbook(filename,'r')
sheet = workbook.sheet_by_index(0)
c_cols = sheet.col_values(0)
c_row = sheet.row_values(0)
data_set = list()

想問各位有沒有什麼方法可以實現我想要拖曳excel檔案到read.exe檔然後直接利用該excel檔案的檔名去做執行
感謝!!


標題:python從CMD呼叫後，到jupyter notebook時無法新增python3，一直呈現ERROR就當了不動了
標籤:python打不開 

各位高手好
我才剛學python(九月份起)
python從CMD呼叫後，到jupyter notebook時無法新增python3，一直呈現ERROR就當了不動了。
我看CMD畫面上呈現以下照片，jupyter畫面中則一直說我的檔案有error
是不是我每次關閉jupyter notebook都用(按叉叉的方式關閉是不對的?)導致程式一直跑呢?
另外請問大家要離開時要做什麼才能完全關閉程式呢?
very very thanks~~~


標題:Python 陣列列表轉浮點數
標籤:python matrix float list 


目前想將第一張照片內容希望能變成第二張照片的浮點數，但當我使用float(x)或haarFeatures = list(map(float, haarFeatures))轉換浮點數時會出現ValueError: could not convert string to float:說我無法將字串轉為float
請問有方法還是哪部分我可能需要做修改 請求解答 Thank you


標題:(已解決!)Perceptron python 實做問題
標籤:ml perceptron python code 實作 

import numpy as np
import random

data = np.loadtxt('hw1_6_train.txt')
print(data)                
print(type(data))          
print(np.shape(data))      

w = [0,0,0,0]
error = 1
iterator = 1

def sign(z): 
    if z > 0:
        return 1
    else:
        return -1

while error != 0:
    error = 0
    for i in range(400):
        data_x = data[i][0:4]
        #print(data_x)
        data_y = data[i][4]
        #print(data_y)
        if sign(np.dot(w,data_x)) != data_y:
            print("iterator: "+str(iterator))
            iterator += 1
            error += 1
            w += data_y * data_x
            #print(w)

這份程式碼如上，目的是為了把400筆4維的數據做2元分類，但我在跑400筆資料時，perceptron總是停不下來，而正確解答應該40、50多次就解決了?!實在是非常絕望，希望各位大大能幫忙看看問題出在哪，我也參考很多人寫的，我還是不知道自己問題出在哪，拜託大家幫忙。
data在此，
https://www.csie.ntu.edu.tw/~htlin/course/mlfound19fall/hw1/hw1_6_train.dat
順帶一題這也是林軒田老師機器學習基石作業一的題目.


標題:python將相同年的數量與金額加總呈現圖表有錯誤 
標籤:python 

TABLE有四個欄位 "商品代碼","個數","金額","販售日期"
商品代碼有四種以上，
販售日期有相同天與不同天
※需要呈現的結果:
(1) 銷售日期的時間需要去掉，只保留年，像是"2015"
(2) 商品代碼相同且需要同一年才可以將數量與金額總和
(3) 可以考慮到多個商品代碼
我的測試檔案:
https://drive.google.com/drive/folders/16La3zPzpNH4aLPeOGYza0pxTsGKAEHJl?usp=sharing
提供的內容:

輸出的錯誤圖示:

目前我想的語法會出現直條圖上出現多筆數值但不是加總數值合併，必需是同商品同1年的數量和金額都加總，
提供我目前我寫的語法:
import pandas as pd
import numpy as np
import warnings
from matplotlib import pyplot as plt
warnings.filterwarnings('ignore')

path = r'C:\Users\feather\Desktop'
df =pd.read_excel(path +'\COM_D.xlsx', encoding='ansi', header=0)
print(df.head())
df.info()

df["year"]=df["販售日期"].dt.year

def toDate(val):
    return val.date()
df["販售日期"]=df["販售日期"].apply(toDate)
df.sort_values(['year'],ascending=True)
result=df.groupby(['year','金額'])
print(result.sum)
df.reset_index(inplace=True)

from matplotlib.font_manager import FontProperties
myfont = FontProperties(fname=r"D:\Anaconda3\Lib\site-packages\matplotlib\mpl-data\fonts\ttf\kaiu.ttf", size=30)

plt.figure(figsize=(8,6))
bar1 = plt.bar(df['year'],df['金額'], width = 0.5, alpha = 0.2, color = 'r') 
plt.title("每年出售總金額", FontProperties=myfont, size=10)     
plt.xticks(df['year'], FontProperties=myfont, size=10)      
plt.xlabel('每年year')       
plt.ylabel('金額dollar')  
plt.legend()    
for rect in bar1:
    height = rect.get_height()  #bar1的高度
    plt.text(rect.get_x() + rect.get_width() / 2, height+3, str(height), ha="center", va="bottom")

真正需要的結果(數值+圖示表示)

請問如何改善查詢結果的方式
謝謝


標題:python  dict
標籤:python dict 

大家好:
小弟剛進入python的世界，以下資料為每個購買品項(key)，分別出現在哪幾筆帳單(value)中，想請教如何把每個帳單的購買物品，由以上的格式依照子集方式列出~
目前資料:

目標長相:



標題:[已解決]Dictionaries裡存list的value
標籤:python dictionary list 

如題，我想將下方資料將word裡的單字以ll作為分類存成一個list，
並且其key為l+ll為命名
l ll word
1 1 bag
1 1 book
1 1 crayon
1 1 pen
1 2 board
1 2 chair
1 2 clock
1 2 desk
1 4 cat
1 4 dog
1 4 hamster
1 4 parrot
1 5 bear
1 5 lion
以下是我的程式碼
# 開啟 CSV 檔案
with open('fileName.csv', newline='') as csvFile:
    rows = csv.reader(csvFile, delimiter=',')
    # 轉成一個 dictionary, 讀取 CSV 檔內容，將每一列轉成字典
    rows = csv.DictReader(csvFile)
    # 迴圈輸出 每一列
#     for row in rows:
#         print(row['l'],row['ll'], row['word'])
#     print("#################")
    # 使用 dictionary分類
    classification = {}
        
    # 迴圈輸出 每一列
    for row in rows:
        classification.setdefault(["l{0}ll{1}".format(row['l'],row['ll'])],[]).append(row['word'])
        

期望輸出
l1ll1 : [bag,book,crayon,pen]
l1ll2 : [board,chair,clock,desk]
l1ll4 : [cat,dog,hamster,parrot]
l1ll5 : [bear,lion]
但會因 classification.setdefault 導致ValueError: I/O operation on closed file. 和 TypeError: unhashable type: 'list' 的錯誤
懇請各位大大解答，感謝


標題:flask +uwsgi 的 env 下如何用 dns.resolver
標籤:python flask uwsgi 

在 flask + uwsgi 下面用
import dns.resolver

會出現 error ....
ModuleNotFoundError: No module named 'dns.resolver'; 'dns' is not a package

當然有做 pip install dnspython 看檔案是存在的
(env) [flask@ecs-b222 app]$ ll ./env/lib/python3.6/site-packages/dns/resolver.py
-rw-rw-r-- 1 flask flask 50210 Sep 30 23:29 ./env/lib/python3.6/site-packages/dns/resolver.py


難道是要設定 ./env/etc/resolve.conf ... 試過沒有效 ....
還缺啥東西 ?
(env) [flask@ecs-b222 app]$ pip list |grep dnspython
dnspython        2.0.0
(env) [flask@ecs-b222 app]$ python
Python 3.6.8 (default, Apr 25 2019, 21:02:35)
[GCC 4.8.5 20150623 (Red Hat 4.8.5-36)] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import dns.resolver
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ModuleNotFoundError: No module named 'dns.resolver'; 'dns' is not a package
>>>




標題:一個python程式執行問題
標籤:python程式問題 


看的一本旗標出版的書「從作中學…」，這三行程式，為何最後執行時會出現一個None？請先進指教


標題:要轉入AI產業
標籤:python入門 轉職 學習 

想請問前輩
最近剛離職想轉入AI產業，原本在做電子硬體測試，對軟體一直有興趣，有學過android app和IOS APP ，但是對軟體業不熟，也沒有AI基礎，所以想去職訓
一個是中興大學辦的
https://www.taiwanjobs.gov.tw/Internet/index/CourseQuery_detail.aspx?oid=122754
一個是世貿辦的
https://www.taiwanjobs.gov.tw/Internet/index/CourseQuery_detail.aspx?oid=122844
這兩個課程那個對我往AI產業就業比較有幫助，
當然我知道上完課程只是開始，


標題:利用pytohn 導入資料夾影像來做特徵值計算
標籤:python3 

目前利用for loop迴圈的概念可以自動抓資料夾的影像去做特徵值計算，print方面給予10張影像就會計算10次，但在要輸出成txt 或 csv 時就只有最後一次的結果 請問需要修改哪個部分才能讓輸出結果可以全部顯示，而不是只有迴圈的最後一次。 謝謝各位指教
import cv2
import glob
import numpy as np

matrix = []   #放幾張影像就會做幾張
for img in glob.glob("faces\*.bmp"):
    cv_img = cv2.imread(img)
    matrix.append(img)
    image = cv2.imread(img)
    img = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY) 
    接下來這部分做特徵值運算
    print(特徵值運算結果)



標題:Minimax演算法code請教
標籤:python minimax algorithm 

各位大大好
小弟目前在研究minimax演算法，於githube有找到一則以python編寫的code,
網址:
https://github.com/Cledersonbc/tic-tac-toe-minimax/blob/master/py_version/minimax.py
但是小弟才學粗淺，對於code有三個地方不懂，來版上請求大大們協助:

為何人類玩家的移動步驟會有-1? 不應該都是大於0嗎?
為何要設定條件 move<1  or move>9? 井字遊戲最大步驟不是9而已嗎?
類似於第1個問題，為何minimax函數的row & column會有-1 的步數?






標題:Python 下載 Youtube 異常
標籤:python3 

用書上範例檔案下載 , 出現以下錯誤 , 我搜尋 RegexMatchError: regex pattern , 還
是找不出解決方案
範例檔案
import requests
from pytube import YouTube
import re
import os

videourlList = []  #儲存所有影片網址的串列

urltext = '/watch?v=hGRplpwjbr0&list=PL316wRwpvsnHZprsPfXM8yPzyZ41bvuWl'  #黑豹預告片
url = 'https://www.youtube.com' + urltext  #影片網址

pathdir = 'download'  #下載資料夾
if not os.path.isdir(pathdir):  #如果資料夾不存在就建立
    os.mkdir(pathdir)

html = requests.get(url)
res1 = re.findall(r'/watch[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]', html.text)  #取得包含「/watch」的網址內容
for temurl in res1:
    if 'list=' and 'index=' in temurl: #必須包含list=及index=
        if temurl not in videourlList:  #如果串列中不存在就加入串列
            videourlList.append(temurl)

print('開始下載：')
n = 1
for video in videourlList:
    yt = YouTube('https://www.youtube.com' + video)
    print(str(n) + '. ' + yt.title)  #顯示標題
    yt.streams.filter(subtype='mp4', res='360p', progressive=True).first().download(pathdir)  #下載mp4,360p影片
    n = n + 1
print('下載完成！')


錯誤訊息
File "C:\Users\SCE\Anaconda3\lib\site-packages\pytube\helpers.py", line 39, in regex_search
    .format(pattern=pattern),

RegexMatchError: regex pattern (\W[\'"]?t[\'"]?: ?[\'"](.+?)[\'"]) had zero matches

helpers.py

"""Various helper functions implemented by pytube."""
from __future__ import absolute_import

import logging
import pprint
import re

from pytube.compat import unicode
from pytube.exceptions import RegexMatchError


logger = logging.getLogger(__name__)


def regex_search(pattern, string, groups=False, group=None, flags=0):
    """Shortcut method to search a string for a given pattern.

    :param str pattern:
        A regular expression pattern.
    :param str string:
        A target string to search.
    :param bool groups:
        Should the return value be ``.groups()``.
    :param int group:
        Index of group to return.
    :param int flags:
        Expression behavior modifiers.
    :rtype:
        str or tuple
    :returns:
        Substring pattern matches.
    """
    regex = re.compile(pattern, flags)
    results = regex.search(string)
    if not results:
        raise RegexMatchError(
            'regex pattern ({pattern}) had zero matches'
            .format(pattern=pattern),
        )
    else:
        logger.debug(
            'finished regex search: %s',
            pprint.pformat(
                {
                    'pattern': pattern,
                    'results': results.group(0),
                }, indent=2,
            ),
        )
        if groups:
            return results.groups()
        elif group is not None:
            return results.group(group)
        else:
            return results


def apply_mixin(dct, key, func, *args, **kwargs):
    r"""Apply in-place data mutation to a dictionary.

    :param dict dct:
        Dictionary to apply mixin function to.
    :param str key:
        Key within dictionary to apply mixin function to.
    :param callable func:
        Transform function to apply to ``dct[key]``.
    :param \*args:
        (optional) positional arguments that ``func`` takes.
    :param \*\*kwargs:
        (optional) keyword arguments that ``func`` takes.
    :rtype:
        None
    """
    dct[key] = func(dct[key], *args, **kwargs)


def safe_filename(s, max_length=255):
    """Sanitize a string making it safe to use as a filename.

    This function was based off the limitations outlined here:
    https://en.wikipedia.org/wiki/Filename.

    :param str s:
        A string to make safe for use as a file name.
    :param int max_length:
        The maximum filename character length.
    :rtype: str
    :returns:
        A sanitized string.
    """
    # Characters in range 0-31 (0x00-0x1F) are not allowed in ntfs filenames.
    ntfs_chrs = [chr(i) for i in range(0, 31)]
    chrs = [
        '\"', '\#', '\$', '\%', '\'', '\*', '\,', '\.', '\/', '\:', '"',
        '\;', '\<', '\>', '\?', '\\', '\^', '\|', '\~', '\\\\',
    ]
    pattern = '|'.join(ntfs_chrs + chrs)
    regex = re.compile(pattern, re.UNICODE)
    filename = regex.sub('', s)
    return unicode(filename[:max_length].rsplit(' ', 0)[0])




標題:如何在django中使用Plotly繪製圖型在網頁上?
標籤:python3 django plotly 網頁設計 圖片 

請問如何在django中使用Plotly繪製圖型在網頁上?
查了很久還是不太清楚如何使用..
http://cn.voidcc.com/question/p-zcqkzbog-so.html
有查到這份資訊
但是看不太明白
想上來問問大大


標題:C#與Python的選擇
標籤:c#與python的選擇 

想請問各位 會建議學C#還是python呢 在職場上這兩種語言 哪種相對較好找到工作


標題:python打包發生error
標籤:python python3 

小弟剛開始接觸python
想把練習檔打包卻發生這個Error
ValueError: script 'C:\Users\USER\QQ.py' not found

想請大大教學~


標題:[python] 爬蟲
標籤:網路爬蟲 python 

請問爬蟲要隔多久request一次才安全？
我想應該每個網頁的限制不一樣，所以應該要問怎麼知道這限制是多少？


標題:python  於 linux  環境的 selenium 用 xvfbwrapper vs pyvirtualdisplay
標籤:linux python selenium webdriver pyvirtualdisplay xvfbwrapper 

如標題
有人用過 xvfbwrapper 與 pyvirtualdisplay 這兩個 套件嗎 ?
這兩個有何不同 ... 哪個吃的資源比較小 ?
有人使用過嗎 ?
我只有使用 pyvirtualdisplay ...... 在 ECS 上感覺有點吃資源
我只買 1核1G 的小機器 ...


標題:python 新手問題
標籤:python3 pandas 

最近在自學PYthon，遇到一個練習是利用pandas建立一個表格
卡在最後要建立一個columns放每個row的加權後的分數
我目前做到下圖這樣

最後想把分數 [86.5, 79.4, 88.2, 96.5, 86.3, 76.8, 96.1, 78.5, 82.4, 88.6]
透過各科加權放在最後一個column，如下圖

有想法是想用迴圈達成，但還是不知道怎麼開頭
希望有人能給點提示~
謝謝QQ


標題:python flask 用 selenium 時用 wsgi 會發生 500 錯誤
標籤:wsgi python python3 selenium webdriver selenium 

python flask 用 selenium 時用 wsgi 會發生 500 錯誤
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: File "/home/flask/app/env/lib/python3.6/site-packages/flask/app.py", line 1949, in full_dispatch_request
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: rv = self.dispatch_request()
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: File "/home/flask/app/env/lib/python3.6/site-packages/flask/app.py", line 1935, in dispatch_request
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: return self.view_functions[rule.endpoint](**req.view_args)
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: File "./app.py", line 260, in postJsonadd
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: ret = dns_add(content)
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: File "./app.py", line 80, in add_dns_add
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: driver.quit()
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: UnboundLocalError: local variable 'driver' referenced before assignment
Sep 16 14:19:08 ecs-b222.novalocal uwsgi[3565]: [pid: 3575|app: 0|req: 3/5] 154.92.212.0 () {54 vars in 796 bytes} [Mon Sep 16 14:19:06 2019] POST /add => generated 0 bytes in 2012 msecs (HTTP/1.1 500) 0 headers in 0 bytes (0 switches on core 0)

但是不掛 wsgi 於 使用者 flask 掛 source env/bin/activate
執行 python3 -u app.py 測過可正常運行 selenium 瀏覽網頁抓取所要的資訊


標題:UBIKE 使用Python 做線性迴歸分析
標籤:線性迴歸 python3 

我補習的大數據班 , 專題研究是 UBIKE , 老師建議我們使用線性迴歸分析
我們要使用 PYTHON , 我要先畫流程圖 , 這樣比較好知道如何設計
我找了網上資料都比較簡單如下 , 我的想法程式的內容有幾個流程
輸入 變數 自訂函數 迴圈 異常處理 輸出 , 首先要設定自變數與應變數
還有下面的數學公式要設定 , 還有其他要設定的
目前還沒有想法 , 想請教大家的意見 . 謝謝
要分析如下特性
包括使用率 熱冷門站點 熱門路線 平日假日租借分析 雨天租借使用率.... 等等





標題:Python 異常訊息 FileNotFoundError
標籤:python3 

錯誤訊息
File "D:/readweather.py", line 15, in parse_html
    with open(arg,'r',encoding='utf-8') as f:

FileNotFoundError: [Errno 2] No such file or directory: 'HTML_DATA\\2018-01-01_466910.htm'



import datetime as dt
import re

#######################################################################
#自訂函式區

def parse_html(arg):
	with open(arg,'r',encoding='utf-8') as f:
		content=f.read()
	f.close()
	content=content.replace('    ','').replace('  ','').replace('\t','').replace('\n','').replace('&nbsp;','')
	hours_data=re.findall('<tr><td nowrap>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td><td>([^<]+)</td></tr>', content)
	return hours_data




標題:找 Python 顧問
標籤:python 3 

如果違反板規請刪除  謝謝
我現在上補習班 300 小時大數據課程 , 9 / 24 就結業了
我們小組 6 人做 UBIKE 資料分析 , 上課學習跟實際應用到專題上
還是有些地方不會 , 所以想要請教 , 就像下面這個程式
可以幫我看看寫的註解那裏不對 , 還有回答問題 , 顧問算月的
回答問題就用 LINE 或 MAIL , 請告知多少錢願意當我顧問 . 謝謝 !
import datetime as dt #將函數 datetime 指定給 dt
import requests,time,pathlib,os,re 

#######################################################################
#自訂函式區
def get_url_filename(arg): #取得網頁檔案
	return re.sub(r'^.*?station=(.*?)&stname=&datepicker=(.*?)$',r'\2_\1',arg)
  #返回用於替換字符串中的匹配項。這是什麼意思
def log(arg): 
#返回 x 的自然对数,要解析的命令行參數列表。這是什麼意思
	with open('log\\event.log','a',encoding='utf-8') as f: #打開event.log 'a'新的內容將會被寫入到已有內容之後。如果該文件不存在，創建新文件進行寫入。 utf-8 中文編碼
		f.writelines(arg+'\n') #寫入行並換行
	f.close()  #f是代表 file 嗎 ? 關檔

#######################################################################

base_dir = os.path.dirname(os.path.realpath(__file__))
#判斷log資料夾是否存在，若不存在則建立log資料夾
pathlib.Path(base_dir+"\\log\\").mkdir(parents=True, exist_ok=True)

with open('log\\event.log','w',encoding='utf-8') as f:
	pass #這裡用意是把event.log內容清空
f.close()

location_dict={'466910':'鞍部','466920':'臺北','466930':'竹子湖','C0A980':'社子','C0A9A0':'大直','C0A9B0':'石牌','C0A9C0':'天母','C0A9E0':'士林','C0A9F0':'內湖','C0AC40':'大屯山','C0AC70':'信義','C0AC80':'文山','C0AH40':'平等','C0AH70':'松山','C1AC50':'關渡','C1A730':'公館','C0A9G0':'南港','C0A990':'大崙尾山'}
#print(location_dict.keys()) 測試列出location_dict所有key:466910,466920...

startdate = dt.datetime(2019, 8,1)
enddate = dt.datetime(2019, 8,1)
totaldate = (enddate - startdate).days + 1

data_folder='HTML_DATA'
#判斷HTML_DATA資料夾是否存在，若不存在則建立HTML_DATA資料夾
pathlib.Path(data_folder).mkdir(parents=True, exist_ok=True)

#######################################################################
#下載全部html資料到HTML_DATA資料夾
for daynumber in range(totaldate): #迴圈 日期數目在全部日期的範圍內
	datestring = str((startdate + dt.timedelta(days = daynumber)).date())
    #將日期轉換為字串
	print(datestring)
	#取得單日_全部地點.htm
	for i in location_dict.keys(): # 迴圈 i 從監測站起點到終點下載資料
		url="https://e-service.cwb.gov.tw/HistoryDataQuery/DayDataController.do?command=viewMain&station=%s&stname=&datepicker=%s" %(i.split("_")[0],datestring)
		#print(url)
try: #異常狀況處裡 ,避免當機產生  r=requests.get(url) 為什麼要設定 r 變數 , 後面沒有引用 r
			print("Download: "+datestring+"_"+i+".htm") #列印下載日期 , 當 i 迴圈中斷的地方
			with open(data_folder+"\\"+datestring+"_"+i+".htm",'w',encoding='utf-8') as f:
                #打開檔案目錄與日期在 i 迴圈
				f.write(r.text) #寫入 r.text 檔案
			f.close() # 關閉		
except:
			print("Error: "+datestring+"_"+i+".htm")
			#列印錯誤日期在迴圈 i 的何處停止
log(url)
    finally:
			time.sleep(5)
print("1. HTML資料下載完畢.")

#######################################################################
#檢查event.log是否為空或有內容，有則表示有資料下載失敗需要重新下載
log_file = (open("log\\event.log", "r"))
download_error_url = log_file.read().split('\n')
log_file.close()
#若download_error_url陣列長度為1時表示是沒有錯誤(只有一列空白行)
#大於1表示有下載錯誤的記錄
if (len(download_error_url))>1:  #假如下載錯誤網址長度>1
	with open('log\\event.log','w',encoding='utf-8') as f:
		pass #這裡用意是把event.log內容清空
	f.close()
	for i in download_error_url: # 迴圈 i 在 下載錯誤網址
		if i!='': #假如 i 不等於空白
			try: # 異常處理同上
				r=requests.get(i)
				print("Download: "+get_url_filename(i)+".htm")
				with open(data_folder+"\\"+get_url_filename(i)+".htm",'w',encoding='utf-8') as f:
					f.write(r.text)
				f.close()
			except:
				print("Error: "+get_url_filename(i)+".htm")
				log(i)
			finally:
				time.sleep(5)
	print("2. 下載錯誤HTML資料補下載完畢.")
else:
	print("2. 檢查完畢，無下載錯誤HTML資料.")



標題:Python 使用 key 获取字典内容
標籤:python3 字典 列表 python 

我有一个列表，列表里面有 n 个字典，列表中字典的 key 都是相同的。
如，list = [{'name':'book','number':5},{'name':'pen','number':4},......]
我如何才能通过字典的 key 获取字典的内容？
结果如：
当我输入“book”时，
返回：
name:book
number:5


標題:[Python 爬蟲] API資料問題
標籤:python 網路爬蟲 爬蟲 python request 

問題已解決，解決方式在最下方。(結果換IP又抓不到資料了...看來只能乖乖等了)

前輩們好，最近在學網路爬蟲，在以GET方式爬取蝦皮資料的時候，會有資料不完整（Price回傳為None）的問題。
設定UA成自己的UA，或是https://shopee.tw/robots.txt 裡面提到的Googlebot也都無法。
在網站上看到的API結果：

但抓下來的結果，price_max_before_discount回傳卻為None：

我寫的程式碼如下（把可能需要的Headers資料都寫進去了，一樣回傳為None）：
import requests
import json
import pandas as pd


headers = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36',
          'cookie':'cookie: _gcl_au=1.1.631645365.1567681365; _med=refer; csrftoken=IgSoSF3SSbOVNwfoOrGwiry97yM8JbWz; SPC_IA=-1; SPC_EC=-; SPC_U=-; SPC_F=lNJUqhewfQYyCYaTUdy0fVvI9kuAbv1f; REC_T_ID=b1ba4b34-cfcc-11e9-9bf9-f8f21e1a8d50; SPC_SI=d59edotsky47v5zvr3q4ugpjkjpi9fna; welcomePkgShown=true; __BWfp=c1567681368204xa77f7febe; cto_lwid=3dc5c1f9-583a-4eba-b6e0-de66e26b215e; _ga=GA1.2.1992864768.1567681368; _gid=GA1.2.175467350.1567681368; AMP_TOKEN=%24NOT_FOUND; SPC_T_IV="qrbmhgMT7OUZKRBmRjNaMw=="; SPC_T_ID="6N0d4ydVBAQW62UNIHqQRsnUWPIAE9mWVnvgiDZuDvlUA/whz+NW/eEiPnp2sCVJUx/+eHEFyXRwzwRsyPQykpqZWq/jb9eGIG07k72k9Pk="',
           'referer':'https://shopee.tw/search?keyword=%E4%BE%BF%E7%9B%86&page=3&sortBy=relevancy',
           'if-none-match': '"3690879c89a118b04a29e96e15098085;gzip"',
           'if-none-match-': '55b03-84bce41404875ad9ceb09e9a45be0899',
           'csrftoken':'IgSoSF3SSbOVNwfoOrGwiry97yM8JbWz',
           'sec-fetch-mode': 'cors',
           'sec-fetch-site': 'same-origin',
           'x-api-source': 'pc',
           'x-requested-with': 'XMLHttpRequest'
          }
          
url = "https://shopee.tw/api/v2/search_items/?by=relevancy&keyword=便盆&limit=100&newest=100&order=desc&page_type=search"
res = requests.get(url, headers=headers, allow_redirects=False)
reqsjson = json.loads(res.text)
items = reqsjson.get('items')

想請教前輩們，遇到這種情況應該如何處理？
謝謝大家。

換IP方法：
https://bigdatafinance.tw/index.php/383-ip
s = requests.session()
proxie = {
'http' : 'http://122.193.14.102:80'
}
url = 'xxx'
response = s.get(url, verify=False, proxies = proxie, timeout = 20)
print response.text
遇到錯誤訊息（Unverified HTTPS request is being made. Adding certificate verification is strongly advised）時，可以安裝認證解決：
http://codebeta.blogspot.com/2017/09/python-requests-insecurerequestwarning.html
先到 http://certifiio.readthedocs.io/en/latest/ 下載 Raw CA Bundle，放在你知道的地方。
然後在使用 requests 的時候，verify 參數後面接那個檔案的路徑。問題解決！


標題:怎樣將幾百個 html 檔轉成 xls 最快
標籤:python3 

單獨一個一個轉太慢了 , 怎樣可以很快轉 , 請問下面程式要怎麼改 , 迴圈要怎麼加
import pandas

with open('d:\weather\\a.txt','r') as f:

    df = pandas.read_html(f.read().decode("gb2312").encode('utf-8'),encoding='utf-8')

print df[0]

bb = pandas.ExcelWriter('out.xlsx')

df[0].to_excel(bb)

bb.close()

下面是要轉的 htm



標題:Python 爬蟲異常  ConnectionError: HTTPSConnectionPool
標籤:python3 

異常訊息
raise ConnectionError(e, request=request)

ConnectionError: HTTPSConnectionPool(host='e-service.cwb.gov.tw', port=443): Max retries exceeded with url: /HistoryDataQuery/DayDataController.do?command=viewMain&station=C0A9A0&stname=&datepicker=2018-02-27 (Caused by NewConnectionError('<urllib3.connection.VerifiedHTTPSConnection object at 0x00000180FB685470>: Failed to establish a new connection: [WinError 10060] 連線嘗試失敗，因為連線對象有一段時間並未正確回應，或是連線建立失敗，因為連線的主機無法回應。'))

網上查解決方法如下ˇ , 加了下面這段還是連一段時間就異常 , 要常常重連才行
while 1:
    try:
        page = requests.get(url)
    except:
        print("Connection refused by the server..")
        print("Let me sleep for 5 seconds")
        print("ZZzzzz...")
        time.sleep(5)
        print("Was a nice sleep, now let me continue...")
        continue

原程式
import datetime as dt  #載入日期時間設定給變數 dt
import requests,time   #載入網頁需求與時間
#設定地址陣列
location_arr=['466910_鞍部','466920_臺北','466930_竹子湖','C0A980_社子','C0A9A0_大直','C0A9B0_石牌','C0A9C0_天母','C0A9E0_士林','C0A9F0_內湖','C0AC40_大屯山','C0AC70_信義','C0AC80_文山','C0AH40_平等','C0AH70_松山','C1AC50_關渡','C1A730_公館','C0A9G0_南港','C0A990_大崙尾山']

# 計算半年時間
startdate = dt.datetime(2018, 2,8)
enddate = dt.datetime(2018, 6,1)
totaldate = (enddate - startdate).days + 1

#在for迴圈內作業。
for daynumber in range(totaldate): # 日期數量迴圈
	datestring = str((startdate + dt.timedelta(days = daynumber)).date())
   # 將日期改成字串
	print(datestring)
	#取得單日_全部地點.htm
    
for i in location_arr:
url="https://e-service.cwb.gov.tw/HistoryDataQuery/DayDataController.do?command=viewMain&station=%s&stname=&datepicker=%s" %(i.split("_")[0],datestring)
		print(url)#列印網頁
		r=requests.get(url)#設定需求網頁變數
		print("Download: "+datestring+"_"+i+".htm")#列印日期迴圈
		with open(datestring+"_"+i+".htm",'w',encoding='utf-8') as f:
			f.write(r.text)
		f.close()
		time.sleep(5) # 讓程序休眠 5 毫秒
        
#解決請求速度過快導致程序報錯      
       
while 1:
    try:
        page = requests.get(url)
    except:
        print("Connection refused by the server..")
        print("Let me sleep for 5 seconds")
        print("ZZzzzz...")
        time.sleep(5)
        print("Was a nice sleep, now let me continue...")
        continue



標題:Python如何將相同天數的數量與金額加總
標籤:python 

表中有四個欄位 "商品代碼","個數",	"金額","販售日期"
商品代碼有四種以上，
販售日期有相同天與不同天
※需要呈現的結果:
(1) 銷售日期的時間需要去掉，只保留年月日，像是"2015/01/13"
(2) 商品代碼相同且需要同一天才可以將數量與金額總和
(3) 可以考慮到多個商品代碼
我的測試檔案https://drive.google.com/file/d/1j7lskVBtk8sO2nGTWhchBTCm65ZPGw2H/view?usp=sharing
提供的內容:

目前我用python的語法會出現無法相同1天合併，以及無法將同1天的數量和金額都加總，
真正需要的結果:

請問如何改善
謝謝


標題:如何提取人力銀行最新職缺數字?
標籤:perl php python 

請教大神,
https://www.1111.com.tw/corp/8325616/
網頁中的最新職缺數字(113)要如何取得?
用get抓下網頁, 找不到113這個值.
感謝.


標題:Python 爬蟲如何爬須按選項的資料
標籤:python3 

我找網上爬蟲資料 , 只找到爬固定的網址 , 如果要填選項要怎麼爬如下
像下面天氣資料 , 我要台北市各區半年的資料 , 需要執行按鈕
https://e-service.cwb.gov.tw/HistoryDataQuery/index.jsp


首先要引入下面模組是嗎 ?
from urllib import request
from bs4 import BeautifulSoup
from urllib.parse import urlparse
from urllib.request import urlopen
from urllib.error import HTTPErroe
import re
import sqlite3
from selenium import webdriver
import json
import requests



標題:Python 是不是取代很多語言
標籤:python3 

最近在補習班上大數據分析使用 Python 跟 Excel 與 R , 感覺 Python 比 c java 更好寫程式 , 網路上也寫 PYTHON 很多應用如下 , 所以 PHP ASP.NET 都被取代了嗎 ?
R 主要是繪圖是嗎 ? 感覺不好學 , 老師都講專有名詞如 T 檢定 迴歸 , 同學都聽沒有 , 用 rattle 是不是就可以畫圖 , 不用寫一堆程式
Python 我現在只接觸到爬蟲 , 像寫介面如 BUTTON LABEL TEXTBOX 這些工具 Python 要怎麼寫
web開發 ：
服務器端編程，具有豐富的Web開發框架，如Django和TurboGears，快速完成一個網站的開發和Web服務。
可以用Python快速完成網站的開發和WEB服務。例如：豆瓣、果殼網、Google、Dropbox等。
爬蟲 :
數據分析離不開數據采集，所以我偶爾也會使用 Python 的標準庫 urllib 去網絡采集一些簡單數據，圖快也會使用 requests，beautifulsoup 是非常不錯的 html 解析工具。
我建議 Python 爬蟲的初學者熟練掌握這些基本庫，後續更高級的可以學習 Python 爬蟲框架 pyspider，scrapy 等，以及分布式爬蟲。
數據分析 :
Python 的數據分析生態系統很完善了，甚至看到很多研究者的討論帖子都建議早點把研究工具遷移到 Python 生態系統。
Numpy Scipy、Pandas、matplotlib 是 Python 最基本數據分析的三駕馬車，而 Jupyter notebook 則是分析的最基本交互式環境。


我會提問python 是否取代很多語言 , 是因為老師說 , 他之前教 java 同樣功能 java 要很多行程式才寫得出來 , 但 python 只要幾行就寫出來了 , 而且說 java 是舊技術 , 當然是要學 python , 所以我才這樣問


標題:ETL用Python寫是否有比較好?
標籤:etl python 

目前Team在做ETL(File to DB或DB to DB)用的方式有：

C#開發Console ETL程式
用開源的ETL工具(如：Kettle)

想問/討論的是
如果要做ETL，用Python寫是否能得到好處?
還是只是比較多開源套件可以用...


標題:Python 的註解與錯誤訊息
標籤:python3 

請問我寫的註解正確嗎 ?
import requests  # 先引入 requests 模組 , 才可以從網上下載資料
html=requests.get('https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json')
# 使用 GET 方式下載普通網頁 , 存到 html 變數
html.encoding="UTF-8"
"""
UTF-8
1. 支援所有語言文字，還有一些怪怪圖形
"""
list1=eval(html.text)
#eval() 函數用來執行一個字符串表達式，並返回表達式的值。抓取網上資料存成 list1

for dict in list1: # 取出字典的內容
    listvalues=list(dict.values()) #列出字典的值 , 存到 listvalues
    print(listvalues) # 列印 listvalues

屬性錯誤訊息 , 是因為字串中沒有值嗎 ?

  File "D:/request.py", line 19, in <module>
    listvalues=list(dict.values()) #列出字典的值 , 存到 listvalues

AttributeError: 'str' object has no attribute 'values'



標題:Python 那裡的 SyntaxError: invalid syntax
標籤:python3 

語法錯誤 , 沒看出來是哪裡錯誤 , 搜尋過網路還是沒查出來



標題:#python 寫大檔案問題(5.6億)
標籤:python pandas 

小弟我生成大檔案時 使用多線程< 4個， 之後再把資料寫進檔裡本來5.6億的資料
，每次都掛在寫檔那直到切4等分才能寫檔成功，我寫檔是用pandas 寫excel
假設我使用迴圈跑這4等分 每次都使用多線程只生成4等分的資料 不會占用多的記憶體
結束後使用time.sleep 有效嗎? 如果是請問要多久
或者是說 有什麼更佳解嗎


標題:python list to dict
標籤:python dict list 

大家好:
這是我的資料(list)，想問要怎把他整個轉成dict的格式，網路上的一些方法皆會碰到錯誤(unhashable type: 'dict' 或 'dict' object has no attribute 'split' )


標題:linebot  push多筆 notify message 的問題 （python）
標籤:line bot python line notify push notification 

各位高手好
目前遇到一個問題，向各位高手請益
我目前寫了一個linebot（部署在heroku上）
輸入特定訊息後，鏈結到line notify連動的頁面
使用notify api完成連動，並紀錄user的access_token之後
再透過
lineNotifyMessage(access_token,message)

def lineNotifyMessage(token, msg):
      headers = {
          "Authorization": "Bearer " + token, 
          "Content-Type" : "application/x-www-form-urlencoded"
      }
    
      payload = {'message': msg}
      r = requests.post("https://notify-api.line.me/api/notify", headers = headers, params = payload)

去發送message訊息給已完成連動使用者
經過測試已經可以發送
但後來發現有些已完成連動的user無法接收到notify訊息
看了heroku log後才發覺有這個錯誤
at=error code=H12 desc="Request timeout"
(經實測大概發送約30個左右就會出現這個錯誤)
爬了一下文，發現heroku有30秒內完成request請求的限制
請問各位高手，有什麼解決的方式呢？
我的code如下
for token in access_token:
    message = 'message'
    lineNotifyMessage(token,message)



標題:#Python  Unable to coerce to Series, length must be : given 問題
標籤:python3 pandas 

我程式遇到的問題是:
我有兩種選擇，一種是重新計算新的權重，一種是導入以計算過(訓練後的)權重
白話一點就是 兩種資料是同一型態，只是取得的方式是(1)計算or(2)導入
我遇到的問題目前就在導入資料時發生的錯誤
我試過了這兩個網站
1:https://stackoverflow.com/questions/29954263/what-does-the-term-broadcasting-mean-in-pandas-documentation?lq=1
這個以降pandas為解決方法，但會延伸出更多問題 而且感覺解決的方式不夠好 所以試過一次不行後就沒再繼續研究
2:https://stackoverflow.com/questions/29954263/what-does-the-term-broadcasting-mean-in-pandas-documentation?lq=1
上面這個，可以直接移至update那邊看 他的解決方式是加個.values
關鍵程式碼
def startTrainModel(self,trainX,trainY,alreadyTrainTheta):
        self.features_Number=trainX.shape[1]
        if(not alreadyTrainTheta):
            self.theta=self.initinitializedWeigth(self.features_Number)
        else:
            temptheta=loadData('theta.xlsx').values
            self.theta=np.asarray(temptheta,dtype='float64')

第一個if是從新訓練，第二個則是導入，且兩個都是同種的資料型態<numpy.ndarray>


標題:類似這種題python 物件設計,要怎麼寫(剛學所以還不太會,詢問一下)
標籤:python3 

1、設計一個電子物件
電子物件有基本兩個 function
1、開
2、關


標題:Minimax演算法如何建構game tree
標籤:python minimax algorithm 

各位大大好，
小弟初學者剛接觸minimax演算法，有個地方疑惑，想尋求大大的引導，問題如下：
1.Game tree如何產生？
圈圈叉叉遊戲中，各文章都會列出game tree說明player下一步驟的各種走向，但是此game tree的各種走向是靠程式撰寫者預先自行條列，之後再利用演算法取得最佳的move呢？
2.大大有其他推薦的minimax文章，可以讓小弟初學者閱讀嗎？


標題:Windows 腳本語言選擇
標籤:powershell cmd python 

各位好，目前我想選擇使用windows腳本語言來完成工作自動化
需求大概是這樣的
1.解壓縮資料夾到特定目錄
2.重新命名資料夾名稱(假如叫做AAA
3.把帶有Key的非標準xml檔移到AAA下面
4.讀取AAA裡面的key字串並寫入到網站web.config中
最一開始用powershell寫，但是卡在第一步
不知道為什麼powershell對於解壓縮zip效率很差(壓縮檔約700MB，解壓縮約1.2G)
正常用7ZIP解大概1分鐘OK，但是用powershell拖了5分鐘以上還沒好
另外讀取Key字串也有問題，xml結構是這樣
然後我下 $xml.AAA_KEY.Account_key 能夠讀取到 "ee03445f%^#@dfd"
但是我就不知道要如何取出Key1 跟 key2
<AAA_KEY>
<Account_key> ee03445f%^#@dfd </Account_key>
    <KEY ID = "User10036">
        <key1> ?45523sseeytTCA$$5FFTY  </key1>
        <key2> 455DSuyeias$%dkja4DDCE  </key2>
</AAA_KEY>



標題:#問 python 有何好方法處理大筆資料
標籤:python 

小弟有3000個詞,以及22萬句樣本(一句話)
我現在的目標是希望做出 22萬*3000 的1 0矩陣 假如 我的詞庫裡有2個詞['cool','it']
而我有一句樣本是'我愛it邦' 那我希望 這句樣本被處理為[0,1]
詞庫第一個詞沒有=0第二個有=1
簡而言之就是一個元素比對了樣本數的向量 希望出來跟樣本數一樣的向量 並且若是元素在向量裡=1 否則=0
套上我的例子就是迴圈跑3000個元素 一次比對樣本數的向量 每跑一次迴圈 就能得到一個向量最終組合成矩陣


標題:Python的list轉dict問題
標籤:python 

剛自學，請問我已把資料分出來為list，
['數學=80','英文=90','自然=70]
但是要如何才能再分開轉為dict?
這樣我才能由print(dic["數學"])印出為80
data=row["查詢"].split("\n")
print(data)
謝謝教導
108804再發問
謝謝回答，
但執行到一半，發現原來來源資料格式還不一致，會出現錯誤，
資料來源為檔案，
我是一行一行讀入處理
如：分出後，資料格式list為
第1筆：['數學=80','英文=90','自然=70']
第2筆：['數學=40','英文-70','自然-40','國語=60']
第3筆：['學數60','英文=50','國語=80']
import csv
with open("1.csv",mode="r",encoding="utf-8") as file:
rows=csv.DictReader(file)
for row in rows:
data=row["分數"].split("\n")
if str(data).find("英文") > 0:
data=str(data).replace("英文-","英文=")
result=dict([d.split("=") for d in data])
print (result)
我是想把資料格式都換成一樣的，再轉dict，但是這樣會有錯誤發生，
ValueError: dictionary update sequence element #1 has length 1; 2 is required
請問我該怎麼修正，謝謝教導。


標題:費式數列  python
標籤:python 費式數列 

table = [0]*3
table[0] = 0
table[1] = 1
for i in range(2,6):
table[2] = table[1] + table[0]
table[0] = table[1]
table[1] = table[2]
print(table[2])
小弟是初學者
不能完全理解這個code
希望有高手能幫幫忙
  1.An====A0|  A1 | A2  |  A3    |....   An
    值====0 |  1 | 0+1 |  (0+1)+1 |      A(n-1)+A(n-2)

table[n] 等於第n項的值的話
一開始table[2] 為table[0]  加 table[1]
之後把table[0]   更新為table[1]的值
table[1]  更新為table[2]的值
新的table[2]等於 新的table[1]+table[0]
相當於舊的table[2]+table[1]
我這樣理解是對的嗎
但為甚麼第一行要寫成那樣阿
還有table是什麼意思
擷取至:
https://medium.com/appworks-school/%E5%88%9D%E5%AD%B8%E8%80%85%E5%AD%B8%E6%BC%94%E7%AE%97%E6%B3%95-%E5%BE%9E%E8%B2%BB%E6%B0%8F%E6%95%B8%E5%88%97%E8%AA%8D%E8%AD%98%E4%BD%95%E8%AC%82%E9%81%9E%E8%BF%B4-dea15d2808a3
的文章


標題:Python 怎麼無法新增  Pydev module
標籤:python 

網路上找了很多資訊 , 試過很多方法 , 但沒記錄下來 , 還是無法新增

錯誤訊息

Fatal Python error: init_sys_streams: can't initialize sys standard streams
Traceback (most recent call last):
  File "D:\Python374\lib\io.py", line 52, in <module>
  File "C:\Users\michael\eclipse-workspace\test\src\abc.py", line 4, in <module>
RuntimeError: lost sys.stdout



標題:請問Python導入函式庫的部分有錯
標籤:python 

我目前正在學習tensorflow 直接複製別人的程式碼
from preprocess import
不過遇到上面那行則有錯誤：ImportError: No module named 'preprocess'
請問是甚麼問題呢
我python是3.5.5版本的


標題:爬蟲| 如何使用Python中的Selenium爬取抓取javascript按鈕?
標籤:網路爬蟲 selenium python javascript 

煩惱好久了><請問大神們!如何點選潛藏在javascript的按鈕呢?!
想要點選商品->台指期
https://www.cmoney.tw/vt/foaccountuserset.aspx


標題:python 實體物件,與一般的函式
標籤:python 

第一張圖用實體物件來取得檔案資料
二三張圖是只用函式來達成目的
我想問的是下面的方法應該比較簡單啊
為甚麼要用實體物件
用函式寫的話
要當模組使用, 在主程式撰寫也比較方便
實體物件有甚麼特別的功用嗎
還有, 初始化函式__init__ 固定不回傳東西嗎, 如果在下面return東西會造成程式錯誤嗎
追加個問題 open(檔案...) 只能開啟  檔名.txt的檔案嗎   檔名.py的檔案為甚麼開不了



標題:tensorflow CNN_LSTM出現維度錯誤
標籤:python tensorflow cnn lstm 

我使用CNN+LSTM要預測
出現錯誤:ValueError: Error when checking target: expected time_distributed_2 to have 3 dimensions, but got array with shape (5692, 1)。
詢問要如何改善
# -*- coding: utf-8 -*-
"""
Created on Mon Jul 22 06:17:16 2019

@author: feather
"""

import pandas as pd

foxconndf= pd.read_csv('SPY.csv', index_col=0 )
foxconndf.dropna(how='any',inplace=True)
foxconndf = foxconndf.drop(["Adj Close"], axis=1)

from sklearn import preprocessing

def normalize(df):
    newdf= df.copy()
    min_max_scaler = preprocessing.MinMaxScaler()
    
    newdf['Open'] = min_max_scaler.fit_transform(df.Open.values.reshape(-1,1))
    newdf['Low'] = min_max_scaler.fit_transform(df.Low.values.reshape(-1,1))
    newdf['High'] = min_max_scaler.fit_transform(df.High.values.reshape(-1,1))
    newdf['Volume'] = min_max_scaler.fit_transform(df.Volume.values.reshape(-1,1))
    newdf['Close'] = min_max_scaler.fit_transform(df.Close.values.reshape(-1,1))
    
    return newdf

foxconndf_norm= normalize(foxconndf)

import numpy as np

def data_helper(df, time_frame):
    
    # 資料維度: 開盤價、收盤價、最高價、最低價、成交量, 5維
    number_features = len(df.columns)

    # 將dataframe 轉成 numpy array
    datavalue = df.as_matrix()

    result = []
    # 若想要觀察的 time_frame 為20天, 需要多加一天做為驗證答案
    for index in range( len(datavalue) - (time_frame+1) ): # 從 datavalue 的第0個跑到倒數第 time_frame+1 個
        result.append(datavalue[index: index + (time_frame+1) ]) # 逐筆取出 time_frame+1 個K棒數值做為一筆 instance
    
    result = np.array(result)
    number_train = round(0.9 * result.shape[0]) # 取 result 的前90% instance做為訓練資料
    
    x_train = result[:int(number_train), :-1] # 訓練資料中, 只取每一個 time_frame 中除了最後一筆的所有資料做為feature
    y_train = result[:int(number_train), -1][:,-1] # 訓練資料中, 取每一個 time_frame 中最後一筆資料的最後一個數值(收盤價)做為答案
    
    # 測試資料
    x_test = result[int(number_train):, :-1]
    y_test = result[int(number_train):, -1][:,-1]
    
    # 將資料組成變好看一點
    x_train = np.reshape(x_train, (x_train.shape[0], x_train.shape[1], number_features))
    x_test = np.reshape(x_test, (x_test.shape[0], x_test.shape[1], number_features))  

    return [x_train, y_train, x_test, y_test]

# 以20天為一區間進行股價預測
X_train, y_train, X_test, y_test = data_helper(foxconndf_norm, 20)
print('X_train:', np.array(X_train).shape) #X_train: (5692, 20, 5)
print('y_train:', np.array(y_train).shape) #y_train: (5692,)
print('X_test:', np.array(X_test).shape)   #X_test: (633, 20, 5)
print('y_test:', np.array(y_train).shape)  #y_test: (5692,)
#print('x:', np.array(X).shape) #x: (113813, 20, 1)

from keras.models import Sequential
#from keras.layers.core import Dense, Dropout, Activation
#from keras.layers.recurrent import LSTM
from keras.layers import Dense, Dropout, Activation
from keras.layers import LSTM
import keras


from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import LSTM
from keras.layers import RepeatVector
from keras.layers import TimeDistributed
from keras.layers.convolutional import Conv1D
from keras.layers.convolutional import MaxPooling1D, MaxPooling2D, Conv2D
from keras.models import Sequential
from keras.layers import Dense,Dropout

import keras.backend as K

def r2_keras(y_true, y_pred):
    """Coefficient of Determination 
    """
    SS_res =  K.sum(K.square( y_true - y_pred ))
    SS_tot = K.sum(K.square( y_true - K.mean(y_true) ) )
    return ( 1 - SS_res/(SS_tot + K.epsilon()) )


def build_model(input_length, input_dim):    
    # CNN+LSTM
    input_length=20
    input_dim=5
    model = Sequential()
    model.add(Conv1D(filters=64, kernel_size=3, activation='relu', input_shape=(input_length, input_dim)))
    model.add(Conv1D(filters=64, kernel_size=3, activation='relu'))
    model.add(MaxPooling1D(pool_size=2))
    model.add(Flatten())
    n_outputs=1
    model.add(RepeatVector(n_outputs))
    model.add(LSTM(200, activation='relu', return_sequences=True))
    model.add(TimeDistributed(Dense(100, activation='relu')))
    model.add(TimeDistributed(Dense(1)))
    #model.compile(loss='mse', optimizer='adam')  
    model.compile(loss='mean_squared_error', optimizer='rmsprop',metrics=['mae',r2_keras])
    model.summary()
    
    print(model.summary())
    return model

# 20天、5維
model = build_model( 20, 5 )



# 一個batch有128個instance，總共跑50個迭代
#model.fit( X_train, y_train, batch_size=128, epochs=1, validation_split=0.1, verbose=1)

model_path='binary_model.h5'
history=model.fit( X_train, y_train, epochs=2800, batch_size=10, validation_split=0.1, verbose=2,
          callbacks = [keras.callbacks.EarlyStopping(monitor='val_loss', min_delta=0, patience=10, verbose=0, mode='min'),
                       keras.callbacks.ModelCheckpoint(model_path,monitor='val_loss', save_best_only=True, mode='min', verbose=0)]
          )


def denormalize(df, norm_value):
    original_value = df['Close'].values.reshape(-1,1)
    norm_value = norm_value.reshape(-1,1)
    
    min_max_scaler = preprocessing.MinMaxScaler()
    min_max_scaler.fit_transform(original_value)
    denorm_value = min_max_scaler.inverse_transform(norm_value)
   
    return denorm_value

# 用訓練好的 LSTM 模型對測試資料集進行預測
pred = model.predict(X_test)

# 將預測值與正確答案還原回原來的區間值
denorm_pred = denormalize(foxconndf, pred)
denorm_ytest = denormalize(foxconndf, y_test)

import matplotlib.pyplot as plt
#%matplotlib inline  

plt.plot(denorm_pred,color='red', label='Prediction')
plt.plot(denorm_ytest,color='blue', label='Answer')
plt.legend(loc='best')
plt.show()


# list all data in history
print(history.history.keys())

# summarize history for R^2
fig_acc = plt.figure(figsize=(5, 5))
plt.plot(history.history['r2_keras'])
plt.plot(history.history['val_r2_keras'])
plt.title('model r^2')
plt.ylabel('R^2')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')
plt.show()

# summarize history for MAE
fig_acc = plt.figure(figsize=(5, 5))
plt.plot(history.history['mean_absolute_error'])
plt.plot(history.history['val_mean_absolute_error'])
plt.title('model MAE')
plt.ylabel('MAE')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')
plt.show()

# summarize history for Loss
fig_acc = plt.figure(figsize=(5, 5))
plt.plot(history.history['loss'])
plt.plot(history.history['val_loss'])
plt.title('model loss')
plt.ylabel('loss')
plt.xlabel('epoch')
plt.legend(['train', 'test'], loc='upper left')
plt.show()

內容如下:
https://drive.google.com/file/d/1SGolkmQn50GjKsckT3C7TWqVjajvkDSd/view?usp=sharing


標題:python 實體物件
標籤:python 

為什麼呼叫這個類別裡的函示中的變數不用加函式名稱
不是應該是 類別名稱.函式名稱(函式中變數)
把變數帶入進去後才得到
self.x=3
self.y=4
的物件嗎
還有, 這裡的self根__init__分別是什麼意思, self在變數裡卻不發揮作用
self.變數 代表的是該物件的屬性嗎, 是因為加了self嗎
class point :
def init(self,x , y) :
self.x=x
self.y=y
def show(self) :
    print(a.x)
    print(a.y)

a=point(3,4)
point.show()
上面這個程式最後面point.show(0)是呼叫類別裡的函式
這裡的self必須要有一個資料
若把self改成a
相當於point(3,4).show() 前者是初始函式已經有資料了 在呼叫第二個函式
後者是給第一個函式資料後再呼叫
有甚麼不同嗎



標題:讀取特定網址中資料 python
標籤:python json 

讀取特定網址中資料
import urllib.request as url
with url.urlopen(網址) as response :
data=response.read().decode("utf-8") 做中文的解碼
print(data)
各位能解釋一下程式的意思嗎
urllib.request是一個模組, 要載入後才能用
utl是別名, 方便用
urlopen 是一個函式
裡面的網址是函式裡的變數
response是一個變數, 代表網址裡的資料
response要經過read()這個函式讀取後才能用
後面是解碼中文
接上面
import json 載入內建模組 json
data=json.load(response)
使用json的模組 處理json格式的資料
load是一個函式
json 還有別的函式嗎 load代表讀取資料的意思嗎
還有有人會跟我一樣寫程式時會讀程式嗎
就像英翻中一樣
一遍寫英文一邊自己翻譯邏輯對不對


標題:請教大神使用Django架站，報錯誤type error
標籤:python django 新手上路 

<上一篇發錯地方，重新再發問一次>
各位大神午安，目前正在使用django架設練習網頁，在設置Django urls name一直發生錯誤，請問有無熟悉django的大神可以給點方向!
以下是我的程式碼
urls.py
from django.contrib import admin
from django.urls import path

from . import views

urlpatterns = [
    path('', views.showtemplate),
    path('<int:id>/', views.singleVendor, name='vendor_id'), # 這一行
    path('create', views.vendor_create_view),
]`

views.py
from django.shortcuts import render
from .models import Vendor
from .forms import VendorForm #import相對應的model Form
from .forms import RawVendorForm # 新增 RawVendorForm
from django.http import Http404
from django.shortcuts import get_object_or_404

# Create your views here.
def showtemplate(request):
    vendor_list = Vendor.objects.all() # 把所有 Vendor 的資料取出來
    context = {'vendor_list': vendor_list} # 建立 Dict對應到Vendor的資料，
    return render(request, 'vendors/vendor_detail.html', context)
#建立class [vendor_create_view]
def vendor_create_view(request):
    form = RawVendorForm(request.POST or None)
    if form.is_valid():
        Vendor.objects.create(**form.cleaned_data)
        form = RawVendorForm()
    context = {
        'form' : form
    }
    return render(request, "vendors/vendor_create.html", context)
def singleVendor(request, id):
    vendor_list = get_object_or_404(Vendor, id=id)
    # try:
    #     vendor_list = Vendor.objects.get(id=id)
    # except Vendor.DoesNotExist:
    #     raise Http404
    context = {
        'vendor_list': vendor_list
    }
    return render(request, 'vendors/vendor_detail.html', context)

modles.py
from django.db import models
# 新增
from django.contrib import admin
# 額外 import 這個過濾套件
from django.utils.translation import gettext_lazy as _
from django.urls import reverse #新增

# Create your models here.
class Vendor(models.Model):
	vendor_name = models.CharField(max_length = 20) # 攤販的名稱
	store_name = models.CharField(max_length = 10) # 攤販店家的名稱
	phone_number = models.CharField(max_length = 20) # 攤販的電話號碼
	address = models.CharField(max_length = 100) # 攤販的地址
     #新增
	def get_absolute_url(self):
		return reverse("vendor_id", kwargs={"id": self.id})

vedor_detail.html
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
{% extends "base.html" %}
{% block title %} My store {% endblock %}
{% block content%}
{% for vlist in vendor_list %}
  <h1> 店家 : {{vlist.vendor_name}} </h1>
  <p> <a href= {{ vlist.get_absolute_url }}> More detail...</a> </p>
{% endfor %}
{% endblock %}
  </body>
</html>

錯誤原因:TypeError at /vendor/1/
'Vendor' object is not iterable
Request Method:	GET
Request URL:	http://127.0.0.1:8000/vendor/1/
Django Version:	2.2.3
Exception Type:	TypeError
Exception Value:	
'Vendor' object is not iterable
有google過錯誤原因，試著修改vedor_detail，還是會顯示失敗，請各位大神幫幫忙


標題:linebot 獲取 user profile 的問題 (python)
標籤:linebot user profile python 

各位高手好，小弟一直卡關，請版上各位高手解惑
我已經成功得到access_token，想透過access_token
獲取user profile，但一直不成功，錯誤顯示401
程式碼如下
profile_data = {'Authorization': 'Bearer ' + access_token}
profile = requests.post('https://api.line.me/v2/profile/', headers=profile_data)
user_id = str(profile['userId'])
displayName = str(profile['displayName'])
pictureUrl = str(profile['pictureUrl'])
statusMessage = str(profile['statusMessage'])


標題:如圖, 明明裡面是亂碼未甚麼不用解碼
標籤:python 

下面的圖是從文件轉過來的
sys.path.append("taxt")
文件裡是正常的, 轉過來變亂碼, 但不解碼輸出正常, 解碼後反而輸不出來
要怎麼在一開始轉過來就是正常的呢



標題:python 要怎麼連續取得多個變數
標籤:python 

在c#語法中
cout<<"請輸入 a1 \n a2 \n a3 \n"
cin>>a1,a2,a3
即可連續取得多筆資料
在python 中 input("請輸入a1,a2,a3") 只會輸入一個資料
還有python還有其他取得資料的方法嗎


標題:【Python】如何在有限的記憶體(8G)內做17萬筆資料的 Apriori 演算法，或者有更快方法？
標籤:python3 big data apriori memory algorithm 

各位大大好，小弟是資料分析新手，目前遇到一個一直卡關的問題：
我目前在做商品的關聯性分析，需要用到Apriori演算法
原本的 raw dataset 有170萬筆，我在前期資料整理時就常常會出現memory error的問題，後來我的夥伴跟我說可以用抽樣的方式來做所以只需要處理17萬筆資料，前期處理也順利完成。
但問題來了，在我做好這17W筆資料的 one-hot encoding 後，要丟入 mlxtend 套件的 Apriori 函式時，每次做到最後這一步，電腦都跑神久，不然就是畫面直接凍結。
在用 jupyternotebook 環境實作時，為了清出記憶體空間，我也使用
del data
gc.collect()

這類的方法，但似乎沒啥用，有沒有大大知道怎麼處理這種問題的 Q_Q
或者有沒有這種演算法的雲端運算資源可以使用？
還是我該去網咖包一台高級一點的電腦來跑嗚嗚？


標題:Python 爬蟲 出現SSLError (Centos7)
標籤:centos python3 requests sslerror 

最近剛學linux centos
當我使用python爬中央氣象局的資料的時候
都會出現SSLERROR的情況
爬其他網站都不會!!
有邦友遇到相同的問題嗎?

這是我的py檔
import json
import requests
url = 'https://opendata.cwb.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=CWB-37A&format=JSON&elementName=PoP'
htmls = requests.get(url)
data = htmls.json()

p.s.
已經試過，一樣給Error
htmls = requests.get(url,verify="False")


執行後出現的錯誤
Traceback (most recent call last):
  File "/home/yen/env/lib/python3.7/site-packages/urllib3/connectionpool.py", line 591, in urlopen
    conn = self._get_conn(timeout=pool_timeout)
  File "/home/yen/env/lib/python3.7/site-packages/urllib3/connectionpool.py", line 249, in _get_conn
    return conn or self._new_conn()
  File "/home/yen/env/lib/python3.7/site-packages/urllib3/connectionpool.py", line 818, in _new_conn
    raise SSLError("Can't connect to HTTPS URL because the SSL "
urllib3.exceptions.SSLError: Can't connect to HTTPS URL because the SSL module is not available.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/yen/env/lib/python3.7/site-packages/requests/adapters.py", line 449, in send
    timeout=timeout
  File "/home/yen/env/lib/python3.7/site-packages/urllib3/connectionpool.py", line 641, in urlopen
    _stacktrace=sys.exc_info()[2])
  File "/home/yen/env/lib/python3.7/site-packages/urllib3/util/retry.py", line 399, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='opendata.cwb.gov.tw', port=443): Max retries exceeded with url: /api/v1/rest/datastore/F-C0032-001?Authorization=CWB-3CE2FA7&format=JSON&elementName=PoP (Caused by SSLError("Can't connect to HTTPS URL because the SSL module is not available."))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/yen/env/lib/python3.7/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
  File "/home/yen/env/lib/python3.7/site-packages/requests/api.py", line 60, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/yen/env/lib/python3.7/site-packages/requests/sessions.py", line 533, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/yen/env/lib/python3.7/site-packages/requests/sessions.py", line 646, in send
    r = adapter.send(request, **kwargs)
  File "/home/yen/env/lib/python3.7/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='opendata.cwb.gov.tw', port=443): Max retries exceeded with url: /api/v1/rest/datastore/F-C0032-001?Authorization=CWB-NA-F8C-4F1-B32-0225CE2FA7&format=JSON&elementName=PoP (Caused by SSLError("Can't connect to HTTPS URL because the SSL module is not available."))


感恩


標題:Python讀取json檔後找尋符合條件的字串並輸出
標籤:python3 搜尋 

Python讀取json檔後找尋符合條件的字串並輸出所屬group 
例如需要找到SmoothScroll這個字串並輸出為 group 1，目前有試過使用
for F in data:
if F=='SmoothScroll':
print('Group 1')
break
else:
print("no")!
但無法達到所要的需求，有進行爬文但沒有搜尋到方法，還請各位大大指點
以下是json檔
{'group 1': [{'index': 8,
   'API name': 'RegOpenKey',
   'params': {'hKey': 'HKEY_CURRENT_USER\\Control Panel\\Desktop'},
   'action': 'Read'},
  {'index': 9,
   'API name': 'RegQueryValue',
   'params': {'hKey': 'HKEY_CURRENT_USER\\Control Panel\\Desktop\\SmoothScroll'},
   'action': 'Read'},
  {'index': 10,
   'API name': 'RegCloseKey',
   'params': {'hKey': 'HKEY_CURRENT_USER\\Control Panel\\Desktop'},
   'action': 'Close'},
  {'index': 54,
   'API name': 'RegOpenKey',
   'params': {'hKey': 'HKEY_CURRENT_USER\\Control Panel\\Desktop'},
   'action': 'Read'},
  {'index': 55,
   'API name': 'RegQueryValue',
   'params': {'hKey': 'HKEY_CURRENT_USER\\Control Panel\\Desktop\\SmoothScroll'},
   'action': 'Read'},
  {'index': 56,
   'API name': 'RegCloseKey',
   'params': {'hKey': 'HKEY_CURRENT_USER\\Control Panel\\Desktop'},
   'action': 'Close'}]}



標題:如何使用Python3中的jupyter抓取tripadvisor的評論資料
標籤:python3 [jupyter notebook] 

想請問一下，要如何從tripadvisor的網站中抓取長榮航空評論文字和分數
並且抓取每一頁的資料
最後儲存成一個檔案
以利之後的分析
小妹在這裡懇求各位的幫忙，拜託大家了


標題:python 選擇讀取指定檔案，內容出現錯誤
標籤:python 

選擇讀取指定檔案，再將train["Date"]時間進行轉換發生錯誤。
詢問要如何改善
Traceback (most recent call last):
  File "<ipython-input-81-7138c031ea33>", line 1, in <module>
    runfile('C:/Users/feather/Desktop/python20180626/test/load_data.py', wdir='C:/Users/feather/Desktop/python20180626/test')

  File "D:\Anaconda3\lib\site-packages\spyder_kernels\customize\spydercustomize.py", line 786, in runfile
    execfile(filename, namespace)

  File "D:\Anaconda3\lib\site-packages\spyder_kernels\customize\spydercustomize.py", line 110, in execfile
    exec(compile(f.read(), filename, 'exec'), namespace)

  File "C:/Users/feather/Desktop/python20180626/test/load_data.py", line 55, in <module>
    train["Date"] = pd.to_datetime(train["Date"])

TypeError: 'NoneType' object is not subscriptable

程式碼
import pandas as pd

def load_data(v):
    class switch(object):
        def __init__(self, value):
            self.value = value
            self.fall = False

        def __iter__(self):
            """Return the match method once, then stop"""
            yield self.match
            raise StopIteration

        def match(self, *args):
            """Indicate whether or not to enter a case suite"""
            if self.fall or not args:
                return True
            elif self.value in args: # changed for v1.5, see below
                self.fall = True
                return True
            else:
                return False

    v = '1'
    for case in switch(v):
        if case('1'):
            pd.read_csv("SPY.csv", encoding='utf-8')
            print("Read SPY.csv OK")
            break
        if case('2'):
            pd.read_csv("SPY2.csv", encoding='utf-8')
            print("Read SPY2.csv OK")
            break
        if case(): # default, could also just omit condition or 'if True'
            print("something else!")


if __name__ == "__main__":
    train = load_data(1)
    
    train["Date"] = pd.to_datetime(train["Date"])
    train["year"] = train["Date"].dt.year
    train["month"] = train["Date"].dt.month
    train["date"] = train["Date"].dt.day
    train["day"] = train["Date"].dt.dayofweek



標題:python 要怎麼同時輸出變數與字串
標籤:python if判斷 變數 

如果把下面if後面的a,固定變數換成上面未輸入的x未知變數,也是一樣的操作嗎



標題:Python 送出資料 求大神給方向
標籤:python 

大神們好
目前利用Python撰寫一個網頁自動修改內容的設定，
但是遇到了一個瓶頸，不知道如何繼續前進的狀況(沒方向)，
框架大概如下:
1.這個網頁用是".aspx"
2.網頁權限設定處，有一個欄位可以輸入編號查詢，點選查詢後才會出現該使用者的權限設定有哪些。
2-1.查詢出來後才會出現內容表格。
2-2.若要調整權限則用checkbox打勾or取消。
3.當查詢資料後，在表格最右方有一個"儲存"，勾選欲開放之權限後，點擊儲存即可完成設定。
4.我希望不要透過Selenium這樣的瀏覽器模擬。
但是，上方的操作都是在同一個網址內完成，只是傳送的訊息略顯不同而已，想請問各位能否給個方向?謝謝。
相關畫面如下(因機敏關係內容調整處理)



標題:python安裝出現錯誤如何解決
標籤:python畫股票 

https://ithelp.ithome.com.tw/articles/10206894
依上面的網址下載TA_Lib-0.4.17-cp36-cp36m-win_amd64.whl
但安裝時出現以下錯誤

請問大家這是什麼意思？


標題:如何讀取多個資料，並同時丟進模型，和幾乎能同時間拋出結果於頁面上?
標籤:python mysql flask keras lstm 

想請問各位大神:
最近在論文在開發股票預測平台，
想請問大家可否給予建議或者方向。
假設目前選定三支股票，並且利用爬蟲方式存到MYSQL當中，
並且分別存到3個table中，
如果我想要同時讀取MYSQL當中三個資料，
並且同時進入一樣LSTM模型當中，並把結果存在MYSQL裡，
最後再把結果抓出呈現於flask上，
且這樣的動作不斷的進行，直到交易時間結束
是否這樣是需要利用到多進程的方式???(為了讓它可以同時進入model裡)
是否加上排程或者迴圈等方式讓他可以不斷的執行?(運算完後又繼續抓取資料運算)
還是有其他更好的方法呢?
以及是不是我的想法有點錯誤，可否指點一下
謝謝各位


標題:Python 在 IDLE 编辑器中 import pygame 失败，怎么回事？
標籤:pip pygame idle python path 

我在网上查了，网上说 Windows 版的 Python 3.7 之后，就不需要单独安装 pip 了，并且我也查看了 Python 目录，发现 pip 确实已经存在了。

但当我 import pygame 时
import pygame

提示：
Traceback (most recent call last):
  File "C:/Users/Admin/Desktop/Alien/test.py", line 1, in <module>
    import pygame
ModuleNotFoundError: No module named 'pygame'

环境变量也已经配置了：



標題:我在python vscode 程式碼 跑的出來, 不過跑出來跟我輸出的完全不一樣
標籤:python debug 初學者 新手 幫助 




標題:Python 类调用时，提示变量没有定义？
標籤:变量 python python 类 class 类调用 

创建了一个类模块，在调用这个模块时，一直提示我一个变量没有被定义，但我明明定义了：


我如果在类模块的文件中，去定义变量：
question = "What language did you first learn to speak?"
则程序可以正常运行，我代码哪里写错了吗？


標題:Python 代码测试问题
標籤:python unittest return print 

我有一个简短的代码，返回city 和 county。
直接调用是正常的：

但我使用 unittest 去测试这段代码的时候，却发生了错误：

但我把 print 改成 return 就好了：

这是为什么，如果我想使用 print，应该怎么修改我的测试代码？


標題:關於利用python取得outlook通訊錄
標籤:python python3 python 3 outlook 

目前的話我可以利用一個人的名字去得到他的相關資料(電話、姓名、別名、信箱、所屬部門等)
假設outlook的通訊錄內有個群組 A ，
我想取得A這個群組裡面的人員名單
想問有沒有哪位大神有方向可以提供一下


標題:Python 如何去除列表中的转义字符
標籤:python 转义符 列表 

如图：

这是通过 Python 打开 TXT 文件，并生成的一个列表。
请问如何删除结果中的转义符？
源代码：



標題:Python 建立xml檔案問題
標籤:python xml level-order 

請問要如何利用python建立下面xml的檔案呢？
<?xml version="1.0" encoding="UTF-8"?>
<Project Version="1.0">	
	<Model Name="ABCD"/>
		<Panel Name="Hello">
			<GroupDic Name="NONE"/>				
		</Panel>
</Project>




標題:Python 函数中的 return
標籤:python return python return python 类 函数 


在图片这行代码中，为什么是用 return long_name.tital(), 而不是使用 print（long_name.title()）?
什么情况下，需要使用 return？


標題:[Visual Basic 陣列] 與 [Python列表]問題探討
標籤:python3 visual basic list comprehension 列表解析 列表推導 

普通寫法
#Python編寫：
a = []
for x in range(21):
    if x%2==0:
        a.append(x)
print(a)

'Visual Basic編寫：
Sub main()
    Dim so As New ArrayList
    For x = 0 To 20
        If x Mod 2 = 0 Then
            so.Add(x)
        End If
    Next
End Sub


運行結果：
[0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20]


高級寫法
#Python List comprehension寫法：
a = [x for x in range(21) if x%2==0]
print(a)

'Visual Basic
??????




使用VB做得到類似Python的List comprehension寫法嗎?




VB除了普通寫法，還有其他更好的寫法嗎?





標題:如何讓python直接讀取k欄和l欄的時間
標籤:python 


如何讓python直接讀取excel的k欄和l欄的時間，我要直接抓開始和結束的時間計算別欄的數值，因為每筆開始和結束時間不一致，想問有甚麼方法
謝謝


標題:關於ObjectDetection API的範本無法執行的問題----
標籤:python tensorflow ai object detection 

我已經重灌套件跟環境好幾次了，還是沒辦法執行他給的.PY檔
from utils import label_map_util
from utils import visualization_utils as vis_util
會出現以下ERROR
ImportError                               Traceback (most recent call last)
 in 
----> 1 from utils import label_map_util
2
3 from utils import visualization_utils as vis_util
C:\TensorFlow\models\research\object_detection\utils\label_map_util.py in 
19 import tensorflow as tf
20 from google.protobuf import text_format
---> 21 from object_detection.protos import string_int_label_map_pb2
22
23
ImportError: cannot import name 'string_int_label_map_pb2'
重新安裝過PROTOC始終不行
也有重新編譯過檔案，單獨針對tring_int_label_map去做編譯
不知道是甚麼問題，GOOGLE都是說重新編譯就可以


標題:關於ObjectDetection API的範本無法執行的問題
標籤:python tensorflow ai object detection keras 

我已經重灌套件跟環境好幾次了，還是沒辦法執行他給的.PY檔
from utils import label_map_util
from utils import visualization_utils as vis_util
會出現以下ERROR
ImportError                               Traceback (most recent call last)
 in 
----> 1 from utils import label_map_util
2
3 from utils import visualization_utils as vis_util
C:\TensorFlow\models\research\object_detection\utils\label_map_util.py in 
19 import tensorflow as tf
20 from google.protobuf import text_format
---> 21 from object_detection.protos import string_int_label_map_pb2
22
23
ImportError: cannot import name 'string_int_label_map_pb2'
重新安裝過PROTOC始終不行
也有重新編譯過檔案，單獨針對tring_int_label_map去做編譯
不知道是甚麼問題，GOOGLE都是說重新編譯就可以


標題:PYTHON無法安裝
標籤:python3 

請問各位大大:
WIN10安裝PYTHON失敗,出現以下訊息, 該如何是好...
0x80070641 -無法存取 Windows Installer 服務,如果Wwindows Installer
未正確安装,就可能發生。請連絡您的支援人員尋求協助。


標題:Python Tkinter 更新Text內容
標籤:python tkinter refresh 

我用tkinter寫出了一個Text框和一個按鈕，Text框的內容是一個變數(output)，而按鈕按下後可以成功更變變數output的內容，但是我無法讓text框的內容更新，網路上找到的方法都失敗
import os
import bs4
from tkinter import *

run = '0'

def main():
    ...
    ...
    ...
    output = response #用監控看確定output會更新
    global run #第二次執行(按按鈕)才更新text內容
    if run == '0': #第一次
        run = '1'
    else: #第二次(更新text)
        T.update()#沒用
        T.update_idletasks()#也是沒用
        
#設定tkinter視窗
root = Tk()
root.geometry("500x800")
root.attributes("-topmost", 1)

main()#第一次執行
button = Button(root, text="Refresh", command=main)#按鈕執行
button.pack()

S = Scrollbar(root)
T = Text(root, height=4, width=100)
S.pack(side=RIGHT, fill=Y)
T.pack(side=LEFT, fill=Y)
S.config(command=T.yview)
T.config(yscrollcommand=S.set)
T.tag_configure('in', font=('Microsoft JhengHei UI', 10))

T.insert(END, output, 'in')
T.config(state=DISABLED)

root.mainloop()



標題:有人會這幾題python題目嗎？
標籤:python 

1.匯入


標題:python matplotlib 繪圖問題
標籤:python matplotlib.pyplot 

當用 lines 定義為兩條線的資料時
要如何去分別定義各自的顏色

code是從文章copy下來的
code出處:https://ithelp.ithome.com.tw/articles/10196239


標題:利用matplotlib畫的圖片，如何使用linebot的方式傳送
標籤:python linebot matplotlib.pyplot 

在網絡上有查到利用linebot傳送圖片只能用圖片的網址，但是我要如何用Python直接將畫出的圖形上傳到imgur來獲取網址?


標題:請教Python學習推薦
標籤:python 

最近想開始學習Python和資料分析,
想請教會Python的各位大大有什麼推薦的網路教程和書籍嗎?
目前本人比較偏向買書籍來看,再配合網路的資料,這樣會比較有目標的方向



標題:關於Python執行結果自動輸出 txt檔失敗問題
標籤:python beautifulsoup 

各位前輩大家好，小弟最近在學python爬蟲，然後遇到問題如下，我現在可以抓到所爬的網站資料原始碼，不過想要將把抓到的原始碼自動寫入txt檔存檔。
執行Python後發生問題:
Traceback (most recent call last):
File "tomy-request.py", line 32, in 
file.write(root.html)
TypeError: write() argument must be str, not Tag
再請前輩們指教，謝謝!!
#抓取網站 原始碼
import urllib.request as req
url="https://www.cac.edu.tw/apply107/system/107ColQry_forapply_4hgd9/html/107_002012.htm"
#建立一個Request物件，附加Request Headers的資訊
request=req.Request(url,headers={
"User-Agent":"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Mobile Safari/537.36"
})
with req.urlopen(request) as response:
data=response.read().decode("utf-8") #讀出資料
#解析原始碼
import bs4
root=bs4.BeautifulSoup(data,"html.parser")
print (root.html) #印出html內的原始碼
with open("html1.txt","w",encoding="utf-8") as file:
file.write(root.html)


標題:VScode 如何幫函數寫註解?
標籤:visual studio code python 

用VScode寫Python時, 我知道可以在def下用多行註解呈現函式的說明
但這是用什麼語法呢? 用Markdown的語法似乎無效

像是滑鼠移到normal時, 會跳出紅色框的說明(或是註解), 但格式是可調整的, 想詢問對應的格式


標題:python如何操作selenium讓chrome列印
標籤:python selenium 列印 

from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import pyautogui
import time
driver = webdriver.Chrome()
driver.get("https://www.google.com.tw/")
driver.execute_script("window.print();")
time.sleep(1)
pyautogui.press('enter')
'''driver.switch_to_active_element()
driver.find_elements_by_class_name("action-button").click()'''
#pyautogui.hotkey('ctrl', 'shift', 'p')
#pyautogui.hotkey('alt', 'p')

大家好 小弟最近想要列印出selenium所抓到的畫面
透過window.print(); 或 pyautogui.hotkey('ctrl', 'shift', 'p')
都可以順利進入到列印畫面
然而卻一直無法點下彈出來的列印按鈕
以上是我的程式碼
想請教大神有沒有相對應的解決方法


標題:求各位大神 差最後一步了
標籤:graphviz 十萬火急 python 3 程式畫圖 迴圈 

感謝 各位大神 po了兩篇文後 讓我的程式到了最後一步
我是用graphviz這個套件來畫圖的
ip = [['192.168.1.1','168.95.98.254','168.95.83.70','220.128.2.226','220.128.1.101','168.95.25.13'],      ['192.168.1.1','168.95.98.254','168.95.82.6','220.128.1.6','220.128.1.101','36.226.251.254']]
假如這是我的一個ip 列表
我是利用dict的方式來處理 節點都建好了
這是我的dict
{'192.168.1.1': '0', '168.95.98.254': '1', '168.95.83.70': '2', '220.128.2.226': '3', '220.128.1.101': '4', '168.95.25.13': '5', '168.95.82.6': '6', '220.128.1.6': '7', '36.226.251.254': '8'}
我要利用迴圈的方式去呈獻這個圖 該怎麼做呢
這個是我用手動的方式建的,我只要用迴圈去表示下面這行就可以了感謝大家
h = ['01', '12','23','34','45','01','16', '67','74','48']
h1 = set(h)
dot.edges(h1)



標題:測試功能+尋找同好
標籤:python3 

測試一下功能
最近學習拍桑中
希望能找到學習的同好


標題:求救 nmap 畫出網路拓撲 
標籤:網路拓墣 python3 寫程式 十萬火急 樹狀圖 

前文 https://ithelp.ithome.com.tw/questions/10193596
之前我有發過一篇文,現在我已經成功把程式寫到剩下畫圖的部份了，但因為作業的期限快到了所以現在在考慮要不要換另一種方式,也就是linux的指令pstree,利用類似這種的樹狀圖來呈獻出我要的網路拓普效果,求大神點一下,我在網路上查到的樹狀圖都不是這種的,我現在達到的步驟是最後我要畫的ip都已經掃描出來，也節篩好了,差把這些ip畫上去,然後同樣的ip再分支出去,大概這樣.
感謝,請大家鞭小力一點,我還在學習中QQ


